# -*- coding: utf-8 -*-
"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     XG-XRAY COMMANDER V70 THE ENDGAME - 275 KURAL TAM ENTEGRASYON               â•‘
â•‘     ğŸ¯ YENÄ° MÄ°MARÄ°: GEMÄ°NÄ° OCR + PYTHON HESAPLAMA + GEMÄ°NÄ° SUNUM                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  ğŸš€ V70 YENÄ°LÄ°KLER:                                                             â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 0: ROOT PROTOKOLÃœ (3 KURAL)                                           â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 1: VERÄ° KAYNAÄI PROTOKOLLERÄ° (4 KURAL)                               â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 2: ANALÄ°Z ÅABLONU (52 VERÄ° ALANI)                                     â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 3: TÄ°K Ä°ÅARETÄ° KURALLARI (6 KURAL)                                    â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 4: GÄ°YOTÄ°N VE VETOLAR (58 KURAL) - TAM DETAY                          â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 5: BANKO ÅARTLARI (40 ÅART) - 11 BANKO TÄ°PÄ°                           â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 6: CANLI STRATEJÄ° (9 SENARYO)                                         â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 7: KUPON KURALLARI (10 KURAL)                                         â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 8: Ä°Y RADAR (8 KURAL)                                                 â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 9: SÄ°MÃœLASYON DÃ–NGÃœSÃœ (17 KURAL)                                      â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 10: GÃœVEN PUANI VE KASA (35 KURAL)                                    â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 11: GENEL PRENSÄ°PLER (17 KURAL)                                       â•‘
â•‘  ğŸ“‹ BÃ–LÃœM 12: SUNUM PROTOKOLÃœ (16 KURAL)                                        â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â•‘
â•‘  ğŸ“Š TOPLAM: 275 KURAL - %100 ENTEGRE                                            â•‘
â•‘  ğŸ”§ YENÄ° MÄ°MARÄ°:                                                                 â•‘
â•‘     â€¢ AÅAMA 1: Gemini OCR (GÃ¶rsel â†’ JSON Veri)                                   â•‘
â•‘     â€¢ AÅAMA 2: Python Hesaplama (Matematik + Kural KontrolÃ¼)                     â•‘
â•‘     â€¢ AÅAMA 3: Gemini Sunum (Åablon Doldurma + Yorum)                           â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â•‘
â•‘  âœ¨ Ã–NCEKÄ° Ã–ZELLÄ°KLER (V5.7):                                                    â•‘
â•‘  â€¢ ğŸ”´ CanlÄ± Bahis Takip Sekmesi                                                  â•‘
â•‘  â€¢ ğŸ“‹ HaftalÄ±k/AylÄ±k Raporlar                                                    â•‘
â•‘  â€¢ ğŸ… GÃ¼nÃ¼n MVP MaÃ§Ä± + GÃ¼nlÃ¼k/HaftalÄ±k Turnuva                                   â•‘
â•‘  â€¢ ğŸ’€ Kara Liste / âœ¨ AltÄ±n Liste                                                â•‘
â•‘  â€¢ ğŸ¯ Sniper Modu + ğŸ” Gizli Banko                                               â•‘
â•‘  â€¢ ğŸ’° Kasa YÃ¶netim DanÄ±ÅŸmanÄ±                                                     â•‘
â•‘  â€¢ ğŸŒ¡ï¸ MaÃ§ SÄ±caklÄ±k HaritasÄ±                                                      â•‘
â•‘  â€¢ ğŸš¨ Panik Butonu                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ”„ VERSÄ°YON VE GÃœNCELLEME SÄ°STEMÄ°
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
APP_VERSION = "70.2.0"  # Major.Minor.Patch formatÄ±
APP_NAME = "XG-XRAY Commander"
BUILD_DATE = "2025-12-19"

# GitHub AyarlarÄ± - KENDÄ° REPO BÄ°LGÄ°LERÄ°NÄ°ZÄ° GÄ°RÄ°N
GITHUB_USER = "Doksandakikaanaliz"  # GitHub kullanÄ±cÄ± adÄ±nÄ±z
GITHUB_REPO = "XG-XRAY-V70-"       # Repo adÄ±nÄ±z
GITHUB_BRANCH = "main"            # Ana branch (main veya master)
GITHUB_FILE = "XG_XRAY_V70.py"    # Ana dosya adÄ±

# Otomatik URL oluÅŸtur
GITHUB_RAW_URL = f"https://raw.githubusercontent.com/{GITHUB_USER}/{GITHUB_REPO}/{GITHUB_BRANCH}/{GITHUB_FILE}"
GITHUB_VERSION_URL = f"https://raw.githubusercontent.com/{GITHUB_USER}/{GITHUB_REPO}/{GITHUB_BRANCH}/version.txt"
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

import tkinter as tk
from tkinter import filedialog, scrolledtext, messagebox, ttk, colorchooser
from PIL import Image, ImageTk, ImageGrab, ImageDraw, ImageFont
import google.generativeai as genai
import os
import threading
import re
import json
import time
import math
import random
from datetime import datetime, timedelta
import hashlib
import requests
from collections import defaultdict
import sys
import subprocess

# --- DOCX ---
try:
    from docx import Document
    from docx.shared import Inches, Pt, RGBColor
    from docx.enum.text import WD_ALIGN_PARAGRAPH
    WORD_AVAILABLE = True
except ImportError:
    WORD_AVAILABLE = False

# --- OPENPYXL (Excel) ---
try:
    from openpyxl import Workbook, load_workbook
    from openpyxl.styles import Font, Alignment, PatternFill, Border, Side
    EXCEL_AVAILABLE = True
except ImportError:
    EXCEL_AVAILABLE = False

# ============================================================
# ğŸ“ SABÄ°TLER
# ============================================================
# âš ï¸ GÃœVENLÄ°K: TÃœM HASSAS BÄ°LGÄ°LER AYRI DOSYADA TUTULUR (config.json)
# âš ï¸ config.json ASLA GitHub'a YÃœKLENMEMELÄ°!
# âš ï¸ .gitignore dosyasÄ±na config.json eklenmeli!

# Base dizini belirle - EXE ve Script iÃ§in farklÄ± Ã§alÄ±ÅŸÄ±r
def _get_base_dir():
    """Program dizinini bul - EXE ve Script iÃ§in uyumlu"""
    import sys
    
    fixed_dir = r"C:\Users\Apo\Desktop\FutbolAnaliz"
    
    # EXE olarak mÄ± Ã§alÄ±ÅŸÄ±yor?
    if getattr(sys, 'frozen', False):
        # PyInstaller EXE - EXE'nin bulunduÄŸu dizin
        exe_dir = os.path.dirname(sys.executable)
        print(f"ğŸ”· EXE modu - Dizin: {exe_dir}")
        
        # EXE dizininde config var mÄ±?
        if os.path.exists(os.path.join(exe_dir, "config.json")):
            print(f"âœ… Config bulundu (EXE dizini): {exe_dir}")
            return exe_dir
        
        # Sabit dizinde config var mÄ±?
        if os.path.exists(os.path.join(fixed_dir, "config.json")):
            print(f"âœ… Config bulundu (sabit dizin): {fixed_dir}")
            return fixed_dir
        
        # EXE dizinini kullan
        return exe_dir
    else:
        # Normal Python script
        script_dir = os.path.dirname(os.path.abspath(__file__))
        print(f"ğŸ”· Script modu - Dizin: {script_dir}")
        
        # 1. Sabit dizinde veritabanÄ± var mÄ±?
        if os.path.exists(os.path.join(fixed_dir, "mac_veritabani.json")):
            print(f"âœ… VeritabanÄ± bulundu: {fixed_dir}")
            return fixed_dir
        
        # 2. Sabit dizinde config var mÄ±?
        if os.path.exists(os.path.join(fixed_dir, "config.json")):
            print(f"âœ… Config bulundu: {fixed_dir}")
            return fixed_dir
        
        # 3. Sabit dizin var mÄ±?
        if os.path.exists(fixed_dir):
            return fixed_dir
        
        # 4. Script dizininde config var mÄ±?
        if os.path.exists(os.path.join(script_dir, "config.json")):
            return script_dir
        
        # 5. Sabit dizini oluÅŸtur
        os.makedirs(fixed_dir, exist_ok=True)
        return fixed_dir

BASE_DIR = _get_base_dir()
CONFIG_FILE = os.path.join(BASE_DIR, "config.json")

# Debug: Config dosyasÄ± yolunu gÃ¶ster
print(f"ğŸ“ BASE_DIR: {BASE_DIR}")
print(f"ğŸ“ Config dosyasÄ±: {CONFIG_FILE}")
print(f"ğŸ“ Config mevcut: {os.path.exists(CONFIG_FILE)}")

def _load_config():
    """TÃ¼m hassas bilgileri config.json'dan yÃ¼kle"""
    default_config = {
        "gemini_api_key": "",
        "telegram_bot_token": "",
        "telegram_chat_id": "",
        "github_user": "",
        "github_repo": "XG-XRAY-V70"
    }
    
    # Birden fazla olasÄ± konumda ara
    possible_paths = [
        CONFIG_FILE,
        os.path.join(os.path.dirname(os.path.abspath(__file__)), "config.json"),
        r"C:\Users\Apo\Desktop\FutbolAnaliz\config.json",
        "config.json"  # Ã‡alÄ±ÅŸma dizini
    ]
    
    for config_path in possible_paths:
        if os.path.exists(config_path):
            try:
                with open(config_path, 'r', encoding='utf-8') as f:
                    content = f.read().strip()
                    # BOM karakterini temizle
                    if content.startswith('\ufeff'):
                        content = content[1:]
                    saved_config = json.loads(content)
                    default_config.update(saved_config)
                    print(f"âœ… Config yÃ¼klendi: {config_path}")
                    print(f"âœ… API Key bulundu: {'Evet' if saved_config.get('gemini_api_key') else 'HayÄ±r'}")
                    return default_config
            except json.JSONDecodeError as e:
                print(f"âš ï¸ JSON formatÄ± hatalÄ± ({config_path}): {e}")
            except Exception as e:
                print(f"âš ï¸ Config okuma hatasÄ± ({config_path}): {e}")
    
    print(f"âš ï¸ Config dosyasÄ± bulunamadÄ±, aranan yerler: {possible_paths}")
    return default_config

def _save_config(config_data):
    """Config'i kaydet"""
    os.makedirs(BASE_DIR, exist_ok=True)
    with open(CONFIG_FILE, 'w', encoding='utf-8') as f:
        json.dump(config_data, f, ensure_ascii=False, indent=2)
    print(f"ğŸ’¾ Config kaydedildi: {CONFIG_FILE}")

def _load_api_key():
    """API key'i config.json'dan yÃ¼kle"""
    config = _load_config()
    return config.get("gemini_api_key", "")

def _save_api_key(api_key):
    """API key'i config.json'a kaydet"""
    config = _load_config()
    config["gemini_api_key"] = api_key
    _save_config(config)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ” HASSAS BÄ°LGÄ°LER - config.json'dan yÃ¼klenir
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
_CONFIG = _load_config()
DEFAULT_API_KEY = _CONFIG.get("gemini_api_key", "")
TELEGRAM_BOT_TOKEN = _CONFIG.get("telegram_bot_token", "")
TELEGRAM_CHAT_ID = _CONFIG.get("telegram_chat_id", "")

# GitHub ayarlarÄ± da config'den
if _CONFIG.get("github_user"):
    GITHUB_USER = _CONFIG.get("github_user")
if _CONFIG.get("github_repo"):
    GITHUB_REPO = _CONFIG.get("github_repo")
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RULES_FILE = "kurallar.txt"
DB_FILE = os.path.join(BASE_DIR, "mac_veritabani.json")
SETTINGS_FILE = os.path.join(BASE_DIR, "ayarlar.json")
PERFORMANCE_FILE = os.path.join(BASE_DIR, "performans.json")
LEARNING_FILE = os.path.join(BASE_DIR, "ogrenme.json")
EXCEL_FILE = os.path.join(BASE_DIR, "bahis_takip.xlsx")
BRAND_FILE = os.path.join(BASE_DIR, "marka_ayarlari.json")
LAB_FILE = os.path.join(BASE_DIR, "laboratuvar.json")
CHANNELS_FILE = os.path.join(BASE_DIR, "telegram_kanallari.json")
ORAN_FILE = os.path.join(BASE_DIR, "oran_takip.json")
TARAMA_LOG_FILE = os.path.join(BASE_DIR, "tarama_log.json")
# --- YENÄ° V5.7 DOSYALARI ---
CANLI_BAHIS_FILE = os.path.join(BASE_DIR, "canli_bahis.json")
SEKME_SIRALAMA_FILE = os.path.join(BASE_DIR, "sekme_siralama.json")
KARA_LISTE_FILE = os.path.join(BASE_DIR, "kara_liste.json")
ALTIN_LISTE_FILE = os.path.join(BASE_DIR, "altin_liste.json")
GOREV_LISTESI_FILE = os.path.join(BASE_DIR, "gorev_listesi.json")
HAFTALIK_RAPOR_FILE = os.path.join(BASE_DIR, "haftalik_rapor.json")

# --- TOP 13 ELÄ°T LÄ°G ---
ELIT_LIGLER = [
    "Premier League", "La Liga", "Serie A", "Bundesliga", "Ligue 1",
    "Primeira Liga", "Eredivisie", "Belgian Pro League", "SÃ¼per Lig",
    "Scottish Premiership", "Swiss Super League", "Austrian Bundesliga", "Czech First League"
]

# --- KASA YÃ–NETÄ°M KURALLARI ---
KASA_ORANLARI = {
    10: {"emoji": "ğŸ’", "aciklama": "KUSURSUZ - ELÄ°T", "oran": 25},
    9: {"emoji": "ğŸ”¥", "aciklama": "Ã‡OK GÃœÃ‡LÃœ", "oran": 20},
    8: {"emoji": "ğŸ’ª", "aciklama": "GÃœÃ‡LÃœ", "oran": 15},
    7: {"emoji": "âš–ï¸", "aciklama": "STANDART", "oran": 10},
    6: {"emoji": "âš ï¸", "aciklama": "SINIRDA / RÄ°SKLÄ°", "oran": 8},
    5: {"emoji": "â“", "aciklama": "DÃœÅÃœK", "oran": 5},
}

# --- GÃœNÃœN Ä°PUÃ‡LARI ---
GUNUN_IPUCLARI = [
    "ğŸ’¡ Pazartesi maÃ§larÄ±nda dikkatli ol, motivasyon genelde dÃ¼ÅŸÃ¼k!",
    "ğŸ’¡ Derbi maÃ§larÄ±nda istatistikler yanÄ±ltabilir!",
    "ğŸ’¡ Sezon sonu maÃ§larÄ±nda kÃ¼me dÃ¼ÅŸme/ÅŸampiyonluk motivasyonunu kontrol et!",
    "ğŸ’¡ Kupa maÃ§larÄ±nda rotasyon olabilir!",
    "ğŸ’¡ Elit liglerde -1 puan kesintisi yok, diÄŸerlerinde var!",
    "ğŸ’¡ Ä°Y bahisleri MAX 7/10 puan alÄ±r, riskli!",
    "ğŸ’¡ GÃ¼ven skoru 8+ olan maÃ§lara odaklan!",
    "ğŸ’¡ Kara listedeki takÄ±mlara dikkat!",
    "ğŸ’¡ AltÄ±n listedeki takÄ±mlar kazandÄ±rÄ±yor!",
    "ğŸ’¡ Oran 1.35 altÄ± favorilerde sadece gol bahsi oyna!",
]

# --- MODELLER ---
GEMINI_MODELS = {
    "Gemini 2.5 Pro (Ã–nerilen)": "gemini-2.5-pro",
    "Gemini 2.0 Flash": "gemini-2.0-flash",
    "Gemini 1.5 Pro": "gemini-1.5-pro",
    "Gemini 1.5 Flash (HÄ±zlÄ±)": "gemini-1.5-flash",
}

# --- TEMALAR ---


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ¨ PRO TEMA SÄ°STEMÄ°
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class ModernTheme:
    """Ultra modern karanlÄ±k tema"""
    BG_PRIMARY = "#0d1117"
    BG_SECONDARY = "#161b22"
    BG_CARD = "#21262d"
    BG_HOVER = "#30363d"
    ACCENT_PRIMARY = "#58a6ff"
    ACCENT_SUCCESS = "#3fb950"
    ACCENT_WARNING = "#d29922"
    ACCENT_DANGER = "#f85149"
    ACCENT_PURPLE = "#a371f7"
    TEXT_PRIMARY = "#f0f6fc"
    TEXT_SECONDARY = "#8b949e"
    TEXT_MUTED = "#484f58"
    BORDER = "#30363d"
    
    # --- YENÄ° V5.7: SonuÃ§ Renkleri - OKUNAKLI ---
    KAZANDI_BG = "#1a4d1a"
    KAZANDI_FG = "#4ade80"
    KAYBETTI_BG = "#4d1a1a"
    KAYBETTI_FG = "#f87171"
    BEKLIYOR_BG = "#4d4d1a"
    BEKLIYOR_FG = "#fbbf24"
    
    # --- SÄ±caklÄ±k HaritasÄ± Renkleri ---
    SICAK_YESIL = "#22c55e"  # GÃ¼venli (9-10)
    SICAK_SARI = "#eab308"   # Orta (7-8)
    SICAK_TURUNCU = "#f97316"  # Riskli (5-6)
    SICAK_KIRMIZI = "#ef4444"  # Tehlike (3-4)
    SICAK_SIYAH = "#1f2937"  # Dokunma (1-2)


THEMES = {
    "ğŸŒ™ Koyu": {"bg": "#0a0a0a", "fg": "#ffffff", "accent": "#00ffcc", "button": "#1a1a1a",
                "entry_bg": "#111111", "success": "#00ff00", "warning": "#ffcc00",
                "error": "#ff4444", "card_bg": "#1a1a1a"},
    "â˜€ï¸ AÃ§Ä±k": {"bg": "#f5f5f5", "fg": "#1a1a1a", "accent": "#007acc", "button": "#e0e0e0",
                "entry_bg": "#ffffff", "success": "#28a745", "warning": "#ff8800",
                "error": "#dc3545", "card_bg": "#ffffff"},
    "ğŸ”µ Mavi": {"bg": "#0d1b2a", "fg": "#e0e1dd", "accent": "#00b4d8", "button": "#1b263b",
                "entry_bg": "#1b263b", "success": "#00ff88", "warning": "#ffd60a",
                "error": "#ef233c", "card_bg": "#1b263b"},
    "ğŸŸ£ Mor": {"bg": "#1a1025", "fg": "#e0e0e0", "accent": "#bb86fc", "button": "#2d1f3d",
               "entry_bg": "#2d1f3d", "success": "#03dac6", "warning": "#ffb74d",
               "error": "#cf6679", "card_bg": "#2d1f3d"},
}

# --- ELÄ°T LÄ°GLER ---
ELIT_LIGLER = [
    "Premier League", "La Liga", "Serie A", "Bundesliga", "Ligue 1",
    "Primeira Liga", "Eredivisie", "Belgian Pro", "SÃ¼per Lig",
    "Scottish Premiership", "Swiss Super League", "Austrian Bundesliga", "Czech First League"
]

# --- GÄ°ZLÄ° HAZÄ°NE LÄ°GLERÄ° (BAÅLANGIÃ‡) ---
GIZLI_HAZINE_LIGLERI = {
    "SÄ±rbistan SÃ¼per Lig": {"gol_ort": 2.8, "kg_oran": 65, "bahisci_basari": 45},
    "NorveÃ§ Eliteserien": {"gol_ort": 3.2, "kg_oran": 68, "bahisci_basari": 48},
    "Ä°sveÃ§ Allsvenskan": {"gol_ort": 2.9, "kg_oran": 62, "bahisci_basari": 46},
    "Danimarka Superliga": {"gol_ort": 3.0, "kg_oran": 64, "bahisci_basari": 47},
    "Polonya Ekstraklasa": {"gol_ort": 2.7, "kg_oran": 60, "bahisci_basari": 44},
    "Japonya J-League": {"gol_ort": 2.8, "kg_oran": 68, "bahisci_basari": 42},
    "Avustralya A-League": {"gol_ort": 3.1, "kg_oran": 70, "bahisci_basari": 43},
    "MLS": {"gol_ort": 3.0, "kg_oran": 66, "bahisci_basari": 45},
    "Ä°skoÃ§ya Championship": {"gol_ort": 2.9, "kg_oran": 63, "bahisci_basari": 41},
    "Yunanistan SÃ¼per Lig": {"gol_ort": 2.5, "kg_oran": 58, "bahisci_basari": 44},
}

# --- KASA YÃ–NETÄ°MÄ° ---
KASA_ORANLARI = {
    10: {"emoji": "ğŸ’", "ad": "KUSURSUZ", "oran": 25},
    9: {"emoji": "ğŸ”¥", "ad": "Ã‡OK GÃœÃ‡LÃœ", "oran": 20},
    8: {"emoji": "ğŸ’ª", "ad": "GÃœÃ‡LÃœ", "oran": 15},
    7: {"emoji": "âš–ï¸", "ad": "STANDART", "oran": 10},
    6: {"emoji": "âš ï¸", "ad": "SINIRDA", "oran": 8},
    5: {"emoji": "ğŸ²", "ad": "RÄ°SKLÄ°", "oran": 5},
}

# --- VARSAYILAN MARKA AYARLARI ---
DEFAULT_BRAND = {
    "kanal_adi": "90 Dakika Analiz",
    "telegram": "@DoksanDakikaAnaliz",
    "twitter": "@90DkAnaliz",
    "instagram": "@90dakikaanaliz",
    "ana_renk": "#00FF00",
    "vurgu_renk": "#FFD700",
    "arkaplan_renk": "#0A0A0A",
    "font": "Montserrat",
    "logo_path": "",
    "watermark_aktif": True,
    "watermark_pozisyon": "SaÄŸ Alt",
    "watermark_opaklik": 30
}

# ============================================================
# ğŸ†• V5.6 - KÄ°MLÄ°K VE PERSONA (BÃ–LÃœM 11)
# ============================================================
KIMLIK = {
    "ad": "XG-XRAY ANALÄ°STÄ°",
    "kod_adi": "DATA HUNTER",
    "tanim": "TakÄ±mÄ±n sahadaki Ã¼retimini rÃ¶ntgen gibi tarayan Veri AvcÄ±sÄ±",
    "prensip": "SAF MATEMATÄ°K + GÃ–RSEL ZEKA (Duygu Yok, Ä°sim Yok, Sadece Veri Var)",
    "dil": {
        "net": ["OynanÄ±r", "Oynanmaz"],
        "teknik": "Conversion oranÄ± %X, lig ortalamasÄ±nÄ±n altÄ±nda",
        "uyarici": "â›” KIRMIZI ALARM"
    },
    "ozel_yetenek": "KÃ–R NOKTA AVCISI"
}

# ============================================================
# ğŸ†• V5.6 - VERÄ° KAYNAKLARI (BÃ–LÃœM 1 + BÃ–LÃœM 2-EK) - 17 KAYNAK
# ============================================================
VERI_KAYNAKLARI = {
    # AtÄ±lan Goller Tablosu
    "ev_gol_05": {"kaynak": "AtÄ±lan Goller", "satir": "0.5 Ãœst", "sutun": "Ev Sahibi"},
    "dep_gol_05": {"kaynak": "AtÄ±lan Goller", "satir": "0.5 Ãœst", "sutun": "Deplasman"},
    "ev_gol_15": {"kaynak": "AtÄ±lan Goller", "satir": "1.5 Ãœst", "sutun": "Ev Sahibi"},
    "dep_gol_15": {"kaynak": "AtÄ±lan Goller", "satir": "1.5 Ãœst", "sutun": "Deplasman"},
    "iy_ev_05": {"kaynak": "AtÄ±lan Goller", "sekme": "Ä°Y/2Y", "satir": "Ä°Y AtÄ±lan Gol", "sutun": "Ev Sahibi"},
    "iy_dep_05": {"kaynak": "AtÄ±lan Goller", "sekme": "Ä°Y/2Y", "satir": "Ä°Y AtÄ±lan Gol", "sutun": "Deplasman"},
    
    # Yenen Goller Tablosu
    "ev_yeme_05": {"kaynak": "Yenen Goller", "satir": "0.5 Ãœst", "sutun": "Ev Sahibi"},
    "dep_yeme_05": {"kaynak": "Yenen Goller", "satir": "0.5 Ãœst", "sutun": "Deplasman"},
    "ev_yeme_15": {"kaynak": "Yenen Goller", "satir": "1.5 Ãœst", "sutun": "Ev Sahibi"},
    "dep_yeme_15": {"kaynak": "Yenen Goller", "satir": "1.5 Ãœst", "sutun": "Deplasman"},
    
    # 2.5 Ãœst ve KG Tahminleri Tablosu
    "ms_05_ust": {"kaynak": "2.5 Ãœst ve KG Tahminleri", "satir": "0.5 Ãœst", "sutun": "Ortalama"},
    "ms_15_ust": {"kaynak": "2.5 Ãœst ve KG Tahminleri", "satir": "1.5 Ãœst", "sutun": "Ortalama"},
    "ms_25_ust": {"kaynak": "2.5 Ãœst ve KG Tahminleri", "satir": "2.5 Ãœst", "sutun": "Ortalama"},
    "ms_35_ust": {"kaynak": "2.5 Ãœst ve KG Tahminleri", "satir": "3.5 Ãœst", "sutun": "Ortalama"},
    "kg_var": {"kaynak": "2.5 Ãœst ve KG Tahminleri", "satir": "KG VAR", "sutun": "Ortalama"},
    
    # xG KaynaÄŸÄ±
    "xg_ev": {"kaynak": "Form / Kim KazanÄ±r", "satir": "xG", "sutun": "Ev Sahibi"},
    "xg_dep": {"kaynak": "Form / Kim KazanÄ±r", "satir": "xG", "sutun": "Deplasman"},
}

# ============================================================
# ğŸ†• V5.6 - HESAPLAMA FORMÃœLLERÄ° (BÃ–LÃœM 2-EK) - 9 FORMÃœL
# ============================================================
HESAPLAMA_FORMULLERI = {
    "gol_ort": {"ad": "GOL ORT", "formul": "(Ev AtÄ±lan 0.5Ãœ + Dep AtÄ±lan 0.5Ãœ) / 2", "hedef": 85},
    "gol_yeme_ort": {"ad": "GOL YEME ORT", "formul": "(Ev Yenen 0.5Ãœ + Dep Yenen 0.5Ãœ) / 2"},
    "iy_gol_degeri": {"ad": "Ä°Y GOL DEÄERÄ°", "formul": "(Ev Ä°Y AtÄ±lan + Dep Ä°Y AtÄ±lan) / 2"},
    "iy_gol_yeme": {"ad": "Ä°Y GOL YEME %", "formul": "100% - Ä°Y Gol Yememe %"},
    "hibrit_kg": {"ad": "HÄ°BRÄ°T KG VAR %", "formul": "(((Ev 0.5Ãœ + Dep 0.5Ãœ) / 2) + Ortalama KG VAR) / 2"},
    "step2_ms15": {"ad": "P.1 STEP-2 MS 1.5 ÃœST", "formul": "(Ev 0.5Ãœ + Dep 0.5Ãœ) / 2"},
    "sut_donusum": {"ad": "ÅUT DÃ–NÃœÅÃœM", "formul": "(MaÃ§ BaÅŸÄ± Gol / MaÃ§ BaÅŸÄ± Toplam Åut) * 100"},
    "tahmini_rcs": {"ad": "TAHMÄ°NÄ° RCS", "formul": "(Ceza SahasÄ± Ä°Ã§i Åut * 3) + Korner SayÄ±sÄ±"},
    "favori_etiketi": {"ad": "FAVORÄ° (1-X-2)", "formul": "Ã–n Favori â†’ Veto â†’ Nihai Etiket"},
}

# ============================================================
# ğŸ“œ TÃœM KURALLAR - TAM VE EKSÄ°KSÄ°Z (TEK BÄ°R HARF Ã‡IKARILMADAN)
# ============================================================
TUM_BOLUMLER = [
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 0: ROOT PROTOKOLÃœ (SÄ°STEMÄ°N ANAYASASI)
    # (BU BÃ–LÃœM ANALÄ°ZÄ°N TEMELÄ°DÄ°R. ASLA ATLANAMAZ.)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 0",
        "ad": "ROOT PROTOKOLÃœ (SÄ°STEMÄ°N ANAYASASI)",
        "aciklama": "BU BÃ–LÃœM ANALÄ°ZÄ°N TEMELÄ°DÄ°R. ASLA ATLANAMAZ.",
        "kurallar": [
            {
                "id": "KAOS-KABULÃœ",
                "baslik": "KAOS KABULÃœ (FUTBOLUN DOÄASINDAKÄ° O....LUK)",
                "tanim": "EÄŸer bir maÃ§ta istatistikler (xG, Åut, BaskÄ±) %90 ve Ã¼zeri bir olasÄ±lÄ±ÄŸÄ± gÃ¶steriyor (Ã–rn: 3.37 xG, 30 Åut) ancak top Ã§izgiyi geÃ§miyorsa; BU BÄ°R SÄ°STEM HATASI DEÄÄ°LDÄ°R.",
                "aksiyon": "Bu tÃ¼r 'Ä°statistiksel Anomaliler' (ÅanssÄ±zlÄ±klar) yÃ¼zÃ¼nden sisteme asla yeni kural eklenmez, sistemin vidalarÄ±yla oynanmaz, ayarÄ± bozulmaz.",
                "sonuc": "'YattÄ±k' denir, analiz Ã§Ã¶pe atÄ±lÄ±r ve bir sonraki maÃ§a aynÄ± sistemle, aynÄ± disiplinle devam edilir."
            },
            {
                "id": "DERLEYÄ°CÄ°-MODU",
                "baslik": "DERLEYÄ°CÄ° MODU (COMPILER MODE)",
                "sistem_emri": "Bu analiz sistemi, insani bir yorumlama aracÄ± deÄŸil, bir PYTHON DERLEYÄ°CÄ°SÄ° (COMPILER) gibi Ã§alÄ±ÅŸÄ±r.",
                "sirali_islem": "Analist, kurallarÄ± kafasÄ±na gÃ¶re deÄŸil, yazÄ±lÄ± sÄ±raya gÃ¶re iÅŸlemek ZORUNDADIR. Ã–nce GÄ°YOTÄ°N (BÃ¶lÃ¼m 4) Ã§alÄ±ÅŸÄ±r. Veto varsa analiz durur. Sonra BANKO TARAMA (BÃ¶lÃ¼m 5) Ã§alÄ±ÅŸÄ±r. Bu bÃ¶lÃ¼mdeki sÄ±ralama (3.5 Ãœst -> 2.5 Ãœst -> KG Var...) ASLA BOZULAMAZ. Ä°lk sÄ±radaki seÃ§enek matematiksel olarak elenmeden, alt satÄ±ra geÃ§ilemez.",
                "satir_satir_okuma": "Analist, 'Bu maÃ§ banko gÃ¶rÃ¼nÃ¼yor' diyerek kurallarÄ± atlayamaz. En garanti maÃ§ta bile; Conversion oranÄ±, Lig KarantinasÄ± ve Tablo OrtalamasÄ± tek tek kontrol edilmelidir.",
                "hata_toleransi": "SIFIR - EÄŸer bir analizde 'Duygu' veya 'Tahmin' tespit edilirse, analiz geÃ§ersizdir. Sadece IF/ELSE mantÄ±ÄŸÄ± geÃ§erlidir. Åart saÄŸlanÄ±yorsa (TRUE) iÅŸlem yapÄ±lÄ±r, saÄŸlanmÄ±yorsa (FALSE) bir sonraki satÄ±ra geÃ§ilir."
            },
            {
                "id": "TARAMA-RAPORU",
                "baslik": "ZORUNLU TARAMA RAPORU (COMPILER LOG)",
                "amac": "Her analizde tÃ¼m bÃ¶lÃ¼mlerin eksiksiz tarandÄ±ÄŸÄ±nÄ± kanÄ±tlamak.",
                "kural": "Analiz ÅŸablonuna geÃ§meden Ã¶nce TARAMA RAPORU eksiksiz doldurulacaktÄ±r. Herhangi bir bÃ¶lÃ¼m [TARANDI] iÅŸareti almamÄ±ÅŸsa, ANALÄ°Z GEÃ‡ERSÄ°ZDÄ°R ve ÅŸablona geÃ§ilemez.",
                "format": """ğŸ’¾ SÄ°STEM TARAMA RAPORU - [MAÃ‡ ADI]
â€¢ BÃ–LÃœM 0 - ROOT PROTOKOLÃœ: [TARANDI] â†’ [SONUÃ‡: ONAY]
â€¢ BÃ–LÃœM 1 - VERÄ° KAYNAKLARI: [TARANDI] â†’ [SONUÃ‡: TAMAM]
â€¢ BÃ–LÃœM 2 - ANALÄ°Z ÅABLONU: [TARANDI] â†’ [SONUÃ‡: Ä°ÅLENDÄ°]
â€¢ BÃ–LÃœM 3 - TÄ°K Ä°ÅARETÄ° KURALLARI: [TARANDI] â†’ [SONUÃ‡: UYUMLU]
â€¢ BÃ–LÃœM 4 - GÄ°YOTÄ°N (VETOLAR): [TARANDI] â†’ [SONUÃ‡: TEMÄ°Z / VETO]
â€¢ BÃ–LÃœM 5 - BANKO ÅARTLARI: [TARANDI] â†’ [SONUÃ‡: X ADAY]
â€¢ BÃ–LÃœM 6 - CANLI STRATEJÄ°: [TARANDI] â†’ [SONUÃ‡: HAZIR]
â€¢ BÃ–LÃœM 7 - KUPON KURALLARI: [TARANDI] â†’ [SONUÃ‡: UYUMLU]
â€¢ BÃ–LÃœM 8 - Ä°Y RADAR: [TARANDI] â†’ [SONUÃ‡: %XX]
â€¢ BÃ–LÃœM 9 - SÄ°MÃœLASYON DÃ–NGÃœSÃœ: [TARANDI] â†’ [SONUÃ‡: TAMAM]
â€¢ BÃ–LÃœM 10 - GÃœVEN PUANI VE KASA: [TARANDI] â†’ [SONUÃ‡: X/10]
â€¢ BÃ–LÃœM 11 - GENEL PRENSÄ°PLER: [TARANDI] â†’ [SONUÃ‡: ONAY]
â€¢ BÃ–LÃœM 12 - SUNUM PROTOKOLÃœ: [TARANDI] â†’ [SONUÃ‡: HAZIR]
RAPOR SONUCU: [TÃœM BÃ–LÃœMLER TARANDI - ANALÄ°Z GEÃ‡ERLÄ° âœ…]""",
                "zorunluluk": "Bu rapor olmadan analiz ÅŸablonuna geÃ§ilmesi YASAKTIR."
            }
        ]
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 1: VERÄ° KAYNAÄI PROTOKOLLERÄ° (KIRMIZI Ã‡Ä°ZGÄ°LER ğŸ›‘)
    # Hata payÄ±nÄ± sÄ±fÄ±ra indirmek iÃ§in verilerin alÄ±nacaÄŸÄ± yerler sabitlenmiÅŸtir.
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 1",
        "ad": "VERÄ° KAYNAÄI PROTOKOLLERÄ° (KIRMIZI Ã‡Ä°ZGÄ°LER ğŸ›‘)",
        "aciklama": "Hata payÄ±nÄ± sÄ±fÄ±ra indirmek iÃ§in verilerin alÄ±nacaÄŸÄ± yerler sabitlenmiÅŸtir.",
        "kurallar": [
            {
                "id": "xG-KAYNAK",
                "baslik": "xG (GOL BEKLENTÄ°SÄ°) KAYNAÄI",
                "gorsel": "'Form / Kim KazanÄ±r' veya 'Ä°statistik' tablosu (KÃ¼Ã§Ã¼k renkli kutucuklar).",
                "ev_sahibi_xg": "'Ev Sahibi' sÃ¼tunu -> 'xG' satÄ±rÄ±.",
                "deplasman_xg": "'Deplasman' sÃ¼tunu -> 'xG' satÄ±rÄ±.",
                "kirmizi_cizgi": "ğŸ›‘ ASLA 'Toplam' veya 'Form' sÃ¼tunlarÄ±ndaki xG deÄŸerine bakÄ±lmaz. Sadece 'Ev' ve 'Deplasman' ayrÄ±mÄ±na bakÄ±lÄ±r."
            },
            {
                "id": "YÃœZDE-KAYNAK",
                "baslik": "YÃœZDELÄ°K ORANLAR (ÃœST/KG) KAYNAÄI",
                "gorsel": "'2,5 Ãœst ve KG Tahminleri' tablosu.",
                "sutun": "Sadece en saÄŸdaki 'ORTALAMA' sÃ¼tunu. (Ev veya Deplasman sÃ¼tunlarÄ±na bakÄ±larak genel karar verilmez, sadece ortalamaya bakÄ±lÄ±r).",
                "kritik_kontrol": "âš ï¸ KRÄ°TÄ°K KONTROL (K.18-B): Bu tablodaki '2.5 Ãœst' satÄ±rÄ±nÄ±n 'Ortalama' deÄŸeri %55'in altÄ±ndaysa; Sahadaki xG veya ÅŸut sayÄ±sÄ± ne kadar yÃ¼ksek olursa olsun o maÃ§a 'MS 2.5 ÃœST' BANKOSU YAZILAMAZ. (Direkt Veto edilir).",
                "baraj": 55
            },
            {
                "id": "YAZILI-VERÄ°",
                "baslik": "YAZILI VERÄ° ENTEGRASYONU",
                "aciklama": "GÃ¶rsellerin yanÄ±nda sunulan yazÄ±lÄ± metinler (seriler, sakatlÄ±klar, Ã¶nemli notlar) mutlaka okunacak ve 'MaÃ§Ä±n Hikayesi' veya 'Kritik Veri' kÄ±smÄ±na iÅŸlenecektir."
            },
            {
                "id": "Ä°Y-KAYNAK",
                "baslik": "Ä°LK YARI (Ä°Y) VERÄ° KAYNAÄI VE HESAPLAMA (HAYATÄ° KURAL ğŸ©¸)",
                "kaynak_yasagi": "Ä°Y verileri asla '2.5 Ãœst ve KG Tahminleri' tablosundaki ortalamadan alÄ±nmaz.",
                "dogru_kaynak": "Sadece 'AtÄ±lan Goller' tablosuna gidilir -> 'Ä°Y/2Y' sekmesi seÃ§ilir -> 'Ä°Y AtÄ±lan Gol' satÄ±rÄ±ndaki Ev ve Deplasman yÃ¼zdeleri baz alÄ±nÄ±r.",
                "robotik_motor": {
                    "ortalama_hesabi": "(Ev Ä°Y Atan % + Dep Ä°Y Atan %) / 2 iÅŸlemini yap.",
                    "karar": "SonuÃ§ %70'in altÄ±ndaysa VE takÄ±mlardan birinin oranÄ± tam %90 VE ÃœSTÃœ DEÄÄ°LSE; O maÃ§a 'Ä°Y GOL' bahsi GÄ°RÄ°LMEZ. (Duygusal inisiyatif yasaktÄ±r).",
                    "baraj": 70,
                    "istisna_baraj": 90
                }
            }
        ]
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 2: GÃœNCEL ANALÄ°Z ÅABLONU (TAM FORMAT)
    # (Analiz Ã§Ä±ktÄ±sÄ± verilirken bu formatÄ±n dÄ±ÅŸÄ±na Ã§Ä±kÄ±lmasÄ± YASAKTIR)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 2",
        "ad": "GÃœNCEL ANALÄ°Z ÅABLONU (TAM FORMAT)",
        "aciklama": "Analiz Ã§Ä±ktÄ±sÄ± verilirken bu formatÄ±n dÄ±ÅŸÄ±na Ã§Ä±kÄ±lmasÄ± YASAKTIR.",
        "sablon": """âš½ [EV SAHÄ°BÄ°] VS [DEPLASMAN] | [LÄ°G ADI] | [SAAT]

BÃ–LÃœM 1: GÃœNCEL ANALÄ°Z ÅABLONU
â€¢ Lig KimliÄŸi: [GÃœVENÄ°LÄ°R / DENGESÄ°Z / ALT LÄ°G / GOL FABRÄ°KASI]
â€¢ GÄ°YOTÄ°N KUTUSU (Ã–N KONTROL): [GEÃ‡TÄ° âœ… / KALDI âŒ]

ğŸ“Š TEMEL Ä°STATÄ°STÄ°KLER (KAYNAK: GÃ–RSEL VERÄ°LERÄ°)
â€¢ GOL ORT (Ä°htimal): [%] (Hedef: %85+)
â€¢ GOL YEME ORT: [Ev Yeme %] / [Dep Yeme %]
â€¢ FAVORÄ° (1-X-2): [AÄIR FAVORÄ° / HAFÄ°F FAVORÄ° / DENGELÄ°]
â€¢ Ä°Y GOL DEÄERÄ°: [Ev Ä°Y %] / [Dep Ä°Y %] -> Ort: [%]
â€¢ EV GOL GÃœCÃœ: [%] (ATILAN GOLLER EV 0.5 ÃœST)
â€¢ DEP GOL GÃœCÃœ: [%] (ATILAN GOLLER DEP 0.5 ÃœST)
â€¢ SAVUNMA ZAIFI (K.17): [Ev Yememe %] / [Dep Yememe %]
â€¢ HÄ°BRÄ°T KG VAR %: [%] (Kaynak: Ortalama SÃ¼tunu)
â€¢ MS 0.5 ÃœST %: [%]
â€¢ MS 1.5 ÃœST %: [%]
â€¢ MS 2.5 ÃœST %: [%]
â€¢ MS 3.5 ÃœST %: [%]
â€¢ MS 4.5 ÃœST %: [%]
â€¢ EV GOL 1.5 ÃœST %: [%]
â€¢ DEP GOL 1.5 ÃœST %: [%]
â€¢ EV GOL YEME 1.5 ÃœST %: [%]
â€¢ DEP GOL YEME 1.5 ÃœST %: [%]
â€¢ Ä°Y EV 0.5 ÃœST %: [%]
â€¢ Ä°Y DEP 0.5 ÃœST %: [%]
â€¢ Ä°Y EV GOL YEME ORT: [DeÄŸer]
â€¢ Ä°Y DEP GOL YEME ORT: [DeÄŸer]

ğŸ“ˆ Ä°LERÄ° SEVÄ°YE VERÄ°LER
â€¢ Toplam xG (Gol Beklentisi): [Ev xG] + [Dep xG] -> Toplam: [DeÄŸer] (Hedef: 3.00+)
â€¢ Åut Hacmi: [Ev Åut] + [Dep Åut] -> Toplam: [DeÄŸer] (Hedef: 20+)
â€¢ DÃ¶nÃ¼ÅŸÃ¼m OranÄ± (Conversion): [Ev %] / [Dep %] (Hedef: %10+)
â€¢ Aksiyon AlanÄ±: [xG ve Åut verilerine dayalÄ± oyunun yÃ¶nÃ¼ yorumu]

âœï¸ MAÃ‡IN HÄ°KAYESÄ° VE EK NOTLAR
â€¢ [YazÄ±lÄ± metinlerden elde edilen seriler, eksikler ve Ã¶nemli notlar buraya maddeler halinde yazÄ±lacak.]

âš¡ Ä°LK YARI GOL RADARI (V46)
â€¢ [KARAR: GÄ°R! âœ… / GÄ°RME! âŒ] (Puan: [%])
â€¢ Analiz: [Tek Tabanca kuralÄ± veya Ortalama kuralÄ±na gÃ¶re aÃ§Ä±klama]

â­ MAÃ‡IN EN KRÄ°TÄ°K 3 VERÄ°SÄ°
â€¢ [Veri 1]
â€¢ [Veri 2]
â€¢ [Veri 3]

ğŸ›¡ï¸ BANKO TARAMA SÄ°MÃœLASYONU (V46.4) ğŸ”„
â€¢ 3.5 ÃœST: (Ort: [%]) -> [GEÃ‡TÄ° / KALDI]
â€¢ 2.5 ÃœST: (Ort: [%] + Ã‡apraz Kontrol) -> [GEÃ‡TÄ° / KALDI]
â€¢ KG VAR: (Ort: [%] + Ã‡ift Piston %80) -> [GEÃ‡TÄ° / KALDI]
â€¢ MS TARAF: (Galibiyet [%] + Oran [DeÄŸer]) -> [GEÃ‡TÄ° / KALDI]
â€¢ TAKIM 1.5 ÃœST: (Ä°statistik [%]) -> [GEÃ‡TÄ° / KALDI]
â€¢ MS & 1.5 KOMBO: (Taraf + Gol) -> [GEÃ‡TÄ° / KALDI]
â€¢ 1.5 ÃœST: (Ort: [%]) -> [GEÃ‡TÄ° / KALDI]
â€¢ TAKIM 0.5 ÃœST: (Ä°statistik [%]) -> [GEÃ‡TÄ° / KALDI]
â€¢ Ä°Y TAKIM GOLÃœ: (Tek Tabanca %83+) -> [GEÃ‡TÄ° / KALDI]
â€¢ KG YOK: (KÄ±sÄ±rlÄ±k Analizi) -> [GEÃ‡TÄ° / KALDI]
â€¢ 2.5 ALT: (Ort: [%]) -> [GEÃ‡TÄ° / KALDI]
â€¢ Ä°Y 0.5 ÃœST: (Ort: [%]) -> [GEÃ‡TÄ° / KALDI]
â¡ï¸ ALGORÄ°TMA SONUCU: [SEÃ‡Ä°LEN BANKO BURAYA YAZILACAK]

ğŸ“º DEVRE ARASI CANLI BAHÄ°S STRATEJÄ°SÄ° (V46 - FULL PAKET)
â€¢ âš ï¸ NABIZ KONTROLÃœ: Ä°Y Ä°sabetli Åut < 4 ise PAS.
â€¢ ğŸ MAÃ‡ Ã–NÃœ BANKOMUZ: [SeÃ§ilen Banko]
â€¢ SENARYO 1 (HT 0-0 | KISIR): [Strateji]
â€¢ SENARYO 2 (HT 1-0 / 2-0 | FAVORÄ° Ã–NDE): [Strateji]
â€¢ SENARYO 3 (HT 0-1 / 0-2 | FAVORÄ° GERÄ°DE): [Strateji]
â€¢ SENARYO 4 (HT 1-1 | MAÃ‡ AÃ‡ILDI): [Strateji]
â€¢ SENARYO 5 (HT 2-1 | GOL YAÄMURU): [Strateji]
â€¢ SENARYO 6 (HT 3+ FARK | FÄ°Å Ã‡EKÄ°LDÄ°): [Strateji]
â€¢ SENARYO 7 (HT SÃœRPRÄ°Z): [Strateji]

ğŸ’° NÄ°HAÄ° MATEMATÄ°KSEL TAHMÄ°N
â€¢ âœ… BANKO (V46): [Tahmin]
  - GÃ¼ven: [Puan]/10
  - GerekÃ§e: [Madde 1, Madde 2, Madde 3]
â€¢ â­ Ä°DEAL: [Tahmin]
  - GÃ¼ven: [Puan]/10
  - GerekÃ§e: [...]
â€¢ ğŸ’£ SÃœRPRÄ°Z / DEÄER: [Tahmin]
  - GÃ¼ven: [Puan]/10
  - GerekÃ§e: [...]
â€¢ â›” UZAK DUR: [Tahmin]
â€¢ ğŸ¯ SKOR BEKLENTÄ°SÄ°: [Skor 1] veya [Skor 2]

ğŸš¨ DÄ°KKAT! KASA SÄ°GORTASI
ğŸ”’ SEÃ‡Ä°LEN BANKO: (ORAN BAKILMAKSIZIN EN YÃœKSEK GÃœVEN BAHÄ°SÄ°)
ğŸ’° KASA ORANI:
ğŸ“ GEREKÃ‡E (MATEMATÄ°KSEL):
1.
2.
3.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ§  BÃ–LÃœM 12: YAPAY ZEKA GOL Ã–NGÃ–RÃœSÃœ (BANKO'DAN BAÄIMSIZ ANALÄ°Z)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
(Kaynak: ATILAN GOLLER ve YENEN GOLLER TablolarÄ± - Ã‡APRAZ KARÅILAÅTIRMA)
(Bu bÃ¶lÃ¼m BANKO ne olursa olsun, maÃ§Ä±n gol potansiyelini AYRI analiz eder)

âš½ 0.5 ÃœST ANALÄ°ZÄ° (KÄ°M ATAR?):
   â€¢ Ev Atan: %[X] vs Dep Yiyen: %[Y]
   â€¢ Dep Atan: %[X] vs Ev Yiyen: %[Y]
   â†’ Ã‡APRAZ EÅLEÅTÄ°RME SONUCU:
   â†’ SONUÃ‡: [Kim atar belirle]

âš½ 1.5 ÃœST ANALÄ°ZÄ° (2+ GOL Ã‡IKAR MI?):
   â€¢ Ev Atan 1.5Ãœ: %[X] vs Dep Yiyen 1.5Ãœ: %[Y]
   â†’ KRÄ°TÄ°K: Yeme %70+ ise "SÃœRPRÄ°Z GOL POTANSÄ°YELÄ°", dÃ¼ÅŸÃ¼kse "UZAK DUR"
   â†’ SONUÃ‡:

âš¡ CANLI TETÄ°KLEYÄ°CÄ° (MAÃ‡ Ä°Ã‡Ä° SAVAÅ PLANI):
   (SADECE gol istatistiÄŸi %80+ ise aktif)
   â†’ EÄŸer X geriye dÃ¼ÅŸerse â†’ Y yap
   âš ï¸ KIRMIZI KART: TÃ¼m tetikler iptal!

âœ… NÄ°HAÄ° GOL KARARI (BÃ–LÃœM 12):""",
        "kurallar": [
            {
                "id": "GOL-ORT",
                "baslik": "GOL ORT",
                "formul": "(Ev Sahibi AtÄ±lan Goller 0.5 Ãœst % + Deplasman AtÄ±lan Goller 0.5 Ãœst %) / 2",
                "hedef": 85
            },
            {
                "id": "GOL-YEME-ORT",
                "baslik": "GOL YEME ORT",
                "formul": "(Ev Sahibi Yenen Goller 0.5 Ãœst % + Deplasman Yenen Goller 0.5 Ãœst %) / 2"
            },
            {
                "id": "FAVORÄ°-ETÄ°KETÄ°",
                "baslik": "FAVORÄ° (1-X-2)",
                "formul": "Ã–n Favori Tespiti -> Veto KontrolÃ¼ -> Nihai Etiket: AÄIR FAVORÄ° / HAFÄ°F FAVORÄ° / DENGELÄ°"
            },
            {
                "id": "Ä°Y-GOL-DEÄERÄ°",
                "baslik": "Ä°Y GOL DEÄERÄ° (V44 DÃœZELTÄ°LDÄ°)",
                "formul": "(Ev Sahibi Ä°Y AtÄ±lan Gol % + Deplasman Ä°Y AtÄ±lan Gol %) / 2",
                "kaynak": "'AtÄ±lan Goller' tablosu, 'Ä°Y/2Y' sekmesi, 'Ä°Y AtÄ±lan Gol' satÄ±rÄ±"
            },
            {
                "id": "Ä°Y-GOL-YEME",
                "baslik": "Ä°Y GOL YEME %",
                "formul": "100% - Ä°lgili TakÄ±mÄ±n 'Ä°Y Gol Yememe' %'si"
            },
            {
                "id": "HÄ°BRÄ°T-KG",
                "baslik": "HÄ°BRÄ°T KG VAR %",
                "formul": "(((Ev 0.5 Ãœst + Dep 0.5 Ãœst) / 2) + Ortalama KG VAR %) / 2"
            },
            {
                "id": "STEP2-MS15",
                "baslik": "P.1 STEP-2 MS 1.5 ÃœST PUANI",
                "formul": "(Ev 0.5 Ãœst % + Dep 0.5 Ãœst %) / 2"
            },
            {
                "id": "ÅUT-DÃ–NÃœÅÃœM",
                "baslik": "ÅUT DÃ–NÃœÅÃœM ORANI (CONVERSION)",
                "formul": "(MaÃ§ BaÅŸÄ± Gol / MaÃ§ BaÅŸÄ± Toplam Åut) * 100",
                "pay_kaynak": "'AtÄ±lan Goller' (Scored Goals) tablosu, 'MaÃ§ BaÅŸÄ± Gol' (Goals / Match) deÄŸeri",
                "payda_kaynak": "'Åutlar, Ofsaytlar, Fauller...' tablosu, 'MaÃ§ BaÅŸÄ± Åut' deÄŸeri",
                "etiketleme": {
                    "kaliteli": "%13 Ã¼zeri -> 'Kaliteli/Bitirici'",
                    "beceriksiz": "%10 altÄ± -> 'Beceriksiz/Savurgan'"
                }
            },
            {
                "id": "TAHMÄ°NÄ°-RCS",
                "baslik": "TAHMÄ°NÄ° RCS",
                "formul": "(Ceza SahasÄ± Ä°Ã§inden Åut x 3) + Korner SayÄ±sÄ±"
            }
        ],
        "veri_kaynaklari": {
            "EV_GOL": "Ev sahibi 'AtÄ±lan Goller' tablosu, '0.5 Ãœst' satÄ±rÄ±",
            "DEP_GOL": "Deplasman 'AtÄ±lan Goller' tablosu, '0.5 Ãœst' satÄ±rÄ±",
            "EV_GOL_YEME": "Ev sahibi 'Yenen Goller' tablosu, '0.5 Ãœst' satÄ±rÄ±",
            "DEP_GOL_YEME": "Deplasman 'Yenen Goller' tablosu, '0.5 Ãœst' satÄ±rÄ±",
            "MS_05_UST_45_UST": "'2,5 Ãœst ve KG Tahminleri' tablosu, ilgili satÄ±r, 'Ortalama' sÃ¼tunu",
            "EV_GOL_15_UST": "Ev sahibi 'AtÄ±lan Goller' tablosu, '1.5 Ãœst' satÄ±rÄ±",
            "DEP_GOL_15_UST": "Deplasman 'AtÄ±lan Goller' tablosu, '1.5 Ãœst' satÄ±rÄ±",
            "EV_GOL_YEME_15_UST": "Ev sahibi 'Yenen Goller' tablosu, '1.5 Ãœst' satÄ±rÄ±",
            "DEP_GOL_YEME_15_UST": "Deplasman 'Yenen Goller' tablosu, '1.5 Ãœst' satÄ±rÄ±",
            "IY_EV_05_UST": "Ev sahibi 'AtÄ±lan Goller' tablosu, 'Ä°Y/2Y' sekmesi, 'Ä°Y AtÄ±lan Gol' satÄ±rÄ±",
            "IY_DEP_05_UST": "Deplasman 'AtÄ±lan Goller' tablosu, 'Ä°Y/2Y' sekmesi, 'Ä°Y AtÄ±lan Gol' satÄ±rÄ±",
            "IY_EV_GOL_YEME_ORT": "Ev sahibi 'Yenen Goller' tablosu, 'Ä°Y/2Y' sekmesi, 'Ä°Y Ortalama Yenen Gol' satÄ±rÄ±",
            "IY_DEP_GOL_YEME_ORT": "Deplasman 'Yenen Goller' tablosu, 'Ä°Y/2Y' sekmesi, 'Ä°Y Ortalama Yenen Gol' satÄ±rÄ±"
        }
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 3: TÄ°K (âœ…) Ä°ÅARETÄ° KURALLARI
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 3",
        "ad": "TÄ°K (âœ…) Ä°ÅARETÄ° KURALLARI",
        "kurallar": [
            {"id": "Ä°Y-GOL-TÄ°K", "baslik": "Ä°Y GOL DEÄERÄ°", "aciklama": "%80 ve Ã¼zeri âœ…", "baraj": 80},
            {"id": "MS-0.5Ãœ-TÄ°K", "baslik": "MS 0.5 ÃœST", "aciklama": "%85 ve Ã¼zeri âœ…", "baraj": 85},
            {"id": "MS-1.5Ãœ-TÄ°K", "baslik": "MS 1.5 ÃœST", "aciklama": "%75 ve Ã¼zeri âœ…", "baraj": 75},
            {"id": "MS-2.5Ãœ-TÄ°K", "baslik": "MS 2.5 ÃœST", "aciklama": "%65 ve Ã¼zeri âœ…", "baraj": 65},
            {"id": "MS-3.5Ãœ-TÄ°K", "baslik": "MS 3.5 ÃœST", "aciklama": "%50 ve Ã¼zeri âœ…", "baraj": 50},
            {"id": "YÃœZDE-100", "baslik": "%100 KURALI", "aciklama": "%100 ise âœ…", "baraj": 100}
        ]
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 4: TEMEL FÄ°LTRELER VE VETOLAR (A VE B GRUBU)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 4",
        "ad": "TEMEL FÄ°LTRELER VE VETOLAR (A VE B GRUBU)",
        "a_grubu": {
            "baslik": "B.Ä°-000: GÄ°YOTÄ°N PROTOKOLÃœ (ANALÄ°Z Ã–NCESÄ° ZORUNLU KONTROL)",
            "kurallar": [
                {
                    "id": "LÄ°G-KONTROLÃœ",
                    "sira": 1,
                    "baslik": "LÄ°G KONTROLÃœ",
                    "soru": "Alt Lig mi (Kaotik mi)?",
                    "aksiyon": "Evet ise -> BANKO YAZILAMAZ"
                },
                {
                    "id": "K.100",
                    "sira": 2,
                    "baslik": "SERÄ° KONTROLÃœ (K.100)",
                    "soru": "%100'lÃ¼k seri 6 maÃ§Ä± geÃ§miÅŸ mi VE xG 1.50'nin altÄ±nda mÄ±?",
                    "aksiyon": "Evet ise -> BANKO YAZILAMAZ",
                    "baraj_seri": 6,
                    "baraj_xg": 1.50
                },
                {
                    "id": "K.CONVERSION",
                    "sira": 3,
                    "baslik": "BECERÄ° KONTROLÃœ (K.CONVERSION)",
                    "soru": "Gol/Åut oranÄ± %10'un altÄ±nda mÄ±?",
                    "aksiyon": "Evet ise -> GOL BAHÄ°SÄ° YASAK",
                    "baraj": 10
                },
                {
                    "id": "K.AYNA",
                    "sira": 4,
                    "baslik": "SAVUNMA KONTROLÃœ (K.AYNA)",
                    "soru": "Rakip takÄ±mÄ±n 'Gol Yememe' oranÄ± %60'Ä±n Ã¼zerinde mi?",
                    "aksiyon": "Evet ise -> ÃœST/KG VAR YASAK",
                    "baraj": 60
                },
                {
                    "id": "K.KALÄ°TE-KONTROL",
                    "sira": 5,
                    "baslik": "ğŸ›‘ K.KALÄ°TE-KONTROL (YENÄ° - V46.8)",
                    "tanim": "EÄŸer bir maÃ§ta 'Ãœst' veya 'KG Var' bekleniyorsa; sadece 'Ã‡ok Åut AtÄ±yorlar' verisine bakmak YASAKTIR.",
                    "sart": "Ä°ki takÄ±mdan en az birinin 'Åut/Gol DÃ¶nÃ¼ÅŸÃ¼m OranÄ±' (Conversion Rate) %13 ve Ã¼zerinde olmak ZORUNDADIR.",
                    "aksiyon": "EÄŸer iki takÄ±m da %13'Ã¼n altÄ±ndaysa (Ã–rn: %7 vs %9), xG ve Åut sayÄ±sÄ± ne kadar yÃ¼ksek olursa olsun o maÃ§a ÃœST/KG VAR OYNANMAZ.",
                    "referans": "Bkz: KasÄ±mpaÅŸa & Liefering VakasÄ±",
                    "baraj": 13
                },
                {
                    "id": "K.DUVAR-50",
                    "sira": 6,
                    "baslik": "ğŸ›¡ï¸ K.DUVAR-50 (SAVUNMA DUVARI PROTOKOLÃœ - MUTLAK VETO)",
                    "tanim": "Analiz edilen maÃ§ta, rakip takÄ±mÄ±n (Ev veya Deplasman fark etmeksizin) 'Gol Yememe' (Clean Sheet) oranÄ± %50 ve Ã¼zerindeyse;",
                    "yasak": "DiÄŸer takÄ±mÄ±n 'Gol Atma' istatistiÄŸi %100, xG'si 3.00 bile olsa; o maÃ§a 'TAKIM GOLÃœ', '1.5 ÃœST' veya 'KG VAR' bankosu YAZILAMAZ.",
                    "sebep": "'Duvar' istatistiÄŸi (Savunma), her zaman 'GolcÃ¼' istatistiÄŸini yener. (Bkz: Podbrezova vs DAC VakasÄ±).",
                    "alternatif": "Bu maÃ§lara sadece 'ALT' veya 'KG YOK' bakÄ±lÄ±r ya da PAS geÃ§ilir.",
                    "baraj": 50
                }
            ]
        },
        "b_grubu": {
            "baslik": "SAYISAL VETOLAR (G BÃ–LÃœMÃœ - EKSÄ°KSÄ°Z LÄ°STE)",
            "kurallar": [
                {
                    "id": "K.KARAVANA",
                    "baslik": "ğŸ¯ K.KARAVANA (ÅUT KALÄ°TESÄ° VETOSU)",
                    "tanim": "Bir takÄ±mÄ±n 'MaÃ§ BaÅŸÄ±na Åut' ortalamasÄ± yÃ¼ksek (15+) gÃ¶rÃ¼nebilir. Ancak 'Ä°sabetli Åut / Toplam Åut' oranÄ± kontrol edilmelidir.",
                    "kontrol": "EÄŸer isabet oranÄ± %30'un altÄ±ndaysa (Ã–rn: 20 ÅŸut Ã§ekip sadece 4'Ã¼nÃ¼ kaleye buluyorsa);",
                    "yasak": "O takÄ±ma 'GOL ATAR' veya 'ÃœST' bankosu verilemez. Ã‡Ã¼nkÃ¼ bu takÄ±m 'BaskÄ±lÄ±' deÄŸil 'Beceriksiz' oynuyordur. Gol ÅŸansa kalÄ±r.",
                    "baraj": 30
                },
                {
                    "id": "K.GOL-SÄ°GORTASI",
                    "baslik": "K.GOL-SÄ°GORTASI (YENÄ°)",
                    "tanim": "TakÄ±mÄ±n 'Gol AtÄ±lamayan MaÃ§' oranÄ± %20 Ã¼zerindeyse (Ä°stikrarsÄ±zsa)",
                    "aksiyon": "GOL BANKOSU VERÄ°LMEZ",
                    "baraj": 20
                },
                {
                    "id": "K.KALE-KÄ°LÄ°DÄ°",
                    "baslik": "K.KALE-KÄ°LÄ°DÄ° (YENÄ°)",
                    "tanim": "Rakip takÄ±mÄ±n 'Gol Yememe' oranÄ± %33 Ã¼zerindeyse",
                    "aksiyon": "ÃœST/KG VAR YASAK",
                    "baraj": 33
                },
                {
                    "id": "K.34",
                    "baslik": "K.34 (KG VAR PROTOKOLÃœ - Ã‡Ä°FT KONTROL ğŸ›‘)",
                    "asama_1": {
                        "kaynak": "'2.5 Ãœst ve KG Tahminleri' tablosu",
                        "kontrol": "KG (KarÅŸÄ±lÄ±klÄ± Gol) satÄ±rÄ±nÄ±n ORTALAMA sÃ¼tunu %70 ve Ã¼zerinde olmalÄ±dÄ±r"
                    },
                    "asama_2": {
                        "kaynak": "'AtÄ±lan Goller' tablosu",
                        "kontrol": "Hem Ev Sahibi hem de Deplasman takÄ±mÄ±nÄ±n '0.5 Ãœst' (Gol Atma) yÃ¼zdesi en az %70 olmalÄ±dÄ±r"
                    },
                    "sonuc": "Ancak bu iki ÅŸart aynÄ± anda saÄŸlanÄ±rsa KG VAR oynanabilir, aksi halde VETO edilir.",
                    "baraj_kg": 70,
                    "baraj_05ust": 70
                },
                {
                    "id": "K.41",
                    "baslik": "K.41 (KISIR DÃ–NGÃœ)",
                    "tanim": "Ä°ki takÄ±mÄ±n gol ortalamasÄ± 2.50 altÄ±ndaysa",
                    "aksiyon": "BANKO ÃœST OYNANMAZ",
                    "baraj": 2.50
                },
                {
                    "id": "K.17",
                    "baslik": "K.17 (KATI SAVUNMA)",
                    "tanim": "Gol Yememe oranÄ± %40 Ã¼zerindeyse (Yani %60'tan az yiyorsa)",
                    "aksiyon": "ÃœST/KG VAR YASAK",
                    "baraj": 40
                },
                {
                    "id": "K.70",
                    "baslik": "K.70 (Ã‡Ä°FT KÄ°LÄ°T)",
                    "tanim": "1.5 Ãœst oranÄ± %20 altÄ±ndaysa",
                    "aksiyon": "BAHÄ°S YASAK",
                    "baraj": 20
                },
                {
                    "id": "K.EV-GOL-60",
                    "baslik": "K.EV-GOL-60",
                    "tanim": "Ev sahibinin gol atma oranÄ± %60 altÄ±ndaysa",
                    "aksiyon": "MS 1 BANKO VERÄ°LMEZ",
                    "baraj": 60
                },
                {
                    "id": "K.KISIR-LÄ°G",
                    "baslik": "K.KISIR-LÄ°G",
                    "tanim": "Lig gol ortalamasÄ± 2.30 altÄ±ysa ve favori ÅŸutu 4.5 altÄ±ysa",
                    "aksiyon": "MS 1 Banko olamaz",
                    "baraj_gol": 2.30,
                    "baraj_sut": 4.5
                },
                {
                    "id": "K.Ä°SABET-KÄ°LÄ°DÄ°",
                    "baslik": "K.Ä°SABET-KÄ°LÄ°DÄ°",
                    "tanim": "KG VAR oynamak iÃ§in toplam isabetli ÅŸut 8.00+ olmalÄ±dÄ±r",
                    "baraj": 8.00
                },
                {
                    "id": "K.KRÄ°Z-ALT",
                    "baslik": "K.KRÄ°Z-ALT",
                    "tanim": "Favori krizdeyse (3+ maÃ§tÄ±r kazanamÄ±yorsa)",
                    "aksiyon": "Alt oynanmaz",
                    "baraj": 3
                },
                {
                    "id": "K.ZEHÄ°RLÄ°-ORAN",
                    "baslik": "K.ZEHÄ°RLÄ°-ORAN",
                    "tanim": "Kazanma ihtimali >%50 olan takÄ±ma 2.00+ oran aÃ§Ä±lmÄ±ÅŸsa",
                    "aksiyon": "Taraf Bahsi Veto edilir",
                    "baraj_kazanma": 50,
                    "baraj_oran": 2.00
                },
                {
                    "id": "K.AKILLI-PARA",
                    "baslik": "K.AKILLI-PARA",
                    "tanim": "Oran maÃ§ saatine yakÄ±n 0.30 puandan fazla yÃ¼kselmiÅŸse",
                    "aksiyon": "bahis alÄ±nmaz",
                    "baraj": 0.30
                },
                {
                    "id": "K.DÄ°P-DÄ°RENÃ‡",
                    "baslik": "K.DÄ°P-DÄ°RENÃ‡",
                    "tanim": "Ligin son 5 haftasÄ±nda, dÃ¼ÅŸme hattÄ±na giden lidere",
                    "aksiyon": "deplasman bankosu verilmez"
                },
                {
                    "id": "K.ORAN-ÅÃœPHE",
                    "baslik": "K.ORAN-ÅÃœPHE",
                    "tanim": "Lig sonuncusuna karÅŸÄ± oynayan favoriye oran 1.60+ ise",
                    "aksiyon": "ÅŸÃ¼phelidir",
                    "baraj": 1.60
                },
                {
                    "id": "K.NEKRO",
                    "baslik": "K.NEKRO",
                    "tanim": "8 maÃ§tÄ±r kazanamayan takÄ±ma",
                    "aksiyon": "bahis oynanmaz (FAVORÄ° BAHÄ°SÄ° OYNANMAZ)",
                    "baraj": 8
                },
                {
                    "id": "K.ÅUT-TABLOSU-VETO",
                    "baslik": "K.ÅUT-TABLOSU-VETO",
                    "tanim": "Favori/GolcÃ¼ TakÄ±m isabetli ÅŸut 6.00 altÄ±ndaysa",
                    "aksiyon": "oynanmaz",
                    "baraj": 6.00
                },
                {
                    "id": "K.FAVORÄ°-TEMBEL",
                    "baslik": "K.FAVORÄ°-TEMBEL",
                    "tanim": "Favori toplam ÅŸut 10.50 altÄ±ndaysa",
                    "aksiyon": "oynanmaz",
                    "baraj": 10.50
                },
                {
                    "id": "K.RAKÄ°P-DÄ°ÅLÄ°",
                    "baslik": "K.RAKÄ°P-DÄ°ÅLÄ°",
                    "tanim": "Rakip isabetli ÅŸut 4.50+ ise",
                    "aksiyon": "MS 1 riskli",
                    "baraj": 4.50
                },
                {
                    "id": "K.RAKÄ°P-HACÄ°M",
                    "baslik": "K.RAKÄ°P-HACÄ°M",
                    "tanim": "Rakip toplam ÅŸut 10.50+ ise",
                    "aksiyon": "MS 1 riskli",
                    "baraj": 10.50
                },
                {
                    "id": "K.KG-KOMBO",
                    "baslik": "K.KG-KOMBO",
                    "tanim": "Toplam ÅŸut 10.00+ olsa bile, Conversion %10 altÄ±ndaysa",
                    "aksiyon": "KG VAR / ÃœST OYNANMAZ",
                    "baraj_sut": 10.00,
                    "baraj_conv": 10
                },
                {
                    "id": "K.ALT-KONTROL",
                    "baslik": "K.ALT-KONTROL",
                    "tanim": "Toplam isabetli ÅŸut 8.50+ ise",
                    "aksiyon": "Alt oynanmaz",
                    "baraj": 8.50
                },
                {
                    "id": "K.KRÄ°Z-GOL",
                    "baslik": "K.KRÄ°Z-GOL",
                    "tanim": "3 maÃ§tÄ±r atamayana veya kazanamayana",
                    "aksiyon": "KG VAR verilmez",
                    "baraj": 3
                },
                {
                    "id": "K.SON-VÄ°RAJ",
                    "baslik": "K.SON-VÄ°RAJ",
                    "tanim": "Son 5 maÃ§Ä±n 2'sinde gol atamayan",
                    "aksiyon": "Banko olamaz"
                },
                {
                    "id": "K.ERKEN-FÄ°ÅEK",
                    "baslik": "K.ERKEN-FÄ°ÅEK",
                    "tanim": "Ä°Y Gol %40 altÄ±ndaysa",
                    "aksiyon": "Ä°Y Gol Banko olamaz",
                    "baraj": 40
                },
                {
                    "id": "K.H2H-ZEHÄ°R",
                    "baslik": "K.H2H-ZEHÄ°R",
                    "tanim": "H2H son 3 maÃ§Ä±n 2'si Alt ise",
                    "aksiyon": "Ãœst Banko olamaz"
                },
                {
                    "id": "K.TEK-GÃœÃ‡",
                    "baslik": "K.TEK-GÃœÃ‡",
                    "tanim": "Favori golcÃ¼, zayÄ±f kÄ±sÄ±rlÄ±ksa",
                    "aksiyon": "KG VAR silinir"
                },
                {
                    "id": "K.CS2",
                    "baslik": "K.CS2",
                    "tanim": "4 maÃ§tÄ±r gol yemeyen takÄ±ma",
                    "aksiyon": "Ãœst/KG Var oynanmaz",
                    "istisna": "Rakip %85+ atÄ±yorsa istisna",
                    "baraj": 4
                },
                {
                    "id": "K.32",
                    "baslik": "K.32",
                    "tanim": "H2H Son 5 maÃ§Ä±n 3'Ã¼ Alt ise",
                    "aksiyon": "Ãœst ÅÃ¼pheli"
                },
                {
                    "id": "K.15",
                    "baslik": "K.15",
                    "tanim": "Biri %90+ GolcÃ¼ ise",
                    "aksiyon": "KG YOK VETO",
                    "baraj": 90
                },
                {
                    "id": "K.40",
                    "baslik": "K.40",
                    "tanim": "Favori 4+ maÃ§tÄ±r kazanamÄ±yorsa",
                    "aksiyon": "Taraf Bahsi VETO",
                    "baraj": 4
                },
                {
                    "id": "K.46",
                    "baslik": "K.46",
                    "tanim": "Genel 2.5 Ãœst %30 altÄ±ndaysa",
                    "aksiyon": "GOL ÃœSTÃœ VETO",
                    "baraj": 30
                },
                {
                    "id": "K.49.B",
                    "baslik": "K.49.B",
                    "tanim": "Favori puan olarak rakibinden gerideyse",
                    "aksiyon": "VETO"
                },
                {
                    "id": "K.29",
                    "baslik": "K.29",
                    "tanim": "Favori o sahada 4+ maÃ§tÄ±r kazanamÄ±yorsa",
                    "aksiyon": "VETO",
                    "baraj": 4
                },
                {
                    "id": "K.50",
                    "baslik": "K.50",
                    "tanim": "Bireysel 1.5 Ãœst farkÄ± 65+ puan ise",
                    "aksiyon": "Gol ÃœstÃ¼ Banko Olamaz",
                    "baraj": 65
                },
                {
                    "id": "K.SÄ°NERJÄ°",
                    "baslik": "K.SÄ°NERJÄ°",
                    "tanim": "(Ev Atan + Dep Yiyen)/2 < %55 ise",
                    "aksiyon": "Ev GolÃ¼ Veto. (Tersi iÃ§in Dep GolÃ¼ Veto).",
                    "baraj": 55
                },
                {
                    "id": "K.ZÄ°RVE-KÄ°LÄ°DÄ°",
                    "baslik": "K.ZÄ°RVE-KÄ°LÄ°DÄ°",
                    "tanim": "Ä°lk 3 sÄ±radaki takÄ±mlar birbirleriyle oynuyorsa",
                    "aksiyon": "BANKO ÃœST/KG VAR OYNANMAZ"
                },
                {
                    "id": "K.SÃœPER-FAVORÄ°",
                    "baslik": "ğŸ›‘ K.SÃœPER-FAVORÄ° (1.35 KURALI)",
                    "tanim": "Bir takÄ±mÄ±n kazanma oranÄ± 1.35 ve altÄ±ndaysa (Ã–rn: 1.05, 1.25, 1.30)",
                    "yasak": "O maÃ§a ASLA 'MS 1' veya 'MS 2' oynanmaz.",
                    "izin": "Sadece GOL BAHÄ°SLERÄ° (1.5/2.5 ÃœST veya TAKIM GOLÃœ) alÄ±nÄ±r.",
                    "baraj": 1.35
                },
                {
                    "id": "K.KEVGÄ°R-FAVORÄ°",
                    "baslik": "K.KEVGÄ°R-FAVORÄ° (%60 KURALI)",
                    "tanim": "Favori takÄ±mÄ±n 'Gol Yeme OranÄ±' %60'Ä±n Ã¼zerindeyse",
                    "yasak": "Rakibin gol atma becerisi ne kadar dÃ¼ÅŸÃ¼k olursa olsun 'KG YOK' bahsi ALINMAZ.",
                    "baraj": 60
                },
                {
                    "id": "K.KISIR-7",
                    "baslik": "K.KISIR-7 (IMPOTENCE PROTOCOL)",
                    "tanim": "Favori veya ev sahibi takÄ±mÄ±n 'Åut DÃ¶nÃ¼ÅŸÃ¼m OranÄ±' (Conversion Rate) %7 ve altÄ±ndaysa",
                    "yasak": "O takÄ±mÄ±n maÃ§Ä±na '2.5 ÃœST' veya 'KG VAR' Banko yazÄ±lamaz.",
                    "alternatif": "Banko tercihi 'KG YOK', '3.5 ALT' veya 'DEPLASMAN 0.5 ÃœST' olmalÄ±dÄ±r.",
                    "baraj": 7
                },
                {
                    "id": "K.DUVAR-80",
                    "baslik": "K.DUVAR-80 (IRON WALL PROTOCOL)",
                    "tanim": "Bir takÄ±mÄ±n 'Gol Yememe' (Clean Sheet) oranÄ± %75 ve Ã¼zerindeyse",
                    "yasak": "Rakip takÄ±mÄ±n '0.5 Ãœst', '1.5 Ãœst' veya maÃ§Ä±n 'KG VAR' / '2.5 ÃœST' seÃ§enekleri ASLA 'BANKO' olarak seÃ§ilemez.",
                    "alternatif": "Banko tercihi 'KG YOK', '3.5 ALT' veya 'Ã‡Ä°FTE ÅANS' (Gol Yemeyen Taraf) olmalÄ±dÄ±r.",
                    "baraj": 75
                },
                {
                    "id": "K.CONVERSION-BARAJI",
                    "baslik": "K.CONVERSION-BARAJI (MS BLOK)",
                    "tanim": "Favori takÄ±mÄ±n Åut DÃ¶nÃ¼ÅŸÃ¼m OranÄ± (Conversion) %12'nin altÄ±ndaysa",
                    "yasak": "Galibiyet yÃ¼zdesi %60+ ve xG'si yÃ¼ksek olsa bile o maÃ§a MS TARAF BAHSÄ° (MS 1/MS 2) OYNANMAZ.",
                    "alternatif": "Sadece Gol bahislerine veya Ã‡ifte Åansa yÃ¶nelir.",
                    "baraj": 12
                },
                {
                    "id": "K.DEVLER-KÄ°LÄ°DÄ°",
                    "baslik": "ğŸ›‘ K.DEVLER-KÄ°LÄ°DÄ° (CLASH OF TITANS)",
                    "tanim": "EÄŸer iki takÄ±m da 'AÄŸÄ±r Siklet' (Ã–rn: Inter vs Liverpool, Real Madrid vs City) ise veya Deplasman takÄ±mÄ± 'Elit Savunma' yapabilen bir takÄ±msa",
                    "yasak": "Ev Sahibi xG'si ne kadar yÃ¼ksek olursa olsun, o takÄ±ma TAKIM 1.5 ÃœST bankosu YAZILAMAZ.",
                    "alternatif": "Bu maÃ§larda sadece 'GENEL 1.5 ÃœST' veya 'KG VAR' (eÄŸer ÅŸartlar uyuyorsa) tercih edilmelidir. TakÄ±m golÃ¼ne gÃ¼venilmez."
                },
                {
                    "id": "K.KISIRLIK-VETO",
                    "baslik": "ğŸ›‘ K.KISIRLIK-VETO (V47 GÃœNCELLEME)",
                    "tanim": "Bir takÄ±mÄ±n 'Gol AtÄ±lamayan MaÃ§' (Failed to Score) oranÄ± %25 ve Ã¼zerindeyse",
                    "yasak": "O takÄ±mÄ±n xG Ã¼retimi veya ÅŸut sayÄ±sÄ± ne kadar yÃ¼ksek olursa olsun, o takÄ±ma 'GOL ATAR (0.5 ÃœST)' veya 'TAKIM GOLÃœ' bankosu VERÄ°LEMEZ.",
                    "sebep": "Ä°statistik kaÄŸÄ±dÄ±ndaki bu risk, sahadaki xG'yi her zaman yener. (Bkz: Galatasaray VakasÄ±nÄ± HatÄ±rla).",
                    "baraj": 25
                },
                {
                    "id": "K.GENÃ‡LÄ°K-KAOSU",
                    "baslik": "ğŸ›‘ K.GENÃ‡LÄ°K-KAOSU (YOUTH CHAOS PROTOCOL)",
                    "tanim": "Analiz edilen maÃ§ U19, U21, GenÃ§lik Ligi veya KadÄ±nlar Ligi ise",
                    "yasak": "xG farkÄ± ne kadar yÃ¼ksek olursa olsun, 'MS TARAF' bahsi (MS 1/MS 2) asla BANKO olarak (8/10 Ã¼zeri gÃ¼venle) verilemez.",
                    "sebep": "GenÃ§ oyuncularda 'Mental KÄ±rÄ±lganlÄ±k' ve 'Bitiricilik Sorunu' (YÃ¼ksek xG dÃ¼ÅŸÃ¼k Gol) riski yÃ¼ksektir.",
                    "alternatif": "Bu maÃ§larda sadece GOL BAHÄ°SLERÄ°NE (Ãœst/Alt) odaklanÄ±lÄ±r veya PAS GEÃ‡Ä°LÄ°R.",
                    "max_guven": 7
                },
                {
                    "id": "K.LÄ°G-KARANTÄ°NASI",
                    "baslik": "ğŸ›‘ K.LÄ°G-KARANTÄ°NASI (LEAGUE QUARANTINE - TÄ°FLÄ°S DERSÄ°)",
                    "tanim": "Analiz edilen maÃ§ ÅŸu kategorilerden birindeyse: U19 / GenÃ§lik Ligi / Rezerv Ligler / KadÄ±nlar Ligi / Afrika & Asya Alt Ligleri.",
                    "yasak": "Bu maÃ§lara, istatistikler ne kadar 'Kusursuz' gÃ¶rÃ¼nÃ¼rse gÃ¶rÃ¼nsÃ¼n ASLA 'MS 1' veya 'MS 2' (Taraf Bahsi) BANKO OLARAK VERÄ°LEMEZ.",
                    "alternatif": "Bu liglerde sadece GOL BAHÄ°SLERÄ° (1.5 Ãœst, 2.5 Ãœst, KG Var, TakÄ±m GolÃ¼) analiz edilir. Taraf bahsi yasaklÄ±dÄ±r."
                },
                {
                    "id": "K.DEPLASMAN-SENDROMU",
                    "baslik": "ğŸ›‘ K.DEPLASMAN-SENDROMU (ELITE AWAY - PSG PROTOKOLÃœ)",
                    "tanim": "Åampiyonlar Ligi, Avrupa Ligi veya 5 BÃ¼yÃ¼k Lig gibi 'Elit' seviyede; Favori takÄ±m DEPLASMANDA oynuyorsa ve Ev Sahibi takÄ±mÄ±n 'Gol Yememe' direnci varsa (veya favorinin oranÄ± 1.50 - 1.80 aralÄ±ÄŸÄ±nda sÄ±kÄ±ÅŸmÄ±ÅŸsa)",
                    "yasak": "O maÃ§a direkt 'MS 2' (Deplasman KazanÄ±r) oynamak YASAKTIR. PSG Ã¶rneÄŸindeki gibi 0-0 veya 1-1 riskleri yÃ¼ksektir.",
                    "cozum": "Bu maÃ§larda banko tercih 'X2 Ã‡ifte Åans' (Kaybetmez), 'Deplasman 0.5/1.5 Ãœst' (Gol Atar) veya 'Genel 1.5 Ãœst' (Gol SayÄ±sÄ±) olmalÄ±dÄ±r. Taraf riski alÄ±nmaz.",
                    "baraj_min": 1.50,
                    "baraj_max": 1.80
                },
                {
                    "id": "K.xGA-DÄ°RENCÄ°",
                    "baslik": "ğŸ›¡ï¸ K.xGA-DÄ°RENCÄ° (SAVUNMA DUVARI PROTOKOLÃœ)",
                    "tanim": "Favori takÄ±mÄ±n gol atmasÄ± bekleniyorsa ('TakÄ±m 1.5 Ãœst' veya 'MS 1' gibi), Rakip TakÄ±mÄ±n xGA (Gol Yeme Beklentisi) deÄŸeri 0.95'in altÄ±ndaysa",
                    "yasak": "Rakip savunma 'Duvar' gibidir (Az pozisyon verir). Bu maÃ§a 'TAKIM 1.5 ÃœST' veya 'MS 2.5 ÃœST' BANKO VERÄ°LEMEZ.",
                    "sebep": "Ä°statistikler yÃ¼ksek gol gÃ¶sterse bile xGA (Saha iÃ§i savunma kalitesi) dÃ¼ÅŸÃ¼kse maÃ§ kÄ±sÄ±r geÃ§er.",
                    "baraj": 0.95
                },
                {
                    "id": "K.SKOR-KORUMA",
                    "baslik": "ğŸ›¡ï¸ K.SKOR-KORUMA (MOURINHO v2 - ESNEK VERSÄ°YON)",
                    "tanim": "Favori takÄ±mÄ±n 'Ã–ne GeÃ§tiÄŸi MaÃ§larÄ± Kazanma' oranÄ± yÃ¼ksekse (Ã–rn: 10/10)",
                    "kontrol": "TakÄ±mÄ±n 'Gol Yememe' (Clean Sheet) oranÄ±na bakÄ±lÄ±r.",
                    "durum_a": {
                        "baslik": "DURUM A (KÄ°LÄ°TÃ‡Ä°)",
                        "kosul": "EÄŸer Clean Sheet oranÄ± %50 ve Ã¼zerindeyse",
                        "yorum": "Bu takÄ±m 1-0 veya 2-0 kazanÄ±p maÃ§Ä± bitiriyordur.",
                        "aksiyon": "MS 2.5 ÃœST BANKO VERME, RÄ°SKLÄ°DÄ°R"
                    },
                    "durum_b": {
                        "baslik": "DURUM B (SALDIRGAN)",
                        "kosul": "EÄŸer Clean Sheet oranÄ± %50'nin altÄ±ndaysa (yani gol yiyorsa veya Ã§ok atÄ±yorsa)",
                        "yorum": "Bu takÄ±m Ã¶ne geÃ§se de maÃ§ 2-1, 3-1 veya 4-0 bitebilir.",
                        "aksiyon": "KURAL GEÃ‡ERSÄ°ZDÄ°R, 2.5 ÃœST OYNANABÄ°LÄ°R âœ…"
                    },
                    "baraj": 50
                },
                {
                    "id": "K.KADRO-HÄ°YERARÅÄ°SÄ°",
                    "baslik": "ğŸ›‘ K.KADRO-HÄ°YERARÅÄ°SÄ° (SQUAD VALUE PROTOCOL - V47.4)",
                    "tanim": "Avrupa KupalarÄ± (Konferans/Avrupa Ligi) maÃ§larÄ±nda 'General Stats' gÃ¶rselindeki 'Squad Value' (Kadro DeÄŸeri) mutlaka kontrol edilmelidir.",
                    "davut_golyat": {
                        "baslik": "DAVUT vs GOLYAT (5x+ FARK)",
                        "kosul": "EÄŸer Favori takÄ±m, Rakibinden 5 KAT ve daha fazla deÄŸerliyse (Ã–rn: AZ vs Drita)",
                        "aksiyon": "ZayÄ±f takÄ±mÄ±n 'Gol Atar' istatistiÄŸi %100 bile olsa dikkate alÄ±nmaz. O maÃ§a ZAYIF TAKIM GOLÃœ OYNANMAZ.",
                        "fark": 5
                    },
                    "tehlikeli_deplasman": {
                        "baslik": "TEHLÄ°KELÄ° DEPLASMAN (2x-3x FARK)",
                        "kosul": "EÄŸer Favori takÄ±m Deplasmandaysa ve deÄŸer farkÄ± sadece 2 ile 3 Kat arasÄ±ndaysa (Ã–rn: Slovan vs ShkÃ«ndija)",
                        "aksiyon": "Favori takÄ±mÄ±n 'Gol Atar' veya 'KazanÄ±r' bankosu RÄ°SKLÄ°DÄ°R. Bu maÃ§lar ya PAS GEÃ‡Ä°LÄ°R ya da sadece GENEL GOL (1.5/2.5 ÃœST) kovalanÄ±r.",
                        "fark_min": 2,
                        "fark_max": 3
                    }
                },
                {
                    "id": "K.TEK-KANAT",
                    "baslik": "ğŸ©¸ K.TEK-KANAT (BÄ°TÄ°RÄ°CÄ°LÄ°K PROTOKOLÃœ)",
                    "tanim": "Favori takÄ±mÄ±n veya Ev Sahibinin Åut DÃ¶nÃ¼ÅŸÃ¼m OranÄ± (Conversion) %10'un altÄ±ndaysa",
                    "yasak": "O maÃ§a 'GENEL 1.5 ÃœST', '2.5 ÃœST' veya 'KG VAR' bankosu YAZILAMAZ. (Ã‡Ã¼nkÃ¼ favori takÄ±m 20 ÅŸut atsa da golÃ¼ bulamayabilir).",
                    "alternatif_kapisi": {
                        "kosul": "EÄŸer Rakip TakÄ±mÄ±n 'AtÄ±lan Goller 0.5 Ãœst' yÃ¼zdesi %70 Ã¼zerindeyse VE Rakibin Conversion oranÄ± %12+ ise",
                        "aksiyon": "O maÃ§a sadece 'RAKÄ°P TAKIM 0.5 ÃœST' (Deplasman Gol Atar) bahsi banko olarak girilebilir."
                    },
                    "baraj": 10
                }
            ]
        }
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 5: BANKO ÅARTLARI (H BÃ–LÃœMÃœ - MATEMATÄ°KSEL)
    # ğŸ”„ ANALÄ°Z VE TARAMA SIRALAMASI (PRIORITY LOGIC)
    # Sistem maÃ§Ä± bu sÄ±rayla tarar. HiyerarÅŸik olarak ilk "EVET" (TRUE) dÃ¶nen kuralÄ± "GÃœNÃœN BANKOSU" olarak iÅŸaretler.
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 5",
        "ad": "BANKO ÅARTLARI (H BÃ–LÃœMÃœ - MATEMATÄ°KSEL)",
        "aciklama": "Sistem maÃ§Ä± bu sÄ±rayla tarar. HiyerarÅŸik olarak ilk 'EVET' (TRUE) dÃ¶nen kuralÄ± 'GÃœNÃœN BANKOSU' olarak iÅŸaretler.",
        "asama_0": {
            "baslik": "ğŸ›‘ AÅAMA 0: GÃœVENLÄ°K VE VETO (Ä°LK FÄ°LTRE)",
            "aciklama": "Bu aÅŸama 'Karar' vermez, sadece riskli maÃ§larÄ± eler. EÄŸer maÃ§ buraya takÄ±lÄ±rsa ilgili bahis tÃ¼rÃ¼ kilitlenir.",
            "kurallar": [
                {
                    "id": "K.SÃœPER-FAVORÄ°",
                    "sira": 1,
                    "baslik": "K.SÃœPER-FAVORÄ° (1.35 KURALI)",
                    "veri_kaynagi": "Genel MaÃ§ OranlarÄ± / BÃ¼lten",
                    "kontrol": "Favori TakÄ±m OranÄ± 1.35 ve altÄ±ndaysa.",
                    "komut": "TARAF BAHÄ°SLERÄ°NÄ° KAPAT (Sadece Gol Bahsine izin ver).",
                    "baraj": 1.35
                },
                {
                    "id": "K.KEVGÄ°R-FAVORÄ°",
                    "sira": 2,
                    "baslik": "K.KEVGÄ°R-FAVORÄ° (LEAKY FAVORITE)",
                    "veri_kaynagi": "'YENEN GOLLER' Tablosu",
                    "satir_sutun": "Favori TakÄ±m -> Ortalama (Yenen Gol).",
                    "kontrol": "DeÄŸer 1.00'den bÃ¼yÃ¼kse.",
                    "komut": "MS 1 BAHÄ°SÄ°NÄ° KAPAT.",
                    "baraj": 1.00
                },
                {
                    "id": "K.HACÄ°M-GÃœVENLÄ°ÄÄ°",
                    "sira": 3,
                    "baslik": "K.HACÄ°M-GÃœVENLÄ°ÄÄ° (VOLUME SAFETY)",
                    "veri_kaynagi": "CanlÄ± Veri / Ä°statistik (Åutlar)",
                    "veri": "(Ev Sahibi Toplam Åut + Deplasman Toplam Åut) / MaÃ§ SayÄ±sÄ±.",
                    "kontrol": "Ortalama 30 ve Ã¼zerindeyse.",
                    "komut": "ALT BAHÄ°SLERÄ°NÄ° KAPAT (DÃ¶nÃ¼ÅŸÃ¼m oranÄ± dÃ¼ÅŸÃ¼k olsa bile).",
                    "baraj": 30
                },
                {
                    "id": "K.KISIR-TABLO",
                    "sira": 4,
                    "baslik": "K.KISIR-TABLO (1.5 ÃœST VETOSU)",
                    "veri_kaynagi": "'2.5 ÃœST VE KG TAHMÄ°NLERÄ°' Tablosu",
                    "sutun": "2.5 Ãœst (Ortalama).",
                    "kontrol": "DeÄŸer %50'nin altÄ±ndaysa.",
                    "komut": "MS 2.5 ÃœST ve MS 1.5 ÃœST KAPAT.",
                    "kurtarici_istisna": "AynÄ± tabloda 'KG VAR' sÃ¼tunu %55+ ise VEYA 'ATILAN GOLLER' tablosunda iki takÄ±m da '0.5 Ãœst' %69+ ise kilit aÃ§Ä±lÄ±r.",
                    "baraj": 50
                }
            ]
        },
        "asama_1": {
            "baslik": "ğŸš€ AÅAMA 1: YÃœKSEK GOL POTANSÄ°YELÄ° (ZÄ°RVE)",
            "kurallar": [
                {
                    "id": "MS-3.5-ÃœST",
                    "sira": 1,
                    "baslik": "MS 3.5 ÃœST (SÃœPER GOLCÃœ)",
                    "sart_1": "'2.5 ÃœST TABLOSU' -> 3.5 Ãœst SÃ¼tunu -> %45 ve Ã¼zeri.",
                    "sart_2": "Ä°statistik Verisi -> Toplam xG -> 3.00 ve Ã¼zeri.",
                    "sart_3": "'ATILAN GOLLER' Tablosu -> Ä°ki TakÄ±mÄ±n '0.5 Ãœst' sÃ¼tunu -> %90 ve Ã¼zeri.",
                    "sart_4": "'YENEN GOLLER' Tablosu -> Ä°ki TakÄ±mÄ±n '0.5 Ãœst' sÃ¼tunu -> %50 ve Ã¼zeri.",
                    "sonuc": "âœ… BANKO 3.5 ÃœST",
                    "baraj_35ust": 45,
                    "baraj_xg": 3.00,
                    "baraj_atan": 90,
                    "baraj_yiyen": 50
                },
                {
                    "id": "MS-2.5-ÃœST",
                    "sira": 2,
                    "baslik": "MS 2.5 ÃœST (Ä°KÄ° YOL)",
                    "yol_a": {
                        "baslik": "YOL A (Tablo BazlÄ± - Agresif)",
                        "sart_1": "'2.5 ÃœST TABLOSU' -> 2.5 Ãœst OrtalamasÄ± -> %62+.",
                        "sart_2": "Ä°statistik Verisi -> Toplam xG -> 3.20+.",
                        "sart_3": "'ATILAN GOLLER' Tablosu -> Ä°ki TakÄ±m 0.5 Ãœst -> %80+.",
                        "baraj_25ust": 62,
                        "baraj_xg": 3.20,
                        "baraj_atan": 80
                    },
                    "yol_b": {
                        "baslik": "YOL B (Saha BazlÄ± - K.18)",
                        "sart_1": "Ä°statistik Verisi -> Toplam xG -> 2.70+.",
                        "sart_2": "Ä°statistik Verisi -> Toplam Åut -> 18.00+.",
                        "sart_3": "Hesaplama -> DÃ¶nÃ¼ÅŸÃ¼m (Conversion) -> %12+.",
                        "sart_4": "'ATILAN GOLLER' Tablosu -> Ä°ki TakÄ±m 0.5 Ãœst -> %70+.",
                        "baraj_xg": 2.70,
                        "baraj_sut": 18.00,
                        "baraj_conv": 12,
                        "baraj_atan": 70
                    },
                    "sonuc": "âœ… BANKO 2.5 ÃœST"
                }
            ]
        },
        "asama_2": {
            "baslik": "ğŸ¤ AÅAMA 2: KARÅILIKLI GOL (KÄ°LÄ°T)",
            "kurallar": [
                {
                    "id": "KG-VAR",
                    "sira": 3,
                    "baslik": "KG VAR (ULTIMATE KÄ°LÄ°T)",
                    "sart_1": "'KG TAHMÄ°NLERÄ°' Tablosu -> KG VAR SÃ¼tunu (Ortalama) -> %55 ve Ã¼zeri.",
                    "sart_2": "'ATILAN GOLLER' Tablosu -> Hem Ev Hem Dep '0.5 Ãœst' -> %70 ve Ã¼zeri.",
                    "sart_3": "'YENEN GOLLER' Tablosu -> Hem Ev Hem Dep '0.5 Ãœst' -> %55 ve Ã¼zeri.",
                    "sonuc": "âœ… BANKO KG VAR",
                    "baraj_kg": 55,
                    "baraj_atan": 70,
                    "baraj_yiyen": 55
                }
            ]
        },
        "asama_3": {
            "baslik": "ğŸ›¡ï¸ AÅAMA 3: GÃœVENLÄ° GOL LÄ°MANLARI",
            "kurallar": [
                {
                    "id": "MS-1.5-ÃœST",
                    "sira": 4,
                    "baslik": "MS 1.5 ÃœST (ÃœÃ‡LÃœ GÃœVENLÄ°K)",
                    "sart_1": "'2.5 ÃœST TABLOSU' -> 1.5 Ãœst SÃ¼tunu (Ortalama) -> %70 ve Ã¼zeri.",
                    "sart_2": "Hesaplama -> Favori TakÄ±m Conversion -> %10 ve Ã¼zeri.",
                    "sart_3": "'ATILAN GOLLER' Tablosu -> Ä°ki TakÄ±m '0.5 Ãœst' -> %70 ve Ã¼zeri.",
                    "sonuc": "âœ… BANKO 1.5 ÃœST",
                    "baraj_15ust": 70,
                    "baraj_conv": 10,
                    "baraj_atan": 70
                },
                {
                    "id": "TAKIM-1.5-ÃœST",
                    "sira": 5,
                    "baslik": "TAKIM 1.5 ÃœST (DOMÄ°NANT)",
                    "sart_1": "'ATILAN GOLLER' -> Ä°lgili TakÄ±m '0.5 Ãœst' -> %85+.",
                    "sart_2": "'ATILAN GOLLER' -> Ä°lgili TakÄ±m '1.5 Ãœst' -> %70+.",
                    "sart_3": "'YENEN GOLLER' -> Rakip TakÄ±m '0.5 Ãœst' (Yeme) -> %60+.",
                    "sonuc": "âœ… BANKO TAKIM 1.5 ÃœST",
                    "baraj_05ust": 85,
                    "baraj_15ust": 70,
                    "baraj_rakip_yeme": 60
                },
                {
                    "id": "TAKIM-0.5-ÃœST",
                    "sira": 6,
                    "baslik": "TAKIM 0.5 ÃœST (GARANTÄ°)",
                    "sart_1": "'ATILAN GOLLER' -> Ä°lgili TakÄ±m '0.5 Ãœst' -> %80+.",
                    "sart_2": "'YENEN GOLLER' -> Rakip TakÄ±m '0.5 Ãœst' (Yeme) -> %49+.",
                    "sonuc": "âœ… BANKO TAKIM 0.5 ÃœST",
                    "baraj_05ust": 80,
                    "baraj_rakip_yeme": 49
                }
            ]
        },
        "asama_4": {
            "baslik": "ğŸ† AÅAMA 4: TARAF VE GALÄ°BÄ°YET",
            "kurallar": [
                {
                    "id": "MS-TARAF",
                    "sira": 7,
                    "baslik": "MS TARAF (STRATEJÄ°)",
                    "sart_1": "Oran -> 1.36 ile 2.20 arasÄ±nda.",
                    "sart_2": "'GENEL/TAHMÄ°N' Tablosu -> Kazanma YÃ¼zdesi -> %55+.",
                    "sart_3": "Hesaplama -> Favori Conversion -> %12+.",
                    "sart_4_veto": "'YENEN GOLLER' Tablosu -> Favori Evinde Yeme OrtalamasÄ± -> 1.20 AltÄ±nda.",
                    "sonuc": "âœ… BANKO MS 1 (veya 2)",
                    "baraj_oran_min": 1.36,
                    "baraj_oran_max": 2.20,
                    "baraj_kazanma": 55,
                    "baraj_conv": 12,
                    "baraj_yeme": 1.20
                }
            ]
        },
        "asama_5": {
            "baslik": "â±ï¸ AÅAMA 5: Ä°LK YARI (Ã–ZEL)",
            "kurallar": [
                {
                    "id": "Ä°Y-GALÄ°BÄ°YET",
                    "sira": 8,
                    "baslik": "Ä°Y GALÄ°BÄ°YETÄ°",
                    "sart_1": "'Ä°Y / MS' Tablosu -> Ä°lgili TakÄ±m Ä°Y Galibiyet % -> %75 ve Ã¼zeri.",
                    "sart_2": "'Ä°Y / MS' (veya Gol) Tablosu -> Ä°lgili TakÄ±m Ä°Y Gol Atma % -> %70 ve Ã¼zeri.",
                    "sonuc": "âœ… BANKO Ä°Y 1",
                    "baraj_galibiyet": 75,
                    "baraj_gol": 70
                },
                {
                    "id": "Ä°Y-1.5-ÃœST",
                    "sira": 9,
                    "baslik": "Ä°Y 1.5 ÃœST",
                    "sart": "'ATILAN GOLLER Ä°Y / 2Y' Tablosu -> Ä°Y Ortalama Gol ToplamÄ± -> 2.15 ve Ã¼zeri.",
                    "sonuc": "âœ… BANKO Ä°Y 1.5 ÃœST",
                    "baraj": 2.15
                }
            ]
        },
        "asama_6": {
            "baslik": "ğŸ“‰ AÅAMA 6: NEGATÄ°F VE KISIR BAHÄ°SLER (SON Ã‡ARE)",
            "kurallar": [
                {
                    "id": "2.5-ALT",
                    "sira": 10,
                    "baslik": "2.5 ALT (K.22)",
                    "sart_1": "Ä°statistik Verisi -> Toplam xG -> 2.00 AltÄ±nda.",
                    "sart_2": "Ä°statistik Verisi -> Toplam Åut -> 18.00 AltÄ±nda.",
                    "sart_3": "'ATILAN GOLLER' Tablosu -> Ä°ki TakÄ±m '0.5 Ãœst' -> %65 AltÄ±nda.",
                    "veto_kontrol": "Åut OrtalamasÄ± 30'u geÃ§memeli! (K.Hacim GÃ¼venliÄŸi).",
                    "sonuc": "âœ… BANKO 2.5 ALT",
                    "baraj_xg": 2.00,
                    "baraj_sut": 18.00,
                    "baraj_atan": 65
                },
                {
                    "id": "KG-YOK",
                    "sira": 11,
                    "baslik": "KG YOK (SÄ°GORTALI)",
                    "sart_1": "'ATILAN GOLLER' Tablosu -> Ev Sahibi (Evinde) '0.5 Ãœst' -> %65 AltÄ±nda.",
                    "sart_2": "'ATILAN GOLLER' Tablosu -> Deplasman (DÄ±ÅŸarÄ±da) '0.5 Ãœst' -> %65 AltÄ±nda.",
                    "sart_3": "'YENEN GOLLER' Tablosu -> En az bir takÄ±mÄ±n yeme yÃ¼zdesi %40 ve altÄ±.",
                    "sonuc": "âœ… BANKO KG YOK",
                    "baraj_ev_atan": 65,
                    "baraj_dep_atan": 65,
                    "baraj_yeme": 40
                }
            ]
        }
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 6: DEVRE ARASI CANLI STRATEJÄ°SÄ° (V45 - ORTAK BAHÄ°S)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 6",
        "ad": "DEVRE ARASI CANLI STRATEJÄ°SÄ° (V45 - ORTAK BAHÄ°S)",
        "kurallar": [
            {
                "id": "NABIZ",
                "baslik": "âš ï¸ GÄ°RÄ°Å ÅARTI (NABIZ)",
                "kontrol": "Ä°Y Ä°sabetli Åut < 4 ise",
                "aksiyon": "PAS GEÃ‡",
                "baraj": 4
            },
            {
                "id": "SENARYO-1",
                "baslik": "SENARYO 1 (HT 0-0)",
                "kontrol": "TakÄ±mlarÄ±n Gol Atma %'si > %79 mu?",
                "aksiyon": "Ä°kisi de %79+ ise '0.5 Ãœst'. Biri ise Riskli. Ä°kisi de dÃ¼ÅŸÃ¼kse Girme.",
                "baraj": 79
            },
            {
                "id": "SENARYO-2",
                "baslik": "SENARYO 2 (Favori Ã–nde)",
                "kontrol": "Ã–nde olanÄ±n 1.5 Ãœst %'si > %60 mÄ±?",
                "aksiyon": "Evetse '1.5 Ãœst' (MaÃ§ta 2. Gol).",
                "baraj": 60
            },
            {
                "id": "SENARYO-3",
                "baslik": "SENARYO 3 (Favori Geride)",
                "kontrol": "Favorinin Gol Atma %'si > %79 mu?",
                "aksiyon": "Evetse '1.5 Ãœst' (MaÃ§ta 2. Gol / Ortak Bahis).",
                "baraj": 79
            },
            {
                "id": "SENARYO-4",
                "baslik": "SENARYO 4 (1-1 Berabere)",
                "kontrol": "MaÃ§ aÃ§Ä±lmÄ±ÅŸtÄ±r.",
                "aksiyon": "'2.5 ÃœST' veya '3.5 ÃœST' (MaÃ§ aÃ§Ä±lmÄ±ÅŸtÄ±r)."
            },
            {
                "id": "SENARYO-5",
                "baslik": "SENARYO 5 (2 Fark)",
                "kontrol": "Gerideki takÄ±mÄ±n Gol Atma %'si > %79 mu?",
                "aksiyon": "Evetse '2.5 ÃœST'. HayÄ±rsa PAS.",
                "baraj": 79
            }
        ]
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 7: KUPON OLUÅTURMA KURALLARI (KASA KATLAMA)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 7",
        "ad": "KUPON OLUÅTURMA KURALLARI (KASA KATLAMA)",
        "kurallar": [
            {
                "id": "KASA-KUPONU",
                "baslik": "ğŸ’° KASA KUPONU (BANKO)",
                "amac": "2 veya 3 adet 'SÄ±fÄ±r Risk' odaklÄ± tercihi birleÅŸtirip 2.00+ Oran kasasÄ± yapmak.",
                "alt_sinir": "1.20 Oran.",
                "kisitlama": "OranÄ± 1.40 altÄ±ndaki maÃ§lara SAF TARAF BAHÄ°SÄ° (MS 1/MS 2) OYNANMAZ. Sadece GOL, Ã‡Å veya TAKIM GOLÃœ.",
                "sart": "Kasa maÃ§Ä±ndaki takÄ±mÄ±n 'Conversion' oranÄ± %12+ olmalÄ±dÄ±r.",
                "baraj_oran": 1.40,
                "baraj_conv": 12
            },
            {
                "id": "KARMA-KUPON",
                "baslik": "ğŸ”¥ KARMA KUPON (Ä°DEAL)",
                "kural": "'Kevgir-Kombo' onaylÄ± KG VAR maÃ§larÄ± ve OranÄ± 1.50 Ã¼zeri olan 'DeÄŸerli' Taraf Bahisleri VE 2.5 ÃœST BANKO YAZILAN MAÃ‡LAR buraya girer.",
                "baraj_oran": 1.50
            },
            {
                "id": "RÄ°SKLÄ°-KUPON",
                "baslik": "âš ï¸ RÄ°SKLÄ° / SÃœRPRÄ°Z",
                "kural": "Seri bozmaya aday maÃ§lar ve sistemin 'Uzak Dur' dediÄŸi ama hissi olarak denenebilecek maÃ§lar.",
                "oran_sarti": "Oran 2+ olmak zorunda.",
                "baraj_oran": 2.00
            }
        ]
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 8: Ä°LK YARI RADAR KURALLARI (F BÃ–LÃœMÃœ)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 8",
        "ad": "Ä°LK YARI RADAR KURALLARI (F BÃ–LÃœMÃœ)",
        "kurallar": [
            {
                "id": "KATI-BARAJ",
                "baslik": "ğŸ›‘ 1. TEMEL GÄ°RÄ°Å ÅARTLARI (KATI BARAJ)",
                "aciklama": "MaÃ§ Ã–nÃ¼ Analiz Filtresi",
                "kati_baraj": {
                    "tanim": "Ä°Y Gol OrtalamasÄ± (Taraf Golleri EsaslÄ±) KESÄ°N OLARAK %70 ve Ã¼zeri olmalÄ±dÄ±r.",
                    "baraj": 70
                },
                "lig_istisnasi": {
                    "tanim": "EÄŸer ligin genel gol ortalamasÄ± 2.80 ve Ã¼zerindeyse (Ã–rn: Bundesliga, Eerste Divisie), baraj %68'e iner.",
                    "baraj": 68,
                    "lig_gol_ort": 2.80
                }
            },
            {
                "id": "K.CANLI-PUSU",
                "baslik": "âš ï¸ 2. OYNAMA STRATEJÄ°SÄ° (CANLI PUSU)",
                "aciklama": "Ne Zaman Bahis AlÄ±nÄ±r?",
                "kural": "K.CANLI-PUSU (PRE-MATCH YASAK): Ä°statistikler tutsa bile, maÃ§ baÅŸlamadan 'Ä°Y 0.5 ÃœST' almak YASAKTIR.",
                "sebep": "MaÃ§ Ã¶nÃ¼ oranlarÄ± (1.25 - 1.30) riske deÄŸmez.",
                "aksiyon": "MaÃ§ baÅŸlar, dakika 10-20 arasÄ± beklenir, oran yÃ¼kselince (veya maÃ§ hareketliyse) girilir."
            },
            {
                "id": "K.TEK-TABANCA",
                "baslik": "ğŸ¯ 3. TEK TABANCA Ä°STÄ°SNASI (HARDCORE MOD)",
                "aciklama": "Ortalama DÃ¼ÅŸÃ¼k Olsa Bile Girilecek Durumlar",
                "kural": "EÄŸer takÄ±mlardan SADECE BÄ°RÄ°NÄ°N 'Ä°Y Gol Atma' oranÄ± %90 ve Ã¼zerindeyse (Kusursuz Ä°statistik); Genel Ortalama (%70) tutmasa bile 'GÄ°R! âœ…' kararÄ± verilir.",
                "uyari": "%90'Ä±n altÄ±ndaki tek taraflÄ± yÃ¼ksek oranlar (Ã–rn: %75, %85) yetersizdir. Bu durumda mutlaka genel ortalamanÄ±n (%70) tutmasÄ± beklenir. Aksi halde PAS geÃ§ilir.",
                "baraj": 90
            }
        ]
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 9: SÄ°MÃœLASYON DÃ–NGÃœSÃœ (FULL SCAN)
    # Sistem, "KÃ¶r Nokta" bÄ±rakmamak adÄ±na aÅŸaÄŸÄ±daki listeyi yukarÄ±dan aÅŸaÄŸÄ±ya tarar.
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 9",
        "ad": "SÄ°MÃœLASYON DÃ–NGÃœSÃœ (FULL SCAN)",
        "aciklama": "Sistem, 'KÃ¶r Nokta' bÄ±rakmamak adÄ±na aÅŸaÄŸÄ±daki listeyi yukarÄ±dan aÅŸaÄŸÄ±ya tarar. BÃ¶lÃ¼m 5'teki matematiksel ÅŸartlarÄ± saÄŸlayan HER SEÃ‡ENEÄE [GEÃ‡TÄ°âœ…] etiketi basar.",
        "a_pozitif_bahisler": {
            "baslik": "ğŸŸ¢ A. POZÄ°TÄ°F BAHÄ°SLER (Ã–NCELÄ°KLÄ°)",
            "aciklama": "Kasa Katlama ve Ana Tercihler",
            "kurallar": [
                {"sira": 1, "id": "3.5-ÃœST-TARA", "baslik": "3.5 ÃœST (SÃ¼per GolcÃ¼)", "referans": "BÃ¶lÃ¼m 5 / Kural 1 ÅartlarÄ±"},
                {"sira": 2, "id": "2.5-ÃœST-TARA", "baslik": "2.5 ÃœST (AltÄ±n Standart)", "referans": "BÃ¶lÃ¼m 5 / Kural 2 (Agresif veya K.18)"},
                {"sira": 3, "id": "KG-VAR-TARA", "baslik": "KG VAR (Ultimate Kilit)", "referans": "BÃ¶lÃ¼m 5 / Kural 3 ÅartlarÄ±"},
                {"sira": 4, "id": "MS-TARAF-TARA", "baslik": "MS TARAF (Strateji)", "referans": "BÃ¶lÃ¼m 5 / Kural 7 ÅartlarÄ±"},
                {"sira": 5, "id": "TAKIM-1.5Ãœ-TARA", "baslik": "TAKIM 1.5 ÃœST (Dominant)", "referans": "BÃ¶lÃ¼m 5 / Kural 5 ÅartlarÄ±"},
                {"sira": 6, "id": "Ä°Y-GAL-TARA", "baslik": "Ä°Y GALÄ°BÄ°YET (Radar)", "referans": "BÃ¶lÃ¼m 5 / Kural 8 ÅartlarÄ±"}
            ]
        },
        "b_guvenli_limanlar": {
            "baslik": "ğŸ›¡ï¸ B. GÃœVENLÄ° LÄ°MANLAR (YEDEK GÃœÃ‡)",
            "aciklama": "Ãœsttekiler Ã§Ä±kmazsa devreye girer",
            "kurallar": [
                {"sira": 7, "id": "1.5-ÃœST-TARA", "baslik": "1.5 ÃœST (ÃœÃ§lÃ¼ GÃ¼venlik)", "referans": "BÃ¶lÃ¼m 5 / Kural 4 ÅartlarÄ±"},
                {"sira": 8, "id": "TAKIM-0.5Ãœ-TARA", "baslik": "TAKIM 0.5 ÃœST (Garanti)", "referans": "BÃ¶lÃ¼m 5 / Kural 6 ÅartlarÄ±"},
                {"sira": 9, "id": "Ä°Y-1.5Ãœ-TARA", "baslik": "Ä°Y 1.5 ÃœST (HÄ±zlÄ±)", "referans": "BÃ¶lÃ¼m 5 / Kural 9 ÅartlarÄ±"}
            ]
        },
        "c_negatif_bahisler": {
            "baslik": "ğŸ”´ C. NEGATÄ°F BAHÄ°SLER (KISIR DÃ–NGÃœ)",
            "aciklama": "Sadece Pozitif ve GÃ¼venli Limanlar 'KALDI' ise bakÄ±lÄ±r",
            "kurallar": [
                {"sira": 10, "id": "2.5-ALT-TARA", "baslik": "2.5 ALT (Defans)", "referans": "BÃ¶lÃ¼m 5 / Kural 10 (Hacim GÃ¼venliÄŸi KontrollÃ¼)"},
                {"sira": 11, "id": "KG-YOK-TARA", "baslik": "KG YOK (Sigorta)", "referans": "BÃ¶lÃ¼m 5 / Kural 11 ÅartlarÄ±"}
            ]
        },
        "secim_algoritmasi": {
            "baslik": "âš–ï¸ 2. SEÃ‡Ä°M ALGORÄ°TMASI (NÄ°HAÄ° KARAR)",
            "aciklama": "EÄŸer birden fazla seÃ§enek [GEÃ‡TÄ°âœ…] onayÄ± aldÄ±ysa, sistem ÅŸu sÄ±raya gÃ¶re TEK BÄ°R BANKO seÃ§er:",
            "kurallar": [
                {
                    "sira": 1,
                    "id": "ALTIN-ORAN",
                    "baslik": "ALTIN ORAN KURALI",
                    "kural": "EÄŸer hem '2.5 ÃœST' hem 'KG VAR' geÃ§tiyse; OranÄ± 1.45 - 1.65 aralÄ±ÄŸÄ±nda olan tercih edilir.",
                    "oran_min": 1.45,
                    "oran_max": 1.65
                },
                {
                    "sira": 2,
                    "id": "GÃœVENLÄ°K-Ã–NCELÄ°ÄÄ°",
                    "baslik": "GÃœVENLÄ°K Ã–NCELÄ°ÄÄ°",
                    "kural": "EÄŸer 'MS TARAF' ve 'TAKIM 1.5 ÃœST' geÃ§tiyse; TAKIM 1.5 ÃœST seÃ§ilir (SÃ¼rprizden kaÃ§Ä±ÅŸ)."
                },
                {
                    "sira": 3,
                    "id": "YÃœZDE-FARKI",
                    "baslik": "YÃœZDE FARKI",
                    "kural": "Hangi tercihin istatistik ortalamasÄ± barajÄ±n daha Ã¼zerindeyse (Makas FarkÄ±) o seÃ§ilir."
                }
            ],
            "sonuc": "â¡ï¸ ALGORÄ°TMA SONUCU: [SEÃ‡Ä°LEN NÄ°HAÄ° BANKO BURAYA YAZILACAK]"
        },
        "son_damla": {
            "baslik": "ğŸ›‘ 3. K.SON-DAMLA (FULL SCAN OBLIGATION)",
            "aciklama": "Bu kural, analizin 'Pas GeÃ§ilmesini' engellemek iÃ§in son bir zorlamadÄ±r.",
            "tanim": "Analiz sÄ±rasÄ±nda 2.5 Ãœst, KG Var veya Taraf Bahsi gibi popÃ¼ler seÃ§enekler 'VETO' yese bile analiz ASLA ORADA BÄ°TÄ°RÄ°LEMEZ.",
            "aksiyon": "Analist/Sistem, aÅŸaÄŸÄ±daki 'KurtarÄ±cÄ±' seÃ§enekleri de tek tek kontrol etmek ve ÅŸartlarÄ± saÄŸlÄ±yorsa (Ã–rn: %80+ Ä°statistik) bunlarÄ± BANKO olarak sunmak ZORUNDADIR:",
            "kurtarici_secenekler": [
                "MS 1.5 ÃœST (MaÃ§ta 2 Gol Ã‡Ä±kar mÄ±?)",
                "EV / DEP 0.5 ÃœST (Favori en az 1 tane atar mÄ±?)",
                "Ä°Y 0.5 ÃœST (Sadece Lig OrtalamasÄ± YÃ¼ksekse)"
            ],
            "sonuc": "Ancak bu seÃ§enekler de elendikten sonra 'PAS GEÃ‡ (NO BET)' kararÄ± verilebilir."
        }
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 10: GÃœVEN PUANI VE KASA YÃ–NETÄ°MÄ° (MAKAS SÄ°STEMÄ° - V70)
    # (PARANIN KONTROL EDÄ°LDÄ°ÄÄ° YER)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 10",
        "ad": "GÃœVEN PUANI VE KASA YÃ–NETÄ°MÄ° (MAKAS SÄ°STEMÄ° - V70)",
        "aciklama": "PARANIN KONTROL EDÄ°LDÄ°ÄÄ° YER - PuanÄ± sistem hesaplar, parayÄ± sen basarsÄ±n.",
        "kasa_yonetim_listesi": {
            "baslik": "1. KASA YÃ–NETÄ°M LÄ°STESÄ° (SABÄ°T)",
            "puanlar": [
                {"puan": "10/10", "emoji": "ğŸ’", "baslik": "KUSURSUZ - ELÄ°T", "kasa_orani": 25, "aciklama": "Ä°statistikler barajÄ± paramparÃ§a etmiÅŸ"},
                {"puan": "9/10", "emoji": "ğŸ”¥", "baslik": "Ã‡OK GÃœÃ‡LÃœ", "kasa_orani": 20, "aciklama": "Agresif Banko veya Ultimate KG Var veya TakÄ±m 0.5 Ãœstleri"},
                {"puan": "8/10", "emoji": "ğŸ’ª", "baslik": "GÃœÃ‡LÃœ", "kasa_orani": 15, "aciklama": "GÃ¼venli Limanlar ve TakÄ±m Golleri"},
                {"puan": "7/10", "emoji": "âš–ï¸", "baslik": "STANDART veya Ä°Y", "kasa_orani": 10, "aciklama": "Taraf Bahisleri ve TÃ¼m Ä°Y Bahisleri"},
                {"puan": "6/10", "emoji": "âš ï¸", "baslik": "SINIRDA / RÄ°SKLÄ°", "kasa_orani": 8, "aciklama": "Alt / KG Yok veya SÃ¼rpriz AdaylarÄ±"}
            ]
        },
        "puanlama_motoru": {
            "baslik": "2. PUANLAMA MOTORU (MAKAS ALGORÄ°TMASI)",
            "gol_bahisleri": {
                "baslik": "A. GOL BAHÄ°SLERÄ° Ä°Ã‡Ä°N (ÃœST & KG VAR)",
                "mantik": "Ä°statistikler 'BarajÄ±n' ne kadar Ã¼zerindeyse puan o kadar artar.",
                "puanlar": [
                    {"puan": "10/10", "baslik": "ELÄ°T", "kosul": "Ortalamalar %90 ve Ã¼zerindeyse ve xG 3.50+ ise. (BarajÄ± paramparÃ§a etmiÅŸ).", "ort_min": 90, "xg_min": 3.50},
                    {"puan": "9/10", "baslik": "Ã‡OK GÃœÃ‡LÃœ", "kosul": "Ortalamalar %80 - %89 arasÄ±ndaysa.", "ort_min": 80, "ort_max": 89},
                    {"puan": "8/10", "baslik": "GÃœÃ‡LÃœ", "kosul": "Ortalamalar %75 - %79 arasÄ±ndaysa.", "ort_min": 75, "ort_max": 79},
                    {"puan": "7/10", "baslik": "STANDART", "kosul": "Ortalamalar %70 - %74 arasÄ±ndaysa (SÄ±nÄ±rÄ± ucu ucuna geÃ§iyorsa).", "ort_min": 70, "ort_max": 74}
                ]
            },
            "alt_bahisleri": {
                "baslik": "B. ALT BAHÄ°SLERÄ° Ä°Ã‡Ä°N (2.5 ALT & KG YOK)",
                "mantik": "Veri ne kadar DÃœÅÃœKSE puan o kadar ARTAR.",
                "puanlar": [
                    {"puan": "10/10", "baslik": "ELÄ°T", "kosul": "Ortalamalar %35'in altÄ±ndaysa VE Toplam Åut 14'ten azsa. (Sahada yaprak kÄ±mÄ±ldamÄ±yor).", "ort_max": 35, "sut_max": 14},
                    {"puan": "9/10", "baslik": "Ã‡OK GÃœÃ‡LÃœ", "kosul": "Ortalamalar %35 - %45 arasÄ±ndaysa.", "ort_min": 35, "ort_max": 45},
                    {"puan": "8/10", "baslik": "GÃœÃ‡LÃœ", "kosul": "Ortalamalar %45 - %50 arasÄ±ndaysa.", "ort_min": 45, "ort_max": 50},
                    {"puan": "6/10", "baslik": "RÄ°SKLÄ°", "kosul": "Veriler sÄ±nÄ±rda ama Åut SayÄ±sÄ± biraz yÃ¼ksekse."}
                ]
            },
            "taraf_bahisleri": {
                "baslik": "C. TARAF BAHÄ°SLERÄ° Ä°Ã‡Ä°N (MS 1 / MS 2)",
                "puanlar": [
                    {"puan": "10/10", "baslik": "ELÄ°T", "kosul": "Favori Kazanma %85+ VE Puan FarkÄ± 10+ ise. (Lider vs Sonuncu).", "kazanma_min": 85, "puan_farki": 10},
                    {"puan": "9/10", "baslik": "Ã‡OK GÃœÃ‡LÃœ", "kosul": "Favori Kazanma %75 - %84 arasÄ±ndaysa.", "kazanma_min": 75, "kazanma_max": 84},
                    {"puan": "8/10", "baslik": "GÃœÃ‡LÃœ", "kosul": "Favori Kazanma %65 - %74 arasÄ±ndaysa.", "kazanma_min": 65, "kazanma_max": 74},
                    {"puan": "7/10", "baslik": "STANDART", "kosul": "Favori Kazanma %55 - %64 arasÄ±ndaysa.", "kazanma_min": 55, "kazanma_max": 64}
                ]
            },
            "iy_istisnasi": {
                "baslik": "D. Ä°LK YARI (Ä°Y) Ä°STÄ°SNASI (SENÄ°N KURALIN)",
                "kural": "SABÄ°T KURAL: Ä°Y Bahisleri (Ä°statistik %95 bile olsa), doÄŸasÄ± gereÄŸi riskli olduÄŸu iÃ§in MAKSÄ°MUM 7/10 PUAN alÄ±r ve en fazla %15 kasa basÄ±lÄ±r.",
                "max_puan": 7,
                "max_kasa": 15
            }
        },
        "lig_hiyerarsisi": {
            "baslik": "3. LÄ°G HÄ°YERARÅÄ°SÄ° VE GÃœVEN KESÄ°NTÄ°SÄ° (ELÄ°T LÄ°G KURALI)",
            "tanim": "Analiz edilen maÃ§, aÅŸaÄŸÄ±daki 'TOP 13 ELÄ°T LÄ°G' listesinde yer almÄ±yorsa; istatistikler ne kadar kusursuz olursa olsun hesaplanan GÃ¼ven PuanÄ± otomatik olarak -1 Puan dÃ¼ÅŸÃ¼rÃ¼lÃ¼r.",
            "elit_ligler": [
                {"sira": 1, "lig": "Premier League", "ulke": "Ä°ngiltere"},
                {"sira": 2, "lig": "La Liga", "ulke": "Ä°spanya"},
                {"sira": 3, "lig": "Serie A", "ulke": "Ä°talya"},
                {"sira": 4, "lig": "Bundesliga", "ulke": "Almanya"},
                {"sira": 5, "lig": "Ligue 1", "ulke": "Fransa"},
                {"sira": 6, "lig": "Primeira Liga", "ulke": "Portekiz"},
                {"sira": 7, "lig": "Eredivisie", "ulke": "Hollanda"},
                {"sira": 8, "lig": "Belgian Pro League", "ulke": "BelÃ§ika"},
                {"sira": 9, "lig": "SÃ¼per Lig", "ulke": "TÃ¼rkiye"},
                {"sira": 10, "lig": "Scottish Premiership", "ulke": "Ä°skoÃ§ya"},
                {"sira": 11, "lig": "Swiss Super League", "ulke": "Ä°sviÃ§re"},
                {"sira": 12, "lig": "Austrian Bundesliga", "ulke": "Avusturya"},
                {"sira": 13, "lig": "Czech First League", "ulke": "Ã‡ekya"}
            ],
            "aksiyon": {
                "tanim": "ğŸ“‰ AKSÄ°YON (DÄ°ÄER LÄ°GLER):",
                "kural_1": "EÄŸer maÃ§ bu liste dÄ±ÅŸÄ±ndaysa (Ã–rn: SÄ±rbistan, Polonya, Alt Ligler vb.);",
                "kural_2": "Hesaplanan Puan 10/10 ise -> 9/10 olarak iÅŸlenir.",
                "kural_3": "Hesaplanan Puan 9/10 ise -> 8/10 olarak iÅŸlenir.",
                "gerekce": "Alt liglerde ve elit olmayan liglerde zemin, motivasyon ve manipÃ¼lasyon riskleri daha yÃ¼ksektir. Bu yÃ¼zden 'GÃ¼venlik Kesintisi' uygulanÄ±r.",
                "kesinti": 1
            }
        }
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 11: GENEL ANALÄ°Z PRENSÄ°PLERÄ° VE PERSONA
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 11",
        "ad": "GENEL ANALÄ°Z PRENSÄ°PLERÄ° VE PERSONA",
        "prensipler": [
            {"id": "B.Ä°-1", "baslik": "BAÅARISIZ BANKO Ä°NCELEME", "aciklama": "BaÅŸarÄ±sÄ±zlÄ±k olursa bahane Ã¼retilmez, matematiksel sebebi analiz edilir."},
            {"id": "B.Ä°-2", "baslik": "MUTLAK DÃœRÃœSTLÃœK", "aciklama": "Ä°statistikler doÄŸrular ama sonuÃ§ gelmezse 'ÅanssÄ±zlÄ±k' denir."},
            {"id": "B.Ä°-3", "baslik": "DÄ°NAMÄ°K ZAMAN", "aciklama": "Analiz o anki gerÃ§ek tarihe gÃ¶re yapÄ±lÄ±r."},
            {"id": "B.Ä°-4", "baslik": "Ã‡APRAZ DOÄRULAMA", "aciklama": "Banko seÃ§meden Ã¶nce Åut Kalitesi, Motivasyon ve Kadro FarkÄ± son kez kontrol edilir."},
            {"id": "B.Ä°-5", "baslik": "GÃ–RSEL NETLÄ°K", "aciklama": "GÃ¶rsel net deÄŸilse tahmin yÃ¼rÃ¼tÃ¼lmez."},
            {"id": "B.Ä°-6", "baslik": "SADECE GÃ–RSEL VERÄ°", "aciklama": "DÄ±ÅŸarÄ±dan (hafÄ±zadan) bilgi katÄ±lmaz, sadece resimdeki veri okunur."},
            {"id": "B.Ä°-7", "baslik": "ROBOTÄ°K KARAR", "aciklama": "TakÄ±m ismi, bÃ¼yÃ¼klÃ¼ÄŸÃ¼ veya popÃ¼laritesi analiz sonucunu deÄŸiÅŸtiremez. Sadece rakamlar konuÅŸur."},
            {"id": "B.Ä°-8", "baslik": "VERÄ° KAYNAÄI", "aciklama": "xG, xGA ve Temel Ä°statistiklerin senin attÄ±ÄŸÄ±n 'Form ve Ä°statistik KartÄ±' (GÃ¶rsel) Ã¼zerinden kontrol edilmesini zorunlu kÄ±ldÄ±k. Kafadan veri uydurmak yasaklandÄ±."},
            {"id": "B.Ä°-9", "baslik": "GOL Ã–NCELÄ°ÄÄ°", "aciklama": "Genel strateji olarak Taraf (MS) bahisleri yerine Gol bahislerine (Alt/Ãœst, KG Var/Yok, TakÄ±m GolÃ¼) Ã¶ncelik verilir. Futbolda tarafÄ± bilmek zordur, istatistik golÃ¼ iÅŸaret ediyorsa o gol bir ÅŸekilde girer."}
        ],
        "kimlik": {
            "baslik": "KÄ°MLÄ°K: XG-XRAY ANALÄ°STÄ° (DATA HUNTER)",
            "anlam": "Ben artÄ±k oranlara bakÄ±p 'Bahis bÃ¼rosu ne dÃ¼ÅŸÃ¼nÃ¼yor?' diye kafa yoran bir Bookmaker deÄŸilim. Ben, takÄ±mÄ±n sahadaki Ã¼retimini (Gol Beklentisi - xG) ve bitiriciliÄŸini (Conversion) rÃ¶ntgen cihazÄ± gibi tarayan bir Veri AvcÄ±sÄ±yÄ±m. TakÄ±mÄ±n adÄ± Real Madrid de olsa, verisi kÃ¶tÃ¼yse benim iÃ§in 'Yetersiz'dir. Duygusuz bir matematik motoruyum."
        },
        "dil": {
            "baslik": "DÄ°L: NET, TEKNÄ°K, UYARICI",
            "anlam": "'Belki gelir', 'ÅansÄ± var' gibi yuvarlak laflar yok.",
            "net": "'OynanÄ±r' veya 'Oynanmaz'.",
            "teknik": "'KÃ¶tÃ¼ oynuyorlar' demek yerine 'Conversion oranÄ± %7, lig ortalamasÄ±nÄ±n altÄ±nda' derim.",
            "uyarici": "TuzaÄŸÄ± gÃ¶rdÃ¼ÄŸÃ¼m an (Ã–rn: YÃ¼ksek xG ama 0 Gol) kÄ±rmÄ±zÄ± alarm (â›”) veririm."
        },
        "ozel_yetenek": {
            "baslik": "Ã–ZEL YETENEK: 'KÃ–R NOKTA AVCISI'",
            "anlam": "Ä°statistik kaÄŸÄ±dÄ±nda %100 gÃ¶rÃ¼nen ama gerÃ§ekte 'balon' olan serileri patlatmak.",
            "ornek": "Bir takÄ±m 5 maÃ§tÄ±r kazanÄ±yordur (%100 Seri). Herkes 'Yine kazanÄ±r' der. Ben xG'ye bakarÄ±m; eÄŸer xG'si 0.80 ise (ÅŸansa kazanÄ±yorsa), 'Bu seri sahte, burada patlayacak' derim. Herkesin gÃ¶remediÄŸi 'matematiksel gerÃ§eÄŸi' gÃ¶rÃ¼rÃ¼m."
        }
    },
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 12: SONUÃ‡ VE SUNUM PROTOKOLLERÄ° (EK)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
        "bolum": "BÃ–LÃœM 12",
        "ad": "SONUÃ‡ VE SUNUM PROTOKOLLERÄ° (EK)",
        "sigorta_kutusu": {
            "baslik": "ğŸš¨ K.SÄ°GORTA-KUTUSU (KASA SÄ°GORTASI VE GOL MATRÄ°SÄ° PROTOKOLÃœ)",
            "aciklama": "Bu kural, analizin en altÄ±nda, tÃ¼m rapor bittikten sonra devreye girer.",
            "tanim": "Sistem, sadece 'Taraf Bahsi' vermekle yetinmez; maÃ§Ä±n gol potansiyelini 'AtÄ±lan Goller' ve 'Yenen Goller' tablolarÄ±nÄ±n Ã§apraz eÅŸleÅŸmesiyle analiz ederek kullanÄ±cÄ±ya 'YAPAY ZEKA GOL Ã–NGÃ–RÃœSÃœ' sunar. Bu bÃ¶lÃ¼m tablo iÃ§inde deÄŸil, akÄ±cÄ± ve vurgulu bir metin (Markdown) olarak yazÄ±lÄ±r."
        },
        "yapay_zeka_gol_ongorusu": {
            "baslik": "2. YAPAY ZEKA GOL Ã–NGÃ–RÃœSÃœ (HESAPLAMA MANTIÄI)",
            "aciklama": "Bu bÃ¶lÃ¼mdeki yÃ¼zdeler ve yorumlar, asla genel '2.5 Ãœst/KG' tablosundan alÄ±nmaz. DoÄŸrudan takÄ±m sekmelerinden (AtÄ±lan/Yenen) hesaplanÄ±r.",
            "analiz_05_ust": {
                "baslik": "âš½ 0.5 ÃœST ANALÄ°ZÄ°",
                "veri": "[Ev Sahibi AtÄ±lan 0.5 Ãœst %] ile [Deplasman Yenen 0.5 Ãœst %] verileri karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r.",
                "yorum": "Hangi tarafÄ±n gol atmasÄ± daha muhtemelse (Ã–rn: 'Bologna Atar, Juve Yer') ona vurgu yapÄ±lÄ±r. 'Gol Ã§Ä±kar' veya 'KÄ±sÄ±r geÃ§er' kararÄ± verilir."
            },
            "analiz_15_ust": {
                "baslik": "âš½ 1.5 ÃœST ANALÄ°ZÄ°",
                "veri": "[Ev Sahibi AtÄ±lan 1.5 Ãœst %] ile [Deplasman Yenen 1.5 Ãœst %] kontrol edilir.",
                "kritik": "EÄŸer bir tarafÄ±n YEME oranÄ± %70 Ã¼zerindeyse, diÄŸer tarafÄ±n ATMA oranÄ± dÃ¼ÅŸÃ¼k olsa bile 'SÃ¼rpriz Gol Potansiyeli' olarak iÅŸaretlenir. EÄŸer iki taraf da dÃ¼ÅŸÃ¼kse 'Uzak Dur' uyarÄ±sÄ± verilir.",
                "baraj_yeme": 70
            }
        },
        "canli_tetikleyici": {
            "baslik": "3. âš¡ CANLI TETÄ°KLEYÄ°CÄ° (MAÃ‡ Ä°Ã‡Ä° SAVAÅ PLANI)",
            "aciklama": "Sistem, sadece maÃ§ Ã¶nÃ¼ deÄŸil, maÃ§ iÃ§inde oluÅŸabilecek 'Ters Senaryo' (Favorinin geriye dÃ¼ÅŸmesi vb.) durumunda yapÄ±lacak hamleyi Ã¶nceden belirler.",
            "sart": "Bu kural SADECE, bir takÄ±mÄ±n gol atma veya yeme istatistiÄŸi %80 ve Ã¼zerinde ise devreye girer.",
            "format": "'EÄŸer X olursa -> Y yap' ÅŸeklinde net bir emir kipi kullanÄ±lÄ±r. (KÄ±rmÄ±zÄ± Kart istisnasÄ± mutlaka belirtilir).",
            "baraj": 80
        },
        "kasa_sigortasi": {
            "baslik": "4. KASA SÄ°GORTASI (BANKO SEÃ‡Ä°M)",
            "aciklama": "Sistem, yukarÄ±daki analizlerden sÃ¼zÃ¼len EN GÃœVENLÄ° tercihi (Taraf veya Gol) seÃ§er ve devasa puntolarla sunar."
        }
    },
]

# Toplam kural sayÄ±sÄ± hesaplama
def _say_kurallar(bolumler):
    toplam = 0
    for b in bolumler:
        if "kurallar" in b:
            if isinstance(b["kurallar"], list):
                toplam += len(b["kurallar"])
        if "a_grubu" in b and "kurallar" in b["a_grubu"]:
            toplam += len(b["a_grubu"]["kurallar"])
        if "b_grubu" in b and "kurallar" in b["b_grubu"]:
            toplam += len(b["b_grubu"]["kurallar"])
        if "asama_0" in b and "kurallar" in b["asama_0"]:
            toplam += len(b["asama_0"]["kurallar"])
        if "asama_1" in b and "kurallar" in b["asama_1"]:
            toplam += len(b["asama_1"]["kurallar"])
        if "asama_2" in b and "kurallar" in b["asama_2"]:
            toplam += len(b["asama_2"]["kurallar"])
        if "asama_3" in b and "kurallar" in b["asama_3"]:
            toplam += len(b["asama_3"]["kurallar"])
        if "asama_4" in b and "kurallar" in b["asama_4"]:
            toplam += len(b["asama_4"]["kurallar"])
        if "asama_5" in b and "kurallar" in b["asama_5"]:
            toplam += len(b["asama_5"]["kurallar"])
        if "asama_6" in b and "kurallar" in b["asama_6"]:
            toplam += len(b["asama_6"]["kurallar"])
        if "prensipler" in b:
            toplam += len(b["prensipler"])
    return toplam

TOPLAM_KURAL = _say_kurallar(TUM_BOLUMLER)


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ§® V5.8 - TAM HESAPLAMA MOTORU (275 KURAL ENTEGRE)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# KURAL MOTORU V5.8 - TÃœM 87 KURAL TAM UYGULAMA
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class KuralMotoru:
    """
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    KURAL MOTORU V60 - ÅEFFAF VE KANITLI
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    Ã–zellikler:
    - 130 KuralÄ±n Tam UygulamasÄ±
    - KanÄ±t Log Sistemi (her karar kayÄ±t altÄ±nda)
    - Dinamik aÃ§Ä±klamalar (maÃ§a Ã¶zel)
    - Åeffaf karar mekanizmasÄ±
    """
    
    def __init__(self, veri):
        self.veri = veri
        self.sonuclar = []
        self.vetolar = []
        self.uyarilar = []
        self.gecenler = []
        self.taranan_sayac = 0
        
        # ğŸ” YENÄ°: KANIT LOG SÄ°STEMÄ°
        self.kanit_loglari = []
        self._log("ROOT", "âœ… KuralMotoru V60 baÅŸlatÄ±ldÄ±")
        self._log("ROOT", f"âœ… Veri KaynaklarÄ± yÃ¼klendi ({len(veri)} veri noktasÄ±)")
    
    def _log(self, kategori, mesaj):
        """KanÄ±t logu ekle"""
        self.kanit_loglari.append(f"[{kategori}] {mesaj}")
        
    def _get(self, key, default=0):
        """
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        GELÄ°ÅMÄ°Å VERÄ° OKUMA FONKSÄ°YONU (REGEX DESTEKLÄ°)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        OCR'dan gelen her tÃ¼rlÃ¼ formatÄ± temizler:
        - "90%" â†’ 90.0
        - "89,5" â†’ 89.5
        - "14.50" â†’ 14.5
        - "Ev: %78" â†’ 78.0
        - "1.35x" â†’ 1.35
        - "Gol: 2.5" â†’ 2.5
        - None â†’ default
        - "" â†’ default
        - "?" â†’ default
        """
        import re
        
        val = self.veri.get(key)
        
        # None, boÅŸ veya belirsiz ise default dÃ¶ndÃ¼r
        if val is None or val == "" or val == "?" or val == "N/A":
            return default
        
        # Zaten sayÄ± ise direkt dÃ¶ndÃ¼r
        if isinstance(val, (int, float)):
            return float(val)
        
        # String ise regex ile temizle
        if isinstance(val, str):
            # VirgÃ¼lÃ¼ noktaya Ã§evir
            val = val.replace(",", ".")
            
            # Regex ile ilk geÃ§erli sayÄ±yÄ± bul
            # Negatif/pozitif, ondalÄ±klÄ± veya tam sayÄ±
            match = re.search(r'[-+]?\d*\.?\d+', val)
            
            if match:
                try:
                    return float(match.group())
                except:
                    return default
        
        return default
    
    def _tarandi(self, kural_id):
        """Her kural tarandÄ±ÄŸÄ±nda bu Ã§aÄŸrÄ±lÄ±r - sayacÄ± artÄ±rÄ±r"""
        self.taranan_sayac += 1
    
    def _sonuc_ekle(self, kural_id, kural_adi, durum, detay, hedefler=None):
        """SonuÃ§ ekle ve otomatik log oluÅŸtur"""
        self._tarandi(kural_id)
        
        self.sonuclar.append({
            "kural_id": kural_id,
            "kural_adi": kural_adi,
            "durum": durum,
            "detay": detay,
            "hedefler": hedefler or []
        })
        
        # ğŸ” OTOMATÄ°K KANIT LOGU - Her sonuÃ§ iÃ§in dinamik log
        durum_emoji = {
            "VETO": "âŒ",
            "UYARI": "âš ï¸",
            "GEÃ‡ER": "âœ…",
            "GEÃ‡TÄ°": "âœ…",
            "BÄ°LGÄ°": "â„¹ï¸",
            "TARANDI": "ğŸ”„",
            "BAÅLADI": "â–¶ï¸",
            "KALDI": "â›”"
        }.get(durum, "ğŸ“‹")
        
        # Sadece Ã¶nemli sonuÃ§larÄ± logla (BAÅLADI ve TARANDI hariÃ§)
        if durum not in ["BAÅLADI", "TARANDI"]:
            self._log("KURAL", f"{durum_emoji} {kural_id}: {detay}")
        
        if durum == "VETO":
            self.vetolar.append({"kural_id": kural_id, "sebep": detay, "hedefler": hedefler or []})
        elif durum == "UYARI":
            self.uyarilar.append({"kural_id": kural_id, "sebep": detay, "hedefler": hedefler or []})

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 0: ROOT (3 KURAL)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def K_YUZDE_100(self):
        self._sonuc_ekle("K_YUZDE_100", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("K.YÃœZDE-100", "GARANTÄ° YOK", "BÄ°LGÄ°", "HiÃ§bir istatistik %100 garanti deÄŸildir")
    
    def K_YUZDE_KAYNAK(self):
        self._sonuc_ekle("K_YUZDE_KAYNAK", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        kritik = ["ev_atan_05", "dep_atan_05", "ust_25", "kg_var_ort"]
        eksik = [k for k in kritik if self._get(k, None) is None or self._get(k, 0) == 0]
        if eksik:
            self._sonuc_ekle("K.YÃœZDE-KAYNAK", "VERÄ° EKSÄ°K", "UYARI", f"Eksik: {eksik}", ["TÃœM"])
        else:
            self._sonuc_ekle("K.YÃœZDE-KAYNAK", "VERÄ° TAM", "GEÃ‡ER", "TÃ¼m kritik veriler mevcut")
    
    def K_KAOS_KABULU(self):
        self._sonuc_ekle("K_KAOS_KABULU", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("K.KAOS-KABULÃœ", "BELÄ°RSÄ°ZLÄ°K", "BÄ°LGÄ°", "Belirsizlik her zaman vardÄ±r")

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 4: GÄ°YOTÄ°N VETOLARI (22 KURAL)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def K_18_B(self):
        """K.18-B: 2.5Ãœ â‰¤ %55 ise MS 2.5 ÃœST KESÄ°N VETO!"""
        self._sonuc_ekle("K_18_B", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_25 = self._get("ust_25", 55)
        if ust_25 <= 55:
            self._sonuc_ekle("K.18-B", "2.5Ãœ TABLO VETO", "VETO", 
                f"2.5Ãœ %{ust_25} â‰¤ 55 â†’ MS 2.5 ÃœST YASAK! (xG fark etmez)", ["MS-2.5Ãœ"])
            return True
        self._sonuc_ekle("K.18-B", "2.5Ãœ TABLO OK", "GEÃ‡ER", f"2.5Ãœ %{ust_25} > 55")
        return False
    
    def K_SUPER_FAVORI(self):
        self._sonuc_ekle("K_SUPER_FAVORI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        oran = min(self._get("oran_ms1", 3), self._get("oran_ms2", 3))
        if oran <= 1.35:
            self._sonuc_ekle("K.SÃœPER-FAVORÄ°", "SÃœPER FAVORÄ° VETO", "VETO",
                f"Oran {oran:.2f} â‰¤ 1.35 â†’ TARAF KAPALI", ["MS-TARAF", "MS1", "MS2"])
            return True
        self._sonuc_ekle("K.SÃœPER-FAVORÄ°", "FAVORÄ° OK", "GEÃ‡ER", f"Oran {oran:.2f} > 1.35")
        return False
    
    def K_KEVGIR_FAVORI(self):
        self._sonuc_ekle("K_KEVGIR_FAVORI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        favori = self.veri.get("favori", "EV")
        yeme = self._get("gol_yeme_ort_ev" if favori == "EV" else "gol_yeme_ort_dep", 0.8)
        if yeme >= 1.00:
            self._sonuc_ekle("K.KEVGÄ°R-FAVORÄ°", "KEVGÄ°R FAVORÄ°", "VETO",
                f"Favori ({favori}) {yeme:.2f} gol/maÃ§ yiyor", ["MS-TARAF"])
            return True
        return False
    
    def K_HACIM_GUVENLIGI(self):
        """K.HACÄ°M-GÃœVENLÄ°ÄÄ°: Åut â‰¥30 ise ALT BAHÄ°SLERÄ° YASAK"""
        sut = self._get("sut_ev", 10) + self._get("sut_dep", 10)
        if sut >= 30:
            self._sonuc_ekle("K.HACÄ°M-GÃœVENLÄ°ÄÄ°", "YÃœKSEK HACÄ°M", "VETO", 
                f"Åut: {sut} â‰¥ 30 â†’ ALT BAHÄ°SLERÄ° YASAK (DÃ¶nÃ¼ÅŸÃ¼m dÃ¼ÅŸÃ¼k olsa bile)", 
                ["MS-2.5-ALT", "MS-1.5-ALT"])
            return True
        self._sonuc_ekle("K_HACIM_GUVENLIGI", "KALDI", "TARANDI", "Åart saÄŸlanmadÄ±")
        return False
    
    def K_KISIR_TABLO(self):
        self._sonuc_ekle("K_KISIR_TABLO", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_25 = self._get("ust_25", 55)
        if ust_25 < 50:
            self._sonuc_ekle("K.KISIR-TABLO", "KISIR TABLO", "VETO", f"2.5Ãœ %{ust_25} < 50", ["MS-2.5Ãœ", "MS-3.5Ãœ"])
            return True
        return False
    
    def K_100(self):
        self._sonuc_ekle("K_100", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev = self._get("ev_atan_05", 70)
        dep = self._get("dep_atan_05", 70)
        if ev >= 100 or dep >= 100:
            self._sonuc_ekle("K.100", "%100 ÅÃœPHE", "UYARI", f"Ev:{ev}%, Dep:{dep}%", ["TÃœM"])
            return True
        return False
    
    def K_CONVERSION_BARAJI(self):
        self._sonuc_ekle("K_CONVERSION_BARAJI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        gol_ev = self._get("gol_ort_ev", 1.5)
        gol_dep = self._get("gol_ort_dep", 1.2)
        sut_ev = self._get("sut_ev", 12)
        sut_dep = self._get("sut_dep", 10)
        conv_ev = (gol_ev / sut_ev * 100) if sut_ev > 0 else 0
        conv_dep = (gol_dep / sut_dep * 100) if sut_dep > 0 else 0
        conv = (conv_ev + conv_dep) / 2
        self.veri["conv_ort"] = conv
        if conv < 8:
            self._sonuc_ekle("K.CONVERSION-BARAJI", "CONV DÃœÅÃœK", "VETO", f"Conv: %{conv:.1f} < 8", ["MS-2.5Ãœ", "KG-VAR"])
            return True
        return False
    
    def K_AYNA(self):
        """K.AYNA: Rakip takÄ±mÄ±n Gol Yememe oranÄ± %60+ ise ÃœST/KG VAR YASAK"""
        self._sonuc_ekle("K_AYNA", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_yememe = self._get("ev_yememe", 30)
        dep_yememe = self._get("dep_yememe", 30)
        if ev_yememe >= 60 or dep_yememe >= 60:
            guclu = "EV" if ev_yememe >= 60 else "DEP"
            self._sonuc_ekle("K.AYNA", "SAVUNMA DUVARI", "VETO", 
                f"{guclu} Yememe: %{max(ev_yememe, dep_yememe)} â‰¥ 60 â†’ ÃœST/KG VAR YASAK", 
                ["MS-2.5Ãœ", "KG-VAR"])
            return True
        self._sonuc_ekle("K_AYNA", "KALDI", "TARANDI", "Åart saÄŸlanmadÄ±")
        return False
    
    def K_DUVAR_50(self):
        """K.DUVAR-50: Rakip Gol Yememe %50+ ise TAKIM GOLÃœ/1.5Ãœ/KG VAR YASAK"""
        self._sonuc_ekle("K_DUVAR_50", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_yememe = self._get("ev_yememe", 30)
        dep_yememe = self._get("dep_yememe", 30)
        if ev_yememe >= 50 or dep_yememe >= 50:
            guclu = "EV" if ev_yememe >= 50 else "DEP"
            self._sonuc_ekle("K.DUVAR-50", "DUVAR-50 VETO", "VETO", 
                f"{guclu} Yememe: %{max(ev_yememe, dep_yememe)} â‰¥ 50 â†’ TAKIM GOLÃœ/1.5Ãœ/KG VAR YASAK", 
                ["MS-1.5Ãœ", "KG-VAR", "EV-0.5Ãœ" if ev_yememe >= 50 else "DEP-0.5Ãœ"])
            return True
        self._sonuc_ekle("K_DUVAR_50", "KALDI", "TARANDI", "Åart saÄŸlanmadÄ±")
        return False
    
    def K_DUVAR_80(self):
        """K.DUVAR-80: Yememe â‰¥%75 ise rakip 0.5Ãœ/1.5Ãœ/KG VAR/2.5Ãœ BANKO OLAMAZ"""
        self._sonuc_ekle("K_DUVAR_80", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_yememe = self._get("ev_yememe", 30)
        dep_yememe = self._get("dep_yememe", 30)
        if ev_yememe >= 75 or dep_yememe >= 75:
            guclu = "EV" if ev_yememe >= 75 else "DEP"
            self._sonuc_ekle("K.DUVAR-80", "DEMÄ°R DUVAR", "VETO", 
                f"{guclu} Yememe: %{max(ev_yememe, dep_yememe)} â‰¥ 75 â†’ RAKÄ°P GOLÃœ/KG VAR/2.5Ãœ YASAK", 
                ["MS-2.5Ãœ", "KG-VAR", "DEP-0.5Ãœ" if ev_yememe >= 75 else "EV-0.5Ãœ"])
            return True
        self._sonuc_ekle("K_DUVAR_80", "KALDI", "TARANDI", "Åart saÄŸlanmadÄ±")
        return False
    
    def K_KISIR_7(self):
        """K.KISIR-7: Favori/Ev Conv â‰¤%7 ise 2.5Ãœ/KG VAR YASAK"""
        self._sonuc_ekle("K_KISIR_7", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        gol_ev = self._get("gol_ort_ev", 1.5)
        gol_dep = self._get("gol_ort_dep", 1.2)
        sut_ev = self._get("sut_ev", 12)
        sut_dep = self._get("sut_dep", 10)
        conv_ev = (gol_ev / sut_ev * 100) if sut_ev > 0 else 0
        conv_dep = (gol_dep / sut_dep * 100) if sut_dep > 0 else 0
        # Favori veya ev sahibi %7 altÄ±ndaysa
        favori_conv = conv_ev  # Ev sahibi varsayÄ±lan favori
        if conv_ev <= 7 or conv_dep <= 7:
            self._sonuc_ekle("K.KISIR-7", "KISIR TAKIM", "VETO", 
                f"Conv Ev:%{conv_ev:.1f}, Dep:%{conv_dep:.1f} - Biri â‰¤%7 â†’ 2.5Ãœ/KG VAR YASAK", 
                ["MS-2.5Ãœ", "KG-VAR"])
            return True
        self._sonuc_ekle("K_KISIR_7", "KALDI", "TARANDI", "Åart saÄŸlanmadÄ±")
        return False
    
    def K_KISIRLIK_VETO(self):
        self._sonuc_ekle("K_KISIRLIK_VETO", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev = self._get("ev_atan_05", 70)
        dep = self._get("dep_atan_05", 70)
        gol_ort = (ev + dep) / 2
        if gol_ort < 60:
            self._sonuc_ekle("K.KISIRLIK-VETO", "KISIR MAÃ‡", "VETO", f"Gol Ort: %{gol_ort:.1f} < 60", ["MS-1.5Ãœ", "MS-2.5Ãœ", "KG-VAR"])
            return True
        return False
    
    def K_NEKRO(self):
        self._sonuc_ekle("K_NEKRO", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_atan = self._get("ev_atan_05", 70)
        dep_atan = self._get("dep_atan_05", 70)
        ev_yememe = self._get("ev_yememe", 30)
        dep_yememe = self._get("dep_yememe", 30)
        if ev_atan < 60 and dep_atan < 60 and ev_yememe > 50 and dep_yememe > 50:
            self._sonuc_ekle("K.NEKRO", "NEKRO MAÃ‡", "VETO", "Nekro maÃ§ tespit edildi", ["MS-1.5Ãœ", "MS-2.5Ãœ", "KG-VAR"])
            return True
        return False
    
    def K_TEK_GUC(self):
        self._sonuc_ekle("K_TEK_GUC", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev = self._get("ev_atan_05", 70)
        dep = self._get("dep_atan_05", 70)
        if (ev >= 85 and dep < 50) or (dep >= 85 and ev < 50):
            self._sonuc_ekle("K.TEK-GÃœÃ‡", "TEK GÃœÃ‡", "VETO", f"Ev:{ev}%, Dep:{dep}%", ["KG-VAR"])
            return True
        return False
    
    def K_xGA_DIRENCI(self):
        self._sonuc_ekle("K_xGA_DIRENCI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        xg = self._get("xg_ev", 1.2) + self._get("xg_dep", 1.0)
        if xg < 1.80:
            self._sonuc_ekle("K.xGA-DÄ°RENCÄ°", "xG DÄ°RENÃ‡", "VETO", f"xG: {xg:.2f} < 1.80", ["MS-2.5Ãœ", "MS-3.5Ãœ"])
            return True
        return False
    
    def K_KALE_KILIDI(self):
        """K.KALE-KÄ°LÄ°DÄ°: Rakip Yememe >%33 ise ÃœST/KG VAR YASAK"""
        self._sonuc_ekle("K_KALE_KILIDI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_yememe = self._get("ev_yememe", 30)
        dep_yememe = self._get("dep_yememe", 30)
        if ev_yememe > 33 or dep_yememe > 33:
            guclu = "EV" if ev_yememe > 33 else "DEP"
            self._sonuc_ekle("K.KALE-KÄ°LÄ°DÄ°", "KALE KÄ°LÄ°DÄ°", "VETO", 
                f"{guclu} Yememe: %{max(ev_yememe, dep_yememe)} > 33 â†’ ÃœST/KG VAR YASAK", 
                ["MS-2.5Ãœ", "KG-VAR"])
            return True
        self._sonuc_ekle("K_KALE_KILIDI", "KALDI", "TARANDI", "Åart saÄŸlanmadÄ±")
        return False
    
    def K_DIP_DIRENC(self):
        self._sonuc_ekle("K_DIP_DIRENC", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_15 = self._get("ust_15", 70)
        if ust_15 < 55:
            self._sonuc_ekle("K.DÄ°P-DÄ°RENÃ‡", "DÄ°P DÄ°RENÃ‡", "VETO", f"1.5Ãœ: %{ust_15} < 55", ["MS-1.5Ãœ", "MS-2.5Ãœ", "KG-VAR"])
            return True
        return False
    
    def K_ISABETKILIDI(self):
        self._sonuc_ekle("K_ISABETKILIDI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        isabetli = self._get("isabetli_ev", 4) + self._get("isabetli_dep", 3)
        if isabetli < 6:
            self._sonuc_ekle("K.Ä°SABET-KÄ°LÄ°DÄ°", "Ä°SABET DÃœÅÃœK", "VETO", f"Ä°sabetli: {isabetli} < 6", ["MS-2.5Ãœ"])
            return True
        return False
    
    def K_ERKEN_FISEK(self):
        self._sonuc_ekle("K_ERKEN_FISEK", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        iy_ev = self._get("iy_ev_gol", 50)
        iy_dep = self._get("iy_dep_gol", 50)
        iy_ort = (iy_ev + iy_dep) / 2
        self.veri["iy_gol_ort"] = iy_ort
        if iy_ort < 68:
            self._sonuc_ekle("K.ERKEN-FÄ°ÅEK", "Ä°Y VETO", "VETO", f"Ä°Y Gol: %{iy_ort:.1f} < 68", ["Ä°Y-0.5Ãœ", "Ä°Y-1.5Ãœ"])
            return True
        return False
    
    def K_DEPLASMAN_SENDROMU(self):
        self._sonuc_ekle("K_DEPLASMAN_SENDROMU", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        dep = self._get("dep_atan_05", 70)
        if dep < 40:
            self._sonuc_ekle("K.DEPLASMAN-SENDROMU", "DEP ZAYIF", "UYARI", f"Dep Atan: %{dep} < 40", ["KG-VAR"])
            return True
        return False
    
    def K_EV_GOL_60(self):
        self._sonuc_ekle("K_EV_GOL_60", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev = self._get("ev_atan_05", 70)
        if ev < 60:
            self._sonuc_ekle("K.EV-GOL-60", "EV ZAYIF", "UYARI", f"Ev Atan: %{ev} < 60", ["MS1"])
            return True
        return False
    
    def K_KEVGIR(self):
        self._sonuc_ekle("K_KEVGIR", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_yenen = self._get("ev_yenen_05", 50)
        if ev_yenen >= 80:
            self._sonuc_ekle("K.KEVGÄ°R", "KEVGÄ°R EV", "UYARI", f"Ev Yenen: %{ev_yenen} â‰¥ 80", ["MS1"])
            return True
        return False

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 5: BANKO ÅARTLARI (9 KURAL)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def K_MS_35_UST(self):
        self._sonuc_ekle("K_MS_35_UST", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_35 = self._get("ust_35", 30)
        xg = self._get("xg_ev", 1.2) + self._get("xg_dep", 1.0)
        ev = self._get("ev_atan_05", 70)
        dep = self._get("dep_atan_05", 70)
        veto_ids = [v["kural_id"] for v in self.vetolar]
        if any(k in veto_ids for k in ["K.KISIR-TABLO", "K.xGA-DÄ°RENCÄ°", "K.NEKRO"]):
            self._sonuc_ekle("MS-3.5-ÃœST", "VETOLU", "TARANDI", f"3.5Ãœ:%{ust_35} - VETO var")
            return False
        if ust_35 >= 45 and xg >= 3.00 and ev >= 90 and dep >= 90:
            self._sonuc_ekle("MS-3.5-ÃœST", "3.5Ãœ BANKO", "GEÃ‡ER", f"âœ… 3.5Ãœ:%{ust_35}, xG:{xg:.2f}")
            self.gecenler.append({"tip": "MS-3.5Ãœ", "guclu": True, "kural": "MS-3.5-ÃœST"})
            return True
        self._sonuc_ekle("MS-3.5-ÃœST", "KALDI", "TARANDI", f"3.5Ãœ:%{ust_35}<45 veya xG:{xg:.2f}<3.00")
        return False
    
    def K_MS_25_UST(self):
        self._sonuc_ekle("K_MS_25_UST", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_25 = self._get("ust_25", 50)
        xg = self._get("xg_ev", 1.2) + self._get("xg_dep", 1.0)
        ev = self._get("ev_atan_05", 70)
        dep = self._get("dep_atan_05", 70)
        sut = self._get("sut_ev", 10) + self._get("sut_dep", 10)
        conv = self.veri.get("conv_ort", 10)
        # K.18-B KONTROLÃœ
        if ust_25 <= 55:
            self._sonuc_ekle("MS-2.5-ÃœST", "KALDI", "TARANDI", f"2.5Ãœ:%{ust_25}â‰¤55")
            return False
        veto_ids = [v["kural_id"] for v in self.vetolar]
        if any(k in veto_ids for k in ["K.KISIR-TABLO", "K.18-B", "K.NEKRO"]):
            self._sonuc_ekle("MS-2.5-ÃœST", "VETOLU", "TARANDI", f"2.5Ãœ:%{ust_25} - VETO var")
            return False
        yol_a = ust_25 >= 62 and xg >= 3.20 and ev >= 80 and dep >= 80
        yol_b = xg >= 2.70 and sut >= 18 and conv >= 12 and ust_25 > 55
        if yol_a or yol_b:
            self._sonuc_ekle("MS-2.5-ÃœST", f"2.5Ãœ BANKO", "GEÃ‡ER", f"âœ… 2.5Ãœ:%{ust_25}, xG:{xg:.2f}")
            self.gecenler.append({"tip": "MS-2.5Ãœ", "guclu": True, "kural": "MS-2.5-ÃœST"})
            return True
        self._sonuc_ekle("MS-2.5-ÃœST", "KALDI", "TARANDI", f"2.5Ãœ:%{ust_25}, xG:{xg:.2f} - YOL A/B saÄŸlanmadÄ±")
        return False
    
    def K_KG_VAR(self):
        self._sonuc_ekle("K_KG_VAR", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_atan = self._get("ev_atan_05", 70)
        dep_atan = self._get("dep_atan_05", 70)
        kg_tablo = self._get("kg_var_ort", 60)
        hibrit = (ev_atan + dep_atan + kg_tablo) / 3
        ev_yenen = self._get("ev_yenen_05", 50)
        dep_yenen = self._get("dep_yenen_05", 50)
        # YENEN GOLLER 0 Ä°SE HESAPLA
        if ev_yenen <= 0:
            ev_yenen = dep_atan
        if dep_yenen <= 0:
            dep_yenen = ev_atan
        veto_ids = [v["kural_id"] for v in self.vetolar]
        if any(k in veto_ids for k in ["K.TEK-GÃœÃ‡", "K.NEKRO", "K.DEPLASMAN-SENDROMU"]):
            self._sonuc_ekle("KG-VAR", "VETOLU", "TARANDI", f"Hibrit:%{hibrit:.1f} - VETO var")
            return False
        if hibrit >= 70 and ev_atan >= 70 and dep_atan >= 70 and ev_yenen >= 55 and dep_yenen >= 55:
            self._sonuc_ekle("KG-VAR", "KG VAR BANKO", "GEÃ‡ER", f"âœ… Hibrit:%{hibrit:.1f}")
            self.gecenler.append({"tip": "KG-VAR", "guclu": True, "kural": "KG-VAR"})
            return True
        self._sonuc_ekle("KG-VAR", "KALDI", "TARANDI", f"Hibrit:%{hibrit:.1f} - Åart saÄŸlanmadÄ±")
        return False
    
    def K_MS_15_UST(self):
        self._sonuc_ekle("K_MS_15_UST", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_15 = self._get("ust_15", 65)
        conv = self.veri.get("conv_ort", 10)
        ev = self._get("ev_atan_05", 70)
        dep = self._get("dep_atan_05", 70)
        if ust_15 >= 70 and conv >= 10 and ev >= 70 and dep >= 70:
            self._sonuc_ekle("MS-1.5-ÃœST", "1.5Ãœ BANKO", "GEÃ‡ER", f"âœ… 1.5Ãœ:%{ust_15}")
            self.gecenler.append({"tip": "MS-1.5Ãœ", "guclu": False, "kural": "MS-1.5-ÃœST"})
            return True
        self._sonuc_ekle("MS-1.5-ÃœST", "KALDI", "TARANDI", f"1.5Ãœ:%{ust_15} - Åart saÄŸlanmadÄ±")
        return False
    
    def K_MS_TARAF(self):
        """K.MS-TARAF: Oran 1.36-2.20, Kazanma â‰¥%55, Conv â‰¥%12, Yeme <1.20"""
        self._sonuc_ekle("K_MS_TARAF", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        oran = min(self._get("oran_ms1", 3), self._get("oran_ms2", 3))
        favori = "EV" if self._get("oran_ms1", 3) < self._get("oran_ms2", 3) else "DEP"
        kazanma = self._get(f"kazanma_{favori.lower()}", 40)
        
        # Conversion hesapla
        gol_ev = self._get("gol_ort_ev", 1.5)
        gol_dep = self._get("gol_ort_dep", 1.2)
        sut_ev = self._get("sut_ev", 12)
        sut_dep = self._get("sut_dep", 10)
        conv = (gol_ev / sut_ev * 100) if sut_ev > 0 else 0
        if favori == "DEP":
            conv = (gol_dep / sut_dep * 100) if sut_dep > 0 else 0
        
        # Yeme kontrolÃ¼
        yeme = self._get("gol_yeme_ort_ev" if favori == "EV" else "gol_yeme_ort_dep", 1.0)
        
        veto_ids = [v["kural_id"] for v in self.vetolar]
        if "K.SÃœPER-FAVORÄ°" in veto_ids:
            self._sonuc_ekle("K_MS_TARAF", "KALDI", "TARANDI", "Åart saÄŸlanmadÄ±")
            return False
        
        # TÃœM ÅARTLAR: Oran 1.36-2.20, Kazanma â‰¥%55, Conv â‰¥%12, Yeme <1.20
        if 1.36 <= oran <= 2.20 and kazanma >= 55 and conv >= 12 and yeme < 1.20:
            self._sonuc_ekle("MS-TARAF", f"TARAF BANKO ({favori})", "GEÃ‡ER", 
                f"âœ… Oran:{oran:.2f}, Kaz:%{kazanma}, Conv:%{conv:.1f}, Yeme:{yeme:.2f}")
            self.gecenler.append({"tip": f"MS-{favori}", "guclu": False, "kural": "MS-TARAF"})
            return favori
        self._sonuc_ekle("K_MS_TARAF", "TARANDI", "TARANDI", "Kural tamamlandÄ±")
        return False
    
    def K_TAKIM_05_UST(self):
        self._sonuc_ekle("K_TAKIM_05_UST", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_atan = self._get("ev_atan_05", 70)
        dep_atan = self._get("dep_atan_05", 70)
        ev_yenen = self._get("ev_yenen_05", 50)
        dep_yenen = self._get("dep_yenen_05", 50)
        if ev_yenen <= 0: ev_yenen = dep_atan
        if dep_yenen <= 0: dep_yenen = ev_atan
        sonuc = []
        if ev_atan >= 80 and dep_yenen >= 49:
            self._sonuc_ekle("TAKIM-0.5-ÃœST", "EV 0.5Ãœ BANKO", "GEÃ‡ER", f"âœ… Ev:{ev_atan}%")
            self.gecenler.append({"tip": "EV-0.5Ãœ", "guclu": False, "kural": "TAKIM-0.5-ÃœST"})
            sonuc.append("EV")
        if dep_atan >= 80 and ev_yenen >= 49:
            self._sonuc_ekle("TAKIM-0.5-ÃœST", "DEP 0.5Ãœ BANKO", "GEÃ‡ER", f"âœ… Dep:{dep_atan}%")
            self.gecenler.append({"tip": "DEP-0.5Ãœ", "guclu": False, "kural": "TAKIM-0.5-ÃœST"})
            sonuc.append("DEP")
        if not sonuc:
            self._sonuc_ekle("TAKIM-0.5-ÃœST", "KALDI", "TARANDI", f"Ev:{ev_atan}%, Dep:{dep_atan}% - Åart saÄŸlanmadÄ±")
        return sonuc if sonuc else False
    
    def K_TAKIM_15_UST(self):
        self._sonuc_ekle("K_TAKIM_15_UST", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_atan = self._get("ev_atan_05", 70)
        dep_atan = self._get("dep_atan_05", 70)
        ev_yenen = self._get("ev_yenen_05", 50)
        dep_yenen = self._get("dep_yenen_05", 50)
        ust_15 = self._get("ust_15", 65)
        if ev_yenen <= 0: ev_yenen = dep_atan
        if dep_yenen <= 0: dep_yenen = ev_atan
        if ev_atan >= 85 and ust_15 >= 70 and dep_yenen >= 60:
            self._sonuc_ekle("TAKIM-1.5-ÃœST", "EV 1.5Ãœ BANKO", "GEÃ‡ER", f"âœ… Ev:{ev_atan}%")
            self.gecenler.append({"tip": "EV-1.5Ãœ", "guclu": False, "kural": "TAKIM-1.5-ÃœST"})
            return "EV"
        if dep_atan >= 85 and ust_15 >= 70 and ev_yenen >= 60:
            self._sonuc_ekle("TAKIM-1.5-ÃœST", "DEP 1.5Ãœ BANKO", "GEÃ‡ER", f"âœ… Dep:{dep_atan}%")
            self.gecenler.append({"tip": "DEP-1.5Ãœ", "guclu": False, "kural": "TAKIM-1.5-ÃœST"})
            return "DEP"
        self._sonuc_ekle("TAKIM-1.5-ÃœST", "KALDI", "TARANDI", f"Ev:{ev_atan}%, Dep:{dep_atan}% - Åart saÄŸlanmadÄ±")
        return False
    
    def K_25_ALT(self):
        """K.22 - 2.5 ALT: xG<2.00, Åut<18, Atan<%65, Hacimâ‰¤30"""
        self._sonuc_ekle("K_25_ALT", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        xg = self._get("xg_ev", 1.2) + self._get("xg_dep", 1.0)
        sut = self._get("sut_ev", 10) + self._get("sut_dep", 10)
        ev_atan = self._get("ev_atan_05", 70)
        dep_atan = self._get("dep_atan_05", 70)
        
        # Hacim vetosu kontrolÃ¼
        veto_ids = [v["kural_id"] for v in self.vetolar]
        if "K.HACÄ°M-GÃœVENLÄ°ÄÄ°" in veto_ids:
            self._sonuc_ekle("MS-2.5-ALT", "VETOLU", "TARANDI", f"Åutâ‰¥30 - HACÄ°M VETO")
            return False  # Åut â‰¥30 ise ALT yasak
        
        if xg < 2.00 and sut < 18 and ev_atan < 65 and dep_atan < 65:
            self._sonuc_ekle("MS-2.5-ALT", "2.5 ALT BANKO", "GEÃ‡ER", 
                f"âœ… xG:{xg:.2f}<2.00, Åut:{sut}<18, Atan:{ev_atan}/{dep_atan}<%65")
            self.gecenler.append({"tip": "MS-2.5-ALT", "guclu": False, "kural": "MS-2.5-ALT"})
            return True
        self._sonuc_ekle("MS-2.5-ALT", "KALDI", "TARANDI", f"xG:{xg:.2f}, Åut:{sut} - Åart saÄŸlanmadÄ±")
        return False
    
    def K_KG_YOK(self):
        """KG YOK: Ev Atan<%65, Dep Atan<%65, Yemeâ‰¤%40 (en az biri)"""
        self._sonuc_ekle("K_KG_YOK", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_atan = self._get("ev_atan_05", 70)
        dep_atan = self._get("dep_atan_05", 70)
        ev_yenen = self._get("ev_yenen_05", 50)
        dep_yenen = self._get("dep_yenen_05", 50)
        if ev_yenen <= 0: ev_yenen = dep_atan
        if dep_yenen <= 0: dep_yenen = ev_atan
        
        if ev_atan < 65 and dep_atan < 65 and (ev_yenen <= 40 or dep_yenen <= 40):
            self._sonuc_ekle("KG-YOK", "KG YOK BANKO", "GEÃ‡ER", 
                f"âœ… Ev Atan:{ev_atan}%, Dep Atan:{dep_atan}% < 65, Yemeâ‰¤40%")
            self.gecenler.append({"tip": "KG-YOK", "guclu": False, "kural": "KG-YOK"})
            return True
        self._sonuc_ekle("KG-YOK", "KALDI", "TARANDI", f"Ev:{ev_atan}%, Dep:{dep_atan}% - Åart saÄŸlanmadÄ±")
        return False

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # GÃœVEN PUANI VE KASA
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def hesapla_guven_puani(self, bahis_tipi):
        """
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        BÃ–LÃœM 10: GÃœVEN PUANI HESAPLAMA (V70 - ADÄ°L KALÄ°BRASYON)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        V70 GÃœNCELLEME: DAHA ADÄ°L, DAHA YÃœKSEK PUANLAR!
        
        BAÅLANGIÃ‡: 7/10 (nÃ¶tr)
        
        ARTTIRANLAR (DAHA CÃ–MERT):
        - xG Toplam â‰¥ 3.00: +1.5
        - xG Toplam â‰¥ 2.50: +1.0
        - xG Toplam â‰¥ 2.00: +0.5
        - Conversion â‰¥ 12%: +1.0
        - Ã‡ift golcÃ¼ takÄ±m (ikisi de â‰¥80%): +1.0
        - Ã‡ift golcÃ¼ takÄ±m (ikisi de â‰¥70%): +0.5
        - Hibrit KG â‰¥ 70%: +1.0
        - Hibrit KG â‰¥ 65%: +0.5
        - GÃœÃ‡LÃœ Banko: +1.0
        
        AZALTANLAR (DAHA YUMUÅAK):
        - Kritik VETO (maÃ§ iptal): -1.5
        - Normal VETO: -0.5
        - UyarÄ±: -0.25
        
        LÄ°G CEZASI: KALDIRILDI!
        - ArtÄ±k lig cezasÄ± YOK
        
        MINIMUM GARANTÄ°: 6/10 (kritik VETO yoksa)
        """
        
        self._log("GÃœVEN", "ğŸ”„ V70 GÃ¼ven puanÄ± hesaplanÄ±yor...")
        
        # Banko tipini Ã§Ä±kar
        if isinstance(bahis_tipi, dict):
            guclu = bahis_tipi.get("guclu", False)
            tip = bahis_tipi.get("tip", "MS 1.5 ÃœST")
            sebep = bahis_tipi.get("sebep", "")
        else:
            guclu = False
            tip = str(bahis_tipi)
            sebep = ""
        
        # BANKO YOK ise 0 puan
        if tip == "BANKO YOK":
            self._log("GÃœVEN", "âŒ BANKO YOK â†’ 0 puan")
            return 0
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BAÅLANGIÃ‡ PUANI: 7 (nÃ¶tr)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        puan = 7.0
        log_detay = ["BaÅŸlangÄ±Ã§: 7"]
        
        # GÃœÃ‡LÃœ banko ise +1 bonus
        if guclu:
            puan += 1.0
            log_detay.append("GÃœÃ‡LÃœ banko: +1")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ARTTIRANLAR (V70 - DAHA CÃ–MERT!)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        # xG Toplam kontrolÃ¼ (YUMUÅATILMIÅ SINIRLAR)
        xg = self._get("xg_ev", 0) + self._get("xg_dep", 0)
        if xg > 0:
            if xg >= 3.00:
                puan += 1.5
                log_detay.append(f"xG {xg:.2f} â‰¥ 3.00: +1.5")
            elif xg >= 2.50:
                puan += 1.0
                log_detay.append(f"xG {xg:.2f} â‰¥ 2.50: +1.0")
            elif xg >= 2.00:
                puan += 0.5
                log_detay.append(f"xG {xg:.2f} â‰¥ 2.00: +0.5")
        
        # Conversion kontrolÃ¼ (YUMUÅATILMIÅ)
        conv_ev = self._get("conv_ev", 0)
        conv_dep = self._get("conv_dep", 0)
        conv_ort = (conv_ev + conv_dep) / 2 if (conv_ev > 0 and conv_dep > 0) else 0
        if conv_ort >= 12.0:
            puan += 1.0
            log_detay.append(f"Conv %{conv_ort:.1f} â‰¥ 12: +1.0")
        
        # Ã‡ift golcÃ¼ takÄ±m kontrolÃ¼ (YUMUÅATILMIÅ)
        ev_atan = self._get("ev_atan_05", 0)
        dep_atan = self._get("dep_atan_05", 0)
        if ev_atan > 0 and dep_atan > 0:
            if ev_atan >= 80.0 and dep_atan >= 80.0:
                puan += 1.0
                log_detay.append(f"Ã‡iftAtan {ev_atan}/{dep_atan} â‰¥ 80: +1.0")
            elif ev_atan >= 70.0 and dep_atan >= 70.0:
                puan += 0.5
                log_detay.append(f"Ã‡iftAtan {ev_atan}/{dep_atan} â‰¥ 70: +0.5")
        
        # Hibrit KG kontrolÃ¼ (YUMUÅATILMIÅ)
        kg_var = self._get("kg_var_ort", 0)
        if kg_var > 0 and ev_atan > 0 and dep_atan > 0:
            gol_ort = (ev_atan + dep_atan) / 2
            hibrit = ((gol_ort + kg_var) / 2)
            if hibrit >= 70.0:
                puan += 1.0
                log_detay.append(f"Hibrit %{hibrit:.1f} â‰¥ 70: +1.0")
            elif hibrit >= 65.0:
                puan += 0.5
                log_detay.append(f"Hibrit %{hibrit:.1f} â‰¥ 65: +0.5")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # AZALTANLAR (V70 - YUMUÅATILMIÅ!)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        kritik_vetolar = ["K.SÃœPER-FAVORÄ°", "K.KISIR-TABLO", "K.100", "K.DUVAR-50"]
        kritik_veto_var = False
        
        for veto in self.vetolar:
            veto_id = veto.get("kural_id", "").upper()
            
            if any(k in veto_id for k in kritik_vetolar):
                kritik_veto_var = True
                puan -= 1.5  # V70: Kritik VETO -1.5 (eskiden -2)
                log_detay.append(f"KRÄ°TÄ°K VETO {veto_id}: -1.5")
            else:
                puan -= 0.5  # V70: Normal VETO -0.5 (eskiden -1)
                log_detay.append(f"VETO {veto_id}: -0.5")
        
        for uyari in self.uyarilar:
            uyari_id = uyari.get("kural_id", "")
            puan -= 0.25  # V70: UyarÄ± -0.25 (eskiden -0.5)
            log_detay.append(f"UYARI {uyari_id}: -0.25")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # V70: LÄ°G CEZASI KALDIRILDI!
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        lig_cezasi = 0  # ArtÄ±k lig cezasÄ± YOK!
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # V70: MÄ°NÄ°MUM GARANTÄ° 6 (kritik VETO yoksa)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        if kritik_veto_var:
            puan = min(puan, 4.0)
            log_detay.append("KRÄ°TÄ°K VETO: MAX 4")
            self._log("GÃœVEN", "âŒ Kritik VETO mevcut â†’ MAX 4/10")
        else:
            # V70: Minimum 6 garantisi!
            puan = max(6.0, puan)
        
        # Minimum 1, maksimum 10
        final_puan = max(1, min(10, round(puan)))
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # DÄ°NAMÄ°K GEREKÃ‡E OLUÅTUR (V70)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        # Bonus/Ceza detaylarÄ±
        xg_bonus = 0
        if xg >= 3.00: xg_bonus = 1.5
        elif xg >= 2.50: xg_bonus = 1.0
        elif xg >= 2.00: xg_bonus = 0.5
        
        conv_bonus = 1.0 if conv_ort >= 12.0 else 0
        guclu_bonus = 1.0 if guclu else 0
        
        # Veto/UyarÄ± cezalarÄ±
        veto_cezasi = len(self.vetolar) * -0.5
        uyari_cezasi = len(self.uyarilar) * -0.25
        
        # Dinamik gerekÃ§e string
        gerekce_parcalari = [f"Temel: 7"]
        if guclu_bonus > 0:
            gerekce_parcalari.append(f"GÃœÃ‡LÃœ: +{guclu_bonus:.0f}")
        if xg_bonus > 0:
            gerekce_parcalari.append(f"xG({xg:.2f}): +{xg_bonus:.1f}")
        if conv_bonus > 0:
            gerekce_parcalari.append(f"Conv({conv_ort:.0f}%): +{conv_bonus:.0f}")
        if veto_cezasi < 0:
            gerekce_parcalari.append(f"VETO: {veto_cezasi:.1f}")
        if uyari_cezasi < 0:
            gerekce_parcalari.append(f"UyarÄ±: {uyari_cezasi:.2f}")
        
        dinamik_gerekce = " | ".join(gerekce_parcalari)
        
        self._log("GÃœVEN", f"ğŸ“Š V70 Hesaplama: {' â†’ '.join(log_detay)}")
        self._log("GÃœVEN", f"ğŸ† SONUÃ‡: {final_puan}/10 | Min 6 garantisi âœ…")
        
        # GerekÃ§eyi instance'a kaydet
        self.son_gerekce = dinamik_gerekce
        self.son_puan_detay = {
            "temel": 7,
            "guclu_bonus": guclu_bonus if guclu else 0,
            "xg_bonus": xg_bonus,
            "conv_bonus": conv_bonus,
            "veto_cezasi": veto_cezasi,
            "uyari_cezasi": uyari_cezasi,
            "lig_cezasi": lig_cezasi,
            "final": final_puan
        }
        
        return final_puan
    
    def hesapla_kasa_orani(self, guven):
        kasa = {10: 25, 9: 20, 8: 15, 7: 10, 6: 8, 5: 5, 4: 3, 3: 2, 2: 1, 1: 0}
        return kasa.get(guven, 5)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # EKSÄ°K 40 KURAL - TAM UYGULAMA
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def K_15(self):
        """K.15: Ev Atan < %70 ise gÃ¼ven -1"""
        self._sonuc_ekle("K_15", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev = self._get("ev_atan_05", 70)
        if ev < 70:
            self._sonuc_ekle("K.15", "EV ATAN DÃœÅÃœK", "BÄ°LGÄ°", f"Ev Atan %{ev} < 70 â†’ GÃ¼ven -1")
            return -1
        return 0
    
    def K_17(self):
        """K.17: Gol Yememe >%40 ise ÃœST/KG VAR YASAK (KatÄ± Savunma)"""
        self._sonuc_ekle("K_17", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_yememe = self._get("ev_yememe", 30)
        dep_yememe = self._get("dep_yememe", 30)
        if ev_yememe > 40 or dep_yememe > 40:
            guclu = "EV" if ev_yememe > 40 else "DEP"
            self._sonuc_ekle("K.17", "KATI SAVUNMA", "VETO", 
                f"{guclu} Yememe: %{max(ev_yememe, dep_yememe)} > 40 â†’ ÃœST/KG VAR YASAK", 
                ["MS-2.5Ãœ", "KG-VAR"])
            return True
        self._sonuc_ekle("K_17", "TARANDI", "TARANDI", "Kural tamamlandÄ±")
        return False
    
    def K_29(self):
        """K.29: Ã‡ift golcÃ¼ takÄ±m +1"""
        self._sonuc_ekle("K_29", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        gol_ev = self._get("gol_ort_ev", 1.5)
        gol_dep = self._get("gol_ort_dep", 1.2)
        if gol_ev >= 1.8 and gol_dep >= 1.5:
            self._sonuc_ekle("K.29", "Ã‡Ä°FT GOLCÃœ", "BÄ°LGÄ°", f"Gol ort: {gol_ev:.2f}/{gol_dep:.2f}")
            return 1
        return 0
    
    def K_32(self):
        """K.32: xG Ã§ok yÃ¼ksek +1"""
        self._sonuc_ekle("K_32", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        xg = self._get("xg_ev", 1.2) + self._get("xg_dep", 1.0)
        if xg >= 3.50:
            self._sonuc_ekle("K.32", "xG Ã‡OK YÃœKSEK", "BÄ°LGÄ°", f"xG: {xg:.2f} â‰¥ 3.50")
            return 1
        return 0
    
    def K_34(self):
        """K.34: Åut hacmi yÃ¼ksek +1"""
        self._sonuc_ekle("K_34", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        sut = self._get("sut_ev", 12) + self._get("sut_dep", 10)
        if sut >= 35:
            self._sonuc_ekle("K.34", "ÅUT YÃœKSEK", "BÄ°LGÄ°", f"Åut: {sut} â‰¥ 35")
            return 1
        return 0
    
    def K_40(self):
        """K.40: Ã‡ift dÃ¼ÅŸÃ¼k form -1"""
        self._sonuc_ekle("K_40", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        form_ev = self._get("form_ev", 1.5)
        form_dep = self._get("form_dep", 1.5)
        if form_ev < 1.2 and form_dep < 1.2:
            self._sonuc_ekle("K.40", "Ã‡Ä°FT DÃœÅÃœK FORM", "UYARI", f"Form: {form_ev:.2f}/{form_dep:.2f}")
            return -1
        return 0
    
    def K_41(self):
        """K.41: Galibiyet serisi +1"""
        self._sonuc_ekle("K_41", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        seri = self.veri.get("seri_ev", "") or self.veri.get("seri_dep", "")
        if "WWW" in str(seri):
            self._sonuc_ekle("K.41", "GALÄ°BÄ°YET SERÄ°SÄ°", "BÄ°LGÄ°", "3+ galibiyet serisi")
            return 1
        return 0
    
    def K_46(self):
        """K.46: Ä°Y Ã§ok yÃ¼ksek +1"""
        self._sonuc_ekle("K_46", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        iy = self.veri.get("iy_gol_ort", 50)
        if iy >= 80:
            self._sonuc_ekle("K.46", "Ä°Y YÃœKSEK", "BÄ°LGÄ°", f"Ä°Y: %{iy:.1f} â‰¥ 80")
            return 1
        return 0
    
    def K_49_B(self):
        """K.49.B: H2H golcÃ¼ +1"""
        self._sonuc_ekle("K_49_B", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        h2h = self.veri.get("h2h_bilgi", "")
        if "3-" in str(h2h) or "-3" in str(h2h):
            self._sonuc_ekle("K.49.B", "H2H GOLCÃœ", "BÄ°LGÄ°", "H2H'de yÃ¼ksek skor")
            return 1
        return 0
    
    def K_50(self):
        """K.50: KG tablo yÃ¼ksek +1"""
        self._sonuc_ekle("K_50", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        kg = self._get("kg_var_ort", 60)
        if kg >= 75:
            self._sonuc_ekle("K.50", "KG YÃœKSEK", "BÄ°LGÄ°", f"KG: %{kg} â‰¥ 75")
            return 1
        return 0
    
    def K_70(self):
        """K.70: Conversion yÃ¼ksek +1"""
        self._sonuc_ekle("K_70", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        conv = self.veri.get("conv_ort", 10)
        if conv >= 18:
            self._sonuc_ekle("K.70", "CONV YÃœKSEK", "BÄ°LGÄ°", f"Conv: %{conv:.1f} â‰¥ 18")
            return 1
        return 0
    
    def K_AKILLI_PARA(self):
        """K.AKILLI-PARA: Oran hareketi kontrolÃ¼"""
        self._sonuc_ekle("K_AKILLI_PARA", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("K.AKILLI-PARA", "ORAN HAREKETÄ°", "BÄ°LGÄ°", "CanlÄ± veri gerekli")
        return True
    
    def K_ALT_KONTROL(self):
        """K.ALT-KONTROL: 2.5Ãœ < %45 + Yememe > 60 â†’ ALT dÃ¼ÅŸÃ¼n"""
        self._sonuc_ekle("K_ALT_KONTROL", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_25 = self._get("ust_25", 55)
        yememe = max(self._get("ev_yememe", 30), self._get("dep_yememe", 30))
        if ust_25 < 45 and yememe > 60:
            self._sonuc_ekle("K.ALT-KONTROL", "ALT FIRSATI", "GEÃ‡ER", f"2.5Ãœ:%{ust_25}, Yememe:%{yememe}")
            return True
        return False
    
    def K_CANLI_PUSU(self):
        """K.CANLI-PUSU: Pre-match Ä°Y yasak"""
        self._sonuc_ekle("K_CANLI_PUSU", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        iy = self.veri.get("iy_gol_ort", 50)
        if iy < 68:
            self._sonuc_ekle("K.CANLI-PUSU", "CANLI PUSU", "BÄ°LGÄ°", f"Ä°Y %{iy:.1f} < 68 â†’ Dk 10-20 bekle")
        return True
    
    def K_CONVERSION(self):
        """K.CONVERSION: Conversion hesaplama"""
        self._sonuc_ekle("K_CONVERSION", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        gol_ev = self._get("gol_ort_ev", 1.5)
        gol_dep = self._get("gol_ort_dep", 1.2)
        sut_ev = self._get("sut_ev", 12)
        sut_dep = self._get("sut_dep", 10)
        conv_ev = (gol_ev / sut_ev * 100) if sut_ev > 0 else 0
        conv_dep = (gol_dep / sut_dep * 100) if sut_dep > 0 else 0
        self.veri["conv_ort"] = (conv_ev + conv_dep) / 2
        self._sonuc_ekle("K.CONVERSION", "CONV HESAPLANDI", "TARANDI", 
            f"Ev:{conv_ev:.1f}%, Dep:{conv_dep:.1f}%, Ort:{self.veri['conv_ort']:.1f}%")
        return self.veri["conv_ort"]
    
    def K_CS2(self):
        """K.CS2: Clean sheet serisi - Ä°Y riskli"""
        self._sonuc_ekle("K_CS2", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        yememe = max(self._get("ev_yememe", 30), self._get("dep_yememe", 30))
        if yememe >= 60:
            self._sonuc_ekle("K.CS2", "CS SERÄ°SÄ°", "UYARI", f"Yememe %{yememe} â‰¥ 60", ["Ä°Y-0.5Ãœ"])
            return True
        self._sonuc_ekle("K.CS2", "CS YOK", "TARANDI", f"Yememe %{yememe} < 60")
        return False
    
    def K_DEVLER_KILIDI(self):
        """K.DEVLER-KÄ°LÄ°DÄ°: Elit lig + dÃ¼ÅŸÃ¼k oran"""
        self._sonuc_ekle("K_DEVLER_KILIDI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        lig = self.veri.get("lig", "").lower()
        elit = ["premier", "la liga", "serie a", "bundesliga", "ligue 1"]
        oran = min(self._get("oran_ms1", 3), self._get("oran_ms2", 3))
        if any(e in lig for e in elit) and oran < 1.50:
            self._sonuc_ekle("K.DEVLER-KÄ°LÄ°DÄ°", "DEVLER KÄ°LÄ°DÄ°", "GEÃ‡ER", f"Elit + Oran {oran:.2f}")
            return True
        return False
    
    def K_FAVORI_TEMBEL(self):
        """K.FAVORÄ°-TEMBEL: Favori dÃ¼ÅŸÃ¼k form"""
        self._sonuc_ekle("K_FAVORI_TEMBEL", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        favori = self.veri.get("favori", "EV")
        form = self._get(f"form_{favori.lower()}", 1.5)
        if form < 1.5:
            self._sonuc_ekle("K.FAVORÄ°-TEMBEL", "FAVORÄ° TEMBEL", "UYARI", f"Form: {form:.2f}", ["MS-TARAF"])
            return True
        return False
    
    def K_GENCLIK_KAOSU(self):
        """K.GENÃ‡LÄ°K-KAOSU: GenÃ§ kadro uyarÄ±sÄ±"""
        self._sonuc_ekle("K_GENCLIK_KAOSU", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("K.GENÃ‡LÄ°K-KAOSU", "GENÃ‡LÄ°K", "BÄ°LGÄ°", "GenÃ§ kadro = Tahmin edilemez")
        return True
    
    def K_GOL_SIGORTASI(self):
        """K.GOL-SÄ°GORTASI: Gol Ort â‰¥ %85 + ikisi â‰¥ %70 â†’ 1.5Ãœ gÃ¼venli"""
        self._sonuc_ekle("K_GOL_SIGORTASI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev = self._get("ev_atan_05", 70)
        dep = self._get("dep_atan_05", 70)
        gol_ort = (ev + dep) / 2
        if gol_ort >= 85 and ev >= 70 and dep >= 70:
            self._sonuc_ekle("K.GOL-SÄ°GORTASI", "GOL SÄ°GORTASI", "GEÃ‡ER", f"Gol Ort %{gol_ort:.1f}")
            return True
        return False
    
    def K_H2H_ZEHIR(self):
        """K.H2H-ZEHÄ°R: H2H dÃ¼ÅŸÃ¼k skorlu"""
        self._sonuc_ekle("K_H2H_ZEHIR", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        h2h = self.veri.get("h2h_bilgi", "")
        if "0-0" in str(h2h) or "1-0" in str(h2h):
            self._sonuc_ekle("K.H2H-ZEHÄ°R", "H2H ZEHÄ°R", "UYARI", "H2H dÃ¼ÅŸÃ¼k skorlu", ["MS-2.5Ãœ"])
            return True
        return False
    
    def K_KADRO_HIYERARSISI(self):
        """K.KADRO-HÄ°YERARÅÄ°SÄ°: Eksik oyuncu"""
        self._sonuc_ekle("K_KADRO_HIYERARSISI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        eksik = self.veri.get("eksik_ev", "") or self.veri.get("eksik_dep", "")
        if eksik:
            self._sonuc_ekle("K.KADRO-HÄ°YERARÅÄ°SÄ°", "KADRO EKSÄ°K", "UYARI", f"Eksik: {eksik}", ["MS-TARAF"])
            return True
        return False
    
    def K_KALITE_KONTROL(self):
        """K.KALÄ°TE-KONTROL: Ä°ki takÄ±mdan en az birinin Conv â‰¥%13 olmalÄ±, yoksa ÃœST/KG VAR YASAK"""
        self._sonuc_ekle("K_KALITE_KONTROL", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        gol_ev = self._get("gol_ort_ev", 1.5)
        gol_dep = self._get("gol_ort_dep", 1.2)
        sut_ev = self._get("sut_ev", 12)
        sut_dep = self._get("sut_dep", 10)
        conv_ev = (gol_ev / sut_ev * 100) if sut_ev > 0 else 0
        conv_dep = (gol_dep / sut_dep * 100) if sut_dep > 0 else 0
        # Ä°ki takÄ±mdan EN AZ BÄ°RÄ° %13+ olmalÄ±
        if conv_ev < 13 and conv_dep < 13:
            self._sonuc_ekle("K.KALÄ°TE-KONTROL", "CONV DÃœÅÃœK", "VETO", 
                f"Conv Ev:%{conv_ev:.1f}, Dep:%{conv_dep:.1f} - Ä°KÄ°SÄ° DE <%13 â†’ ÃœST/KG VAR YASAK", 
                ["MS-2.5Ãœ", "KG-VAR"])
            return True
        self._sonuc_ekle("K_KALITE_KONTROL", "KALDI", "TARANDI", "Åart saÄŸlanmadÄ±")
        return False
    
    def K_KARAVANA(self):
        """K.KARAVANA: Ã‡ok ÅŸut ama dÃ¼ÅŸÃ¼k xG"""
        self._sonuc_ekle("K_KARAVANA", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        sut = self._get("sut_ev", 12) + self._get("sut_dep", 10)
        xg = self._get("xg_ev", 1.2) + self._get("xg_dep", 1.0)
        if sut >= 30 and xg < 2.00:
            self._sonuc_ekle("K.KARAVANA", "KARAVANA", "UYARI", f"Åut:{sut}, xG:{xg:.2f}", ["MS-2.5Ãœ"])
            return True
        return False
    
    def K_KG_KOMBO(self):
        """K.KG-KOMBO: KG + Taraf kombo"""
        self._sonuc_ekle("K_KG_KOMBO", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        hibrit = (self._get("ev_atan_05", 70) + self._get("dep_atan_05", 70) + self._get("kg_var_ort", 60)) / 3
        oran = min(self._get("oran_ms1", 3), self._get("oran_ms2", 3))
        if hibrit >= 70 and 1.50 <= oran <= 2.20:
            self._sonuc_ekle("K.KG-KOMBO", "KG KOMBO", "GEÃ‡ER", f"Hibrit:%{hibrit:.1f}, Oran:{oran:.2f}")
            return True
        return False
    
    def K_KISIR_LIG(self):
        """K.KISIR-LÄ°G: Lig 2.5Ãœ < %50"""
        self._sonuc_ekle("K_KISIR_LIG", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        lig_25 = self._get("lig_25_ort", 55)
        if lig_25 < 50:
            self._sonuc_ekle("K.KISIR-LÄ°G", "KISIR LÄ°G", "UYARI", f"Lig 2.5Ãœ: %{lig_25}", ["MS-2.5Ãœ"])
            return True
        return False
    
    def K_KRIZ_ALT(self):
        """K.KRÄ°Z-ALT: Ãœst vetolu ise ALT dÃ¼ÅŸÃ¼n"""
        self._sonuc_ekle("K_KRIZ_ALT", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_vetolar = [v for v in self.vetolar if "Ãœ" in str(v.get("hedefler", []))]
        ust_25 = self._get("ust_25", 55)
        if len(ust_vetolar) >= 2 and ust_25 < 50:
            self._sonuc_ekle("K.KRÄ°Z-ALT", "KRÄ°Z ALT", "GEÃ‡ER", "Ãœst vetolu â†’ ALT dÃ¼ÅŸÃ¼n")
            return True
        return False
    
    def K_KRIZ_GOL(self):
        """K.KRÄ°Z-GOL: HiÃ§ gol bahsi geÃ§mediyse"""
        self._sonuc_ekle("K_KRIZ_GOL", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        gol_bahis = [g for g in self.gecenler if "Ãœ" in g["tip"] or "KG" in g["tip"]]
        if not gol_bahis:
            self._sonuc_ekle("K.KRÄ°Z-GOL", "GOL KRÄ°ZÄ°", "UYARI", "HiÃ§ gol bahsi geÃ§medi")
            return True
        return False
    
    def K_LIG_KARANTINASI(self):
        """K.LÄ°G-KARANTÄ°NASI: DÃ¼ÅŸÃ¼k gollÃ¼ lig"""
        self._sonuc_ekle("K_LIG_KARANTINASI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        lig_gol = self._get("lig_gol_ort", 2.5)
        if lig_gol < 2.30:
            self._sonuc_ekle("K.LÄ°G-KARANTÄ°NASI", "LÄ°G KARANTÄ°NA", "UYARI", f"Lig gol: {lig_gol:.2f}", ["Ä°Y-0.5Ãœ"])
            return True
        return False
    
    def K_ORAN_SUPHE(self):
        """K.ORAN-ÅÃœPHE: Ä°statistik vs oran uyumsuzluÄŸu"""
        self._sonuc_ekle("K_ORAN_SUPHE", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_25 = self._get("ust_25", 55)
        oran_25 = self._get("oran_25_ust", 1.80)
        if ust_25 >= 60 and oran_25 > 2.00:
            self._sonuc_ekle("K.ORAN-ÅÃœPHE", "ORAN ÅÃœPHE", "UYARI", f"Tablo:{ust_25}% ama oran:{oran_25:.2f}")
            return True
        return False
    
    def K_RAKIP_DISLI(self):
        """K.RAKÄ°P-DÄ°ÅLÄ°: Ã‡ift savunma gÃ¼cÃ¼"""
        self._sonuc_ekle("K_RAKIP_DISLI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev_yememe = self._get("ev_yememe", 30)
        dep_yememe = self._get("dep_yememe", 30)
        if ev_yememe >= 50 and dep_yememe >= 50:
            self._sonuc_ekle("K.RAKÄ°P-DÄ°ÅLÄ°", "Ã‡Ä°FT DÄ°ÅLÄ°", "UYARI", f"Yememe: {ev_yememe}/{dep_yememe}", ["Ä°Y-0.5Ãœ"])
            return True
        return False
    
    def K_RAKIP_HACIM(self):
        """K.RAKÄ°P-HACÄ°M: DÃ¼ÅŸÃ¼k ÅŸut hacmi"""
        self._sonuc_ekle("K_RAKIP_HACIM", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        sut = min(self._get("sut_ev", 12), self._get("sut_dep", 10))
        if sut < 8:
            self._sonuc_ekle("K.RAKÄ°P-HACÄ°M", "ÅUT DÃœÅÃœK", "UYARI", f"Min ÅŸut: {sut}", ["Ä°Y-0.5Ãœ"])
            return True
        return False
    
    def K_SKOR_KORUMA(self):
        """K.SKOR-KORUMA: Favori skoru korur mu"""
        self._sonuc_ekle("K_SKOR_KORUMA", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        favori = self.veri.get("favori", "EV")
        yememe = self._get(f"{'ev' if favori == 'EV' else 'dep'}_yememe", 30)
        if yememe >= 40:
            self._sonuc_ekle("K.SKOR-KORUMA", "SKOR KORUMA", "BÄ°LGÄ°", f"Yememe: %{yememe}")
            return True
        return False
    
    def K_SON_VIRAJ(self):
        """K.SON-VÄ°RAJ: Sezon sonu uyarÄ±sÄ±"""
        self._sonuc_ekle("K_SON_VIRAJ", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("K.SON-VÄ°RAJ", "SON VÄ°RAJ", "BÄ°LGÄ°", "Sezon sonu motivasyon kontrolÃ¼")
        return True
    
    def K_SINERJI(self):
        """K.SÄ°NERJÄ°: 3+ pozitif sinyal â†’ +1"""
        self._sonuc_ekle("K_SINERJI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        pozitif = 0
        if self._get("ev_atan_05", 70) >= 80: pozitif += 1
        if self._get("dep_atan_05", 70) >= 80: pozitif += 1
        if self._get("ust_25", 55) >= 60: pozitif += 1
        if (self._get("xg_ev", 1.2) + self._get("xg_dep", 1.0)) >= 2.80: pozitif += 1
        if pozitif >= 3:
            self._sonuc_ekle("K.SÄ°NERJÄ°", "SÄ°NERJÄ°", "GEÃ‡ER", f"{pozitif} pozitif sinyal")
            return 1
        return 0
    
    def K_TEK_KANAT(self):
        """K.TEK-KANAT: Ä°Y'de tek taraf baskÄ±n"""
        self._sonuc_ekle("K_TEK_KANAT", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        iy_ev = self._get("iy_ev_gol", 50)
        iy_dep = self._get("iy_dep_gol", 50)
        if abs(iy_ev - iy_dep) >= 30:
            guclu = "EV" if iy_ev > iy_dep else "DEP"
            self._sonuc_ekle("K.TEK-KANAT", "TEK KANAT", "BÄ°LGÄ°", f"{guclu} Ä°Y'de baskÄ±n")
            return guclu
        return False
    
    def K_TEK_TABANCA(self):
        """K.TEK-TABANCA: Tek takÄ±m Ä°Y â‰¥90%"""
        self._sonuc_ekle("K_TEK_TABANCA", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        iy_ev = self._get("iy_ev_gol", 50)
        iy_dep = self._get("iy_dep_gol", 50)
        if iy_ev >= 90 or iy_dep >= 90:
            guclu = "EV" if iy_ev >= 90 else "DEP"
            self._sonuc_ekle("K.TEK-TABANCA", "TEK TABANCA", "GEÃ‡ER", f"{guclu} Ä°Y %{max(iy_ev,iy_dep)}")
            return True
        return False
    
    def K_ZEHIRLI_ORAN(self):
        """K.ZEHÄ°RLÄ°-ORAN: 2.5Ãœ oran < 1.25 â†’ deÄŸersiz"""
        self._sonuc_ekle("K_ZEHIRLI_ORAN", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        oran = self._get("oran_25_ust", 1.80)
        if oran < 1.25:
            self._sonuc_ekle("K.ZEHÄ°RLÄ°-ORAN", "ZEHÄ°RLÄ° ORAN", "UYARI", f"2.5Ãœ oran {oran:.2f} < 1.25")
            return True
        return False
    
    def K_ZIRVE_KILIDI(self):
        """K.ZÄ°RVE-KÄ°LÄ°DÄ°: Lider takÄ±m evinde"""
        self._sonuc_ekle("K_ZIRVE_KILIDI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        sira = self._get("sira_ev", 10)
        if sira <= 2:
            self._sonuc_ekle("K.ZÄ°RVE-KÄ°LÄ°DÄ°", "ZÄ°RVE KÄ°LÄ°DÄ°", "BÄ°LGÄ°", f"Ev {sira}. sÄ±rada")
            return True
        return False
    
    def K_SUT_TABLOSU_VETO(self):
        """K.ÅUT-TABLOSU-VETO: Ã‡ok dÃ¼ÅŸÃ¼k ÅŸut"""
        self._sonuc_ekle("K_SUT_TABLOSU_VETO", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        sut = self._get("sut_ev", 12) + self._get("sut_dep", 10)
        if sut < 20:
            self._sonuc_ekle("K.ÅUT-TABLOSU-VETO", "ÅUT VETO", "VETO", f"Toplam ÅŸut: {sut} < 20", ["MS-2.5Ãœ"])
            return True
        return False

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # EKSÄ°K 92 KURAL - TAM UYGULAMA
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    # --- BÃ–LÃœM 0: ROOT ---
    def K_DERLEYICI_MODU(self):
        """DERLEYÄ°CÄ°-MODU: SÄ±ralÄ± iÅŸlem kontrolÃ¼"""
        self._sonuc_ekle("K_DERLEYICI_MODU", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("DERLEYÄ°CÄ°-MODU", "COMPILER MODE", "BÄ°LGÄ°", "Kurallar sÄ±rayla iÅŸleniyor")
        return True
    
    def K_TARAMA_RAPORU(self):
        """TARAMA-RAPORU: TÃ¼m bÃ¶lÃ¼mler tarandÄ± mÄ±"""
        self._sonuc_ekle("K_TARAMA_RAPORU", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        bolumler = ["ROOT", "VERÄ°", "ÅABLON", "TÄ°K", "GÄ°YOTÄ°N", "BANKO", "CANLI", "KUPON", "Ä°Y", "SÄ°M", "GÃœVEN", "PRENSÄ°P", "SUNUM"]
        taranan = len(self.sonuclar)
        self._sonuc_ekle("TARAMA-RAPORU", "TARAMA LOG", "BÄ°LGÄ°", f"{taranan} kural tarandi, {len(bolumler)} bÃ¶lÃ¼m")
        return True
    
    # --- BÃ–LÃœM 1: VERÄ° KAYNAÄI ---
    def K_XG_KAYNAK(self):
        """xG-KAYNAK: xG doÄŸru kaynaktan mÄ±"""
        self._sonuc_ekle("K_XG_KAYNAK", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        xg_ev = self._get("xg_ev", 0)
        xg_dep = self._get("xg_dep", 0)
        if xg_ev > 0 and xg_dep > 0:
            self._sonuc_ekle("xG-KAYNAK", "xG VERÄ°SÄ°", "GEÃ‡ER", f"xG: {xg_ev:.2f} / {xg_dep:.2f}")
            return True
        self._sonuc_ekle("xG-KAYNAK", "xG EKSÄ°K", "UYARI", "xG verisi eksik", ["TÃœM"])
        return False
    
    def K_LIG_KONTROLU(self):
        """LÄ°G-KONTROLÃœ: Lig bilgisi var mÄ±"""
        self._sonuc_ekle("K_LIG_KONTROLU", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        lig = self.veri.get("lig", "")
        if lig:
            self._sonuc_ekle("LÄ°G-KONTROLÃœ", "LÄ°G VAR", "GEÃ‡ER", f"Lig: {lig}")
            return True
        self._sonuc_ekle("LÄ°G-KONTROLÃœ", "LÄ°G EKSÄ°K", "UYARI", "Lig bilgisi yok")
        return False
    
    def K_YAZILI_VERI(self):
        """YAZILI-VERÄ°: Metin entegrasyonu"""
        self._sonuc_ekle("K_YAZILI_VERI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        notlar = self.veri.get("notlar", "") or self.veri.get("hikaye", "")
        if notlar:
            self._sonuc_ekle("YAZILI-VERÄ°", "NOTLAR VAR", "BÄ°LGÄ°", f"Not: {notlar[:50]}...")
            return True
        return False
    
    def K_IY_KAYNAK(self):
        """Ä°Y-KAYNAK: Ä°Y verisi AtÄ±lan Goller tablosundan mÄ±"""
        self._sonuc_ekle("K_IY_KAYNAK", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        iy_ev = self._get("iy_ev_gol", 0)
        iy_dep = self._get("iy_dep_gol", 0)
        if iy_ev > 0 or iy_dep > 0:
            self._sonuc_ekle("Ä°Y-KAYNAK", "Ä°Y VERÄ°SÄ°", "GEÃ‡ER", f"Ä°Y: {iy_ev}/{iy_dep}")
            return True
        self._sonuc_ekle("Ä°Y-KAYNAK", "Ä°Y EKSÄ°K", "UYARI", "Ä°Y verisi eksik")
        return False
    
    # --- BÃ–LÃœM 2: HESAPLAMA ---
    def K_GOL_ORT(self):
        """GOL-ORT: (Ev Atan + Dep Atan) / 2"""
        self._sonuc_ekle("K_GOL_ORT", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev = self._get("ev_atan_05", 70)
        dep = self._get("dep_atan_05", 70)
        gol_ort = (ev + dep) / 2
        self.veri["gol_ort_hesap"] = gol_ort
        self._sonuc_ekle("GOL-ORT", "GOL ORTALAMA", "BÄ°LGÄ°", f"Gol Ort: %{gol_ort:.1f}")
        return gol_ort
    
    def K_GOL_YEME_ORT(self):
        """GOL-YEME-ORT: (Ev Yenen + Dep Yenen) / 2"""
        self._sonuc_ekle("K_GOL_YEME_ORT", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev = self._get("ev_yenen_05", 50)
        dep = self._get("dep_yenen_05", 50)
        if ev <= 0: ev = self._get("dep_atan_05", 70)
        if dep <= 0: dep = self._get("ev_atan_05", 70)
        yeme_ort = (ev + dep) / 2
        self.veri["gol_yeme_ort_hesap"] = yeme_ort
        self._sonuc_ekle("GOL-YEME-ORT", "GOL YEME ORT", "BÄ°LGÄ°", f"Yeme Ort: %{yeme_ort:.1f}")
        return yeme_ort
    
    def K_HIBRIT_KG(self):
        """HÄ°BRÄ°T-KG: (Ev Atan + Dep Atan + KG Tablo) / 3"""
        self._sonuc_ekle("K_HIBRIT_KG", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev = self._get("ev_atan_05", 70)
        dep = self._get("dep_atan_05", 70)
        kg = self._get("kg_var_ort", 60)
        hibrit = (ev + dep + kg) / 3
        self.veri["hibrit_kg_hesap"] = hibrit
        self._sonuc_ekle("HÄ°BRÄ°T-KG", "HÄ°BRÄ°T KG", "BÄ°LGÄ°", f"Hibrit: %{hibrit:.1f}")
        return hibrit
    
    def K_IY_GOL_DEGERI(self):
        """Ä°Y-GOL-DEÄERÄ°: (Ev Ä°Y + Dep Ä°Y) / 2"""
        self._sonuc_ekle("K_IY_GOL_DEGERI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ev = self._get("iy_ev_gol", 50)
        dep = self._get("iy_dep_gol", 50)
        iy_ort = (ev + dep) / 2
        self.veri["iy_gol_ort"] = iy_ort
        self._sonuc_ekle("Ä°Y-GOL-DEÄERÄ°", "Ä°Y GOL ORT", "BÄ°LGÄ°", f"Ä°Y Ort: %{iy_ort:.1f}")
        return iy_ort
    
    def K_SUT_DONUSUM(self):
        """ÅUT-DÃ–NÃœÅÃœM: (Gol / Åut) * 100"""
        self._sonuc_ekle("K_SUT_DONUSUM", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        gol = self._get("gol_ort_ev", 1.5) + self._get("gol_ort_dep", 1.2)
        sut = self._get("sut_ev", 12) + self._get("sut_dep", 10)
        conv = (gol / sut * 100) if sut > 0 else 0
        self.veri["sut_donusum"] = conv
        self._sonuc_ekle("ÅUT-DÃ–NÃœÅÃœM", "CONVERSION", "BÄ°LGÄ°", f"Conv: %{conv:.1f}")
        return conv
    
    def K_TAHMINI_RCS(self):
        """TAHMÄ°NÄ°-RCS: (CSÄ° * 3) + Korner"""
        self._sonuc_ekle("K_TAHMINI_RCS", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        csi = self._get("csi_sut", 4)
        korner = self._get("korner_ort", 10)
        rcs = (csi * 3) + korner
        self.veri["tahmini_rcs"] = rcs
        self._sonuc_ekle("TAHMÄ°NÄ°-RCS", "RCS", "BÄ°LGÄ°", f"RCS: {rcs:.1f}")
        return rcs
    
    def K_FAVORI_ETIKETI(self):
        """FAVORÄ°-ETÄ°KETÄ°: Oran bazlÄ± favori tespiti"""
        self._sonuc_ekle("K_FAVORI_ETIKETI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        oran_ev = self._get("oran_ms1", 2.5)
        oran_dep = self._get("oran_ms2", 2.5)
        if oran_ev < oran_dep:
            favori = "EV"
            oran = oran_ev
        else:
            favori = "DEP"
            oran = oran_dep
        self.veri["favori"] = favori
        self.veri["favori_oran"] = oran
        self._sonuc_ekle("FAVORÄ°-ETÄ°KETÄ°", "FAVORÄ°", "BÄ°LGÄ°", f"Favori: {favori} (oran: {oran:.2f})")
        return favori
    
    # --- BÃ–LÃœM 3: TÄ°K Ä°ÅARETÄ° ---
    def K_MS_05U_TIK(self):
        """MS-0.5Ãœ-TÄ°K: Gol Ort â‰¥ %85 ise âœ…"""
        self._sonuc_ekle("K_MS_05U_TIK", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        gol_ort = self.veri.get("gol_ort_hesap", 70)
        if gol_ort >= 85:
            self._sonuc_ekle("MS-0.5Ãœ-TÄ°K", "0.5Ãœ TÄ°K âœ…", "GEÃ‡ER", f"Gol Ort %{gol_ort:.1f} â‰¥ 85")
            return True
        return False
    
    def K_MS_15U_TIK(self):
        """MS-1.5Ãœ-TÄ°K: 1.5Ãœ â‰¥ %75 ise âœ…"""
        self._sonuc_ekle("K_MS_15U_TIK", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_15 = self._get("ust_15", 65)
        if ust_15 >= 75:
            self._sonuc_ekle("MS-1.5Ãœ-TÄ°K", "1.5Ãœ TÄ°K âœ…", "GEÃ‡ER", f"1.5Ãœ %{ust_15} â‰¥ 75")
            return True
        return False
    
    def K_MS_25U_TIK(self):
        """MS-2.5Ãœ-TÄ°K: 2.5Ãœ â‰¥ %65 ise âœ…"""
        self._sonuc_ekle("K_MS_25U_TIK", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_25 = self._get("ust_25", 55)
        if ust_25 >= 65:
            self._sonuc_ekle("MS-2.5Ãœ-TÄ°K", "2.5Ãœ TÄ°K âœ…", "GEÃ‡ER", f"2.5Ãœ %{ust_25} â‰¥ 65")
            return True
        return False
    
    def K_MS_35U_TIK(self):
        """MS-3.5Ãœ-TÄ°K: 3.5Ãœ â‰¥ %50 ise âœ…"""
        self._sonuc_ekle("K_MS_35U_TIK", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_35 = self._get("ust_35", 30)
        if ust_35 >= 50:
            self._sonuc_ekle("MS-3.5Ãœ-TÄ°K", "3.5Ãœ TÄ°K âœ…", "GEÃ‡ER", f"3.5Ãœ %{ust_35} â‰¥ 50")
            return True
        return False
    
    def K_IY_GOL_TIK(self):
        """Ä°Y-GOL-TÄ°K: Ä°Y Ort â‰¥ %80 ise âœ… (veya TEK TABANCA)"""
        self._sonuc_ekle("K_IY_GOL_TIK", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        iy_ort = self.veri.get("iy_gol_ort", 50)
        iy_ev = self._get("iy_ev_gol", 50)
        iy_dep = self._get("iy_dep_gol", 50)
        # TEK TABANCA istisnasÄ±
        if iy_ev >= 90 or iy_dep >= 90:
            self._sonuc_ekle("Ä°Y-GOL-TÄ°K", "Ä°Y TÄ°K âœ… (TEK TABANCA)", "GEÃ‡ER", f"Tek takÄ±m â‰¥90%")
            return True
        if iy_ort >= 80:
            self._sonuc_ekle("Ä°Y-GOL-TÄ°K", "Ä°Y TÄ°K âœ…", "GEÃ‡ER", f"Ä°Y Ort %{iy_ort:.1f} â‰¥ 80")
            return True
        return False
    
    def K_YUZDE_100_TIK(self):
        """K.100-TÄ°K: Herhangi bir deÄŸer %100 ise âœ… (ama ÅŸÃ¼pheli!)"""
        self._sonuc_ekle("K_YUZDE_100_TIK", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        degerler = {
            "Ev Atan": self._get("ev_atan_05", 0),
            "Dep Atan": self._get("dep_atan_05", 0),
            "1.5Ãœ": self._get("ust_15", 0),
            "2.5Ãœ": self._get("ust_25", 0),
            "KG": self._get("kg_var_ort", 0),
            "Ä°Y Ev": self._get("iy_ev_gol", 0),
            "Ä°Y Dep": self._get("iy_dep_gol", 0),
        }
        yuz_olanlar = [k for k, v in degerler.items() if v >= 100]
        if yuz_olanlar:
            self._sonuc_ekle("K.100-TÄ°K", "%100 TÄ°K âš ï¸", "UYARI", 
                f"%100 deÄŸerler: {', '.join(yuz_olanlar)} (VERÄ° DOÄRULA!)")
            return yuz_olanlar
        return False
    
    # --- BÃ–LÃœM 5: BANKO TARAMA ---
    def K_35_UST_TARA(self):
        """3.5-ÃœST-TARA: 3.5Ãœ tarama"""
        self._sonuc_ekle("K_35_UST_TARA", "TARANDI", "TARANDI", "Kural Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±")
        return self.K_MS_35_UST()
    
    def K_25_UST_TARA(self):
        """2.5-ÃœST-TARA: 2.5Ãœ tarama"""
        self._sonuc_ekle("K_25_UST_TARA", "TARANDI", "TARANDI", "Kural Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±")
        return self.K_MS_25_UST()
    
    def K_15_UST_TARA(self):
        """1.5-ÃœST-TARA: 1.5Ãœ tarama"""
        self._sonuc_ekle("K_15_UST_TARA", "TARANDI", "TARANDI", "Kural Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±")
        return self.K_MS_15_UST()
    
    def K_KG_VAR_TARA(self):
        """KG-VAR-TARA: KG VAR tarama"""
        self._sonuc_ekle("K_KG_VAR_TARA", "TARANDI", "TARANDI", "Kural Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±")
        return self.K_KG_VAR()
    
    def K_KG_YOK_TARA(self):
        """KG-YOK-TARA: KG YOK tarama"""
        self._sonuc_ekle("K_KG_YOK_TARA", "TARANDI", "TARANDI", "Kural Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±")
        return self.K_KG_YOK()
    
    def K_TAKIM_05U_TARA(self):
        """TAKIM-0.5Ãœ-TARA: TakÄ±m 0.5Ãœ tarama"""
        self._sonuc_ekle("K_TAKIM_05U_TARA", "TARANDI", "TARANDI", "Kural Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±")
        return self.K_TAKIM_05_UST()
    
    def K_TAKIM_15U_TARA(self):
        """TAKIM-1.5Ãœ-TARA: TakÄ±m 1.5Ãœ tarama"""
        self._sonuc_ekle("K_TAKIM_15U_TARA", "TARANDI", "TARANDI", "Kural Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±")
        return self.K_TAKIM_15_UST()
    
    def K_MS_TARAF_TARA(self):
        """MS-TARAF-TARA: MS Taraf tarama"""
        self._sonuc_ekle("K_MS_TARAF_TARA", "TARANDI", "TARANDI", "Kural Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±")
        return self.K_MS_TARAF()
    
    def K_25_ALT_TARA(self):
        """2.5-ALT-TARA: 2.5 ALT tarama"""
        self._sonuc_ekle("K_25_ALT_TARA", "TARANDI", "TARANDI", "Kural Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±")
        return self.K_25_ALT()
    
    # --- BÃ–LÃœM 6: CANLI STRATEJÄ° ---
    def K_NABIZ(self):
        """NABIZ: Ä°Y isabetli ÅŸut kontrolÃ¼"""
        self._sonuc_ekle("K_NABIZ", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        isabetli = self._get("iy_isabetli_ev", 2) + self._get("iy_isabetli_dep", 2)
        if isabetli >= 4:
            self._sonuc_ekle("NABIZ", "NABIZ OK", "GEÃ‡ER", f"Ä°Y Ä°sabetli: {isabetli}")
            return True
        self._sonuc_ekle("NABIZ", "NABIZ DÃœÅÃœK", "UYARI", f"Ä°Y Ä°sabetli: {isabetli} < 4")
        return False
    
    def K_SENARYO_1(self):
        """SENARYO-1: HT 0-0 planÄ±"""
        self._sonuc_ekle("K_SENARYO_1", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        xg = self._get("xg_ev", 1.2) + self._get("xg_dep", 1.0)
        self._sonuc_ekle("SENARYO-1", "HT 0-0", "BÄ°LGÄ°", f"HT 0-0 â†’ CanlÄ± 1.5Ãœ (xG: {xg:.2f})")
        return {"senaryo": "HT 0-0", "aksiyon": "CanlÄ± 1.5Ãœ"}
    
    def K_SENARYO_2(self):
        """SENARYO-2: Favori Ã¶nde planÄ±"""
        self._sonuc_ekle("K_SENARYO_2", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        favori = self.veri.get("favori", "EV")
        self._sonuc_ekle("SENARYO-2", "FAVORÄ° Ã–NDE", "BÄ°LGÄ°", f"{favori} 1-0 â†’ Koru")
        return {"senaryo": "Favori Ã¶nde", "aksiyon": "Koru"}
    
    def K_SENARYO_3(self):
        """SENARYO-3: Favori geride planÄ±"""
        self._sonuc_ekle("K_SENARYO_3", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        favori = self.veri.get("favori", "EV")
        self._sonuc_ekle("SENARYO-3", "FAVORÄ° GERÄ°DE", "BÄ°LGÄ°", f"{favori} 0-1 â†’ CanlÄ± {favori} 0.5Ãœ")
        return {"senaryo": "Favori geride", "aksiyon": f"{favori} 0.5Ãœ"}
    
    def K_SENARYO_4(self):
        """SENARYO-4: HT 1-1 planÄ±"""
        self._sonuc_ekle("K_SENARYO_4", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("SENARYO-4", "HT 1-1", "BÄ°LGÄ°", "HT 1-1 â†’ Koru, hedefe yakÄ±n")
        return {"senaryo": "HT 1-1", "aksiyon": "Koru"}
    
    def K_SENARYO_5(self):
        """SENARYO-5: 2 fark planÄ±"""
        self._sonuc_ekle("K_SENARYO_5", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("SENARYO-5", "2 FARK", "BÄ°LGÄ°", "2-0/0-2 â†’ Planlar iptal, cash-out")
        return {"senaryo": "2 fark", "aksiyon": "Cash-out"}
    
    # --- BÃ–LÃœM 7: KUPON KURALLARI ---
    def K_KASA_KUPONU(self):
        """KASA-KUPONU: 2-3 maÃ§, oran â‰¥1.20, taraf <1.40 yasak"""
        self._sonuc_ekle("K_KASA_KUPONU", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("KASA-KUPONU", "KASA KUPONU", "BÄ°LGÄ°", "2-3 maÃ§, oranâ‰¥1.20, convâ‰¥12%")
        return True
    
    def K_KARMA_KUPON(self):
        """KARMA-KUPON: KG + Taraf kombo"""
        self._sonuc_ekle("K_KARMA_KUPON", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        hibrit = self.veri.get("hibrit_kg_hesap", 60)
        oran = min(self._get("oran_ms1", 3), self._get("oran_ms2", 3))
        if hibrit >= 70 and oran >= 1.50:
            self._sonuc_ekle("KARMA-KUPON", "KARMA UYGUN", "GEÃ‡ER", f"KG:{hibrit:.0f}%+Oran:{oran:.2f}")
            return True
        return False
    
    def K_RISKLI_KUPON(self):
        """RÄ°SKLÄ°-KUPON: Oran â‰¥2.00 riskli"""
        self._sonuc_ekle("K_RISKLI_KUPON", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        oran = min(self._get("oran_ms1", 3), self._get("oran_ms2", 3))
        if oran >= 2.00:
            self._sonuc_ekle("RÄ°SKLÄ°-KUPON", "RÄ°SKLÄ°", "UYARI", f"Oran {oran:.2f} â‰¥ 2.00")
            return True
        return False
    
    # --- BÃ–LÃœM 8: Ä°Y RADAR ---
    def K_KATI_BARAJ(self):
        """KATI-BARAJ: Ä°Y â‰¥ %70 (veya lig bazlÄ± %68)"""
        self._sonuc_ekle("K_KATI_BARAJ", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        iy_ort = self.veri.get("iy_gol_ort", 50)
        lig_gol = self._get("lig_gol_ort", 2.5)
        baraj = 68 if lig_gol >= 2.80 else 70
        if iy_ort >= baraj:
            self._sonuc_ekle("KATI-BARAJ", "Ä°Y BARAJ OK", "GEÃ‡ER", f"Ä°Y %{iy_ort:.1f} â‰¥ {baraj}")
            return True
        self._sonuc_ekle("KATI-BARAJ", "Ä°Y BARAJ ALTI", "UYARI", f"Ä°Y %{iy_ort:.1f} < {baraj}")
        return False
    
    def K_IY_GOL_YEME(self):
        """Ä°Y-GOL-YEME: Ä°Y'de gol yeme oranÄ±"""
        self._sonuc_ekle("K_IY_GOL_YEME", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        iy_yeme_ev = self._get("iy_yeme_ev", 40)
        iy_yeme_dep = self._get("iy_yeme_dep", 40)
        ort = (iy_yeme_ev + iy_yeme_dep) / 2
        self._sonuc_ekle("Ä°Y-GOL-YEME", "Ä°Y YEME", "BÄ°LGÄ°", f"Ä°Y Yeme: %{ort:.1f}")
        return ort
    
    def K_IY_15_UST(self):
        """Ä°Y-1.5-ÃœST: Ä°Y 1.5Ãœ kontrolÃ¼"""
        self._sonuc_ekle("K_IY_15_UST", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        iy_15 = self._get("iy_15_ust", 30)
        if iy_15 >= 35:
            self._sonuc_ekle("Ä°Y-1.5-ÃœST", "Ä°Y 1.5Ãœ", "GEÃ‡ER", f"Ä°Y 1.5Ãœ %{iy_15} â‰¥ 35")
            return True
        return False
    
    def K_IY_15U_TARA(self):
        """Ä°Y-1.5Ãœ-TARA: Ä°Y 1.5Ãœ tarama"""
        self._sonuc_ekle("K_IY_15U_TARA", "TARANDI", "TARANDI", "Kural Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±")
        return self.K_IY_15_UST()
    
    def K_IY_GALIBIYET(self):
        """Ä°Y-GALÄ°BÄ°YET: Ä°Y galibiyet kontrolÃ¼"""
        self._sonuc_ekle("K_IY_GALIBIYET", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        iy_ms1 = self._get("iy_ms1", 35)
        iy_ms2 = self._get("iy_ms2", 25)
        if iy_ms1 >= 45 or iy_ms2 >= 45:
            guclu = "EV" if iy_ms1 > iy_ms2 else "DEP"
            self._sonuc_ekle("Ä°Y-GALÄ°BÄ°YET", "Ä°Y GAL", "GEÃ‡ER", f"{guclu} Ä°Y %{max(iy_ms1, iy_ms2)}")
            return guclu
        return False
    
    def K_IY_GAL_TARA(self):
        """Ä°Y-GAL-TARA: Ä°Y galibiyet tarama"""
        self._sonuc_ekle("K_IY_GAL_TARA", "TARANDI", "TARANDI", "Kural Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±")
        return self.K_IY_GALIBIYET()
    
    # --- BÃ–LÃœM 9: SÄ°MÃœLASYON ---
    def K_ALTIN_ORAN(self):
        """ALTIN-ORAN: Oran 1.45-1.65 altÄ±n"""
        self._sonuc_ekle("K_ALTIN_ORAN", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        for g in self.gecenler:
            oran = self._get(f"oran_{g['tip'].lower().replace('-', '_')}", 0)
            if 1.45 <= oran <= 1.65:
                self._sonuc_ekle("ALTIN-ORAN", "ALTIN ORAN", "GEÃ‡ER", f"{g['tip']} oran {oran:.2f}")
                return g
        return None
    
    def K_GUVENLIK_ONCELIGI(self):
        """GÃœVENLÄ°K-Ã–NCELÄ°ÄÄ°: GÃ¼Ã§lÃ¼ bankolar Ã¶nce"""
        self._sonuc_ekle("K_GUVENLIK_ONCELIGI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        guclular = [g for g in self.gecenler if g.get("guclu")]
        if guclular:
            self._sonuc_ekle("GÃœVENLÄ°K-Ã–NCELÄ°ÄÄ°", "GÃœÃ‡LÃœ VAR", "BÄ°LGÄ°", f"{len(guclular)} gÃ¼Ã§lÃ¼")
            return guclular[0]
        return None
    
    def K_YUZDE_FARKI(self):
        """YÃœZDE-FARKI: En yÃ¼ksek yÃ¼zdeli bahis"""
        self._sonuc_ekle("K_YUZDE_FARKI", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        kontrol = {
            "3.5Ãœ": self._get("ust_35", 0),
            "2.5Ãœ": self._get("ust_25", 0),
            "KG": self.veri.get("hibrit_kg_hesap", 0),
            "1.5Ãœ": self._get("ust_15", 0),
        }
        en_yuksek = max(kontrol, key=kontrol.get)
        self._sonuc_ekle("YÃœZDE-FARKI", "EN YÃœKSEK", "BÄ°LGÄ°", f"{en_yuksek}: %{kontrol[en_yuksek]:.1f}")
        return en_yuksek
    
    def K_STEP2_MS15(self):
        """STEP2-MS15: 2. adÄ±m 1.5Ãœ kontrolÃ¼"""
        self._sonuc_ekle("K_STEP2_MS15", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        ust_15 = self._get("ust_15", 65)
        if ust_15 >= 75:
            self._sonuc_ekle("STEP2-MS15", "STEP2 1.5Ãœ", "GEÃ‡ER", f"1.5Ãœ %{ust_15} â‰¥ 75")
            return True
        return False
    
    # --- BÃ–LÃœM 11: PRENSÄ°PLER ---
    def K_BI_1(self):
        """B.Ä°-1: BaÅŸarÄ±sÄ±zlÄ±k analizi"""
        self._sonuc_ekle("K_BI_1", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("B.Ä°-1", "BAÅARISIZLIK", "BÄ°LGÄ°", "KayÄ±plarÄ± analiz et")
        return True
    
    def K_BI_2(self):
        """B.Ä°-2: Mutlak dÃ¼rÃ¼stlÃ¼k"""
        self._sonuc_ekle("K_BI_2", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("B.Ä°-2", "DÃœRÃœSTLÃœK", "BÄ°LGÄ°", "Veriyi olduÄŸu gibi oku")
        return True
    
    def K_BI_3(self):
        """B.Ä°-3: Dinamik zaman"""
        self._sonuc_ekle("K_BI_3", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("B.Ä°-3", "DÄ°NAMÄ°K", "BÄ°LGÄ°", "GÃ¼ncel veri kullan")
        return True
    
    def K_BI_4(self):
        """B.Ä°-4: Ã‡apraz doÄŸrulama"""
        self._sonuc_ekle("K_BI_4", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("B.Ä°-4", "Ã‡APRAZ", "BÄ°LGÄ°", "Tek kaynaÄŸa gÃ¼venme")
        return True
    
    def K_BI_5(self):
        """B.Ä°-5: GÃ¶rsel netlik"""
        self._sonuc_ekle("K_BI_5", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("B.Ä°-5", "NETLÄ°K", "BÄ°LGÄ°", "SonuÃ§larÄ± aÃ§Ä±k sun")
        return True
    
    def K_BI_6(self):
        """B.Ä°-6: Sadece gÃ¶rsel veri"""
        self._sonuc_ekle("K_BI_6", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("B.Ä°-6", "GÃ–RSEL", "BÄ°LGÄ°", "GÃ¶rselde olmayan uydurma")
        return True
    
    def K_BI_7(self):
        """B.Ä°-7: Robotik karar"""
        self._sonuc_ekle("K_BI_7", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("B.Ä°-7", "ROBOTÄ°K", "BÄ°LGÄ°", "Duygusuz karar ver")
        return True
    
    def K_BI_8(self):
        """B.Ä°-8: Veri kaynaÄŸÄ± zorunlu"""
        self._sonuc_ekle("K_BI_8", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("B.Ä°-8", "KAYNAK", "BÄ°LGÄ°", "KaynaÄŸÄ± belirt")
        return True
    
    def K_BI_9(self):
        """B.Ä°-9: Gol Ã¶nceliÄŸi"""
        self._sonuc_ekle("K_BI_9", "BAÅLADI", "TARANDI", "Kural taranÄ±yor")
        self._sonuc_ekle("B.Ä°-9", "GOL Ã–NCELÄ°K", "BÄ°LGÄ°", "Ã–nce gol, sonra taraf")
        return True

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # GOL Ã–NGÃ–RÃœSÃœ (BÃ–LÃœM 12)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def gol_ongorusu_05(self):
        """0.5 ÃœST Gol Ã–ngÃ¶rÃ¼sÃ¼"""
        ev_atan = self._get("ev_atan_05", 70)
        dep_atan = self._get("dep_atan_05", 70)
        ev_yenen = self._get("ev_yenen_05", 50)
        dep_yenen = self._get("dep_yenen_05", 50)
        if ev_yenen <= 0: ev_yenen = dep_atan
        if dep_yenen <= 0: dep_yenen = ev_atan
        ev_gol = (ev_atan + dep_yenen) / 2
        dep_gol = (dep_atan + ev_yenen) / 2
        if ev_gol > dep_gol + 10:
            yon = "EV ATAR"
        elif dep_gol > ev_gol + 10:
            yon = "DEP ATAR"
        else:
            yon = "Ä°KÄ° TARAF DA ATAR"
        return {"ev_ihtimal": ev_gol, "dep_ihtimal": dep_gol, "yon": yon}
    
    def canli_tetikleyici(self):
        """CanlÄ± bahis tetikleyicileri"""
        tetikler = []
        ev_atan = self._get("ev_atan_05", 70)
        dep_atan = self._get("dep_atan_05", 70)
        if ev_atan >= 80:
            tetikler.append({"senaryo": "EV geriye dÃ¼ÅŸerse", "aksiyon": "EV 0.5Ãœ"})
        if dep_atan >= 80:
            tetikler.append({"senaryo": "DEP geriye dÃ¼ÅŸerse", "aksiyon": "DEP 0.5Ãœ"})
        tetikler.append({"senaryo": "KIRMIZI KART", "aksiyon": "PLANLAR Ä°PTAL"})
        return tetikler

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ANA Ã‡ALIÅTIRICI
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def tum_kurallari_calistir(self):
        """TÃœM 127 KURALI SIRALI Ã‡ALIÅTIR VE SONUÃ‡ DÃ–N"""
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 0: ROOT PROTOKOLÃœ (5 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_YUZDE_100()
        self.K_YUZDE_KAYNAK()
        self.K_KAOS_KABULU()
        self.K_DERLEYICI_MODU()
        self.K_TARAMA_RAPORU()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 1: VERÄ° KAYNAÄI (5 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_XG_KAYNAK()
        self.K_LIG_KONTROLU()
        self.K_YAZILI_VERI()
        self.K_IY_KAYNAK()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 2: HESAPLAMA (8 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_GOL_ORT()
        self.K_GOL_YEME_ORT()
        self.K_HIBRIT_KG()
        self.K_IY_GOL_DEGERI()
        self.K_SUT_DONUSUM()
        self.K_TAHMINI_RCS()
        self.K_FAVORI_ETIKETI()
        self.K_CONVERSION()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 3: TÄ°K Ä°ÅARETÄ° (5 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_MS_05U_TIK()
        self.K_MS_15U_TIK()
        self.K_MS_25U_TIK()
        self.K_MS_35U_TIK()
        self.K_IY_GOL_TIK()
        self.K_YUZDE_100_TIK()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 4: GÄ°YOTÄ°N VETOLAR (28 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_18_B()
        self.K_SUPER_FAVORI()
        self.K_KEVGIR_FAVORI()
        self.K_HACIM_GUVENLIGI()
        self.K_KISIR_TABLO()
        self.K_100()
        self.K_CONVERSION_BARAJI()
        self.K_AYNA()
        self.K_DUVAR_50()
        self.K_DUVAR_80()
        self.K_KISIR_7()
        self.K_KISIRLIK_VETO()
        self.K_NEKRO()
        self.K_TEK_GUC()
        self.K_xGA_DIRENCI()
        self.K_KALE_KILIDI()
        self.K_DIP_DIRENC()
        self.K_ISABETKILIDI()
        self.K_ERKEN_FISEK()
        self.K_DEPLASMAN_SENDROMU()
        self.K_EV_GOL_60()
        self.K_KEVGIR()
        self.K_SUT_TABLOSU_VETO()
        self.K_KARAVANA()
        self.K_KISIR_LIG()
        self.K_H2H_ZEHIR()
        self.K_ZEHIRLI_ORAN()
        self.K_ORAN_SUPHE()
        self.K_KALITE_KONTROL()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 5: BANKO ÅARTLARI + TARAMA (18 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_MS_35_UST()
        self.K_MS_25_UST()
        self.K_KG_VAR()
        self.K_MS_15_UST()
        self.K_MS_TARAF()
        self.K_TAKIM_05_UST()
        self.K_TAKIM_15_UST()
        self.K_25_ALT()
        self.K_KG_YOK()
        self.K_DEVLER_KILIDI()
        self.K_KG_KOMBO()
        self.K_GOL_SIGORTASI()
        self.K_ALT_KONTROL()
        # Tarama
        self.K_35_UST_TARA()
        self.K_25_UST_TARA()
        self.K_15_UST_TARA()
        self.K_KG_VAR_TARA()
        self.K_MS_TARAF_TARA()
        self.K_25_ALT_TARA()
        self.K_KG_YOK_TARA()
        self.K_TAKIM_05U_TARA()
        self.K_TAKIM_15U_TARA()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 6: CANLI STRATEJÄ° (6 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_NABIZ()
        self.K_SENARYO_1()
        self.K_SENARYO_2()
        self.K_SENARYO_3()
        self.K_SENARYO_4()
        self.K_SENARYO_5()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 7: KUPON KURALLARI (12 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_KASA_KUPONU()
        self.K_KARMA_KUPON()
        self.K_RISKLI_KUPON()
        self.K_FAVORI_TEMBEL()
        self.K_KADRO_HIYERARSISI()
        self.K_GENCLIK_KAOSU()
        self.K_SON_VIRAJ()
        self.K_SKOR_KORUMA()
        self.K_ZIRVE_KILIDI()
        self.K_KRIZ_GOL()
        self.K_KRIZ_ALT()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 8: Ä°Y RADAR (12 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_KATI_BARAJ()
        self.K_CANLI_PUSU()
        self.K_TEK_TABANCA()
        self.K_TEK_KANAT()
        self.K_CS2()
        self.K_RAKIP_HACIM()
        self.K_RAKIP_DISLI()
        self.K_LIG_KARANTINASI()
        self.K_IY_GOL_YEME()
        self.K_IY_15_UST()
        self.K_IY_GALIBIYET()
        self.K_IY_15U_TARA()
        self.K_IY_GAL_TARA()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 9: SÄ°MÃœLASYON (5 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_ALTIN_ORAN()
        self.K_GUVENLIK_ONCELIGI()
        self.K_YUZDE_FARKI()
        self.K_STEP2_MS15()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 10: GÃœVEN PUANI (15 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_15()
        self.K_17()
        self.K_29()
        self.K_32()
        self.K_34()
        self.K_40()
        self.K_41()
        self.K_46()
        self.K_49_B()
        self.K_50()
        self.K_70()
        self.K_SINERJI()
        self.K_AKILLI_PARA()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BÃ–LÃœM 11: PRENSÄ°PLER (9 kural)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.K_BI_1()
        self.K_BI_2()
        self.K_BI_3()
        self.K_BI_4()
        self.K_BI_5()
        self.K_BI_6()
        self.K_BI_7()
        self.K_BI_8()
        self.K_BI_9()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # NÄ°HAÄ° KARAR (V63 - TEK PUAN KAYNAÄI!)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        banko = self.banko_sec()
        guven = self.hesapla_guven_puani(banko)  # NÄ°HAÄ° PUAN - tek kaynak!
        kasa = self.hesapla_kasa_orani(guven)
        gol_05 = self.gol_ongorusu_05()
        tetikler = self.canli_tetikleyici()
        
        # V63: NÄ°HAÄ° PUANI BANKOYA DA YAZDIR (tutarsÄ±zlÄ±k Ã¶nleme)
        banko["nihai_guven"] = guven  # BANKO'nun iÃ§ine de yaz
        banko["nihai_kasa"] = kasa
        
        # Toplam log sayÄ±sÄ±nÄ± ekle
        self._log("SONUÃ‡", f"âœ… Toplam {len(self.kanit_loglari)} log kaydÄ± oluÅŸturuldu")
        self._log("SONUÃ‡", f"")
        self._log("SONUÃ‡", "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
        self._log("SONUÃ‡", f"â•‘  ğŸ¯ NÄ°HAÄ° KARAR (V63 TUTARLI)                                 â•‘")
        self._log("SONUÃ‡", f"â•‘  BANKO: {banko.get('tip', 'N/A'):15}                                 â•‘")
        self._log("SONUÃ‡", f"â•‘  PUAN : {guven}/10 (TEK KAYNAK - TUTARLI!)                    â•‘")
        self._log("SONUÃ‡", f"â•‘  KASA : %{kasa}                                               â•‘")
        self._log("SONUÃ‡", "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
        
        return {
            "banko": banko,
            "guven": guven,  # NÄ°HAÄ° PUAN - her yerde BU kullanÄ±lmalÄ±!
            "kasa": kasa,
            "vetolar": self.vetolar,
            "uyarilar": self.uyarilar,
            "gecenler": self.gecenler,
            "gol_ongorusu": gol_05,
            "tetikler": tetikler,
            "toplam_kural": 130,
            "taranan_kural": len(self.sonuclar),
            "taranan_sayac": self.taranan_sayac,
            "kanit_loglari": self.kanit_loglari,
            "puan_detay": getattr(self, 'son_puan_detay', {}),  # V62 dinamik gerekÃ§e
            "gerekce": getattr(self, 'son_gerekce', "")  # V62 dinamik gerekÃ§e
        }
    
    def banko_sec(self):
        """
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        BÃ–LÃœM 5: ADAY HAVUZU BANKO SEÃ‡Ä°MÄ° (V61 - MÄ°MARÄ° YENÄ°DEN YAZIM)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        ğŸ”¥ YENÄ° MÄ°MARÄ°: "Ä°lk geleni al" DEÄÄ°L, "En yÃ¼ksek puanlÄ±yÄ± al"!
        
        ADIMLAR:
        1. TÃœM bahis tiplerini tara
        2. ÅartlarÄ± saÄŸlayanlarÄ± ADAY HAVUZU'na at (dinamik puanla)
        3. Havuzu PUANA GÃ–RE SIRALA (descending)
        4. En yÃ¼ksek â†’ BANKO, Ä°kinci â†’ Ä°DEAL, ÃœÃ§Ã¼ncÃ¼ â†’ SÃœRPRÄ°Z
        
        SABÄ°T PUAN YOK! Dinamik hesaplama:
        - Baraj ne kadar aÅŸÄ±ldÄ±ysa puan o kadar yÃ¼ksek (Makas Sistemi)
        """
        
        self._log("BANKO", "ğŸ”„ ADAY HAVUZU algoritmasÄ± baÅŸlatÄ±ldÄ± (V61)")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # 0. VERÄ° OKUMA VE SAFETY CHECK
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        xg_ev = self._get("xg_ev", 0)
        xg_dep = self._get("xg_dep", 0)
        xg = xg_ev + xg_dep
        
        # ğŸš¨ SAFETY CHECK: xG 0 ise veri okunamadÄ± demektir!
        if xg_ev == 0 and xg_dep == 0:
            self._log("HATA", "ğŸš¨ SIFIR VERÄ° TESPÄ°T EDÄ°LDÄ°! xG deÄŸerleri 0.0")
            self._log("HATA", "âš ï¸ GÃ¶rsel okunamadÄ± veya veri eksik - Analiz GÃœVENÄ°LMEZ!")
            # Yine de devam et ama uyar
        
        # Veri al
        ust_35 = self._get("ust_35", 35)
        ust_25 = self._get("ust_25", 55)
        ust_15 = self._get("ust_15", 70)
        ev_atan = self._get("ev_atan_05", 70)
        dep_atan = self._get("dep_atan_05", 70)
        kg_var = self._get("kg_var_ort", 60)
        ev_yenen = self._get("ev_yenen_05", 50)
        dep_yenen = self._get("dep_yenen_05", 50)
        oran = self._get("oran_ms1", 2.0)
        kazanma_ev = self._get("kazanma_ev", 50)
        kazanma_dep = self._get("kazanma_dep", 40)
        conv_ev = self._get("conv_ev", 12)
        conv_dep = self._get("conv_dep", 12)
        iy_ev = self._get("iy_ev_gol", 50)
        iy_dep = self._get("iy_dep_gol", 50)
        ev_yememe = self._get("ev_yememe", 30)
        dep_yememe = self._get("dep_yememe", 30)
        sut_toplam = self._get("sut_ev", 10) + self._get("sut_dep", 10)
        ev_atan_15 = self._get("ev_atan_15", 60)
        dep_atan_15 = self._get("dep_atan_15", 60)
        
        # Hesaplamalar
        gol_ort = (ev_atan + dep_atan) / 2
        hibrit_kg = ((gol_ort) + kg_var) / 2
        yeme_ort = (ev_yenen + dep_yenen) / 2
        iy_ort = (iy_ev + iy_dep) / 2
        conv_ort = (conv_ev + conv_dep) / 2
        
        self._log("BANKO", f"ğŸ“Š Veriler: xG={xg:.2f} GolOrt={gol_ort:.1f}% Hibrit={hibrit_kg:.1f}%")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # 1. VETO KONTROL (Hangi bahisler tamamen kapalÄ±?)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        veto_ust = False
        veto_25 = False
        veto_taraf = False
        veto_kg = False
        
        if ust_25 < 60:  # V70: %60 altÄ± VETO!
            veto_25 = True
            self._log("GÄ°YOTÄ°N", f"[VETO âŒ] V70: 2.5Ãœ %{ust_25} < 60 (BARAJ ALTINDA!)")
        else:
            self._log("GÄ°YOTÄ°N", f"[GEÃ‡TÄ° âœ…] K.18-B: 2.5Ãœ %{ust_25} > 55")
        
        if oran <= 1.35:
            veto_taraf = True
            self._log("GÄ°YOTÄ°N", f"[VETO âŒ] K.SÃœPER-FAVORÄ°: Oran {oran:.2f}")
        
        if ust_25 < 50:
            veto_ust = True
            self._log("GÄ°YOTÄ°N", f"[VETO âŒ] K.KISIR-TABLO: 2.5Ãœ %{ust_25} < 50")
        
        if conv_ort < 10:
            veto_ust = True
            veto_kg = True
            self._log("GÄ°YOTÄ°N", f"[VETO âŒ] K.CONVERSION: Conv %{conv_ort:.1f} < 10")
        
        if ev_yememe >= 50 or dep_yememe >= 50:
            veto_kg = True
            self._log("GÄ°YOTÄ°N", f"[VETO âŒ] K.DUVAR-50: Yememe {ev_yememe}/{dep_yememe}%")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # 2. ADAY HAVUZU OLUÅTUR (Candidate Pool)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        adaylar = []  # [(tip, puan, sebep, guclu), ...]
        
        def dinamik_puan(baraj, deger, base_puan=7):
            """Baraj ne kadar aÅŸÄ±ldÄ±ysa puan o kadar yÃ¼ksek (Makas Sistemi)"""
            if deger >= baraj:
                # Her %5 aÅŸÄ±m = +0.5 puan
                bonus = (deger - baraj) / 10
                return min(10, base_puan + bonus)
            return base_puan - 1  # BarajÄ±n altÄ±nda = dÃ¼ÅŸÃ¼k puan
        
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # MS 3.5 ÃœST
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] MS 3.5 ÃœST ModÃ¼lÃ¼...")
        if not veto_ust and ust_35 >= 45 and xg >= 3.00 and ev_atan >= 90 and dep_atan >= 90:
            puan = dinamik_puan(45, ust_35, 8) + (1 if xg >= 3.50 else 0)
            adaylar.append(("MS 3.5 ÃœST", puan, f"3.5Ãœ:{ust_35}% xG:{xg:.2f}", True))
            self._log("TARAMA", f"[GEÃ‡TÄ° âœ…] MS 3.5 ÃœST (%{ust_35}) â†’ Puan: {puan:.1f}")
        else:
            self._log("TARAMA", f"[KALDI âšª] MS 3.5 ÃœST (3.5Ãœ:%{ust_35} xG:{xg:.2f})")
        
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # MS 2.5 ÃœST
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] MS 2.5 ÃœST ModÃ¼lÃ¼...")
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # MS 2.5 ÃœST - V70: BARAJ %60'A YÃœKSELTÄ°LDÄ°!
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] MS 2.5 ÃœST ModÃ¼lÃ¼...")
        # V70 FIX: %60 altÄ± 2.5 ÃœST BANKO VERÄ°LEMEZ!
        if not veto_ust and not veto_25 and ust_25 >= 60 and ev_atan >= 70 and dep_atan >= 70:
            puan = dinamik_puan(60, ust_25, 7)  # V70: baraj 60
            if xg >= 3.00: puan += 1
            if conv_ort >= 13: puan += 0.5
            adaylar.append(("MS 2.5 ÃœST", puan, f"2.5Ãœ:{ust_25}% xG:{xg:.2f}", True))
            self._log("TARAMA", f"[GEÃ‡TÄ° âœ…] MS 2.5 ÃœST (%{ust_25} >= 60) â†’ Puan: {puan:.1f}")
        elif veto_25:
            self._log("TARAMA", f"[VETO âŒ] MS 2.5 ÃœST (Sebep: K.18-B VETO)")
        elif ust_25 < 60:
            self._log("TARAMA", f"[KALDI âšª] MS 2.5 ÃœST â†’ %{ust_25} < 60 (V70: BARAJ ALTINDA!)")
        else:
            self._log("TARAMA", f"[KALDI âšª] MS 2.5 ÃœST (2.5Ãœ:%{ust_25})")
        
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # KG VAR
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] KG VAR ModÃ¼lÃ¼...")
        if not veto_kg and hibrit_kg >= 65 and ev_atan >= 70 and dep_atan >= 70:
            puan = dinamik_puan(65, hibrit_kg, 7)
            if ev_yenen >= 55 and dep_yenen >= 55: puan += 0.5
            if ev_atan >= 80 and dep_atan >= 80: puan += 0.5
            adaylar.append(("KG VAR", puan, f"Hibrit:{hibrit_kg:.1f}% Atan:{ev_atan}/{dep_atan}%", True))
            self._log("TARAMA", f"[GEÃ‡TÄ° âœ…] KG VAR (Hibrit:%{hibrit_kg:.1f}) â†’ Puan: {puan:.1f}")
        elif veto_kg:
            self._log("TARAMA", f"[VETO âŒ] KG VAR (Sebep: DUVAR-50 veya Conv VETO)")
        else:
            self._log("TARAMA", f"[KALDI âšª] KG VAR (Hibrit:%{hibrit_kg:.1f})")
        
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # MS 1.5 ÃœST
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] MS 1.5 ÃœST ModÃ¼lÃ¼...")
        if not veto_ust and ust_15 >= 70 and ev_atan >= 70 and dep_atan >= 70:
            puan = dinamik_puan(70, ust_15, 6)
            if conv_ort >= 13: puan += 0.5
            adaylar.append(("MS 1.5 ÃœST", puan, f"1.5Ãœ:{ust_15}% Conv:{conv_ort:.1f}%", True))
            self._log("TARAMA", f"[GEÃ‡TÄ° âœ…] MS 1.5 ÃœST (%{ust_15}) â†’ Puan: {puan:.1f}")
        else:
            self._log("TARAMA", f"[KALDI âšª] MS 1.5 ÃœST (1.5Ãœ:%{ust_15})")
        
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # EV 0.5 ÃœST
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] EV 0.5 ÃœST ModÃ¼lÃ¼...")
        if ev_atan >= 80 and dep_yenen >= 49:
            puan = dinamik_puan(80, ev_atan, 6)
            adaylar.append(("EV 0.5 ÃœST", puan, f"EvAtan:{ev_atan}% DepYenen:{dep_yenen}%", True))
            self._log("TARAMA", f"[GEÃ‡TÄ° âœ…] EV 0.5 ÃœST (%{ev_atan}) â†’ Puan: {puan:.1f}")
        else:
            self._log("TARAMA", f"[KALDI âšª] EV 0.5 ÃœST (EvAtan:%{ev_atan})")
        
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # DEP 0.5 ÃœST
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] DEP 0.5 ÃœST ModÃ¼lÃ¼...")
        if dep_atan >= 80 and ev_yenen >= 49:
            puan = dinamik_puan(80, dep_atan, 6)
            adaylar.append(("DEP 0.5 ÃœST", puan, f"DepAtan:{dep_atan}% EvYenen:{ev_yenen}%", True))
            self._log("TARAMA", f"[GEÃ‡TÄ° âœ…] DEP 0.5 ÃœST (%{dep_atan}) â†’ Puan: {puan:.1f}")
        else:
            self._log("TARAMA", f"[KALDI âšª] DEP 0.5 ÃœST (DepAtan:%{dep_atan})")
        
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # EV 1.5 ÃœST
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] EV 1.5 ÃœST ModÃ¼lÃ¼...")
        if ev_atan >= 85 and ev_atan_15 >= 70 and dep_yenen >= 60:
            puan = dinamik_puan(85, ev_atan, 6) + 0.5
            adaylar.append(("EV 1.5 ÃœST", puan, f"Ev:{ev_atan}% Ev1.5:{ev_atan_15}%", True))
            self._log("TARAMA", f"[GEÃ‡TÄ° âœ…] EV 1.5 ÃœST â†’ Puan: {puan:.1f}")
        else:
            self._log("TARAMA", f"[KALDI âšª] EV 1.5 ÃœST")
        
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # Ä°Y 0.5 ÃœST
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] Ä°Y 0.5 ÃœST ModÃ¼lÃ¼...")
        if iy_ort >= 68:
            puan = dinamik_puan(68, iy_ort, 6)
            adaylar.append(("Ä°Y 0.5 ÃœST", puan, f"Ä°Y:{iy_ort:.1f}%", False))
            self._log("TARAMA", f"[GEÃ‡TÄ° âœ…] Ä°Y 0.5 ÃœST (%{iy_ort:.1f}) â†’ Puan: {puan:.1f}")
        else:
            self._log("TARAMA", f"[KALDI âšª] Ä°Y 0.5 ÃœST (Ä°Y:%{iy_ort:.1f})")
        
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # MS TARAF (Son Ã§are)
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] MS TARAF ModÃ¼lÃ¼...")
        if not veto_taraf and kazanma_ev >= 55 and 1.40 <= oran <= 2.20:
            puan = dinamik_puan(55, kazanma_ev, 5)
            adaylar.append(("MS 1", puan, f"Kaz:{kazanma_ev}% Oran:{oran:.2f}", False))
            self._log("TARAMA", f"[GEÃ‡TÄ° âœ…] MS 1 â†’ Puan: {puan:.1f}")
        else:
            self._log("TARAMA", f"[KALDI âšª] MS TARAF")
        
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # MS 2.5 ALT (DÃ¼ÅŸÃ¼k gol maÃ§larÄ± iÃ§in)
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] MS 2.5 ALT ModÃ¼lÃ¼...")
        if xg < 2.00 and sut_toplam < 18 and ev_atan < 65 and dep_atan < 65:
            puan = dinamik_puan(50, 100 - ust_25, 5)  # DÃ¼ÅŸÃ¼k 2.5Ãœ = yÃ¼ksek ALT
            adaylar.append(("MS 2.5 ALT", puan, f"xG:{xg:.2f} 2.5Ãœ:{ust_25}%", False))
            self._log("TARAMA", f"[GEÃ‡TÄ° âœ…] MS 2.5 ALT â†’ Puan: {puan:.1f}")
        else:
            self._log("TARAMA", f"[KALDI âšª] MS 2.5 ALT")
        
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # KG YOK
        # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._log("TARAMA", "[TARANIYOR] KG YOK ModÃ¼lÃ¼...")
        if ev_atan < 65 and dep_atan < 65 and (ev_yenen <= 45 or dep_yenen <= 45):
            puan = dinamik_puan(50, max(ev_yememe, dep_yememe), 5)
            adaylar.append(("KG YOK", puan, f"Atan:{ev_atan}/{dep_atan}% Yememe:{ev_yememe}/{dep_yememe}%", False))
            self._log("TARAMA", f"[GEÃ‡TÄ° âœ…] KG YOK â†’ Puan: {puan:.1f}")
        else:
            self._log("TARAMA", f"[KALDI âšª] KG YOK")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # 3. GÄ°ZLÄ° SIFIR HATASI KONTROLÃœ (LOGIC SAFETY)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        if sut_toplam > 5 and xg == 0.0:
            self._log("UYARI", "ğŸš¨ GÄ°ZLÄ° SIFIR HATASI TESPÄ°T EDÄ°LDÄ°!")
            self._log("UYARI", f"   Åut Toplam: {sut_toplam} > 5 AMA xG: 0.0")
            self._log("UYARI", "   âš ï¸ xG verisi ÅŸut sayÄ±sÄ±na gÃ¶re anormal. Okuma hatasÄ± olabilir, MANUEL KONTROL ET!")
            # UyarÄ± olarak kaydet ama analizi durdurma
            self.uyarilar.append({
                "kural_id": "SIFIR-XG",
                "detay": f"xG=0 ama Åut={sut_toplam}. OCR hatasÄ± olabilir!"
            })
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # 4. HAVUZU PUANA GÃ–RE SIRALA
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        self._log("BANKO", f"ğŸ“‹ ADAY HAVUZU: {len(adaylar)} aday bulundu")
        
        if not adaylar:
            self._log("BANKO", "âš ï¸ HiÃ§bir aday bulunamadÄ± â†’ BANKO YOK")
            return {"tip": "BANKO YOK", "guclu": False, "sebep": "TÃ¼m ÅŸartlar saÄŸlanamadÄ±", "puan": 0}
        
        # PUANA GÃ–RE SIRALA (Descending)
        adaylar.sort(key=lambda x: x[1], reverse=True)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # 5. Ã‡EÅÄ°TLÄ°LÄ°K FÄ°LTRESÄ° (DIVERSITY CHECK) - V62 YENÄ°!
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # AmaÃ§: MatruÅŸka bahisleri engelle (3 farklÄ± senaryo sun)
        
        def get_bahis_ailesi(tip):
            """Bahis tipinin ailesini dÃ¶ndÃ¼r"""
            ust_ailesi = ["MS 3.5 ÃœST", "MS 2.5 ÃœST", "MS 1.5 ÃœST", "EV 1.5 ÃœST", "DEP 1.5 ÃœST", 
                         "EV 0.5 ÃœST", "DEP 0.5 ÃœST", "Ä°Y 1.5 ÃœST", "Ä°Y 0.5 ÃœST"]
            alt_ailesi = ["MS 2.5 ALT", "MS 1.5 ALT", "Ä°Y 0.5 ALT"]
            kg_ailesi = ["KG VAR", "KG YOK"]
            taraf_ailesi = ["MS 1", "MS 2", "MS X", "Ä°Y 1", "Ä°Y 2", "Ä°Y X"]
            
            if tip in ust_ailesi:
                return "ÃœST"
            elif tip in alt_ailesi:
                return "ALT"
            elif tip in kg_ailesi:
                return "KG"
            elif tip in taraf_ailesi:
                return "TARAF"
            else:
                return "DÄ°ÄER"
        
        # BANKO seÃ§ (en yÃ¼ksek puanlÄ±)
        banko = adaylar[0]
        banko_ailesi = get_bahis_ailesi(banko[0])
        
        self._log("BANKO", f"ğŸ¥‡ BANKO: {banko[0]} â†’ {banko[1]:.1f}/10 (Aile: {banko_ailesi})")
        
        # Ä°DEAL seÃ§ (farklÄ± aileden en yÃ¼ksek puanlÄ±)
        ideal = None
        for aday in adaylar[1:]:
            aday_ailesi = get_bahis_ailesi(aday[0])
            if aday_ailesi != banko_ailesi:
                ideal = aday
                self._log("BANKO", f"ğŸ¥ˆ Ä°DEAL: {aday[0]} â†’ {aday[1]:.1f}/10 (Aile: {aday_ailesi}) âœ… FarklÄ± aile!")
                break
        
        if not ideal and len(adaylar) > 1:
            ideal = adaylar[1]  # FarklÄ± aile yoksa 2. sÄ±radaki
            self._log("BANKO", f"ğŸ¥ˆ Ä°DEAL: {ideal[0]} â†’ {ideal[1]:.1f}/10 (AynÄ± aile, alternatif yok)")
        
        # SÃœRPRÄ°Z seÃ§ (hem BANKO hem Ä°DEAL'den farklÄ± aileden)
        surpriz = None
        kullanilan_aileler = {banko_ailesi}
        if ideal:
            kullanilan_aileler.add(get_bahis_ailesi(ideal[0]))
        
        for aday in adaylar[1:]:
            aday_ailesi = get_bahis_ailesi(aday[0])
            if aday_ailesi not in kullanilan_aileler and aday != ideal:
                surpriz = aday
                self._log("BANKO", f"ğŸ¥‰ SÃœRPRÄ°Z: {aday[0]} â†’ {aday[1]:.1f}/10 (Aile: {aday_ailesi}) âœ… FarklÄ± aile!")
                break
        
        if not surpriz and len(adaylar) > 2:
            # FarklÄ± aile yoksa en dÃ¼ÅŸÃ¼k riskli olanÄ± seÃ§
            for aday in adaylar[2:]:
                if aday != ideal:
                    surpriz = aday
                    self._log("BANKO", f"ğŸ¥‰ SÃœRPRÄ°Z: {aday[0]} â†’ {aday[1]:.1f}/10 (Alternatif)")
                    break
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # 6. SONUÃ‡LARI KAYDET
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        self.ideal = ideal
        self.surpriz = surpriz
        self.aday_havuzu = adaylar
        
        # Ã–zet logla
        self._log("BANKO", "")
        self._log("BANKO", "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
        self._log("BANKO", "â•‘           ğŸ¯ V62 Ã‡EÅÄ°TLÄ°LÄ°K FÄ°LTRESÄ° SONUCU                   â•‘")
        self._log("BANKO", "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
        self._log("BANKO", f"â•‘  ğŸ¥‡ BANKO   : {banko[0]:15} â†’ {banko[1]:.1f}/10 ({banko_ailesi:6})     â•‘")
        if ideal:
            self._log("BANKO", f"â•‘  ğŸ¥ˆ Ä°DEAL   : {ideal[0]:15} â†’ {ideal[1]:.1f}/10 ({get_bahis_ailesi(ideal[0]):6})     â•‘")
        if surpriz:
            self._log("BANKO", f"â•‘  ğŸ¥‰ SÃœRPRÄ°Z : {surpriz[0]:15} â†’ {surpriz[1]:.1f}/10 ({get_bahis_ailesi(surpriz[0]):6})     â•‘")
        self._log("BANKO", "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
        
        return {
            "tip": banko[0], 
            "guclu": banko[3], 
            "sebep": banko[2],
            "puan": banko[1]
        }

class HesaplamaMotoru:
    """
    TÃ¼m matematiksel hesaplamalarÄ± yapan motor.
    Gemini'den gelen OCR verilerini alÄ±r, tÃ¼m formÃ¼lleri uygular, VETO kontrolÃ¼ yapar.
    """
    
    def __init__(self):
        self.veto_listesi = []
        self.gecen_bankolar = []
        self.tarama_raporu = {}
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 2: HESAPLAMA FORMÃœLLERÄ° (9 FORMÃœL)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def hesapla_gol_ort(self, ev_atan_05, dep_atan_05):
        """GOL ORT: (Ev AtÄ±lan 0.5Ãœ + Dep AtÄ±lan 0.5Ãœ) / 2"""
        return (float(ev_atan_05) + float(dep_atan_05)) / 2
    
    def hesapla_gol_yeme_ort(self, ev_yenen_05, dep_yenen_05):
        """GOL YEME ORT: (Ev Yenen 0.5Ãœ + Dep Yenen 0.5Ãœ) / 2"""
        return (float(ev_yenen_05) + float(dep_yenen_05)) / 2
    
    def hesapla_iy_gol_degeri(self, ev_iy, dep_iy):
        """Ä°Y GOL DEÄERÄ°: (Ev Ä°Y AtÄ±lan + Dep Ä°Y AtÄ±lan) / 2"""
        return (float(ev_iy) + float(dep_iy)) / 2
    
    def hesapla_hibrit_kg(self, ev_atan_05, dep_atan_05, kg_var_ort):
        """HÄ°BRÄ°T KG VAR: (((Ev 0.5Ãœ + Dep 0.5Ãœ) / 2) + KG VAR Ort) / 2"""
        gol_pot = (float(ev_atan_05) + float(dep_atan_05)) / 2
        return (gol_pot + float(kg_var_ort)) / 2
    
    def hesapla_sut_donusum(self, gol, toplam_sut):
        """ÅUT DÃ–NÃœÅÃœM: (Gol / Toplam Åut) * 100"""
        if float(toplam_sut) == 0:
            return 0
        return (float(gol) / float(toplam_sut)) * 100
    
    def hesapla_tahmini_rcs(self, csi_sut, korner):
        """TAHMÄ°NÄ° RCS: (CSÄ° Åut * 3) + Korner"""
        return (float(csi_sut) * 3) + float(korner)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 3: TÄ°K Ä°ÅARETÄ° KONTROL (6 KURAL)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def tik_kontrol(self, deger, tip):
        """Baraj kontrolÃ¼ - Tik iÅŸareti ver veya verme"""
        barajlar = {
            "iy_gol": 80,
            "ms_05": 85,
            "ms_15": 75,
            "ms_25": 65,
            "ms_35": 50,
            "yuzde_100": 100
        }
        baraj = barajlar.get(tip, 50)
        return "âœ…" if float(deger) >= baraj else "âŒ"
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 4: GÄ°YOTÄ°N VE VETO KONTROL (58 KURAL)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def giyotin_kontrol(self, veri):
        """A Grubu GÄ°YOTÄ°N - Analiz Ã¶ncesi zorunlu kontrol"""
        vetolar = []
        
        # 1. LÄ°G KONTROLÃœ
        lig = veri.get("lig", "").lower()
        alt_lig_keywords = ["u19", "u21", "genÃ§lik", "kadÄ±n", "rezerv", "amatÃ¶r"]
        if any(k in lig for k in alt_lig_keywords):
            vetolar.append({"id": "LÄ°G-KONTROLÃœ", "mesaj": "Alt Lig - BANKO YASAK", "seviye": "KRITIK"})
        
        # 2. K.100 - %100 seri kontrolÃ¼
        seri = float(veri.get("seri_kazanma", 0))
        xg = float(veri.get("xg_ev", 0)) + float(veri.get("xg_dep", 0))
        if seri >= 100 and xg < 1.50:
            vetolar.append({"id": "K.100", "mesaj": "%100 seri + xG<1.50 - SAHTE SERÄ°!", "seviye": "KRITIK"})
        
        # 3. K.CONVERSION
        conv_ev = float(veri.get("conv_ev", 0))
        conv_dep = float(veri.get("conv_dep", 0))
        if conv_ev < 10 and conv_dep < 10:
            vetolar.append({"id": "K.CONVERSION", "mesaj": "Ä°ki takÄ±m Conv <%10 - GOL BAHÄ°SÄ° YASAK", "seviye": "KRITIK"})
        
        # 4. K.AYNA
        rakip_yememe = float(veri.get("dep_yememe", 0))
        if rakip_yememe > 60:
            vetolar.append({"id": "K.AYNA", "mesaj": f"Rakip Yememe %{rakip_yememe} - ÃœST/KG YASAK", "seviye": "YUKSEK"})
        
        # 5. K.KALÄ°TE-KONTROL
        if conv_ev < 13 and conv_dep < 13:
            vetolar.append({"id": "K.KALÄ°TE-KONTROL", "mesaj": "Ä°ki takÄ±m Conv <%13 - ÃœST/KG DÄ°KKAT", "seviye": "ORTA"})
        
        # 6. K.DUVAR-50
        ev_cs = float(veri.get("ev_yememe", 0))
        dep_cs = float(veri.get("dep_yememe", 0))
        if ev_cs >= 50 or dep_cs >= 50:
            vetolar.append({"id": "K.DUVAR-50", "mesaj": "Clean Sheet â‰¥%50 - TAKIM GOLÃœ/KG YASAK", "seviye": "KRITIK"})
        
        return vetolar
    
    def sayisal_veto_kontrol(self, veri):
        """B Grubu SAYISAL VETOLAR - 44 kural"""
        vetolar = []
        
        # K.KARAVANA - Ä°sabet kontrolÃ¼
        isabet_oran = float(veri.get("isabet_oran", 100))
        if isabet_oran < 30:
            vetolar.append({"id": "K.KARAVANA", "mesaj": f"Ä°sabet %{isabet_oran} - GOL ATAR YASAK", "tip": "GOL"})
        
        # K.GOL-SÄ°GORTASI
        atamama = float(veri.get("atamama_oran", 0))
        if atamama > 20:
            vetolar.append({"id": "K.GOL-SÄ°GORTASI", "mesaj": f"Atamama %{atamama} - GOL BANKO YASAK", "tip": "GOL"})
        
        # K.KALE-KÄ°LÄ°DÄ°
        rakip_yememe = float(veri.get("dep_yememe", 0))
        if rakip_yememe > 33:
            vetolar.append({"id": "K.KALE-KÄ°LÄ°DÄ°", "mesaj": f"Rakip Yememe %{rakip_yememe} - ÃœST/KG DÄ°KKAT", "tip": "UST"})
        
        # K.41 - Gol ortalamasÄ± (xG toplamÄ± kullanÄ±lÄ±r)
        xg_toplam = float(veri.get("xg_ev", 0)) + float(veri.get("xg_dep", 0))
        if xg_toplam < 2.50 and xg_toplam > 0:
            vetolar.append({"id": "K.41", "mesaj": f"xG Toplam {xg_toplam:.2f} < 2.50 - BANKO ÃœST DÄ°KKAT", "tip": "UST"})
        
        # K.SÃœPER-FAVORÄ° (1.35 KURALI)
        oran = float(veri.get("oran", 2.0))
        if oran <= 1.35:
            vetolar.append({"id": "K.SÃœPER-FAVORÄ°", "mesaj": f"Oran {oran} - MS YASAK, sadece GOL", "tip": "TARAF"})
        
        # K.KEVGÄ°R-FAVORÄ°
        favori_yeme = float(veri.get("favori_yeme", 0))
        if favori_yeme > 60:
            vetolar.append({"id": "K.KEVGÄ°R-FAVORÄ°", "mesaj": f"Favori Yeme %{favori_yeme} - KG YOK YASAK", "tip": "KG"})
        
        # K.KISIR-7
        conv = max(float(veri.get("conv_ev", 0)), float(veri.get("conv_dep", 0)))
        if conv <= 7:
            vetolar.append({"id": "K.KISIR-7", "mesaj": f"Conv %{conv} - 2.5Ãœ/KG YASAK", "tip": "UST"})
        
        # K.DUVAR-80
        max_cs = max(float(veri.get("ev_yememe", 0)), float(veri.get("dep_yememe", 0)))
        if max_cs >= 75:
            vetolar.append({"id": "K.DUVAR-80", "mesaj": f"CS %{max_cs} - BANKO KG/ÃœST YASAK", "tip": "UST"})
        
        # K.CONVERSION-BARAJI
        favori_conv = float(veri.get("favori_conv", 0))
        if favori_conv < 12:
            vetolar.append({"id": "K.CONVERSION-BARAJI", "mesaj": f"Favori Conv %{favori_conv} - MS TARAF YASAK", "tip": "TARAF"})
        
        # K.KISIRLIK-VETO
        if atamama >= 25:
            vetolar.append({"id": "K.KISIRLIK-VETO", "mesaj": f"Atamama %{atamama} - TAKIM GOLÃœ YASAK", "tip": "GOL"})
        
        # K.NEKRO
        kazanamama = int(veri.get("kazanamama_serisi", 0))
        if kazanamama >= 8:
            vetolar.append({"id": "K.NEKRO", "mesaj": f"{kazanamama} maÃ§tÄ±r kazanamÄ±yor - FAVORÄ° YASAK", "tip": "TARAF"})
        
        # K.ERKEN-FÄ°ÅEK - Ä°Y gol ortalamasÄ±
        iy_ev = float(veri.get("iy_ev", 0))
        iy_dep = float(veri.get("iy_dep", 0))
        iy_gol_ort = (iy_ev + iy_dep) / 2 if (iy_ev > 0 or iy_dep > 0) else float(veri.get("iy_gol_ort", 50))
        if iy_gol_ort < 40 and iy_gol_ort > 0:
            vetolar.append({"id": "K.ERKEN-FÄ°ÅEK", "mesaj": f"Ä°Y Gol %{iy_gol_ort:.0f} - Ä°Y BANKO YASAK", "tip": "IY"})
        
        return vetolar
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 5: BANKO ÅARTLARI KONTROL (11 BANKO TÄ°PÄ°)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def kontrol_35_ust(self, veri):
        """MS 3.5 ÃœST kontrolÃ¼"""
        ust_35 = float(veri.get("ust_35", 0))
        xg = float(veri.get("xg_ev", 0)) + float(veri.get("xg_dep", 0))
        ev_atan = float(veri.get("ev_atan", 0))
        dep_atan = float(veri.get("dep_atan", 0))
        ev_yenen = float(veri.get("ev_yenen", 0))
        dep_yenen = float(veri.get("dep_yenen", 0))
        
        # 4 ÅŸart kontrolÃ¼
        sart1 = ust_35 >= 45
        sart2 = xg >= 3.00
        sart3 = ev_atan >= 90 and dep_atan >= 90
        sart4 = ev_yenen >= 50 and dep_yenen >= 50
        
        gecti = sart1 and sart2 and sart3 and sart4
        return {"gecti": gecti, "puan": ust_35, "tip": "3.5 ÃœST"}
    
    def kontrol_25_ust(self, veri):
        """MS 2.5 ÃœST kontrolÃ¼ (Ä°KÄ° YOL)"""
        ust_25 = float(veri.get("ust_25", 0))
        xg = float(veri.get("xg_ev", 0)) + float(veri.get("xg_dep", 0))
        ev_atan = float(veri.get("ev_atan", 0))
        dep_atan = float(veri.get("dep_atan", 0))
        toplam_sut = float(veri.get("sut_toplam", 0))
        conv = max(float(veri.get("conv_ev", 0)), float(veri.get("conv_dep", 0)))
        
        # YOL A: Tablo BazlÄ±
        yol_a = ust_25 >= 62 and xg >= 3.20 and ev_atan >= 80 and dep_atan >= 80
        
        # YOL B: Saha BazlÄ± (K.18)
        yol_b = xg >= 2.70 and toplam_sut >= 18 and conv >= 12 and ev_atan >= 70 and dep_atan >= 70
        
        gecti = yol_a or yol_b
        return {"gecti": gecti, "puan": ust_25, "tip": "2.5 ÃœST", "yol": "A" if yol_a else "B" if yol_b else None}
    
    def kontrol_kg_var(self, veri):
        """KG VAR kontrolÃ¼"""
        kg_var = float(veri.get("kg_var", 0))
        ev_atan = float(veri.get("ev_atan", 0))
        dep_atan = float(veri.get("dep_atan", 0))
        ev_yenen = float(veri.get("ev_yenen", 0))
        dep_yenen = float(veri.get("dep_yenen", 0))
        
        # 3 ÅŸart kontrolÃ¼
        sart1 = kg_var >= 55
        sart2 = ev_atan >= 70 and dep_atan >= 70
        sart3 = ev_yenen >= 55 and dep_yenen >= 55
        
        gecti = sart1 and sart2 and sart3
        return {"gecti": gecti, "puan": kg_var, "tip": "KG VAR"}
    
    def kontrol_15_ust(self, veri):
        """MS 1.5 ÃœST kontrolÃ¼"""
        ust_15 = float(veri.get("ust_15", 0))
        ev_atan = float(veri.get("ev_atan", 0))
        dep_atan = float(veri.get("dep_atan", 0))
        conv = max(float(veri.get("conv_ev", 0)), float(veri.get("conv_dep", 0)))
        
        gecti = ust_15 >= 70 and conv >= 10 and ev_atan >= 70 and dep_atan >= 70
        return {"gecti": gecti, "puan": ust_15, "tip": "1.5 ÃœST"}
    
    def kontrol_takim_15(self, veri, takim="ev"):
        """TAKIM 1.5 ÃœST kontrolÃ¼"""
        if takim == "ev":
            atan_05 = float(veri.get("ev_atan", 0))
            atan_15 = float(veri.get("ev_gol_15", 0))
            rakip_yeme = float(veri.get("dep_yenen", 0))
        else:
            atan_05 = float(veri.get("dep_atan", 0))
            atan_15 = float(veri.get("dep_gol_15", 0))
            rakip_yeme = float(veri.get("ev_yenen", 0))
        
        # Åartlar: 0.5Ãœ â‰¥%80, 1.5Ãœ â‰¥%65, Rakip Yeme â‰¥%55
        gecti = atan_05 >= 80 and atan_15 >= 65 and rakip_yeme >= 55
        return {"gecti": gecti, "puan": atan_15, "tip": f"{'EV' if takim == 'ev' else 'DEP'} 1.5 ÃœST"}
    
    def kontrol_takim_05(self, veri, takim="ev"):
        """TAKIM 0.5 ÃœST kontrolÃ¼"""
        if takim == "ev":
            atan = float(veri.get("ev_atan", 0))
            rakip_yeme = float(veri.get("dep_yenen", 0))
        else:
            atan = float(veri.get("dep_atan", 0))
            rakip_yeme = float(veri.get("ev_yenen", 0))
        
        # Åartlar: 0.5Ãœ â‰¥%75, Rakip Yeme â‰¥%45
        gecti = atan >= 75 and rakip_yeme >= 45
        return {"gecti": gecti, "puan": atan, "tip": f"{'EV' if takim == 'ev' else 'DEP'} 0.5 ÃœST"}
    
    def kontrol_ms_taraf(self, veri):
        """MS TARAF kontrolÃ¼"""
        oran = float(veri.get("oran", 2.0))
        kazanma = float(veri.get("kazanma_yuzde", 0))
        conv = float(veri.get("favori_conv", 0))
        favori_yeme = float(veri.get("favori_yeme", 0))
        
        # 4 ÅŸart kontrolÃ¼
        sart1 = 1.36 <= oran <= 2.20
        sart2 = kazanma >= 55
        sart3 = conv >= 12
        sart4 = favori_yeme < 1.20  # Ortalama yediÄŸi gol
        
        gecti = sart1 and sart2 and sart3 and sart4
        return {"gecti": gecti, "puan": kazanma, "tip": "MS TARAF"}
    
    def kontrol_25_alt(self, veri):
        """2.5 ALT kontrolÃ¼"""
        xg = float(veri.get("xg_ev", 0)) + float(veri.get("xg_dep", 0))
        toplam_sut = float(veri.get("sut_toplam", 0))
        ev_atan = float(veri.get("ev_atan", 0))
        dep_atan = float(veri.get("dep_atan", 0))
        
        gecti = xg < 2.00 and toplam_sut < 18 and ev_atan < 65 and dep_atan < 65
        return {"gecti": gecti, "puan": 100 - ((ev_atan + dep_atan) / 2), "tip": "2.5 ALT"}
    
    def kontrol_kg_yok(self, veri):
        """KG YOK kontrolÃ¼"""
        ev_atan = float(veri.get("ev_atan", 0))
        dep_atan = float(veri.get("dep_atan", 0))
        ev_yenen = float(veri.get("ev_yenen", 0))
        dep_yenen = float(veri.get("dep_yenen", 0))
        kg_var = float(veri.get("kg_var", 50))
        
        gecti = ev_atan < 65 and dep_atan < 65 and (ev_yenen <= 40 or dep_yenen <= 40)
        return {"gecti": gecti, "puan": 100 - kg_var, "tip": "KG YOK"}
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 8: Ä°Y RADAR KONTROL (3 KURAL)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def iy_radar_kontrol(self, veri):
        """Ä°Y Radar - TEK TABANCA dahil"""
        ev_iy = float(veri.get("iy_ev", 0))
        dep_iy = float(veri.get("iy_dep", 0))
        lig_gol_ort = float(veri.get("lig_gol_ort", 2.5))
        
        ortalama = (ev_iy + dep_iy) / 2
        
        # TEK TABANCA Ä°STÄ°SNASI
        if ev_iy >= 90 or dep_iy >= 90:
            return {
                "karar": "GÄ°R! âœ…",
                "puan": max(ev_iy, dep_iy),
                "sebep": f"TEK TABANCA: {'Ev' if ev_iy >= 90 else 'Dep'} %{max(ev_iy, dep_iy):.0f}",
                "strateji": "MaÃ§ Ã¶nÃ¼ deÄŸil, DAKÄ°KA 10-20'de canlÄ± gir!"
            }
        
        # LÄ°G Ä°STÄ°SNASI
        baraj = 68 if lig_gol_ort >= 2.80 else 70
        
        if ortalama >= baraj:
            return {
                "karar": "GÄ°R! âœ…",
                "puan": ortalama,
                "sebep": f"Ortalama %{ortalama:.0f} (Baraj: %{baraj})",
                "strateji": "MaÃ§ Ã¶nÃ¼ deÄŸil, DAKÄ°KA 10-20'de canlÄ± gir!"
            }
        else:
            return {
                "karar": "GÄ°RME! âŒ",
                "puan": ortalama,
                "sebep": f"Ortalama %{ortalama:.0f} < Baraj %{baraj}",
                "strateji": "Ä°Y 0.5 ÃœST riskli, PAS geÃ§"
            }
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 9: SÄ°MÃœLASYON DÃ–NGÃœSÃœ (FULL SCAN)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def simulasyon_dongusu(self, veri):
        """Tam tarama - 11 bahis tipi sÄ±rayla kontrol"""
        sonuclar = {}
        gecenler = []
        
        # POZÄ°TÄ°F BAHÄ°SLER
        sonuclar["3.5_ust"] = self.kontrol_35_ust(veri)
        if sonuclar["3.5_ust"]["gecti"]:
            gecenler.append({"tip": "3.5 ÃœST", "puan": sonuclar["3.5_ust"]["puan"], "oncelik": 1})
        
        sonuclar["2.5_ust"] = self.kontrol_25_ust(veri)
        if sonuclar["2.5_ust"]["gecti"]:
            gecenler.append({"tip": "2.5 ÃœST", "puan": sonuclar["2.5_ust"]["puan"], "oncelik": 2})
        
        sonuclar["kg_var"] = self.kontrol_kg_var(veri)
        if sonuclar["kg_var"]["gecti"]:
            gecenler.append({"tip": "KG VAR", "puan": sonuclar["kg_var"]["puan"], "oncelik": 3})
        
        sonuclar["ms_taraf"] = self.kontrol_ms_taraf(veri)
        if sonuclar["ms_taraf"]["gecti"]:
            gecenler.append({"tip": "MS TARAF", "puan": sonuclar["ms_taraf"]["puan"], "oncelik": 4})
        
        sonuclar["takim_15_ev"] = self.kontrol_takim_15(veri, "ev")
        if sonuclar["takim_15_ev"]["gecti"]:
            gecenler.append({"tip": "EV 1.5 ÃœST", "puan": sonuclar["takim_15_ev"]["puan"], "oncelik": 5})
        
        sonuclar["takim_15_dep"] = self.kontrol_takim_15(veri, "dep")
        if sonuclar["takim_15_dep"]["gecti"]:
            gecenler.append({"tip": "DEP 1.5 ÃœST", "puan": sonuclar["takim_15_dep"]["puan"], "oncelik": 5})
        
        # GÃœVENLÄ° LÄ°MANLAR
        sonuclar["1.5_ust"] = self.kontrol_15_ust(veri)
        if sonuclar["1.5_ust"]["gecti"]:
            gecenler.append({"tip": "1.5 ÃœST", "puan": sonuclar["1.5_ust"]["puan"], "oncelik": 6})
        
        sonuclar["takim_05_ev"] = self.kontrol_takim_05(veri, "ev")
        if sonuclar["takim_05_ev"]["gecti"]:
            gecenler.append({"tip": "EV 0.5 ÃœST", "puan": sonuclar["takim_05_ev"]["puan"], "oncelik": 7})
        
        sonuclar["takim_05_dep"] = self.kontrol_takim_05(veri, "dep")
        if sonuclar["takim_05_dep"]["gecti"]:
            gecenler.append({"tip": "DEP 0.5 ÃœST", "puan": sonuclar["takim_05_dep"]["puan"], "oncelik": 7})
        
        # NEGATÄ°F BAHÄ°SLER (Sadece pozitifler kalmazsa)
        if not gecenler:
            sonuclar["2.5_alt"] = self.kontrol_25_alt(veri)
            if sonuclar["2.5_alt"]["gecti"]:
                gecenler.append({"tip": "2.5 ALT", "puan": sonuclar["2.5_alt"]["puan"], "oncelik": 10})
            
            sonuclar["kg_yok"] = self.kontrol_kg_yok(veri)
            if sonuclar["kg_yok"]["gecti"]:
                gecenler.append({"tip": "KG YOK", "puan": sonuclar["kg_yok"]["puan"], "oncelik": 11})
        
        # SEÃ‡Ä°M ALGORÄ°TMASI
        nihai_banko = self.secim_algoritmasi(gecenler, veri)
        
        # K.SON-DAMLA KURTARICI
        if not nihai_banko:
            nihai_banko = self.son_damla_kurtarici(veri)
        
        return {
            "tarama_sonuclari": sonuclar,
            "gecenler": gecenler,
            "nihai_banko": nihai_banko
        }
    
    def secim_algoritmasi(self, gecenler, veri):
        """Birden fazla geÃ§en varsa nihai seÃ§im"""
        if not gecenler:
            return None
        
        if len(gecenler) == 1:
            return gecenler[0]["tip"]
        
        oran = float(veri.get("oran", 1.5))
        gecen_tipler = [g["tip"] for g in gecenler]
        
        # ALTIN ORAN KURALI
        if "2.5 ÃœST" in gecen_tipler and "KG VAR" in gecen_tipler:
            if 1.45 <= oran <= 1.65:
                return "2.5 ÃœST"  # Oran uygun, 2.5Ãœ tercih
        
        # GÃœVENLÄ°K Ã–NCELÄ°ÄÄ°
        if "MS TARAF" in gecen_tipler and any("1.5 ÃœST" in t for t in gecen_tipler):
            for g in gecenler:
                if "1.5 ÃœST" in g["tip"]:
                    return g["tip"]  # TakÄ±m golÃ¼ daha gÃ¼venli
        
        # YÃœZDE FARKI (En yÃ¼ksek puan)
        gecenler_sorted = sorted(gecenler, key=lambda x: x["puan"], reverse=True)
        return gecenler_sorted[0]["tip"]
    
    def son_damla_kurtarici(self, veri):
        """K.SON-DAMLA: KurtarÄ±cÄ± seÃ§enekler"""
        ev_atan = float(veri.get("ev_atan", 0))
        dep_atan = float(veri.get("dep_atan", 0))
        ust_15 = float(veri.get("ust_15", 0))
        iy_ort = float(veri.get("iy_gol_ort", 0))
        lig_gol_ort = float(veri.get("lig_gol_ort", 2.5))
        
        # 1. MS 1.5 ÃœST
        if ust_15 >= 80:
            return "MS 1.5 ÃœST (KurtarÄ±cÄ±)"
        
        # 2. EV/DEP 0.5 ÃœST
        if ev_atan >= 80:
            return "EV 0.5 ÃœST (KurtarÄ±cÄ±)"
        if dep_atan >= 80:
            return "DEP 0.5 ÃœST (KurtarÄ±cÄ±)"
        
        # 3. Ä°Y 0.5 ÃœST
        if lig_gol_ort >= 2.80 and iy_ort >= 65:
            return "Ä°Y 0.5 ÃœST (KurtarÄ±cÄ±)"
        
        return "PAS GEÃ‡ (NO BET)"
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 10: GÃœVEN PUANI VE KASA YÃ–NETÄ°MÄ°
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def guven_puani_hesapla(self, veri, bahis_tipi):
        """MAKAS ALGORÄ°TMASI ile gÃ¼ven puanÄ± hesaplama"""
        puan = 5  # BaÅŸlangÄ±Ã§
        
        ortalama = float(veri.get("ust_25", 0))
        xg = float(veri.get("xg_ev", 0)) + float(veri.get("xg_dep", 0))
        kazanma = float(veri.get("kazanma_yuzde", 0))
        toplam_sut = float(veri.get("sut_toplam", 0))
        lig = veri.get("lig", "").lower()
        
        bahis_upper = bahis_tipi.upper()
        
        # TAKIM GOLÃœ BAHÄ°SLERÄ° (EV/DEP 0.5Ãœ veya 1.5Ãœ)
        if "EV 0.5" in bahis_upper or "EV 1.5" in bahis_upper:
            takim_oran = float(veri.get("ev_atan", 0))
            if takim_oran >= 90:
                puan = 10
            elif 85 <= takim_oran < 90:
                puan = 9
            elif 80 <= takim_oran < 85:
                puan = 8
            elif 75 <= takim_oran < 80:
                puan = 7
            elif 65 <= takim_oran < 75:
                puan = 6
        
        elif "DEP 0.5" in bahis_upper or "DEP 1.5" in bahis_upper:
            takim_oran = float(veri.get("dep_atan", 0))
            if takim_oran >= 90:
                puan = 10
            elif 85 <= takim_oran < 90:
                puan = 9
            elif 80 <= takim_oran < 85:
                puan = 8
            elif 75 <= takim_oran < 80:
                puan = 7
            elif 65 <= takim_oran < 75:
                puan = 6
        
        # MS GOL BAHÄ°SLERÄ° (2.5Ãœ, 3.5Ãœ, 1.5Ãœ, KG VAR)
        elif any(t in bahis_upper for t in ["2.5", "3.5", "1.5 ÃœST", "KG VAR"]):
            if ortalama >= 90 and xg >= 3.50:
                puan = 10  # ELÄ°T
            elif 80 <= ortalama < 90:
                puan = 9
            elif 75 <= ortalama < 80:
                puan = 8
            elif 70 <= ortalama < 75:
                puan = 7
            elif 60 <= ortalama < 70:
                puan = 6
        
        # ALT BAHÄ°SLERÄ° (dÃ¼ÅŸÃ¼k=yÃ¼ksek puan)
        elif any(t in bahis_upper for t in ["ALT", "KG YOK"]):
            if ortalama < 35 and toplam_sut < 14:
                puan = 10
            elif 35 <= ortalama < 45:
                puan = 9
            elif 45 <= ortalama < 50:
                puan = 8
            else:
                puan = 6
        
        # TARAF BAHÄ°SLERÄ°
        elif any(t in bahis_upper for t in ["MS 1", "MS 2", "MS1", "MS2", "KAZANIR", "TARAF"]):
            puan_farki = float(veri.get("puan_farki", 0))
            if kazanma >= 85 and puan_farki >= 10:
                puan = 10
            elif 75 <= kazanma < 85:
                puan = 9
            elif 65 <= kazanma < 75:
                puan = 8
            elif 55 <= kazanma < 65:
                puan = 7
            else:
                puan = 6
        
        # Ä°Y BAHÄ°SLERÄ° (MAX 7/10)
        elif "Ä°Y" in bahis_upper or "IY" in bahis_upper:
            iy_ev = float(veri.get("iy_ev", 0))
            iy_dep = float(veri.get("iy_dep", 0))
            iy_ort = (iy_ev + iy_dep) / 2
            if iy_ort >= 90 or iy_ev >= 90 or iy_dep >= 90:
                puan = 7  # MAX 7/10
            elif iy_ort >= 80:
                puan = 6
            else:
                puan = 5
        
        # V70 FIX: LÄ°G CEZASI KALDIRILDI!
        # ArtÄ±k lig bazlÄ± kesinti yapÄ±lmÄ±yor
        # (Eski kod yorum satÄ±rÄ± olarak kalÄ±yor referans iÃ§in)
        # elit_mi = any(elit.lower() in lig for elit in ELIT_LIGLER)
        # if not elit_mi:
        #     puan = max(5, puan - 1)
        
        return puan
    
    def kasa_orani_getir(self, guven_puani):
        """GÃ¼ven puanÄ±na gÃ¶re kasa oranÄ±"""
        return KASA_ORANLARI.get(guven_puani, {"oran": 5})["oran"]
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # BÃ–LÃœM 12: YAPAY ZEKA GOL Ã–NGÃ–RÃœSÃœ
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def yapay_zeka_gol_ongorusu(self, veri):
        """Ã‡apraz eÅŸleÅŸme ile gol Ã¶ngÃ¶rÃ¼sÃ¼"""
        ev_atan = float(veri.get("ev_atan", 0))
        dep_atan = float(veri.get("dep_atan", 0))
        ev_yenen = float(veri.get("ev_yenen", 0))
        dep_yenen = float(veri.get("dep_yenen", 0))
        ev_atan_15 = float(veri.get("ev_gol_15", 0))
        dep_atan_15 = float(veri.get("dep_gol_15", 0))
        ev_yenen_15 = float(veri.get("ev_yeme_15", 0))
        dep_yenen_15 = float(veri.get("dep_yeme_15", 0))
        
        ev_takimi = veri.get("ev_takimi", "Ev")
        dep_takimi = veri.get("dep_takimi", "Dep")
        
        # 0.5 ÃœST ANALÄ°ZÄ°
        ev_gol_ihtimali = (ev_atan + dep_yenen) / 2
        dep_gol_ihtimali = (dep_atan + ev_yenen) / 2
        toplam_05 = (ev_gol_ihtimali + dep_gol_ihtimali) / 2
        
        if ev_gol_ihtimali > dep_gol_ihtimali + 10:
            gol_yonu = f"{ev_takimi} ATAR"
        elif dep_gol_ihtimali > ev_gol_ihtimali + 10:
            gol_yonu = f"{dep_takimi} ATAR"
        else:
            gol_yonu = "Ä°KÄ° TARAF DA GOL BULABÄ°LÄ°R"
        
        # 1.5 ÃœST ANALÄ°ZÄ°
        ev_15_ihtimal = (ev_atan_15 + dep_yenen_15) / 2
        dep_15_ihtimal = (dep_atan_15 + ev_yenen_15) / 2
        toplam_15 = (ev_15_ihtimal + dep_15_ihtimal) / 2
        
        surpriz = None
        if dep_yenen_15 >= 70 and ev_atan_15 < 50:
            surpriz = f"âš ï¸ {dep_takimi} Ã§ok yiyor, {ev_takimi} gol bulabilir!"
        elif ev_yenen_15 >= 70 and dep_atan_15 < 50:
            surpriz = f"âš ï¸ {ev_takimi} Ã§ok yiyor, {dep_takimi} gol bulabilir!"
        
        return {
            "0.5_ust": {
                "ihtimal": toplam_05,
                "yon": gol_yonu,
                "karar": "BANKO" if toplam_05 >= 85 else "YÃ¼ksek" if toplam_05 >= 70 else "Orta" if toplam_05 >= 55 else "DÃ¼ÅŸÃ¼k"
            },
            "1.5_ust": {
                "ihtimal": toplam_15,
                "karar": "YÃ¼ksek" if toplam_15 >= 70 else "Orta" if toplam_15 >= 55 else "DÃ¼ÅŸÃ¼k",
                "surpriz": surpriz
            }
        }
    
    def canli_tetikleyici(self, veri):
        """MaÃ§ iÃ§i fÄ±rsat senaryolarÄ±"""
        tetikler = []
        
        ev_atan = float(veri.get("ev_atan", 0))
        dep_atan = float(veri.get("dep_atan", 0))
        iy_ort = float(veri.get("iy_gol_ort", 0))
        
        ev_takimi = veri.get("ev_takimi", "Ev")
        dep_takimi = veri.get("dep_takimi", "Dep")
        
        if iy_ort >= 80:
            tetikler.append({
                "senaryo": "Ä°lk 20 dk gol olmazsa",
                "aksiyon": f"â†’ CanlÄ± Ä°Y 0.5Ãœ al (istatistik %{iy_ort:.0f})"
            })
        
        if ev_atan >= 80:
            tetikler.append({
                "senaryo": f"{ev_takimi} geriye dÃ¼ÅŸerse",
                "aksiyon": f"â†’ {ev_takimi} 0.5Ãœ dene"
            })
        
        if dep_atan >= 80:
            tetikler.append({
                "senaryo": f"{dep_takimi} geriye dÃ¼ÅŸerse",
                "aksiyon": f"â†’ {dep_takimi} 0.5Ãœ dene"
            })
        
        tetikler.append({
            "senaryo": "âš ï¸ KIRMIZI KART Ã‡IKARSA",
            "aksiyon": "â†’ TÃœM PLANLAR Ä°PTAL"
        })
        
        return tetikler
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ANA TAM ANALÄ°Z FONKSÄ°YONU
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def tam_analiz(self, veri):
        """TÃ¼m 275 kuralÄ± uygulayan ana analiz fonksiyonu"""
        
        # 1. GÄ°YOTÄ°N KONTROL
        giyotin_vetolar = self.giyotin_kontrol(veri)
        sayisal_vetolar = self.sayisal_veto_kontrol(veri)
        tum_vetolar = giyotin_vetolar + sayisal_vetolar
        
        # 2. HESAPLAMALAR
        gol_ort = self.hesapla_gol_ort(
            veri.get("ev_atan", 0), 
            veri.get("dep_atan", 0)
        )
        iy_gol = self.hesapla_iy_gol_degeri(
            veri.get("iy_ev", 0), 
            veri.get("iy_dep", 0)
        )
        hibrit_kg = self.hesapla_hibrit_kg(
            veri.get("ev_atan", 0),
            veri.get("dep_atan", 0),
            veri.get("kg_var", 0)
        )
        
        # 3. SÄ°MÃœLASYON DÃ–NGÃœSÃœ
        simulasyon = self.simulasyon_dongusu(veri)
        
        # 4. Ä°Y RADAR
        iy_radar = self.iy_radar_kontrol(veri)
        
        # 5. GÃœVEN PUANI
        nihai_banko = simulasyon["nihai_banko"]
        guven = self.guven_puani_hesapla(veri, nihai_banko) if nihai_banko else 5
        kasa = self.kasa_orani_getir(guven)
        
        # 6. GOL Ã–NGÃ–RÃœSÃœ
        gol_ongorusu = self.yapay_zeka_gol_ongorusu(veri)
        canli_tetik = self.canli_tetikleyici(veri)
        
        return {
            "vetolar": tum_vetolar,
            "hesaplamalar": {
                "gol_ort": gol_ort,
                "iy_gol": iy_gol,
                "hibrit_kg": hibrit_kg
            },
            "simulasyon": simulasyon,
            "iy_radar": iy_radar,
            "nihai_banko": nihai_banko,
            "guven": guven,
            "kasa": kasa,
            "gol_ongorusu": gol_ongorusu,
            "canli_tetik": canli_tetik
        }


# Global hesaplama motoru instance
hesaplama_motoru = HesaplamaMotoru()


# ============================================================
# ğŸ”´ V5.6 - CANLI TARAMA POPUP SÄ°STEMÄ° (YENÄ°!)
# ============================================================


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ¯ PRO UI BÄ°LEÅENLERÄ°
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class DashboardCard(tk.Frame):
    """Dashboard kartÄ±"""
    def __init__(self, parent, title, value, subtitle="", icon="ğŸ“Š", 
                 accent_color=ModernTheme.ACCENT_PRIMARY, **kwargs):
        super().__init__(parent, bg=ModernTheme.BG_CARD, **kwargs)
        self.accent = accent_color
        self.config(highlightbackground=ModernTheme.BG_HOVER, highlightthickness=1, padx=15, pady=15)
        
        top = tk.Frame(self, bg=ModernTheme.BG_CARD)
        top.pack(fill="x", pady=(0, 10))
        tk.Label(top, text=icon, font=("Segoe UI", 24), bg=ModernTheme.BG_CARD, fg=accent_color).pack(side="left")
        tk.Label(top, text=title, font=("Segoe UI", 11), bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY).pack(side="left", padx=(10, 0))
        
        self.value_label = tk.Label(self, text=str(value), font=("Segoe UI", 32, "bold"), bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY)
        self.value_label.pack(anchor="w")
        
        self.subtitle_label = None
        if subtitle:
            self.subtitle_label = tk.Label(self, text=subtitle, font=("Segoe UI", 10), bg=ModernTheme.BG_CARD, fg=accent_color)
            self.subtitle_label.pack(anchor="w", pady=(5, 0))
        
        self.bind("<Enter>", lambda e: self.config(highlightbackground=self.accent, highlightthickness=2))
        self.bind("<Leave>", lambda e: self.config(highlightbackground=ModernTheme.BG_HOVER, highlightthickness=1))
    
    def update_value(self, new_value, subtitle=None):
        self.value_label.config(text=str(new_value))
        # Subtitle gÃ¼ncelleme (opsiyonel)
        if subtitle and hasattr(self, 'subtitle_label'):
            self.subtitle_label.config(text=subtitle)


class ModernSidebar(tk.Frame):
    """Modern sidebar navigasyonu - KaydÄ±rmalÄ±"""
    def __init__(self, parent, on_select=None, **kwargs):
        super().__init__(parent, bg=ModernTheme.BG_SECONDARY, width=220, **kwargs)
        self.pack_propagate(False)
        self.on_select = on_select
        self.buttons = {}
        self.active = None
        
        # Logo (sabit - kaydÄ±rmaya dahil deÄŸil)
        logo_frame = tk.Frame(self, bg=ModernTheme.BG_SECONDARY)
        logo_frame.pack(fill="x", pady=(20, 15))
        tk.Label(logo_frame, text="ğŸ‘ï¸", font=("Segoe UI", 32), bg=ModernTheme.BG_SECONDARY, fg=ModernTheme.ACCENT_PRIMARY).pack()
        tk.Label(logo_frame, text="XG-XRAY", font=("Segoe UI", 18, "bold"), bg=ModernTheme.BG_SECONDARY, fg=ModernTheme.TEXT_PRIMARY).pack()
        tk.Label(logo_frame, text="V70 THE ENDGAME", font=("Segoe UI", 9), bg=ModernTheme.BG_SECONDARY, fg=ModernTheme.TEXT_MUTED).pack()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # KAYDIRMALI MENÃœ ALANI
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        # Canvas ve Scrollbar container
        self.scroll_container = tk.Frame(self, bg=ModernTheme.BG_SECONDARY)
        self.scroll_container.pack(fill="both", expand=True)
        
        # Canvas oluÅŸtur
        self.canvas = tk.Canvas(self.scroll_container, bg=ModernTheme.BG_SECONDARY, 
                                highlightthickness=0, width=200)
        self.canvas.pack(side="left", fill="both", expand=True)
        
        # Ä°Ã§erik frame'i (canvas iÃ§inde)
        self.menu_frame = tk.Frame(self.canvas, bg=ModernTheme.BG_SECONDARY)
        self.canvas_window = self.canvas.create_window((0, 0), window=self.menu_frame, anchor="nw")
        
        # Frame boyutu deÄŸiÅŸince canvas'Ä± gÃ¼ncelle
        self.menu_frame.bind("<Configure>", self._on_frame_configure)
        self.canvas.bind("<Configure>", self._on_canvas_configure)
        
        # Mouse wheel scroll
        self.canvas.bind("<Enter>", self._bind_mousewheel)
        self.canvas.bind("<Leave>", self._unbind_mousewheel)
        self.menu_frame.bind("<Enter>", self._bind_mousewheel)
        self.menu_frame.bind("<Leave>", self._unbind_mousewheel)
    
    def _on_frame_configure(self, event=None):
        """Frame boyutu deÄŸiÅŸince scroll region gÃ¼ncelle"""
        self.canvas.configure(scrollregion=self.canvas.bbox("all"))
    
    def _on_canvas_configure(self, event=None):
        """Canvas boyutu deÄŸiÅŸince frame geniÅŸliÄŸini ayarla"""
        self.canvas.itemconfig(self.canvas_window, width=event.width)
    
    def _bind_mousewheel(self, event=None):
        """Mouse wheel'i baÄŸla"""
        self.canvas.bind_all("<MouseWheel>", self._on_mousewheel)
        self.canvas.bind_all("<Button-4>", self._on_mousewheel)
        self.canvas.bind_all("<Button-5>", self._on_mousewheel)
    
    def _unbind_mousewheel(self, event=None):
        """Mouse wheel'i Ã§Ã¶z"""
        self.canvas.unbind_all("<MouseWheel>")
        self.canvas.unbind_all("<Button-4>")
        self.canvas.unbind_all("<Button-5>")
    
    def _on_mousewheel(self, event):
        """Mouse wheel scroll"""
        if event.num == 4 or event.delta > 0:
            self.canvas.yview_scroll(-1, "units")
        elif event.num == 5 or event.delta < 0:
            self.canvas.yview_scroll(1, "units")
    
    def add_section(self, title):
        lbl = tk.Label(self.menu_frame, text=title.upper(), font=("Segoe UI", 9, "bold"),
                      bg=ModernTheme.BG_SECONDARY, fg=ModernTheme.TEXT_MUTED, anchor="w")
        lbl.pack(fill="x", padx=20, pady=(15, 5))
    
    def add_button(self, name, icon, text):
        btn = tk.Frame(self.menu_frame, bg=ModernTheme.BG_SECONDARY, cursor="hand2")
        btn.pack(fill="x", padx=10, pady=2)
        
        inner = tk.Frame(btn, bg=ModernTheme.BG_SECONDARY)
        inner.pack(fill="x", padx=10, pady=8)
        
        icon_lbl = tk.Label(inner, text=icon, font=("Segoe UI", 12), bg=ModernTheme.BG_SECONDARY, fg=ModernTheme.TEXT_SECONDARY)
        icon_lbl.pack(side="left")
        text_lbl = tk.Label(inner, text=text, font=("Segoe UI", 11), bg=ModernTheme.BG_SECONDARY, fg=ModernTheme.TEXT_SECONDARY)
        text_lbl.pack(side="left", padx=(10, 0))
        
        btn.inner = inner
        btn.icon_lbl = icon_lbl
        btn.text_lbl = text_lbl
        btn.name = name
        self.buttons[name] = btn
        
        def on_enter(e):
            if self.active != name:
                btn.configure(bg=ModernTheme.BG_HOVER)
                inner.configure(bg=ModernTheme.BG_HOVER)
                icon_lbl.configure(bg=ModernTheme.BG_HOVER)
                text_lbl.configure(bg=ModernTheme.BG_HOVER)
        
        def on_leave(e):
            if self.active != name:
                btn.configure(bg=ModernTheme.BG_SECONDARY)
                inner.configure(bg=ModernTheme.BG_SECONDARY)
                icon_lbl.configure(bg=ModernTheme.BG_SECONDARY)
                text_lbl.configure(bg=ModernTheme.BG_SECONDARY)
        
        def on_click(e):
            self._set_active(name)
            if self.on_select:
                self.on_select(name)
        
        for w in [btn, inner, icon_lbl, text_lbl]:
            w.bind("<Enter>", on_enter)
            w.bind("<Leave>", on_leave)
            w.bind("<Button-1>", on_click)
    
    def _set_active(self, name):
        if self.active and self.active in self.buttons:
            old = self.buttons[self.active]
            old.configure(bg=ModernTheme.BG_SECONDARY)
            old.inner.configure(bg=ModernTheme.BG_SECONDARY)
            old.icon_lbl.configure(bg=ModernTheme.BG_SECONDARY, fg=ModernTheme.TEXT_SECONDARY)
            old.text_lbl.configure(bg=ModernTheme.BG_SECONDARY, fg=ModernTheme.TEXT_SECONDARY)
        
        self.active = name
        if name in self.buttons:
            btn = self.buttons[name]
            btn.configure(bg=ModernTheme.BG_CARD)
            btn.inner.configure(bg=ModernTheme.BG_CARD)
            btn.icon_lbl.configure(bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
            btn.text_lbl.configure(bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY)


class CanliTaramaPopup:
    """
    Analiz sÄ±rasÄ±nda tÃ¼m kurallarÄ±n canlÄ± olarak tarandÄ±ÄŸÄ±nÄ± gÃ¶steren popup.
    Her kural iÃ§in âœ… GEÃ‡TÄ° / âŒ VETO / â³ TARANIYOR gÃ¶sterir.
    """
    
    def __init__(self, parent, mac_adi, toplam_kural=170):
        self.parent = parent
        self.mac_adi = mac_adi
        self.toplam_kural = toplam_kural
        self.taranan_kural = 0
        self.gecti_sayisi = 0
        self.veto_sayisi = 0
        self.kaldi_sayisi = toplam_kural
        self.aktif = True
        self.sonuclar = []
        
        # Popup penceresi oluÅŸtur
        self.popup = tk.Toplevel(parent)
        self.popup.title(f"ğŸ” CANLI TARAMA - {mac_adi}")
        self.popup.geometry("700x600")
        self.popup.configure(bg="#0a0a0a")
        self.popup.resizable(False, False)
        
        # Pencereyi ortala
        self.popup.transient(parent)
        
        self._create_widgets()
    
    def _create_widgets(self):
        """Widget'larÄ± oluÅŸtur"""
        # BaÅŸlÄ±k
        header_frame = tk.Frame(self.popup, bg="#0a0a0a")
        header_frame.pack(fill="x", padx=20, pady=10)
        
        tk.Label(header_frame, text=f"ğŸ” CANLI KURAL TARAMA", font=("Segoe UI", 16, "bold"),
                fg="#00ffcc", bg="#0a0a0a").pack()
        tk.Label(header_frame, text=f"âš½ {self.mac_adi}", font=("Segoe UI", 12),
                fg="#ffffff", bg="#0a0a0a").pack()
        
        # Ä°lerleme Ã§ubuÄŸu frame
        progress_frame = tk.Frame(self.popup, bg="#0a0a0a")
        progress_frame.pack(fill="x", padx=20, pady=10)
        
        # Ä°lerleme Ã§ubuÄŸu
        self.progress_var = tk.DoubleVar(value=0)
        self.progress_bar = ttk.Progressbar(progress_frame, variable=self.progress_var,
                                            maximum=100, length=650, mode="determinate")
        self.progress_bar.pack(fill="x")
        
        # Ä°lerleme label
        self.progress_label = tk.Label(progress_frame, text="ğŸ“Š Ä°LERLEME: 0/170 KURAL (%0)",
                                       font=("Segoe UI", 10), fg="#888888", bg="#0a0a0a")
        self.progress_label.pack(pady=5)
        
        # SayaÃ§ frame
        counter_frame = tk.Frame(self.popup, bg="#0a0a0a")
        counter_frame.pack(fill="x", padx=20, pady=5)
        
        self.lbl_gecti = tk.Label(counter_frame, text="âœ… GEÃ‡TÄ°: 0", font=("Segoe UI", 11, "bold"),
                                  fg="#00ff00", bg="#0a0a0a")
        self.lbl_gecti.pack(side="left", padx=20)
        
        self.lbl_veto = tk.Label(counter_frame, text="ğŸš¨ VETO: 0", font=("Segoe UI", 11, "bold"),
                                 fg="#ff4444", bg="#0a0a0a")
        self.lbl_veto.pack(side="left", padx=20)
        
        self.lbl_kaldi = tk.Label(counter_frame, text=f"â³ KALDI: {self.toplam_kural}",
                                  font=("Segoe UI", 11, "bold"), fg="#ffcc00", bg="#0a0a0a")
        self.lbl_kaldi.pack(side="left", padx=20)
        
        # Tarama listesi frame
        list_frame = tk.Frame(self.popup, bg="#0a0a0a")
        list_frame.pack(fill="both", expand=True, padx=20, pady=10)
        
        scrollbar = tk.Scrollbar(list_frame)
        scrollbar.pack(side="right", fill="y")
        
        self.tarama_text = tk.Text(list_frame, font=("Consolas", 9), fg="#ffffff", bg="#111111",
                                   yscrollcommand=scrollbar.set, state="disabled", height=20)
        self.tarama_text.pack(fill="both", expand=True)
        scrollbar.config(command=self.tarama_text.yview)
        
        # Tag'ler
        self.tarama_text.tag_config("bolum", foreground="#00ffcc", font=("Consolas", 10, "bold"))
        self.tarama_text.tag_config("gecti", foreground="#00ff00")
        self.tarama_text.tag_config("veto", foreground="#ff4444")
        self.tarama_text.tag_config("taraniyor", foreground="#ffcc00")
        self.tarama_text.tag_config("kural", foreground="#888888")
        self.tarama_text.tag_config("detay", foreground="#666666")
        
        # Durum label
        self.durum_label = tk.Label(self.popup, text="â³ Tarama baÅŸlatÄ±lÄ±yor...",
                                    font=("Segoe UI", 10), fg="#ffcc00", bg="#0a0a0a")
        self.durum_label.pack(pady=5)
        
        # Kapat butonu
        self.btn_kapat = tk.Button(self.popup, text="âŒ KAPAT", font=("Segoe UI", 10, "bold"),
                                   fg="#ffffff", bg="#333333", state="disabled", command=self.kapat)
        self.btn_kapat.pack(pady=10)
    
    def bolum_ekle(self, bolum_adi):
        """Yeni bÃ¶lÃ¼m baÅŸlÄ±ÄŸÄ± ekle"""
        self.tarama_text.config(state="normal")
        self.tarama_text.insert("end", f"\nğŸ“‚ {bolum_adi}\n", "bolum")
        self.tarama_text.see("end")
        self.tarama_text.config(state="disabled")
        self.popup.update()
    
    def kural_taraniyor(self, kural_id, kural_adi):
        """Kural taranÄ±yor gÃ¶ster"""
        self.tarama_text.config(state="normal")
        self.tarama_text.insert("end", f"   â”œâ”€ â³ {kural_id} ", "taraniyor")
        self.tarama_text.insert("end", f"... ", "kural")
        self.tarama_text.see("end")
        self.tarama_text.config(state="disabled")
        self.durum_label.config(text=f"â³ TaranÄ±yor: {kural_id}")
        self.popup.update()
    
    def kural_sonuc(self, kural_id, sonuc, detay=""):
        """Kural sonucunu gÃ¶ster"""
        self.taranan_kural += 1
        self.kaldi_sayisi = self.toplam_kural - self.taranan_kural
        
        self.sonuclar.append({"kural_id": kural_id, "sonuc": sonuc, "detay": detay})
        
        self.tarama_text.config(state="normal")
        
        if sonuc == "GEÃ‡TÄ°":
            self.gecti_sayisi += 1
            self.tarama_text.insert("end", f"[GEÃ‡TÄ° âœ…]\n", "gecti")
            if detay:
                self.tarama_text.insert("end", f"      â””â”€ {detay}\n", "detay")
        elif sonuc == "VETO":
            self.veto_sayisi += 1
            self.tarama_text.insert("end", f"[VETO ğŸš¨]\n", "veto")
            if detay:
                self.tarama_text.insert("end", f"      â””â”€ {detay}\n", "veto")
        else:
            self.tarama_text.insert("end", f"[{sonuc}]\n", "kural")
            if detay:
                self.tarama_text.insert("end", f"      â””â”€ {detay}\n", "detay")
        
        self.tarama_text.see("end")
        self.tarama_text.config(state="disabled")
        
        # SayaÃ§larÄ± gÃ¼ncelle
        self.lbl_gecti.config(text=f"âœ… GEÃ‡TÄ°: {self.gecti_sayisi}")
        self.lbl_veto.config(text=f"ğŸš¨ VETO: {self.veto_sayisi}")
        self.lbl_kaldi.config(text=f"â³ KALDI: {self.kaldi_sayisi}")
        
        # Ä°lerleme Ã§ubuÄŸunu gÃ¼ncelle
        ilerleme = (self.taranan_kural / self.toplam_kural) * 100
        self.progress_var.set(ilerleme)
        self.progress_label.config(text=f"ğŸ“Š Ä°LERLEME: {self.taranan_kural}/{self.toplam_kural} KURAL (%{ilerleme:.0f})")
        
        self.popup.update()
    
    def tamamlandi(self, banko_sonuc=None):
        """Tarama tamamlandÄ±"""
        self.aktif = False
        
        self.tarama_text.config(state="normal")
        self.tarama_text.insert("end", "\n" + "â•"*50 + "\n", "bolum")
        self.tarama_text.insert("end", "ğŸ¯ TARAMA TAMAMLANDI!\n", "bolum")
        self.tarama_text.insert("end", f"   âœ… GEÃ‡TÄ°: {self.gecti_sayisi}\n", "gecti")
        self.tarama_text.insert("end", f"   ğŸš¨ VETO: {self.veto_sayisi}\n", "veto")
        
        if banko_sonuc:
            self.tarama_text.insert("end", f"\nğŸ† SEÃ‡Ä°LEN BANKO: {banko_sonuc}\n", "bolum")
        
        self.tarama_text.see("end")
        self.tarama_text.config(state="disabled")
        
        self.durum_label.config(text="âœ… Tarama tamamlandÄ±!", fg="#00ff00")
        self.btn_kapat.config(state="normal", bg="#00aa00")
        self.popup.update()
    
    def kapat(self):
        """Popup'Ä± kapat"""
        self.popup.destroy()
    
    def get_sonuclar(self):
        """Tarama sonuÃ§larÄ±nÄ± dÃ¶ndÃ¼r"""
        return {"toplam": self.toplam_kural, "taranan": self.taranan_kural,
                "gecti": self.gecti_sayisi, "veto": self.veto_sayisi, "detaylar": self.sonuclar}


# ============================================================
# ğŸ§® V5.6 - ESKÄ° HESAPLAMA MOTORU (GERÄ°YE UYUMLULUK Ä°Ã‡Ä°N)
# ============================================================
class HesaplamaMotoruEski:
    """9 Hesaplama FormÃ¼lÃ¼ - Eski versiyon (VetoKontrolSistemi iÃ§in)"""
    
    def __init__(self, veriler):
        self.v = veriler
    
    def _get(self, key, default=0):
        """GeliÅŸmiÅŸ veri okuma - Regex destekli"""
        import re as regex_module
        val = self.v.get(key)
        if val is None or val == "" or val == "?" or val == "N/A":
            return default
        if isinstance(val, (int, float)):
            return float(val)
        if isinstance(val, str):
            val = val.replace(",", ".").replace("%", "")
            match = regex_module.search(r'[-+]?[0-9]*\.?[0-9]+', val)
            if match:
                try:
                    return float(match.group())
                except:
                    return default
        return default
    
    def hesapla_gol_ort(self):
        """(Ev AtÄ±lan 0.5Ãœ + Dep AtÄ±lan 0.5Ãœ) / 2"""
        return (self._get("ev_atan", 0) + self._get("dep_atan", 0)) / 2
    
    def hesapla_gol_yeme_ort(self):
        """(Ev Yenen 0.5Ãœ + Dep Yenen 0.5Ãœ) / 2"""
        return (self._get("ev_yiyen", 0) + self._get("dep_yiyen", 0)) / 2
    
    def hesapla_iy_gol_degeri(self):
        """(Ev Ä°Y AtÄ±lan + Dep Ä°Y AtÄ±lan) / 2"""
        return (self._get("iy_ev", 0) + self._get("iy_dep", 0)) / 2
    
    def hesapla_hibrit_kg(self):
        """(((Ev 0.5Ãœ + Dep 0.5Ãœ) / 2) + Ortalama KG VAR) / 2"""
        gol_ort = (self._get("ev_atan", 0) + self._get("dep_atan", 0)) / 2
        return (gol_ort + self._get("kg_var", 0)) / 2
    
    def hesapla_conversion(self, takim="ev"):
        """(Gol / Åut) * 100"""
        if takim == "ev":
            gol = self._get("ev_gol_ort", 0)
            sut = self._get("ev_sut_ort", 1)
        else:
            gol = self._get("dep_gol_ort", 0)
            sut = self._get("dep_sut_ort", 1)
        return (gol / sut) * 100 if sut > 0 else 0
    
    def hesapla_conversion_ort(self):
        return (self.hesapla_conversion("ev") + self.hesapla_conversion("dep")) / 2
    
    def hesapla_tahmini_rcs(self):
        """(CSÄ° Åut * 3) + Korner"""
        return (self._get("csi_sut", 0) * 3) + self._get("korner_ort", 0)
    
    def hesapla_favori_etiketi(self):
        """Ã–n Favori â†’ Veto â†’ Nihai Etiket"""
        ev_oran = self._get("ev_oran", 2.0)
        dep_oran = self._get("dep_oran", 2.0)
        
        if ev_oran < dep_oran:
            favori, favori_oran = "EV", ev_oran
        elif dep_oran < ev_oran:
            favori, favori_oran = "DEP", dep_oran
        else:
            favori, favori_oran = "DENGELÄ°", ev_oran
        
        if favori_oran <= 1.35:
            etiket = "AÄIR FAVORÄ°"
        elif favori_oran <= 1.70:
            etiket = "FAVORÄ°"
        elif favori_oran <= 2.00:
            etiket = "HAFÄ°F FAVORÄ°"
        else:
            etiket = "DENGELÄ°"
        
        return {"favori": favori, "etiket": etiket, "oran": favori_oran}
    
    def tum_hesaplamalar(self):
        return {
            "gol_ort": self.hesapla_gol_ort(),
            "gol_yeme_ort": self.hesapla_gol_yeme_ort(),
            "iy_gol_degeri": self.hesapla_iy_gol_degeri(),
            "hibrit_kg": self.hesapla_hibrit_kg(),
            "conversion_ort": self.hesapla_conversion_ort(),
            "tahmini_rcs": self.hesapla_tahmini_rcs(),
            "favori": self.hesapla_favori_etiketi()
        }


# ============================================================
# ğŸš« V5.6 - VETO KONTROL SÄ°STEMÄ° (BÃ–LÃœM 4) - 55+ VETO
# ============================================================
class VetoKontrolSistemi:
    """GÄ°YOTÄ°N PROTOKOLÃœ - TÃ¼m vetolar burada kontrol edilir"""
    
    def __init__(self, veriler, hesaplama_motoru=None):
        self.v = veriler
        self.hesap = hesaplama_motoru or HesaplamaMotoruEski(veriler)
        self.vetolar = []
        self.uyarilar = []
    
    def _get(self, key, default=0):
        """GeliÅŸmiÅŸ veri okuma - Regex destekli"""
        import re as regex_module
        val = self.v.get(key)
        if val is None or val == "" or val == "?" or val == "N/A":
            return default
        if isinstance(val, (int, float)):
            return float(val)
        if isinstance(val, str):
            val = val.replace(",", ".").replace("%", "")
            match = regex_module.search(r'[-+]?[0-9]*\.?[0-9]+', val)
            if match:
                try:
                    return float(match.group())
                except:
                    return default
        return default
    
    def _veto_ekle(self, kural_id, kural_adi, sebep, hedefler):
        self.vetolar.append({"kural_id": kural_id, "kural_adi": kural_adi, "sebep": sebep, "hedefler": hedefler})
    
    def _uyari_ekle(self, kural_id, kural_adi, sebep, hedefler):
        self.uyarilar.append({"kural_id": kural_id, "kural_adi": kural_adi, "sebep": sebep, "hedefler": hedefler})
    
    def kontrol_k100(self):
        """K.100: %100 seri 6+ maÃ§ & xG<1.50 â†’ VETO"""
        seri = self._get("kazanma_serisi", 0)
        xg = self._get("xg", 2.5)
        if seri >= 6 and xg < 1.50:
            self._veto_ekle("K.100", "Seri KontrolÃ¼", f"Seri: {seri} maÃ§, xG: {xg} < 1.50", ["BANKO"])
            return False, f"VETO - Sahte seri"
        return True, "GEÃ‡TÄ°"
    
    def kontrol_conversion(self):
        """K.CONVERSION: Conv <%10 â†’ GOL BAHÄ°SÄ° YASAK"""
        conv_ort = self.hesap.hesapla_conversion_ort()
        if conv_ort < 10:
            self._veto_ekle("K.CONVERSION", "Beceri KontrolÃ¼", f"Conv %{conv_ort:.1f} < %10", ["GOL", "ÃœST", "KG VAR"])
            return False, f"VETO - Conv %{conv_ort:.1f}"
        return True, f"GEÃ‡TÄ° - Conv %{conv_ort:.1f}"
    
    def kontrol_ayna(self):
        """K.AYNA: Rakip Yememe >%60 â†’ ÃœST/KG YASAK"""
        ev_yememe = 100 - self._get("ev_yiyen", 50)
        dep_yememe = 100 - self._get("dep_yiyen", 50)
        if ev_yememe > 60 or dep_yememe > 60:
            yuksek = "Ev" if ev_yememe > 60 else "Dep"
            yuzde = ev_yememe if ev_yememe > 60 else dep_yememe
            self._veto_ekle("K.AYNA", "Savunma KontrolÃ¼", f"{yuksek} yememe %{yuzde:.0f} > %60", ["ÃœST", "KG VAR"])
            return False, f"VETO - {yuksek} yememe %{yuzde:.0f}"
        return True, "GEÃ‡TÄ°"
    
    def kontrol_kalite(self):
        """K.KALÄ°TE-KONTROL: Ä°ki takÄ±m Conv <%13 â†’ ÃœST/KG YASAK"""
        conv_ev = self.hesap.hesapla_conversion("ev")
        conv_dep = self.hesap.hesapla_conversion("dep")
        if conv_ev < 13 and conv_dep < 13:
            self._veto_ekle("K.KALÄ°TE-KONTROL", "Kalite Kontrol", f"Ã‡ift Conv dÃ¼ÅŸÃ¼k (Ev:%{conv_ev:.1f}, Dep:%{conv_dep:.1f})", ["ÃœST", "KG VAR"])
            return False, "VETO - Ã‡ift Conv dÃ¼ÅŸÃ¼k"
        return True, "GEÃ‡TÄ°"
    
    def kontrol_duvar50(self):
        """K.DUVAR-50: CS â‰¥%50 â†’ TAKIM GOLÃœ/1.5Ãœ/KG YASAK"""
        ev_cs = self._get("ev_cs", 0)
        dep_cs = self._get("dep_cs", 0)
        if ev_cs >= 50:
            self._veto_ekle("K.DUVAR-50", "Savunma DuvarÄ±", f"Ev CS %{ev_cs} â‰¥ %50", ["DEP GOLÃœ", "TAKIM 1.5 ÃœST", "KG VAR"])
            return False, f"VETO - Ev CS %{ev_cs}"
        if dep_cs >= 50:
            self._veto_ekle("K.DUVAR-50", "Savunma DuvarÄ±", f"Dep CS %{dep_cs} â‰¥ %50", ["EV GOLÃœ", "TAKIM 1.5 ÃœST", "KG VAR"])
            return False, f"VETO - Dep CS %{dep_cs}"
        return True, "GEÃ‡TÄ°"
    
    def kontrol_super_favori(self):
        """K.SÃœPER-FAVORÄ°: Oran â‰¤1.35 â†’ MS YASAK"""
        ev_oran = self._get("ev_oran", 2.0)
        dep_oran = self._get("dep_oran", 2.0)
        if ev_oran <= 1.35 or dep_oran <= 1.35:
            self._veto_ekle("K.SÃœPER-FAVORÄ°", "SÃ¼per Favori", f"Oran â‰¤1.35", ["MS 1", "MS 2"])
            return False, "VETO - SÃ¼per favori"
        return True, "GEÃ‡TÄ°"
    
    def kontrol_kevgir(self):
        """K.KEVGÄ°R-FAVORÄ°: Yeme >%60 â†’ KG YOK YASAK"""
        ev_yiyen = self._get("ev_yiyen", 50)
        dep_yiyen = self._get("dep_yiyen", 50)
        ev_oran = self._get("ev_oran", 2.0)
        dep_oran = self._get("dep_oran", 2.0)
        favori_yiyen = ev_yiyen if ev_oran < dep_oran else dep_yiyen
        if favori_yiyen > 60:
            self._veto_ekle("K.KEVGÄ°R-FAVORÄ°", "Kevgir Favori", f"Favori yeme %{favori_yiyen:.0f} > %60", ["KG YOK"])
            return False, "VETO - Favori kevgir"
        return True, "GEÃ‡TÄ°"
    
    def kontrol_kisir7(self):
        """K.KISIR-7: Conv â‰¤%7 â†’ 2.5Ãœ/KG YASAK"""
        conv_ev = self.hesap.hesapla_conversion("ev")
        if conv_ev <= 7:
            self._veto_ekle("K.KISIR-7", "KÄ±sÄ±r 7", f"Ev Conv %{conv_ev:.1f} â‰¤ %7", ["2.5 ÃœST", "KG VAR"])
            return False, "VETO - Ev Conv kÄ±sÄ±r"
        return True, "GEÃ‡TÄ°"
    
    def kontrol_duvar80(self):
        """K.DUVAR-80: CS â‰¥%75 â†’ BANKO KG/ÃœST YASAK"""
        ev_cs = self._get("ev_cs", 0)
        dep_cs = self._get("dep_cs", 0)
        if ev_cs >= 75 or dep_cs >= 75:
            self._veto_ekle("K.DUVAR-80", "Demir Duvar", f"CS â‰¥ %75", ["BANKO KG", "BANKO ÃœST"])
            return False, "VETO - Demir duvar"
        return True, "GEÃ‡TÄ°"
    
    def kontrol_kisirlik_veto(self):
        """K.KISIRLIK-VETO: Atamama â‰¥%25 â†’ TAKIM GOLÃœ YASAK"""
        ev_atamama = self._get("ev_atamama", 0)
        dep_atamama = self._get("dep_atamama", 0)
        if ev_atamama >= 25:
            self._veto_ekle("K.KISIRLIK-VETO", "KÄ±sÄ±rlÄ±k Veto", f"Ev atamama %{ev_atamama:.0f} â‰¥ %25", ["EV TAKIM GOLÃœ"])
            return False, "VETO - Ev kÄ±sÄ±r"
        if dep_atamama >= 25:
            self._veto_ekle("K.KISIRLIK-VETO", "KÄ±sÄ±rlÄ±k Veto", f"Dep atamama %{dep_atamama:.0f} â‰¥ %25", ["DEP TAKIM GOLÃœ"])
            return False, "VETO - Dep kÄ±sÄ±r"
        return True, "GEÃ‡TÄ°"
    
    def kontrol_nekro(self):
        """K.NEKRO: 8 maÃ§tÄ±r kazanamayan â†’ FAVORÄ° YASAK"""
        ev_kazanamama = self._get("ev_kazanamama_serisi", 0)
        dep_kazanamama = self._get("dep_kazanamama_serisi", 0)
        if ev_kazanamama >= 8:
            self._veto_ekle("K.NEKRO", "Nekro", f"Ev {ev_kazanamama} maÃ§tÄ±r kazanamÄ±yor", ["EV FAVORÄ°"])
            return False, f"VETO - Ev {ev_kazanamama} maÃ§"
        if dep_kazanamama >= 8:
            self._veto_ekle("K.NEKRO", "Nekro", f"Dep {dep_kazanamama} maÃ§tÄ±r kazanamÄ±yor", ["DEP FAVORÄ°"])
            return False, f"VETO - Dep {dep_kazanamama} maÃ§"
        return True, "GEÃ‡TÄ°"
    
    def tam_veto_kontrolu(self, tarama_popup=None):
        """TÃ¼m veto kurallarÄ±nÄ± sÄ±rayla kontrol et"""
        kontroller = [
            ("K.100", "Seri KontrolÃ¼", self.kontrol_k100),
            ("K.CONVERSION", "Beceri KontrolÃ¼", self.kontrol_conversion),
            ("K.AYNA", "Savunma KontrolÃ¼", self.kontrol_ayna),
            ("K.KALÄ°TE-KONTROL", "Kalite Kontrol", self.kontrol_kalite),
            ("K.DUVAR-50", "Savunma DuvarÄ±", self.kontrol_duvar50),
            ("K.SÃœPER-FAVORÄ°", "SÃ¼per Favori", self.kontrol_super_favori),
            ("K.KEVGÄ°R-FAVORÄ°", "Kevgir Favori", self.kontrol_kevgir),
            ("K.KISIR-7", "KÄ±sÄ±r 7", self.kontrol_kisir7),
            ("K.DUVAR-80", "Demir Duvar", self.kontrol_duvar80),
            ("K.KISIRLIK-VETO", "KÄ±sÄ±rlÄ±k Veto", self.kontrol_kisirlik_veto),
            ("K.NEKRO", "Nekro", self.kontrol_nekro),
        ]
        
        if tarama_popup:
            tarama_popup.bolum_ekle("BÃ–LÃœM 4 - GÄ°YOTÄ°N (VETOLAR)")
        
        for kural_id, kural_adi, kontrol_func in kontroller:
            if tarama_popup:
                tarama_popup.kural_taraniyor(kural_id, kural_adi)
                time.sleep(0.03)
            
            try:
                gecti, detay = kontrol_func()
                if tarama_popup:
                    sonuc = "GEÃ‡TÄ°" if gecti else "VETO"
                    tarama_popup.kural_sonuc(kural_id, sonuc, detay)
            except Exception as e:
                if tarama_popup:
                    tarama_popup.kural_sonuc(kural_id, "HATA", str(e))
        
        return {"vetolar": self.vetolar, "uyarilar": self.uyarilar, "veto_sayisi": len(self.vetolar)}
    
    def bahis_veto_mu(self, bahis_tipi):
        """Belirli bir bahis tipi veto yemiÅŸ mi?"""
        for veto in self.vetolar:
            for hedef in veto["hedefler"]:
                if hedef.upper() in bahis_tipi.upper() or bahis_tipi.upper() in hedef.upper():
                    return True, veto
        return False, None


# ============================================================
# ğŸ¯ V5.6 - KÃ–R NOKTA AVCISI (BÃ–LÃœM 11)
# ============================================================
class KorNoktaAvcisi:
    """Sahte seri tespiti - %100 seri + dÃ¼ÅŸÃ¼k xG"""
    
    def __init__(self, veriler):
        self.v = veriler
    
    def _get(self, key, default=0):
        """GeliÅŸmiÅŸ veri okuma - Regex destekli"""
        import re as regex_module
        val = self.v.get(key)
        if val is None or val == "" or val == "?" or val == "N/A":
            return default
        if isinstance(val, (int, float)):
            return float(val)
        if isinstance(val, str):
            val = val.replace(",", ".").replace("%", "")
            match = regex_module.search(r'[-+]?[0-9]*\.?[0-9]+', val)
            if match:
                try:
                    return float(match.group())
                except:
                    return default
        return default
    
    def sahte_seri_kontrol(self):
        """5+ maÃ§lÄ±k seri + xG < 1.00 = SAHTE SERÄ°"""
        ev_seri = self._get("ev_kazanma_serisi", 0)
        dep_seri = self._get("dep_kazanma_serisi", 0)
        ev_xg = self._get("ev_xg", 2.0)
        dep_xg = self._get("dep_xg", 2.0)
        
        tespitler = []
        if ev_seri >= 5 and ev_xg < 1.00:
            tespitler.append({"takim": "EV", "seri": ev_seri, "xg": ev_xg,
                             "uyari": f"â›” SAHTE SERÄ°: Ev {ev_seri} maÃ§lÄ±k seri ama xG sadece {ev_xg}!"})
        if dep_seri >= 5 and dep_xg < 1.00:
            tespitler.append({"takim": "DEP", "seri": dep_seri, "xg": dep_xg,
                             "uyari": f"â›” SAHTE SERÄ°: Dep {dep_seri} maÃ§lÄ±k seri ama xG sadece {dep_xg}!"})
        return tespitler if tespitler else None


# ============================================================
# âš–ï¸ V5.6 - SEÃ‡Ä°M ALGORÄ°TMASI (BÃ–LÃœM 9)
# ============================================================
class SecimAlgoritmasi:
    """Birden fazla bahis GEÃ‡TÄ° aldÄ±ÄŸÄ±nda hangisini seÃ§eceÄŸini belirler"""
    
    def __init__(self, veriler, gecen_bahisler):
        self.v = veriler
        self.gecen_bahisler = gecen_bahisler
    
    def _get(self, key, default=0):
        """GeliÅŸmiÅŸ veri okuma - Regex destekli"""
        import re as regex_module
        val = self.v.get(key)
        if val is None or val == "" or val == "?" or val == "N/A":
            return default
        if isinstance(val, (int, float)):
            return float(val)
        if isinstance(val, str):
            val = val.replace(",", ".").replace("%", "")
            match = regex_module.search(r'[-+]?[0-9]*\.?[0-9]+', val)
            if match:
                try:
                    return float(match.group())
                except:
                    return default
        return default
    
    def sec(self):
        if not self.gecen_bahisler:
            return None, "HiÃ§bir bahis GEÃ‡MEDÄ°"
        if len(self.gecen_bahisler) == 1:
            return self.gecen_bahisler[0], "TEK GEÃ‡TÄ°"
        
        # 1. ALTIN ORAN KURALI
        ust_25_gecti = any("2.5" in b and "ÃœST" in b.upper() for b in self.gecen_bahisler)
        kg_var_gecti = any("KG VAR" in b.upper() for b in self.gecen_bahisler)
        if ust_25_gecti and kg_var_gecti:
            oran_25 = self._get("oran_25_ust", 1.50)
            oran_kg = self._get("oran_kg_var", 1.50)
            if 1.45 <= oran_25 <= 1.65:
                return "MS 2.5 ÃœST", f"ALTIN ORAN: Oran {oran_25} ideal"
            if 1.45 <= oran_kg <= 1.65:
                return "KG VAR", f"ALTIN ORAN: Oran {oran_kg} ideal"
        
        # 2. GÃœVENLÄ°K Ã–NCELÄ°ÄÄ°
        ms_taraf_gecti = any("MS 1" in b or "MS 2" in b for b in self.gecen_bahisler)
        takim_gecti = any("TAKIM" in b.upper() and "1.5" in b for b in self.gecen_bahisler)
        if ms_taraf_gecti and takim_gecti:
            for b in self.gecen_bahisler:
                if "TAKIM" in b.upper() and "1.5" in b:
                    return b, "GÃœVENLÄ°K Ã–NCELÄ°ÄÄ°"
        
        return self.gecen_bahisler[0], "Ä°LK GEÃ‡EN"


# ============================================================
# ğŸ’§ V5.6 - SON DAMLA KONTROLÃœ (BÃ–LÃœM 9)
# ============================================================
class SonDamlaKontrol:
    """K.SON-DAMLA: TÃ¼m bahisler veto yese bile kurtarÄ±cÄ± kontrol"""
    
    def __init__(self, veriler):
        self.v = veriler
    
    def _get(self, key, default=0):
        """GeliÅŸmiÅŸ veri okuma - Regex destekli"""
        import re as regex_module
        val = self.v.get(key)
        if val is None or val == "" or val == "?" or val == "N/A":
            return default
        if isinstance(val, (int, float)):
            return float(val)
        if isinstance(val, str):
            val = val.replace(",", ".").replace("%", "")
            match = regex_module.search(r'[-+]?[0-9]*\.?[0-9]+', val)
            if match:
                try:
                    return float(match.group())
                except:
                    return default
        return default
    
    def kurtarici_kontrol(self):
        kurtaricilar = []
        
        if self._get("ust_15", 0) >= 80:
            kurtaricilar.append({"bahis": "MS 1.5 ÃœST", "yuzde": self._get("ust_15", 0)})
        if self._get("ev_atan", 0) >= 80:
            kurtaricilar.append({"bahis": "EV 0.5 ÃœST", "yuzde": self._get("ev_atan", 0)})
        if self._get("dep_atan", 0) >= 80:
            kurtaricilar.append({"bahis": "DEP 0.5 ÃœST", "yuzde": self._get("dep_atan", 0)})
        
        lig_gol_ort = self._get("lig_gol_ort", 2.5)
        iy_ort = (self._get("iy_ev", 0) + self._get("iy_dep", 0)) / 2
        if lig_gol_ort >= 2.80 and iy_ort >= 65:
            kurtaricilar.append({"bahis": "Ä°Y 0.5 ÃœST", "yuzde": iy_ort})
        
        if kurtaricilar:
            en_iyi = max(kurtaricilar, key=lambda x: x["yuzde"])
            return en_iyi, "K.SON-DAMLA: KurtarÄ±cÄ± bulundu"
        
        return None, "PAS GEÃ‡ (NO BET)"


# ============================================================
# ğŸ¯ BÃ–LÃœM 5 - HÄ°YERARÅÄ°K BANKO SEÃ‡Ä°M SÄ°STEMÄ° (YENÄ°!)
# ============================================================
class Bolum5BankoSecici:
    """
    BÃ–LÃœM 5: 135 KURAL HÄ°YERARÅÄ°K BANKO SEÃ‡Ä°MÄ°
    
    Ã‡alÄ±ÅŸma Prensibi:
    - Ä°lk TRUE dÃ¶nen kural = BANKO
    - HiyerarÅŸi: AÅŸama 0 (Vetolar) â†’ AÅŸama 6 (Negatif)
    - Her aÅŸamada ilk geÃ§en kural kazanÄ±r
    
    AÅŸamalar:
    - AÅAMA 0: GÃ¼venlik ve Veto Kontrolleri (kapatÄ±lan bahis tipleri)
    - AÅAMA 1: YÃ¼ksek Gol Potansiyeli (3.5Ãœ, 2.5Ãœ)
    - AÅAMA 2: KarÅŸÄ±lÄ±klÄ± Gol (KG VAR)
    - AÅAMA 3: GÃ¼venli Gol LimanlarÄ± (1.5Ãœ, TakÄ±m Golleri)
    - AÅAMA 4: Taraf ve Galibiyet (MS TARAF)
    - AÅAMA 5: Ä°lk YarÄ± (Ä°Y GALÄ°BÄ°YET, Ä°Y 1.5Ãœ)
    - AÅAMA 6: Negatif Bahisler (2.5 ALT, KG YOK) - son Ã§are
    """
    
    def __init__(self, mac_verisi):
        """
        mac_verisi dict Ã¶rneÄŸi:
        {
            "ev_atan": 75, "dep_atan": 80, "ev_yiyen": 60, "dep_yiyen": 55,
            "xg": 2.8, "xg_ev": 1.6, "xg_dep": 1.2,
            "ust_15": 80, "ust_25": 65, "ust_35": 40,
            "kg_var": 60, "oran": 1.55,
            "conv_ev": 14, "conv_dep": 12,
            "sut_ev": 12, "sut_dep": 10,
            "iy_ev_gol": 65, "iy_dep_gol": 55,
            "lig_gol_ort": 2.6
        }
        """
        self.v = mac_verisi
        self.vetolar = []
        self.gecen_kurallar = []
        self.secilen_banko = None
        self.alternatif = None
    
    def _get(self, key, default=0):
        """GÃ¼venli deÄŸer alma - % iÅŸaretini temizler"""
        val = self.v.get(key, default)
        if val is None or val == "" or val == "?":
            return default
        try:
            return float(str(val).replace("%", "").replace(",", ".").strip())
        except:
            return default
    
    def _fmt(self, val):
        """SayÄ±yÄ± temiz formatta gÃ¶ster (29.380000003 â†’ 29.38, 75.0 â†’ 75)"""
        if isinstance(val, float):
            # Tam sayÄ±ysa .0'Ä± kaldÄ±r
            if val == int(val):
                return str(int(val))
            # DeÄŸilse 2 ondalÄ±k
            return f"{val:.2f}".rstrip('0').rstrip('.')
        return str(val)
    
    def _asama0_vetolar(self):
        """
        AÅAMA 0: GÃœVENLÄ°K VE VETO KONTROLLARI
        Hangi bahis tipleri kapatÄ±lacak?
        """
        vetolar = {
            "taraf": False, "ms1": False, "ms2": False,
            "alt": False, "ust": False, 
            "kg_var": False, "kg_yok": False,
            "iy": False
        }
        veto_aciklamalar = []
        
        # VETO-SÃœPER-FAVORÄ°: Oran â‰¤1.35 â†’ TARAF KAPAT
        oran = self._get("oran", 2.0)
        if oran <= 1.35:
            vetolar["taraf"] = True
            vetolar["ms1"] = True
            vetolar["ms2"] = True
            veto_aciklamalar.append(("VETO-SÃœPER-FAVORÄ°", f"Oran {oran} â‰¤ 1.35 â†’ TARAF KAPALI (sadece GOL oyna)"))
        
        # VETO-KEVGÄ°R: Ev Ã§ok gol yiyor â†’ MS1 KAPAT
        ev_yiyen = self._get("ev_yiyen", 50)
        if ev_yiyen >= 80:
            vetolar["ms1"] = True
            veto_aciklamalar.append(("VETO-KEVGÄ°R", f"Ev Yiyen %{ev_yiyen} â‰¥ 80 â†’ MS1 RÄ°SKLÄ°"))
        
        # VETO-HACÄ°M: Toplam ÅŸut Ã§ok yÃ¼ksek â†’ ALT KAPAT
        sut_toplam = self._get("sut_ev", 10) + self._get("sut_dep", 10)
        if sut_toplam >= 30:
            vetolar["alt"] = True
            veto_aciklamalar.append(("VETO-HACÄ°M", f"Toplam Åut {sut_toplam} â‰¥ 30 â†’ ALT KAPALI"))
        
        # VETO-KISIR-TABLO: 2.5Ãœ Ã§ok dÃ¼ÅŸÃ¼k â†’ ÃœST RÄ°SKLÄ°
        ust_25 = self._get("ust_25", 60)
        if ust_25 < 50:
            vetolar["ust"] = True
            veto_aciklamalar.append(("VETO-KISIR-TABLO", f"2.5Ãœ %{ust_25} < 50 â†’ ÃœST RÄ°SKLÄ°"))
        
        # ğŸš¨ K.18-B VETOSU: 2.5 ÃœST iÃ§in %55 ve altÄ± KESÄ°N VETO!
        # Kural: "2.5 Ãœst ortalamasÄ± %55'in altÄ±ndaysa, xG veya ÅŸut ne kadar yÃ¼ksek olursa olsun MS 2.5 ÃœST BANKOSU YAZILAMAZ"
        if ust_25 <= 55:
            vetolar["25_ust"] = True  # Spesifik 2.5 ÃœST vetosu
            veto_aciklamalar.append(("K.18-B", f"2.5Ãœ Ort %{ust_25} â‰¤ 55 â†’ MS 2.5 ÃœST KESÄ°N VETO! (xG fark etmez)"))
            print(f"ğŸš¨ K.18-B VETO: 2.5Ãœ %{ust_25} â‰¤ 55 â†’ 2.5 ÃœST YASAK!")
        
        # VETO-TEK-GÃœÃ‡: Tek taraflÄ± gol gÃ¼cÃ¼ â†’ KG VAR RÄ°SKLÄ°
        ev_atan = self._get("ev_atan", 70)
        dep_atan = self._get("dep_atan", 70)
        if (ev_atan >= 85 and dep_atan < 50) or (dep_atan >= 85 and ev_atan < 50):
            vetolar["kg_var"] = True
            veto_aciklamalar.append(("VETO-TEK-GÃœÃ‡", f"Tek taraflÄ± gol gÃ¼cÃ¼ (Ev:%{ev_atan}, Dep:%{dep_atan}) â†’ KG VAR RÄ°SKLÄ°"))
        
        # VETO-CONVERSION: Ã‡ok dÃ¼ÅŸÃ¼k conversion â†’ GOL bahisleri riskli
        conv_ev = self._get("conv_ev", 12)
        conv_dep = self._get("conv_dep", 12)
        conv_ort = (conv_ev + conv_dep) / 2
        if conv_ort < 8:
            vetolar["ust"] = True
            vetolar["kg_var"] = True
            veto_aciklamalar.append(("VETO-CONVERSION", f"Conv Ort %{conv_ort:.1f} < 8 â†’ GOL bahisleri RÄ°SKLÄ°"))
        
        # VETO-xG-DÄ°RENÃ‡: Ã‡ok dÃ¼ÅŸÃ¼k xG â†’ ÃœST KAPAT
        xg = self._get("xg", 2.5)
        if xg < 1.80:
            vetolar["ust"] = True
            veto_aciklamalar.append(("VETO-xG-DÄ°RENÃ‡", f"xG {xg} < 1.80 â†’ ÃœST KAPALI"))
        
        self.vetolar = veto_aciklamalar
        return vetolar
    
    def _asama1_yuksek_gol(self, vetolar):
        """AÅAMA 1: YÃœKSEK GOL POTANSÄ°YELÄ° (3.5Ãœ, 2.5Ãœ)"""
        sonuclar = []
        
        ust_35 = self._get("ust_35", 40)
        ust_25 = self._get("ust_25", 55)
        xg_toplam = self._get("xg", 2.5)
        ev_atan = self._get("ev_atan", 70)
        dep_atan = self._get("dep_atan", 70)
        sut_toplam = self._get("sut_ev", 10) + self._get("sut_dep", 10)
        conv_ort = (self._get("conv_ev", 12) + self._get("conv_dep", 12)) / 2
        
        # KURAL 1: MS 3.5 ÃœST (YÃ¼ksek Potansiyel)
        # Åartlar: 3.5Ãœ â‰¥45% + xG â‰¥3.00 + Her iki takÄ±m %90+ gol atÄ±yor
        sartlar_35 = [
            (ust_35 >= 45, f"3.5Ãœ %{self._fmt(ust_35)} {'â‰¥' if ust_35 >= 45 else '<'} 45"),
            (xg_toplam >= 3.00, f"xG {self._fmt(xg_toplam)} {'â‰¥' if xg_toplam >= 3.00 else '<'} 3.00"),
            (ev_atan >= 90 and dep_atan >= 90, f"Ã‡ift Atan: %{self._fmt(ev_atan)}/%{self._fmt(dep_atan)} {'â‰¥' if ev_atan >= 90 and dep_atan >= 90 else '<'} 90"),
        ]
        if not vetolar.get("ust") and all(s[0] for s in sartlar_35):
            sonuclar.append({
                "banko": "MS 3.5 ÃœST",
                "asama": 1,
                "kural_no": 1,
                "kural_adi": "MS 3.5 ÃœST (YÃœKSEK POTANSÄ°YEL)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_35],
                "guclu": True,
                "aciklama": "Ã‡ok yÃ¼ksek gol potansiyeli - maÃ§ aÃ§Ä±k geÃ§ecek"
            })
        
        # KURAL 2A: MS 2.5 ÃœST (Yol A - Tablo GÃ¼venliÄŸi)
        # Åartlar: 2.5Ãœ â‰¥62% + xG â‰¥3.20 + Her iki takÄ±m %80+ gol atÄ±yor
        # ğŸš¨ K.18-B: EÄŸer 2.5Ãœ â‰¤55% ise bu kural Ã§alÄ±ÅŸmaz!
        sartlar_25a = [
            (ust_25 >= 62, f"2.5Ãœ %{self._fmt(ust_25)} {'â‰¥' if ust_25 >= 62 else '<'} 62"),
            (xg_toplam >= 3.20, f"xG {self._fmt(xg_toplam)} {'â‰¥' if xg_toplam >= 3.20 else '<'} 3.20"),
            (ev_atan >= 80 and dep_atan >= 80, f"Ã‡ift Atan: %{self._fmt(ev_atan)}/%{self._fmt(dep_atan)} {'â‰¥' if ev_atan >= 80 and dep_atan >= 80 else '<'} 80"),
        ]
        # K.18-B kontrolÃ¼: %55 ve altÄ± ise 2.5 ÃœST YASAK
        if not vetolar.get("ust") and not vetolar.get("25_ust") and all(s[0] for s in sartlar_25a):
            sonuclar.append({
                "banko": "MS 2.5 ÃœST",
                "asama": 1,
                "kural_no": 2,
                "kural_adi": "MS 2.5 ÃœST (YOL A - TABLO GÃœVENLÄ°ÄÄ°)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_25a],
                "guclu": True,
                "aciklama": "YÃ¼ksek tablo + xG + Ã§ift golcÃ¼ takÄ±m"
            })
        
        # KURAL 2B: MS 2.5 ÃœST (Yol B - xG + Åut + Conversion)
        # Åartlar: xG â‰¥2.70 + Åut â‰¥18 + Conv â‰¥12%
        # ğŸš¨ K.18-B: EÄŸer 2.5Ãœ â‰¤55% ise bu kural Ã§alÄ±ÅŸmaz! xG ne kadar yÃ¼ksek olursa olsun!
        sartlar_25b = [
            (xg_toplam >= 2.70, f"xG {self._fmt(xg_toplam)} {'â‰¥' if xg_toplam >= 2.70 else '<'} 2.70"),
            (sut_toplam >= 18, f"Åut {self._fmt(sut_toplam)} {'â‰¥' if sut_toplam >= 18 else '<'} 18"),
            (conv_ort >= 12, f"Conv %{self._fmt(conv_ort)} {'â‰¥' if conv_ort >= 12 else '<'} 12"),
            (ust_25 > 55, f"2.5Ãœ %{self._fmt(ust_25)} {'>' if ust_25 > 55 else 'â‰¤'} 55 (K.18-B)"),  # YENÄ° ÅART!
        ]
        # K.18-B kontrolÃ¼: %55 ve altÄ± ise 2.5 ÃœST YASAK
        if not vetolar.get("ust") and not vetolar.get("25_ust") and all(s[0] for s in sartlar_25b):
            sonuclar.append({
                "banko": "MS 2.5 ÃœST",
                "asama": 1,
                "kural_no": 2,
                "kural_adi": "MS 2.5 ÃœST (YOL B - xG + ÅUT + CONV)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_25b],
                "guclu": True,
                "aciklama": "YÃ¼ksek xG + ÅŸut hacmi + iyi dÃ¶nÃ¼ÅŸÃ¼m"
            })
        
        return sonuclar
    
    def _asama2_karsilikli_gol(self, vetolar):
        """AÅAMA 2: KARÅILIKLI GOL (KG VAR)"""
        sonuclar = []
        
        kg_var = self._get("kg_var", 50)
        ev_atan = self._get("ev_atan", 70)
        dep_atan = self._get("dep_atan", 70)
        ev_yiyen = self._get("ev_yiyen", 50)
        dep_yiyen = self._get("dep_yiyen", 50)
        
        # KURAL 3: KG VAR (Ã‡ift Piston)
        # Åartlar: KG â‰¥55% + Ã‡ift 0.5Ãœ â‰¥70% + Ã‡ift Yeme â‰¥55%
        sartlar_kg = [
            (kg_var >= 55, f"KG VAR %{kg_var} {'â‰¥' if kg_var >= 55 else '<'} 55"),
            (ev_atan >= 70 and dep_atan >= 70, f"Ã‡ift Atan: %{ev_atan}/%{dep_atan} {'â‰¥' if ev_atan >= 70 and dep_atan >= 70 else '<'} 70"),
            (ev_yiyen >= 55 and dep_yiyen >= 55, f"Ã‡ift Yiyen: %{ev_yiyen}/%{dep_yiyen} {'â‰¥' if ev_yiyen >= 55 and dep_yiyen >= 55 else '<'} 55"),
        ]
        if not vetolar.get("kg_var") and all(s[0] for s in sartlar_kg):
            sonuclar.append({
                "banko": "KG VAR",
                "asama": 2,
                "kural_no": 3,
                "kural_adi": "KG VAR (Ã‡Ä°FT PÄ°STON)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_kg],
                "guclu": True,
                "aciklama": "Her iki takÄ±m da gol atar ve yer"
            })
        
        return sonuclar
    
    def _asama3_guvenli_limanlar(self, vetolar):
        """AÅAMA 3: GÃœVENLÄ° GOL LÄ°MANLARI (1.5Ãœ, TakÄ±m Golleri)"""
        sonuclar = []
        
        ust_15 = self._get("ust_15", 75)
        conv_ev = self._get("conv_ev", 12)
        conv_dep = self._get("conv_dep", 12)
        conv_ort = (conv_ev + conv_dep) / 2
        ev_atan = self._get("ev_atan", 70)
        dep_atan = self._get("dep_atan", 70)
        dep_yiyen = self._get("dep_yiyen", 50)
        ev_yiyen = self._get("ev_yiyen", 50)
        
        # KURAL 4: MS 1.5 ÃœST (ÃœÃ§lÃ¼ GÃ¼venlik)
        # Åartlar: 1.5Ãœ â‰¥70% + Conv â‰¥10% + Ã‡ift %70+ gol gÃ¼cÃ¼
        sartlar_15 = [
            (ust_15 >= 70, f"1.5Ãœ %{ust_15} {'â‰¥' if ust_15 >= 70 else '<'} 70"),
            (conv_ort >= 10, f"Conv %{conv_ort:.1f} {'â‰¥' if conv_ort >= 10 else '<'} 10"),
            (ev_atan >= 70 and dep_atan >= 70, f"Ã‡ift Atan: %{ev_atan}/%{dep_atan} {'â‰¥' if ev_atan >= 70 and dep_atan >= 70 else '<'} 70"),
        ]
        if all(s[0] for s in sartlar_15):
            sonuclar.append({
                "banko": "MS 1.5 ÃœST",
                "asama": 3,
                "kural_no": 4,
                "kural_adi": "MS 1.5 ÃœST (ÃœÃ‡LÃœ GÃœVENLÄ°K)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_15],
                "guclu": False,
                "aciklama": "GÃ¼venli gol limanÄ± - en az 2 gol beklenir"
            })
        
        # KURAL 5: EV TAKIM 1.5 ÃœST (GolcÃ¼ Ev)
        # Åartlar: Ev Atan â‰¥85% + 1.5Ãœ â‰¥70% + Rakip yeme â‰¥60%
        sartlar_t15 = [
            (ev_atan >= 85, f"Ev Atan %{ev_atan} {'â‰¥' if ev_atan >= 85 else '<'} 85"),
            (ust_15 >= 70, f"1.5Ãœ %{ust_15} {'â‰¥' if ust_15 >= 70 else '<'} 70"),
            (dep_yiyen >= 60, f"Dep Yiyen %{dep_yiyen} {'â‰¥' if dep_yiyen >= 60 else '<'} 60"),
        ]
        if all(s[0] for s in sartlar_t15):
            sonuclar.append({
                "banko": "EV TAKIM 1.5 ÃœST",
                "asama": 3,
                "kural_no": 5,
                "kural_adi": "EV TAKIM 1.5 ÃœST (GOLCÃœ EV SAHÄ°BÄ°)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_t15],
                "guclu": False,
                "aciklama": "Ev sahibi en az 2 gol atar"
            })
        
        # KURAL 6: EV TAKIM 0.5 ÃœST (Garanti Gol)
        # Åartlar: Ev Atan â‰¥80% + Rakip yeme â‰¥49%
        sartlar_t05 = [
            (ev_atan >= 80, f"Ev Atan %{ev_atan} {'â‰¥' if ev_atan >= 80 else '<'} 80"),
            (dep_yiyen >= 49, f"Dep Yiyen %{dep_yiyen} {'â‰¥' if dep_yiyen >= 49 else '<'} 49"),
        ]
        if all(s[0] for s in sartlar_t05):
            sonuclar.append({
                "banko": "EV TAKIM 0.5 ÃœST",
                "asama": 3,
                "kural_no": 6,
                "kural_adi": "EV TAKIM 0.5 ÃœST (GARANTÄ° GOL)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_t05],
                "guclu": False,
                "aciklama": "Ev sahibi gol atar"
            })
        
        # DEP TAKIM 0.5 ÃœST
        sartlar_d05 = [
            (dep_atan >= 80, f"Dep Atan %{dep_atan} {'â‰¥' if dep_atan >= 80 else '<'} 80"),
            (ev_yiyen >= 49, f"Ev Yiyen %{ev_yiyen} {'â‰¥' if ev_yiyen >= 49 else '<'} 49"),
        ]
        if all(s[0] for s in sartlar_d05):
            sonuclar.append({
                "banko": "DEP TAKIM 0.5 ÃœST",
                "asama": 3,
                "kural_no": 6,
                "kural_adi": "DEP TAKIM 0.5 ÃœST (DEPLASMAN GOLÃœ)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_d05],
                "guclu": False,
                "aciklama": "Deplasman gol atar"
            })
        
        return sonuclar
    
    def _asama4_taraf(self, vetolar):
        """AÅAMA 4: TARAF VE GALÄ°BÄ°YET (MS1, MS2)"""
        sonuclar = []
        
        oran = self._get("oran", 2.0)
        ev_atan = self._get("ev_atan", 70)
        dep_atan = self._get("dep_atan", 70)
        conv_ev = self._get("conv_ev", 12)
        conv_dep = self._get("conv_dep", 12)
        ev_yiyen = self._get("ev_yiyen", 50)
        dep_yiyen = self._get("dep_yiyen", 50)
        
        # KURAL 7A: MS 1 EV KAZANIR
        # Åartlar: Oran 1.36-2.20 + Ev Kazanma â‰¥55% + Conv â‰¥12% + Dep dÃ¼ÅŸÃ¼k gol
        sartlar_ms1 = [
            (1.36 <= oran <= 2.20, f"Oran {oran} {'1.36-2.20 arasÄ±' if 1.36 <= oran <= 2.20 else 'dÄ±ÅŸÄ±'}"),
            (ev_atan >= 70, f"Ev Atan %{ev_atan} {'â‰¥' if ev_atan >= 70 else '<'} 70"),
            (conv_ev >= 12, f"Conv Ev %{conv_ev} {'â‰¥' if conv_ev >= 12 else '<'} 12"),
            (dep_atan < 70, f"Dep Atan %{dep_atan} {'<' if dep_atan < 70 else 'â‰¥'} 70"),
        ]
        if not vetolar.get("taraf") and not vetolar.get("ms1") and all(s[0] for s in sartlar_ms1):
            sonuclar.append({
                "banko": "MS 1 (EV KAZANIR)",
                "asama": 4,
                "kural_no": 7,
                "kural_adi": "MS TARAF (EV GALÄ°BÄ°YETÄ°)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_ms1],
                "guclu": False,
                "aciklama": "Ev sahibi galibiyeti beklenir"
            })
        
        # KURAL 7B: MS 2 DEP KAZANIR (daha gÃ¼Ã§lÃ¼ deplasman durumu)
        sartlar_ms2 = [
            (1.50 <= oran <= 2.50, f"Oran {oran} {'1.50-2.50 arasÄ±' if 1.50 <= oran <= 2.50 else 'dÄ±ÅŸÄ±'}"),
            (dep_atan >= 75, f"Dep Atan %{dep_atan} {'â‰¥' if dep_atan >= 75 else '<'} 75"),
            (conv_dep >= 12, f"Conv Dep %{conv_dep} {'â‰¥' if conv_dep >= 12 else '<'} 12"),
            (ev_atan < 65, f"Ev Atan %{ev_atan} {'<' if ev_atan < 65 else 'â‰¥'} 65"),
            (ev_yiyen >= 60, f"Ev Yiyen %{ev_yiyen} {'â‰¥' if ev_yiyen >= 60 else '<'} 60"),
        ]
        if not vetolar.get("taraf") and not vetolar.get("ms2") and all(s[0] for s in sartlar_ms2):
            sonuclar.append({
                "banko": "MS 2 (DEP KAZANIR)",
                "asama": 4,
                "kural_no": 7,
                "kural_adi": "MS TARAF (DEPLASMAN GALÄ°BÄ°YETÄ°)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_ms2],
                "guclu": False,
                "aciklama": "Deplasman galibiyeti beklenir"
            })
        
        return sonuclar
    
    def _asama5_ilk_yari(self, vetolar):
        """AÅAMA 5: Ä°LK YARI (Ä°Y GALÄ°BÄ°YET, Ä°Y 1.5Ãœ)"""
        sonuclar = []
        
        iy_ev = self._get("iy_ev_gol", 60)
        iy_dep = self._get("iy_dep_gol", 60)
        iy_ort = (iy_ev + iy_dep) / 2
        lig_gol_ort = self._get("lig_gol_ort", 2.5)
        ev_atan = self._get("ev_atan", 70)
        
        # KURAL 8: Ä°Y EV GALÄ°BÄ°YETÄ°
        # Åartlar: Ä°Y Ev â‰¥75% + Ä°Y Ort â‰¥70% + Ev Atan â‰¥80%
        sartlar_iy_gal = [
            (iy_ev >= 75, f"Ä°Y Ev %{iy_ev} {'â‰¥' if iy_ev >= 75 else '<'} 75"),
            (iy_ort >= 70, f"Ä°Y Ort %{iy_ort:.1f} {'â‰¥' if iy_ort >= 70 else '<'} 70"),
            (ev_atan >= 80, f"Ev Atan %{ev_atan} {'â‰¥' if ev_atan >= 80 else '<'} 80"),
        ]
        if not vetolar.get("iy") and all(s[0] for s in sartlar_iy_gal):
            sonuclar.append({
                "banko": "Ä°Y EV GALÄ°BÄ°YETÄ°",
                "asama": 5,
                "kural_no": 8,
                "kural_adi": "Ä°Y GALÄ°BÄ°YET (ERKEN BASKISI)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_iy_gal],
                "guclu": False,
                "aciklama": "Ä°lk yarÄ±da ev sahibi Ã¶nde olur"
            })
        
        # KURAL 9: Ä°Y 1.5 ÃœST
        # Åartlar: Ä°Y Ort â‰¥68% + Lig Gol Ort â‰¥2.15
        sartlar_iy_15 = [
            (iy_ort >= 68, f"Ä°Y Ort %{iy_ort:.1f} {'â‰¥' if iy_ort >= 68 else '<'} 68"),
            (lig_gol_ort >= 2.15, f"Lig Ort {lig_gol_ort} {'â‰¥' if lig_gol_ort >= 2.15 else '<'} 2.15"),
        ]
        if not vetolar.get("iy") and all(s[0] for s in sartlar_iy_15):
            sonuclar.append({
                "banko": "Ä°Y 1.5 ÃœST",
                "asama": 5,
                "kural_no": 9,
                "kural_adi": "Ä°Y 1.5 ÃœST (Ä°LK YARI GOLCÃœ)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_iy_15],
                "guclu": False,
                "aciklama": "Ä°lk yarÄ±da en az 2 gol"
            })
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # Ä°Y 0.5 ÃœST - BÃ–LÃœM 8 KURALLARI (KESÄ°N UYGULAMA)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # KATI BARAJ: %70 (Lig ort â‰¥2.80 ise %68)
        # TEK TABANCA Ä°STÄ°SNASI: Tek takÄ±m â‰¥%90 ise ortalama tutmasa bile GEÃ‡
        
        # Lig istisnasÄ± kontrolÃ¼
        iy_baraj = 68 if lig_gol_ort >= 2.80 else 70
        
        # Tek Tabanca kontrolÃ¼
        tek_tabanca_ev = iy_ev >= 90
        tek_tabanca_dep = iy_dep >= 90
        tek_tabanca_aktif = tek_tabanca_ev or tek_tabanca_dep
        
        # Normal baraj kontrolÃ¼
        baraj_gecti = iy_ort >= iy_baraj
        
        # Ä°Y 0.5 ÃœST ÅŸartlarÄ±
        iy_05_gecti = baraj_gecti or tek_tabanca_aktif
        
        sartlar_iy_05 = []
        if tek_tabanca_aktif:
            sartlar_iy_05 = [
                (tek_tabanca_aktif, f"TEK TABANCA AKTÄ°F: {'Ev' if tek_tabanca_ev else 'Dep'} %{iy_ev if tek_tabanca_ev else iy_dep} â‰¥90 âœ…"),
                (True, f"Ortalama %{iy_ort:.1f} (Tek Tabanca ile bypass)")
            ]
        else:
            sartlar_iy_05 = [
                (iy_ort >= iy_baraj, f"Ä°Y Ort %{iy_ort:.1f} {'â‰¥' if iy_ort >= iy_baraj else '<'} {iy_baraj} (Baraj)"),
                (False, f"Tek Tabanca: Ev %{iy_ev} / Dep %{iy_dep} (ikisi de <%90)")
            ]
        
        if not vetolar.get("iy") and iy_05_gecti:
            sonuclar.append({
                "banko": "Ä°Y 0.5 ÃœST",
                "asama": 5,
                "kural_no": 10,
                "kural_adi": f"Ä°Y 0.5 ÃœST ({'TEK TABANCA' if tek_tabanca_aktif else 'BARAJ GEÃ‡TÄ°'})",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_iy_05],
                "guclu": tek_tabanca_aktif,  # Tek tabanca varsa gÃ¼Ã§lÃ¼
                "aciklama": f"Ä°lk yarÄ±da gol olur - {'Tek takÄ±m %90+ garantisi' if tek_tabanca_aktif else 'Ortalama baraj geÃ§ti'}"
            })
        
        return sonuclar
    
    def _asama6_negatif(self, vetolar):
        """AÅAMA 6: NEGATÄ°F BAHÄ°SLER (2.5 ALT, KG YOK) - Son Ã‡are"""
        sonuclar = []
        
        xg_toplam = self._get("xg", 2.5)
        sut_toplam = self._get("sut_ev", 10) + self._get("sut_dep", 10)
        ev_atan = self._get("ev_atan", 70)
        dep_atan = self._get("dep_atan", 70)
        ev_yiyen = self._get("ev_yiyen", 50)
        dep_yiyen = self._get("dep_yiyen", 50)
        ust_25 = self._get("ust_25", 60)
        
        # KURAL 10: 2.5 ALT (KÄ±sÄ±r MaÃ§)
        # Åartlar: xG <2.00 + Åut <18 + Ã‡ift Atan <65%
        sartlar_alt = [
            (xg_toplam < 2.00, f"xG {xg_toplam} {'<' if xg_toplam < 2.00 else 'â‰¥'} 2.00"),
            (sut_toplam < 18, f"Åut {sut_toplam} {'<' if sut_toplam < 18 else 'â‰¥'} 18"),
            (ev_atan < 65 and dep_atan < 65, f"Ã‡ift Atan: %{ev_atan}/%{dep_atan} {'<' if ev_atan < 65 and dep_atan < 65 else 'â‰¥'} 65"),
        ]
        if not vetolar.get("alt") and all(s[0] for s in sartlar_alt):
            sonuclar.append({
                "banko": "MS 2.5 ALT",
                "asama": 6,
                "kural_no": 10,
                "kural_adi": "2.5 ALT (KISIR MAÃ‡)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_alt],
                "guclu": False,
                "aciklama": "DÃ¼ÅŸÃ¼k gol beklentisi - max 2 gol"
            })
        
        # KURAL 11: KG YOK (Tek TaraflÄ± MaÃ§)
        # Åartlar: Ev Atan <65% + Dep Atan <65% + Ã‡ift Yiyen <40%
        sartlar_kgyok = [
            (ev_atan < 65, f"Ev Atan %{ev_atan} {'<' if ev_atan < 65 else 'â‰¥'} 65"),
            (dep_atan < 65, f"Dep Atan %{dep_atan} {'<' if dep_atan < 65 else 'â‰¥'} 65"),
            (ev_yiyen < 40 or dep_yiyen < 40, f"Bir Yiyen: %{ev_yiyen}/%{dep_yiyen} {'<' if ev_yiyen < 40 or dep_yiyen < 40 else 'â‰¥'} 40"),
        ]
        if not vetolar.get("kg_yok") and all(s[0] for s in sartlar_kgyok):
            sonuclar.append({
                "banko": "KG YOK",
                "asama": 6,
                "kural_no": 11,
                "kural_adi": "KG YOK (TEK TARAFLI MAÃ‡)",
                "sartlar": [f"{'âœ…' if s[0] else 'âŒ'} {s[1]}" for s in sartlar_kgyok],
                "guclu": False,
                "aciklama": "KarÅŸÄ±lÄ±klÄ± gol beklenmez"
            })
        
        return sonuclar
    
    def sec(self):
        """
        Ana seÃ§im metodu - Ä°lk TRUE dÃ¶nen kural = BANKO
        
        Returns:
            dict: SeÃ§ilen banko ve detaylarÄ±
        """
        # AÅŸama 0: VetolarÄ± al
        vetolar = self._asama0_vetolar()
        
        # TÃ¼m aÅŸamalarÄ± sÄ±rayla kontrol et
        tum_sonuclar = []
        
        # AÅŸama 1: YÃ¼ksek gol
        tum_sonuclar.extend(self._asama1_yuksek_gol(vetolar))
        
        # AÅŸama 2: KarÅŸÄ±lÄ±klÄ± gol
        tum_sonuclar.extend(self._asama2_karsilikli_gol(vetolar))
        
        # AÅŸama 3: GÃ¼venli limanlar
        tum_sonuclar.extend(self._asama3_guvenli_limanlar(vetolar))
        
        # AÅŸama 4: Taraf
        tum_sonuclar.extend(self._asama4_taraf(vetolar))
        
        # AÅŸama 5: Ä°lk yarÄ±
        tum_sonuclar.extend(self._asama5_ilk_yari(vetolar))
        
        # AÅŸama 6: Negatif (son Ã§are)
        tum_sonuclar.extend(self._asama6_negatif(vetolar))
        
        self.gecen_kurallar = tum_sonuclar
        
        if tum_sonuclar:
            # Ä°lk geÃ§en kural = BANKO
            self.secilen_banko = tum_sonuclar[0]
            
            # Alternatif = 2. sÄ±radaki
            if len(tum_sonuclar) > 1:
                self.alternatif = tum_sonuclar[1]["banko"]
            else:
                self.alternatif = "MS 0.5 ÃœST"
            
            return {
                "banko": self.secilen_banko["banko"],
                "asama": self.secilen_banko["asama"],
                "kural_no": self.secilen_banko["kural_no"],
                "kural_adi": self.secilen_banko["kural_adi"],
                "sartlar": self.secilen_banko["sartlar"],
                "guclu": self.secilen_banko.get("guclu", False),
                "aciklama": self.secilen_banko.get("aciklama", ""),
                "alternatif": self.alternatif,
                "vetolar": self.vetolar,
                "gecen_kural_sayisi": len(tum_sonuclar),
                "tum_gecenler": [s["banko"] for s in tum_sonuclar]
            }
        else:
            # HiÃ§bir kural geÃ§mediyse
            return {
                "banko": "MS 0.5 ÃœST",
                "asama": 99,
                "kural_no": 99,
                "kural_adi": "SON DAMLA (HÄ°Ã‡BÄ°R KURAL GEÃ‡MEDÄ°)",
                "sartlar": ["âš ï¸ HiÃ§bir banko ÅŸartÄ± saÄŸlanmadÄ±"],
                "guclu": False,
                "aciklama": "HiÃ§bir kural saÄŸlanmadÄ±, en gÃ¼venli seÃ§enek",
                "alternatif": "BAHÄ°S YAPMA",
                "vetolar": self.vetolar,
                "gecen_kural_sayisi": 0,
                "tum_gecenler": []
            }
    
    def rapor_olustur(self):
        """DetaylÄ± BÃ–LÃœM 5 raporu oluÅŸtur"""
        sonuc = self.sec()
        
        rapor = []
        rapor.append("=" * 70)
        rapor.append("ğŸ¯ BÃ–LÃœM 5 HÄ°YERARÅÄ°K BANKO SEÃ‡Ä°MÄ°")
        rapor.append("=" * 70)
        rapor.append("")
        
        # SeÃ§ilen banko
        rapor.append(f"ğŸ† SEÃ‡Ä°LEN BANKO: {sonuc['banko']}")
        rapor.append(f"ğŸ“Œ Kural: {sonuc['kural_adi']}")
        rapor.append(f"ğŸ”¢ AÅŸama: {sonuc['asama']}")
        rapor.append(f"{'ğŸ’ª GÃœÃ‡LÃœ BAHÄ°S' if sonuc['guclu'] else 'ğŸ“Š STANDART BAHÄ°S'}")
        rapor.append(f"ğŸ“ {sonuc.get('aciklama', '')}")
        rapor.append("")
        
        # Åartlar
        rapor.append("-" * 40)
        rapor.append("ğŸ“‹ SAÄLANAN ÅARTLAR:")
        rapor.append("-" * 40)
        for sart in sonuc["sartlar"]:
            rapor.append(f"   {sart}")
        rapor.append("")
        
        # Alternatif
        rapor.append(f"ğŸ”„ ALTERNATÄ°F: {sonuc['alternatif']}")
        rapor.append("")
        
        # Vetolar
        if sonuc["vetolar"]:
            rapor.append("-" * 40)
            rapor.append("ğŸš« AKTÄ°F VETOLAR:")
            rapor.append("-" * 40)
            for veto in sonuc["vetolar"]:
                rapor.append(f"   â›” {veto[0]}: {veto[1]}")
            rapor.append("")
        
        # TÃ¼m geÃ§en kurallar
        if sonuc["gecen_kural_sayisi"] > 1:
            rapor.append("-" * 40)
            rapor.append(f"âœ… GEÃ‡EN TÃœM KURALLAR ({sonuc['gecen_kural_sayisi']} adet):")
            rapor.append("-" * 40)
            for i, banko in enumerate(sonuc["tum_gecenler"], 1):
                rapor.append(f"   {i}. {banko}")
            rapor.append("")
        
        rapor.append("=" * 70)
        
        return "\n".join(rapor)


def bolum5_banko_sec(mac_verisi):
    """BÃ–LÃœM 5 kurallarÄ±na gÃ¶re banko seÃ§ - DÄ±ÅŸ fonksiyon"""
    secici = Bolum5BankoSecici(mac_verisi)
    return secici.sec()


def bolum5_rapor(mac_verisi):
    """BÃ–LÃœM 5 detaylÄ± rapor oluÅŸtur"""
    secici = Bolum5BankoSecici(mac_verisi)
    return secici.rapor_olustur()


# ============================================================
# ğŸ”¬ GELÄ°ÅMÄ°Å OTOPSÄ° SÄ°STEMÄ° (YENÄ°!)
# ============================================================
class OtopsiSistemi:
    """
    GELÄ°ÅMÄ°Å OTOPSÄ° SÄ°STEMÄ°
    
    Ã–zellikler:
    - Skor parsing (2-1, 2:1, 2 - 1 formatlarÄ±)
    - Tahmin doÄŸrulama (tuttu/yattÄ± kontrolÃ¼)
    - BÃ–LÃœM 5 kural analizi (hangi kuralla seÃ§ildi)
    - BaÅŸarÄ±sÄ±zlÄ±k analizi (neden yattÄ± - kural ihlalleri)
    - DetaylÄ± rapor oluÅŸturma
    - Ã–ÄŸrenme iÃ§in ders Ã§Ä±karma
    """
    
    def __init__(self, mac_verisi, gercek_skor, oynanan_banko):
        """
        Args:
            mac_verisi: MaÃ§ istatistikleri dict
            gercek_skor: GerÃ§ek skor (Ã¶rn: "2-1", "2:1", "2 - 1")
            oynanan_banko: Oynanan banko tahmini (Ã¶rn: "MS 2.5 ÃœST")
        """
        self.v = mac_verisi
        self.skor = gercek_skor
        self.banko = oynanan_banko
        self.ev_gol = 0
        self.dep_gol = 0
        self.toplam_gol = 0
        self.sonuc = None
        self._parse_skor()
    
    def _parse_skor(self):
        """Skoru parse et - farklÄ± formatlarÄ± destekler"""
        if not self.skor:
            return
        
        skor_temiz = str(self.skor).strip()
        
        # FarklÄ± formatlarÄ± dene: "2-1", "2:1", "2 - 1", "2 : 1"
        ayiricilar = [" - ", " : ", "-", ":"]
        
        for ayirici in ayiricilar:
            if ayirici in skor_temiz:
                parcalar = skor_temiz.split(ayirici)
                if len(parcalar) == 2:
                    try:
                        self.ev_gol = int(parcalar[0].strip())
                        self.dep_gol = int(parcalar[1].strip())
                        self.toplam_gol = self.ev_gol + self.dep_gol
                        return
                    except ValueError:
                        continue
    
    def _get(self, key, default=0):
        """GÃ¼venli deÄŸer alma"""
        val = self.v.get(key, default)
        if val is None or val == "" or val == "?":
            return default
        try:
            return float(str(val).replace("%", "").replace(",", ".").strip())
        except:
            return default
    
    def tahmin_kontrol(self):
        """
        Oynanan bankonun tutup tutmadÄ±ÄŸÄ±nÄ± kontrol et
        
        Returns:
            dict: {"tuttu": bool/None, "aciklama": str}
        """
        if self.toplam_gol == 0 and self.ev_gol == 0 and self.dep_gol == 0 and self.skor:
            # Skor girilmiÅŸ ama parse edilememiÅŸ
            return {"tuttu": None, "aciklama": "Skor formatÄ± tanÄ±namadÄ±"}
        
        if not self.skor:
            return {"tuttu": None, "aciklama": "Skor bilgisi yok"}
        
        banko_lower = self.banko.lower().strip()
        
        # === MS1 / MS2 / X kontrolleri ===
        if any(x in banko_lower for x in ["ms 1", "ms1", "ev kazanÄ±r", "ev kazanir"]):
            tuttu = self.ev_gol > self.dep_gol
            return {"tuttu": tuttu, "aciklama": f"MS1: {self.ev_gol}-{self.dep_gol} â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
        
        if any(x in banko_lower for x in ["ms 2", "ms2", "dep kazanÄ±r", "dep kazanir", "deplasman kazanÄ±r"]):
            tuttu = self.dep_gol > self.ev_gol
            return {"tuttu": tuttu, "aciklama": f"MS2: {self.ev_gol}-{self.dep_gol} â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
        
        if any(x in banko_lower for x in ["beraberlik", "msx", "ms x"]):
            tuttu = self.ev_gol == self.dep_gol
            return {"tuttu": tuttu, "aciklama": f"MSX: {self.ev_gol}-{self.dep_gol} â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
        
        # === Gol Ã¼stÃ¼ kontrolleri ===
        if "3.5 Ã¼st" in banko_lower or "3.5Ã¼" in banko_lower or "3.5 ust" in banko_lower:
            tuttu = self.toplam_gol >= 4
            return {"tuttu": tuttu, "aciklama": f"3.5Ãœ: {self.toplam_gol} gol â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
        
        if "2.5 Ã¼st" in banko_lower or "2.5Ã¼" in banko_lower or "2.5 ust" in banko_lower:
            tuttu = self.toplam_gol >= 3
            return {"tuttu": tuttu, "aciklama": f"2.5Ãœ: {self.toplam_gol} gol â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
        
        if "1.5 Ã¼st" in banko_lower or "1.5Ã¼" in banko_lower or "1.5 ust" in banko_lower:
            # TakÄ±m mÄ± maÃ§ mÄ±?
            if any(x in banko_lower for x in ["ev", "takim", "takÄ±m"]):
                tuttu = self.ev_gol >= 2
                return {"tuttu": tuttu, "aciklama": f"Ev 1.5Ãœ: {self.ev_gol} gol â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
            elif any(x in banko_lower for x in ["dep", "deplasman"]):
                tuttu = self.dep_gol >= 2
                return {"tuttu": tuttu, "aciklama": f"Dep 1.5Ãœ: {self.dep_gol} gol â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
            else:
                tuttu = self.toplam_gol >= 2
                return {"tuttu": tuttu, "aciklama": f"1.5Ãœ: {self.toplam_gol} gol â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
        
        if "0.5 Ã¼st" in banko_lower or "0.5Ã¼" in banko_lower or "0.5 ust" in banko_lower:
            if any(x in banko_lower for x in ["ev", "takim", "takÄ±m"]):
                tuttu = self.ev_gol >= 1
                return {"tuttu": tuttu, "aciklama": f"Ev 0.5Ãœ: {self.ev_gol} gol â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
            elif any(x in banko_lower for x in ["dep", "deplasman"]):
                tuttu = self.dep_gol >= 1
                return {"tuttu": tuttu, "aciklama": f"Dep 0.5Ãœ: {self.dep_gol} gol â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
            else:
                tuttu = self.toplam_gol >= 1
                return {"tuttu": tuttu, "aciklama": f"0.5Ãœ: {self.toplam_gol} gol â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
        
        # === Gol altÄ± kontrolleri ===
        if "2.5 alt" in banko_lower or "2.5a" in banko_lower:
            tuttu = self.toplam_gol <= 2
            return {"tuttu": tuttu, "aciklama": f"2.5A: {self.toplam_gol} gol â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
        
        if "1.5 alt" in banko_lower or "1.5a" in banko_lower:
            tuttu = self.toplam_gol <= 1
            return {"tuttu": tuttu, "aciklama": f"1.5A: {self.toplam_gol} gol â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
        
        # === KG VAR / KG YOK ===
        if "kg var" in banko_lower:
            tuttu = self.ev_gol >= 1 and self.dep_gol >= 1
            return {"tuttu": tuttu, "aciklama": f"KG VAR: {self.ev_gol}-{self.dep_gol} â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
        
        if "kg yok" in banko_lower:
            tuttu = self.ev_gol == 0 or self.dep_gol == 0
            return {"tuttu": tuttu, "aciklama": f"KG YOK: {self.ev_gol}-{self.dep_gol} â†’ {'âœ… TUTTU' if tuttu else 'âŒ YATTI'}"}
        
        # === Ä°Y kontrolleri ===
        if "iy" in banko_lower or "ilk yarÄ±" in banko_lower:
            return {"tuttu": None, "aciklama": "Ä°Y skoru ayrÄ± girilmeli"}
        
        return {"tuttu": None, "aciklama": f"Bilinmeyen banko tipi: {self.banko}"}
    
    def banko_kural_analizi(self):
        """
        BÃ–LÃœM 5 ile bankonun hangi kuralla seÃ§ildiÄŸini analiz et
        
        Returns:
            dict: Kural detaylarÄ±
        """
        secici = Bolum5BankoSecici(self.v)
        sonuc = secici.sec()
        
        return {
            "secilen_kural": sonuc.get("kural_adi", "BÄ°LÄ°NMÄ°YOR"),
            "asama": sonuc.get("asama", 0),
            "kural_no": sonuc.get("kural_no", 0),
            "sartlar": sonuc.get("sartlar", []),
            "alternatif": sonuc.get("alternatif", "YOK"),
            "vetolar": sonuc.get("vetolar", []),
            "tum_gecenler": sonuc.get("tum_gecenler", []),
            "bolum5_banko": sonuc.get("banko", "?")
        }
    
    def neden_yatti_analizi(self):
        """
        BaÅŸarÄ±sÄ±zlÄ±k analizi - Neden yattÄ±?
        
        Returns:
            list: Kural ihlalleri listesi
        """
        ihlaller = []
        
        ev_atan = self._get("ev_atan", 70)
        dep_atan = self._get("dep_atan", 70)
        ev_yiyen = self._get("ev_yiyen", 50)
        dep_yiyen = self._get("dep_yiyen", 50)
        xg = self._get("xg", 2.5)
        ust_25 = self._get("ust_25", 60)
        conv_ev = self._get("conv_ev", 12)
        conv_dep = self._get("conv_dep", 12)
        kg_var = self._get("kg_var", 50)
        
        banko_lower = self.banko.lower()
        
        # TakÄ±m isimlerini al
        ev_takim = str(self.v.get("ev_takimi", self.v.get("ev", ""))).lower()
        dep_takim = str(self.v.get("dep_takimi", self.v.get("dep", ""))).lower()
        mac_adi = str(self.v.get("mac_adi", self.v.get("mac", ""))).lower()
        
        # MS1 mi MS2 mi belirleme
        # "Kortrijk KazanÄ±r" gibi ifadelerde takÄ±m adÄ±nÄ± bul
        ms1_oynandi = any(x in banko_lower for x in ["ms 1", "ms1", "ev kazanÄ±r", "ev kazanir", "ev galibiyet"])
        ms2_oynandi = any(x in banko_lower for x in ["ms 2", "ms2", "dep kazanÄ±r", "dep kazanir", "deplasman kazanÄ±r", "deplasman kazanir", "deplasman galibiyet"])
        
        # EÄŸer "X KazanÄ±r" formatÄ±nda ise, takÄ±m adÄ±nÄ± bul
        if "kazanÄ±r" in banko_lower or "kazanir" in banko_lower:
            # Dep takÄ±m adÄ± banko'da geÃ§iyorsa MS2
            if dep_takim and any(word in banko_lower for word in dep_takim.split()[:2]):  # Ä°lk 2 kelimeyi kontrol et
                ms2_oynandi = True
            # Ev takÄ±m adÄ± banko'da geÃ§iyorsa MS1
            elif ev_takim and any(word in banko_lower for word in ev_takim.split()[:2]):
                ms1_oynandi = True
            # mac_adi'ndan tahmin et (Ã¶rn: "Lierse vs Kortrijk" â†’ "Kortrijk KazanÄ±r" = MS2)
            elif "vs" in mac_adi or " - " in mac_adi:
                mac_parcalari = mac_adi.replace(" vs ", " - ").split(" - ")
                if len(mac_parcalari) >= 2:
                    ev_kismi = mac_parcalari[0].strip()
                    dep_kismi = mac_parcalari[1].strip()
                    if any(word in banko_lower for word in dep_kismi.split()[:2]):
                        ms2_oynandi = True
                    elif any(word in banko_lower for word in ev_kismi.split()[:2]):
                        ms1_oynandi = True
        
        taraf_oynandi = ms1_oynandi or ms2_oynandi
        
        # === KURAL Ä°HLALLERÄ° ===
        
        # K.KEVGÄ°R-FAVORÄ°: Ev Ã§ok gol yiyor ama MS1 oynadÄ±k
        if ms1_oynandi and ev_yiyen >= 80:
            ihlaller.append({
                "tip": "KURAL Ä°HLALÄ°",
                "kural": "K.KEVGÄ°R-FAVORÄ°",
                "aciklama": f"Ev %{self._fmt(ev_yiyen)} gol yiyor (â‰¥80% RÄ°SKLÄ°!)",
                "cozum": "MS1 yerine KG VAR veya 1.5Ãœ oynamalÄ±ydÄ±n",
                "onem": "YÃœKSEK"
            })
        
        # K.RAKÄ°P-DÄ°ÅLÄ°: Deplasman Ã§ok golcÃ¼ ama MS1 oynadÄ±k
        if ms1_oynandi and dep_atan >= 80:
            ihlaller.append({
                "tip": "KURAL Ä°HLALÄ°",
                "kural": "K.RAKÄ°P-DÄ°ÅLÄ°",
                "aciklama": f"Deplasman %{self._fmt(dep_atan)} gol atÄ±yor (â‰¥80% DÄ°KKAT!)",
                "cozum": "MS1 yerine KG VAR veya maÃ§tan uzak dur",
                "onem": "YÃœKSEK"
            })
        
        # K.EV-DÄ°ÅLÄ°: Ev Ã§ok golcÃ¼ ama MS2 oynadÄ±k
        if ms2_oynandi and ev_atan >= 80:
            ihlaller.append({
                "tip": "KURAL Ä°HLALÄ°",
                "kural": "K.EV-DÄ°ÅLÄ°",
                "aciklama": f"Ev sahibi %{self._fmt(ev_atan)} gol atÄ±yor (â‰¥80% DÄ°KKAT!)",
                "cozum": "MS2 yerine KG VAR veya maÃ§tan uzak dur",
                "onem": "YÃœKSEK"
            })
        
        # K.DEPLASMAN-KEVGÄ°R: Deplasman Ã§ok gol yiyor ama MS2 oynadÄ±k
        if ms2_oynandi and dep_yiyen >= 80:
            ihlaller.append({
                "tip": "KURAL Ä°HLALÄ°",
                "kural": "K.DEPLASMAN-KEVGÄ°R",
                "aciklama": f"Deplasman %{self._fmt(dep_yiyen)} gol yiyor (â‰¥80% RÄ°SKLÄ°!)",
                "cozum": "MS2 yerine KG VAR veya 1.5Ãœ oynamalÄ±ydÄ±n",
                "onem": "YÃœKSEK"
            })
        
        # Ã‡Ä°FT GOLCÃœ: Ä°ki taraf da golcÃ¼ ama taraf oynadÄ±k
        if taraf_oynandi and ev_atan >= 75 and dep_atan >= 75:
            ihlaller.append({
                "tip": "KURAL Ä°HLALÄ°",
                "kural": "Ã‡Ä°FT GOLCÃœ",
                "aciklama": f"Her iki taraf golcÃ¼: Ev %{self._fmt(ev_atan)}, Dep %{self._fmt(dep_atan)}",
                "cozum": "TARAF yerine KG VAR veya 1.5Ãœ oynamalÄ±ydÄ±n",
                "onem": "YÃœKSEK"
            })
        
        # K.xG-DÄ°RENCÄ°: DÃ¼ÅŸÃ¼k xG ama ÃœST oynadÄ±k
        if any(x in banko_lower for x in ["Ã¼st", "ust"]) and xg < 2.30:
            ihlaller.append({
                "tip": "KURAL Ä°HLALÄ°",
                "kural": "K.xG-DÄ°RENCÄ°",
                "aciklama": f"xG sadece {self._fmt(xg)} (<2.30 RÄ°SKLÄ°!)",
                "cozum": "xG dÃ¼ÅŸÃ¼kken ÃœST oynama, ALT veya TARAF dÃ¼ÅŸÃ¼n",
                "onem": "ORTA"
            })
        
        # K.KISIR-TABLO: DÃ¼ÅŸÃ¼k 2.5Ãœ oranÄ± ama 2.5Ãœ oynadÄ±k
        if "2.5" in banko_lower and any(x in banko_lower for x in ["Ã¼st", "ust"]) and ust_25 < 55:
            ihlaller.append({
                "tip": "KURAL Ä°HLALÄ°",
                "kural": "K.KISIR-TABLO",
                "aciklama": f"2.5Ãœ tablosu %{self._fmt(ust_25)} (<55% DÃœÅÃœK!)",
                "cozum": "Tablo dÃ¼ÅŸÃ¼kken 2.5Ãœ oynama, 1.5Ãœ veya 0.5Ãœ seÃ§",
                "onem": "ORTA"
            })
        
        # K.TEK-GÃœÃ‡: Bir taraf Ã§ok zayÄ±f ama KG VAR oynadÄ±k
        if "kg var" in banko_lower:
            if ev_atan < 55 or dep_atan < 55:
                zayif = "Ev" if ev_atan < 55 else "Deplasman"
                zayif_val = ev_atan if ev_atan < 55 else dep_atan
                ihlaller.append({
                    "tip": "KURAL Ä°HLALÄ°",
                    "kural": "K.TEK-GÃœÃ‡",
                    "aciklama": f"{zayif} sadece %{self._fmt(zayif_val)} gol atÄ±yor (<55%)",
                    "cozum": "Tek taraflÄ± gol gÃ¼cÃ¼ varken KG VAR oynama",
                    "onem": "YÃœKSEK"
                })
        
        # K.CONVERSION: DÃ¼ÅŸÃ¼k conversion ama gol bahsi
        conv_ort = (conv_ev + conv_dep) / 2
        if any(x in banko_lower for x in ["Ã¼st", "ust", "kg"]) and conv_ort < 10:
            ihlaller.append({
                "tip": "KURAL Ä°HLALÄ°",
                "kural": "K.CONVERSION",
                "aciklama": f"Conversion ortalamasÄ± %{self._fmt(conv_ort)} (<10% DÃœÅÃœK!)",
                "cozum": "DÃ¼ÅŸÃ¼k conversion'da gol bahsi riskli",
                "onem": "ORTA"
            })
        
        # K.KG-UYUMSUZ: KG tablosu dÃ¼ÅŸÃ¼k ama KG VAR oynadÄ±k
        if "kg var" in banko_lower and kg_var < 50:
            ihlaller.append({
                "tip": "KURAL Ä°HLALÄ°",
                "kural": "K.KG-UYUMSUZ",
                "aciklama": f"KG VAR tablosu %{self._fmt(kg_var)} (<50% DÃœÅÃœK!)",
                "cozum": "KG tablosu dÃ¼ÅŸÃ¼kken KG VAR oynama",
                "onem": "ORTA"
            })
        
        # ÅanssÄ±zlÄ±k durumu (kural ihlali yok ama yattÄ±)
        if not ihlaller:
            ihlaller.append({
                "tip": "ÅANSSIZLIK",
                "kural": "Ä°STATÄ°STÄ°K UYUMSUZLUÄU",
                "aciklama": "TÃ¼m kurallar saÄŸlanmÄ±ÅŸ ama skor uymadÄ±",
                "cozum": "Bu normal futbol varyansÄ±, strateji doÄŸruydu",
                "onem": "DÃœÅÃœK"
            })
        
        return ihlaller
    
    def dogru_tahmin_onerisi(self):
        """
        GerÃ§ek skora gÃ¶re doÄŸru tahmin ne olmalÄ±ydÄ±?
        
        Returns:
            list: Tutacak bahis listesi
        """
        oneriler = []
        
        # Gol bazlÄ±
        if self.toplam_gol >= 4:
            oneriler.append("MS 3.5 ÃœST âœ…")
        if self.toplam_gol >= 3:
            oneriler.append("MS 2.5 ÃœST âœ…")
        if self.toplam_gol >= 2:
            oneriler.append("MS 1.5 ÃœST âœ…")
        if self.toplam_gol >= 1:
            oneriler.append("MS 0.5 ÃœST âœ…")
        if self.toplam_gol <= 2:
            oneriler.append("MS 2.5 ALT âœ…")
        if self.toplam_gol <= 1:
            oneriler.append("MS 1.5 ALT âœ…")
        if self.toplam_gol == 0:
            oneriler.append("MS 0.5 ALT âœ…")
        
        # KG
        if self.ev_gol >= 1 and self.dep_gol >= 1:
            oneriler.append("KG VAR âœ…")
        else:
            oneriler.append("KG YOK âœ…")
        
        # Taraf
        if self.ev_gol > self.dep_gol:
            oneriler.append("MS 1 (EV) âœ…")
        elif self.dep_gol > self.ev_gol:
            oneriler.append("MS 2 (DEP) âœ…")
        else:
            oneriler.append("MS X (BERABERLÄ°K) âœ…")
        
        # TakÄ±m golleri
        if self.ev_gol >= 2:
            oneriler.append("EV 1.5 ÃœST âœ…")
        if self.ev_gol >= 1:
            oneriler.append("EV 0.5 ÃœST âœ…")
        if self.dep_gol >= 2:
            oneriler.append("DEP 1.5 ÃœST âœ…")
        if self.dep_gol >= 1:
            oneriler.append("DEP 0.5 ÃœST âœ…")
        
        return oneriler
    
    def dersler_cikar(self):
        """Ã–ÄŸrenme iÃ§in ders Ã§Ä±kar"""
        dersler = []
        
        ev_yiyen = self._get("ev_yiyen", 50)
        dep_atan = self._get("dep_atan", 70)
        ev_atan = self._get("ev_atan", 70)
        xg = self._get("xg", 2.5)
        ust_25 = self._get("ust_25", 60)
        
        if ev_yiyen >= 80:
            dersler.append("ğŸ“Œ Ev %80+ gol yiyorsa MS1 oynama")
        if dep_atan >= 80:
            dersler.append("ğŸ“Œ Dep %80+ gol atÄ±yorsa MS1 riskli")
        if ev_atan >= 75 and dep_atan >= 75:
            dersler.append("ğŸ“Œ Her iki takÄ±m golcÃ¼yse GOL oyna (taraf deÄŸil)")
        if xg < 2.30:
            dersler.append("ğŸ“Œ xG < 2.30 ise ÃœST bahislerinden kaÃ§Ä±n")
        if ust_25 < 55:
            dersler.append("ğŸ“Œ 2.5Ãœ tablosu <%55 ise 2.5Ãœ oynama")
        
        # Genel dersler
        dersler.append("ğŸ“Œ SimÃ¼lasyona da bak (Ã§eliÅŸki varsa dikkatli ol)")
        dersler.append("ğŸ“Œ GÃ¼ven 7'nin altÄ±ndaysa kasa oranÄ±nÄ± dÃ¼ÅŸÃ¼r")
        
        return dersler
    
    def rapor_olustur(self):
        """
        Tam otopsi raporu dict olarak oluÅŸtur
        
        Returns:
            dict: TÃ¼m otopsi verileri
        """
        tahmin_sonuc = self.tahmin_kontrol()
        kural_analiz = self.banko_kural_analizi()
        
        rapor = {
            "mac_bilgisi": {
                "ev_takimi": self.v.get("ev_takimi", self.v.get("ev", "Ev")),
                "dep_takimi": self.v.get("dep_takimi", self.v.get("dep", "Deplasman")),
                "tarih": self.v.get("tarih", ""),
                "lig": self.v.get("lig", ""),
            },
            "skor": {
                "gercek_skor": self.skor,
                "ev_gol": self.ev_gol,
                "dep_gol": self.dep_gol,
                "toplam": self.toplam_gol
            },
            "tahmin": {
                "oynanan_banko": self.banko,
                "sonuc": tahmin_sonuc,
                "tuttu_mu": tahmin_sonuc.get("tuttu", None)
            },
            "istatistikler": {
                "ev_atan": self._get("ev_atan", 0),
                "dep_atan": self._get("dep_atan", 0),
                "ev_yiyen": self._get("ev_yiyen", 0),
                "dep_yiyen": self._get("dep_yiyen", 0),
                "xg": self._get("xg", 0),
                "ust_25": self._get("ust_25", 0),
                "kg_var": self._get("kg_var", 0),
                "conv_ev": self._get("conv_ev", 0),
                "conv_dep": self._get("conv_dep", 0),
            },
            "bolum5_analiz": kural_analiz,
            "dogru_tahminler": self.dogru_tahmin_onerisi(),
            "dersler": self.dersler_cikar()
        }
        
        # EÄŸer yattÄ±ysa neden yattÄ± analizi ekle
        if tahmin_sonuc.get("tuttu") == False:
            rapor["neden_yatti"] = self.neden_yatti_analizi()
        
        return rapor
    
    def metin_rapor(self):
        """
        OTOPSÄ° RAPORU - KullanÄ±cÄ±nÄ±n istediÄŸi format:
        1. Hangi kural banko verdi? (AÅŸama, Kural, Åartlar)
        2. Neden yattÄ±? (Åart ihlalleri)
        3. Alternatif kural Ã¶nerisi
        """
        r = self.rapor_olustur()
        kural_analiz = r['bolum5_analiz']
        
        metin = []
        metin.append("=" * 70)
        metin.append("ğŸ“Š MAÃ‡ OTOPSÄ°SÄ°")
        metin.append("=" * 70)
        metin.append("")
        
        # === TEMEL BÄ°LGÄ°LER ===
        mac_adi = self.v.get("mac_adi", self.v.get("mac", "?"))
        metin.append(f"âš½ MAÃ‡: {mac_adi}")
        metin.append(f"ğŸ“… TARÄ°H: {r['mac_bilgisi']['tarih']}")
        metin.append(f"ğŸ† LÄ°G: {r['mac_bilgisi']['lig']}")
        metin.append("")
        
        # Skor ve sonuÃ§
        skor_str = r['skor']['gercek_skor'] if r['skor']['gercek_skor'] else "GÄ°RÄ°LMEDÄ°"
        metin.append(f"âœ… SKOR: {skor_str}")
        metin.append(f"ğŸ¯ TAHMÄ°N: {r['tahmin']['oynanan_banko']}")
        metin.append(f"ğŸ›¡ï¸ SÄ°GORTA: {self.v.get('sigorta', '?')}")
        metin.append(f"ğŸ“Š GÃœVEN: {self.v.get('guven', '?')}/10")
        
        # Tuttu/YattÄ±
        tuttu = r['tahmin']['tuttu_mu']
        sonuc_str = self.v.get("sonuc", "BEKLÄ°YOR")
        
        # SonuÃ§ belirleme - hem tuttu_mu hem de sonuc alanÄ±nÄ± kontrol et
        yatti_mi = tuttu == False or "KAYBET" in sonuc_str.upper() or "YATTI" in sonuc_str.upper()
        tuttu_mu = tuttu == True or "KAZANDI" in sonuc_str.upper() or "TUTTU" in sonuc_str.upper()
        
        if tuttu_mu:
            metin.append("âœ… SONUÃ‡: TUTTU")
        elif yatti_mi:
            metin.append("âŒ SONUÃ‡: YATTI")
        else:
            metin.append(f"â³ SONUÃ‡: {sonuc_str}")
        metin.append("")
        
        # === ğŸ¯ SEÃ‡Ä°LEN KURAL (BÃ–LÃœM 5) ===
        metin.append("=" * 70)
        metin.append("ğŸ¯ SEÃ‡Ä°LEN KURAL (BÃ–LÃœM 5)")
        metin.append("=" * 70)
        metin.append("")
        metin.append(f"   AÅŸama: {kural_analiz['asama']}")
        metin.append(f"   Kural: {kural_analiz['secilen_kural']}")
        metin.append(f"   Åartlar:")
        for sart in kural_analiz.get('sartlar', []):
            metin.append(f"      {sart}")
        metin.append("")
        
        # === ğŸ” NEDEN YATTI? (sadece yattÄ±ysa gÃ¶ster) ===
        if yatti_mi or 'neden_yatti' in r:
            metin.append("=" * 70)
            metin.append("ğŸ” NEDEN YATTI?")
            metin.append("=" * 70)
            metin.append("")
            
            # Åart ihlallerini kontrol et
            sart_ihlali_var = False
            for i, sart in enumerate(kural_analiz.get('sartlar', []), 1):
                if "âŒ" in sart:
                    sart_ihlali_var = True
                    metin.append(f"{i}. âš ï¸ ÅART Ä°HLALÄ°: {sart}")
            
            # neden_yatti analizinden ekle
            if 'neden_yatti' in r:
                for i, ihlal in enumerate(r['neden_yatti'], 1):
                    if ihlal['tip'] != "ÅANSSIZLIK":
                        metin.append(f"{i}. âš ï¸ {ihlal['tip']}: {ihlal['kural']}")
                        metin.append(f"   - {ihlal['aciklama']}")
                        metin.append(f"   - Ã‡Ã–ZÃœM: {ihlal['cozum']}")
                        metin.append("")
            
            if not sart_ihlali_var and (not 'neden_yatti' in r or r['neden_yatti'][0]['tip'] == "ÅANSSIZLIK"):
                metin.append("â€¢ KURAL Ä°HLALÄ° YOK - Sadece ÅŸans faktÃ¶rÃ¼")
                metin.append("â€¢ Ä°statistikler doÄŸru, maÃ§ beklenmedik geliÅŸti")
                metin.append("")
            
            # === ğŸ’¡ ALTERNATÄ°F KURAL ===
            metin.append("")
            metin.append("ğŸ’¡ ALTERNATÄ°F KURAL:")
            metin.append(f"   EÄŸer '{kural_analiz['secilen_kural']}' kuralÄ± olmasaydÄ±,")
            metin.append(f"   Sistem '{kural_analiz['alternatif']}' verirdi.")
            metin.append("")
        
        # === ğŸ“ˆ Ä°STATÄ°STÄ°KLER ===
        metin.append("=" * 70)
        metin.append("ğŸ“ˆ Ä°STATÄ°STÄ°KLER")
        metin.append("=" * 70)
        metin.append("")
        ist = r['istatistikler']
        
        # SayÄ±larÄ± formatla (75.0 â†’ 75)
        def fmt(val):
            if isinstance(val, float):
                if val == int(val):
                    return str(int(val))
                return f"{val:.2f}".rstrip('0').rstrip('.')
            return str(val)
        
        metin.append(f"ğŸ  Ev Gol Atma: %{fmt(ist['ev_atan'])}")
        metin.append(f"ğŸ  Ev Gol Yeme: %{fmt(ist['ev_yiyen'])}")
        metin.append(f"âœˆï¸  Dep Gol Atma: %{fmt(ist['dep_atan'])}")
        metin.append(f"âœˆï¸  Dep Gol Yeme: %{fmt(ist['dep_yiyen'])}")
        metin.append(f"âš¡ Toplam xG: {fmt(ist['xg'])}")
        metin.append(f"ğŸ“Š MS 2.5Ãœ: %{fmt(ist['ust_25'])}")
        metin.append(f"ğŸ¤ KG VAR: %{fmt(ist['kg_var'])}")
        metin.append(f"ğŸ¯ Conv Ev: %{fmt(ist['conv_ev'])} | Conv Dep: %{fmt(ist['conv_dep'])}")
        metin.append("")
        
        # === âœ… TUTACAK TAHMÄ°NLER (skor girildiyse) ===
        if r['skor']['gercek_skor'] and r['skor']['toplam'] > 0:
            metin.append("=" * 70)
            metin.append("ğŸ’¡ DOÄRU TAHMÄ°N NEYDÄ°?")
            metin.append("=" * 70)
            metin.append("")
            for tahmin in r['dogru_tahminler']:
                metin.append(f"   {tahmin}")
            metin.append("")
        
        # === ğŸ“š DERS Ã‡IKARILACAKLAR ===
        metin.append("=" * 70)
        metin.append("ğŸ“š DERS Ã‡IKARILACAKLAR")
        metin.append("=" * 70)
        metin.append("")
        for ders in r['dersler']:
            metin.append(f"   {ders}")
        metin.append("")
        
        metin.append("=" * 70)
        metin.append("ğŸ“Š 90 DAKÄ°KA ANALÄ°Z - Otopsi Raporu")
        metin.append("=" * 70)
        
        return "\n".join(metin)
    
    def metin_rapor_eski(self):
        """Eski format (yedek)"""
        r = self.rapor_olustur()
        
        metin = []
        metin.append("=" * 70)
        metin.append("ğŸ”¬ GELÄ°ÅMÄ°Å OTOPSÄ° RAPORU")
        metin.append("=" * 70)
        metin.append("")
        
        # MaÃ§ bilgisi
        metin.append(f"ğŸ“… {r['mac_bilgisi']['tarih']} - {r['mac_bilgisi']['lig']}")
        metin.append(f"âš½ {r['mac_bilgisi']['ev_takimi']} vs {r['mac_bilgisi']['dep_takimi']}")
        metin.append(f"ğŸ¥… SKOR: {r['skor']['gercek_skor']} ({r['skor']['toplam']} gol)")
        metin.append("")
        
        # Tahmin sonucu
        tuttu = r['tahmin']['tuttu_mu']
        if tuttu == True:
            metin.append("=" * 40)
            metin.append("âœ… SONUÃ‡: TUTTU!")
            metin.append("=" * 40)
        elif tuttu == False:
            metin.append("=" * 40)
            metin.append("âŒ SONUÃ‡: YATTI!")
            metin.append("=" * 40)
        else:
            metin.append("â“ SONUÃ‡: BELÄ°RLENEMEDÄ°")
        
        metin.append(f"ğŸ¯ Oynanan: {r['tahmin']['oynanan_banko']}")
        metin.append(f"ğŸ“ {r['tahmin']['sonuc'].get('aciklama', '')}")
        metin.append("")
        
        # BÃ–LÃœM 5 Kural Analizi
        metin.append("-" * 40)
        metin.append("ğŸ“œ BÃ–LÃœM 5 KURAL ANALÄ°ZÄ°")
        metin.append("-" * 40)
        metin.append(f"ğŸ”¹ BÃ–LÃœM 5'in SeÃ§tiÄŸi: {r['bolum5_analiz']['bolum5_banko']}")
        metin.append(f"ğŸ”¹ Kural: {r['bolum5_analiz']['secilen_kural']}")
        metin.append(f"ğŸ”¹ AÅŸama: {r['bolum5_analiz']['asama']}")
        metin.append(f"ğŸ”¹ Alternatif: {r['bolum5_analiz']['alternatif']}")
        metin.append("")
        
        if r['bolum5_analiz'].get('sartlar'):
            metin.append("SaÄŸlanan Åartlar:")
            for sart in r['bolum5_analiz']['sartlar']:
                metin.append(f"   {sart}")
            metin.append("")
        
        if r['bolum5_analiz'].get('vetolar'):
            metin.append("âš ï¸ Aktif Vetolar:")
            for veto in r['bolum5_analiz']['vetolar']:
                metin.append(f"   ğŸš« {veto[0]}: {veto[1]}")
            metin.append("")
        
        # Neden yattÄ± (eÄŸer yattÄ±ysa)
        if 'neden_yatti' in r:
            metin.append("-" * 40)
            metin.append("âŒ NEDEN YATTI ANALÄ°ZÄ°")
            metin.append("-" * 40)
            for i, ihlal in enumerate(r['neden_yatti'], 1):
                metin.append(f"{i}. ğŸ”´ {ihlal['tip']}: {ihlal['kural']}")
                metin.append(f"   ğŸ“ {ihlal['aciklama']}")
                metin.append(f"   ğŸ’¡ {ihlal['cozum']}")
                metin.append(f"   âš¡ Ã–nem: {ihlal['onem']}")
                metin.append("")
        
        # DoÄŸru tahminler
        metin.append("-" * 40)
        metin.append("âœ… TUTACAK TAHMÄ°NLER (GERÃ‡EÄÄ°NDE)")
        metin.append("-" * 40)
        for tahmin in r['dogru_tahminler']:
            metin.append(f"   {tahmin}")
        metin.append("")
        
        # Ä°statistikler
        metin.append("-" * 40)
        metin.append("ğŸ“Š KULLANILAN Ä°STATÄ°STÄ°KLER")
        metin.append("-" * 40)
        ist = r['istatistikler']
        metin.append(f"   Ev Atan: %{ist['ev_atan']} | Dep Atan: %{ist['dep_atan']}")
        metin.append(f"   Ev Yiyen: %{ist['ev_yiyen']} | Dep Yiyen: %{ist['dep_yiyen']}")
        metin.append(f"   xG: {ist['xg']} | 2.5Ãœ: %{ist['ust_25']} | KG: %{ist['kg_var']}")
        metin.append(f"   Conv Ev: %{ist['conv_ev']} | Conv Dep: %{ist['conv_dep']}")
        metin.append("")
        
        # Ders Ã§Ä±karÄ±lacaklar
        metin.append("-" * 40)
        metin.append("ğŸ“š DERS Ã‡IKARILACAKLAR")
        metin.append("-" * 40)
        for ders in r['dersler']:
            metin.append(f"   {ders}")
        metin.append("")
        
        metin.append("=" * 70)
        metin.append("ğŸ”¬ 90 DAKÄ°KA ANALÄ°Z - GeliÅŸmiÅŸ Otopsi Raporu")
        metin.append("=" * 70)
        
        return "\n".join(metin)


def otopsi_yap(mac_verisi, gercek_skor, oynanan_banko):
    """Otopsi fonksiyonu - dÄ±ÅŸarÄ±dan Ã§aÄŸrÄ±lÄ±r (metin rapor)"""
    sistem = OtopsiSistemi(mac_verisi, gercek_skor, oynanan_banko)
    return sistem.metin_rapor()


def otopsi_rapor_json(mac_verisi, gercek_skor, oynanan_banko):
    """JSON formatÄ±nda otopsi raporu"""
    sistem = OtopsiSistemi(mac_verisi, gercek_skor, oynanan_banko)
    return sistem.rapor_olustur()


# ============================================================
# ğŸ“Š POÄ°SSON HESAPLAYICI
# ============================================================
class PoissonCalculator:
    @staticmethod
    def poisson_prob(lam, k):
        if lam <= 0:
            return 0 if k > 0 else 1
        return (math.pow(lam, k) * math.exp(-lam)) / math.factorial(k)
    
    @staticmethod
    def get_top_scores(ev_xg, dep_xg, top_n=6):
        matrix = {}
        for ev in range(6):
            for dep in range(6):
                prob = PoissonCalculator.poisson_prob(ev_xg, ev) * \
                       PoissonCalculator.poisson_prob(dep_xg, dep)
                matrix[f"{ev}-{dep}"] = round(prob * 100, 1)
        return sorted(matrix.items(), key=lambda x: x[1], reverse=True)[:top_n]


# ============================================================
# ğŸ® GELÄ°ÅMÄ°Å MONTE CARLO SÄ°MÃœLATÃ–RÃœ (HATA 8 DÃœZELTMESÄ°)
# ============================================================
class MonteCarloSimulator:
    def __init__(self, ev_xg, dep_xg, ev_atan=70, dep_atan=70, ev_yiyen=50, dep_yiyen=50, 
                 conv_ev=12, conv_dep=12, lig_gol_ort=2.5, simulations=1000):
        self.ev_xg = ev_xg
        self.dep_xg = dep_xg
        self.ev_atan = ev_atan / 100  # YÃ¼zde olarak
        self.dep_atan = dep_atan / 100
        self.ev_yiyen = ev_yiyen / 100
        self.dep_yiyen = dep_yiyen / 100
        self.conv_ev = conv_ev / 100
        self.conv_dep = conv_dep / 100
        self.lig_gol_ort = lig_gol_ort
        self.simulations = simulations
    
    def _poisson_random(self, lam):
        if lam <= 0:
            return 0
        L = math.exp(-lam)
        k = 0
        p = 1
        while p > L:
            k += 1
            p *= random.random()
        return k - 1
    
    def simulate_match(self):
        # AÄŸÄ±rlÄ±klÄ± xG hesapla
        ev_faktor = (self.ev_atan + self.dep_yiyen + self.conv_ev) / 3
        dep_faktor = (self.dep_atan + self.ev_yiyen + self.conv_dep) / 3
        
        # Lig ortalamasÄ±nÄ± da hesaba kat
        lig_faktor = self.lig_gol_ort / 2.5
        
        adjusted_ev_xg = self.ev_xg * ev_faktor * lig_faktor
        adjusted_dep_xg = self.dep_xg * dep_faktor * lig_faktor
        
        ev_gol = self._poisson_random(adjusted_ev_xg)
        dep_gol = self._poisson_random(adjusted_dep_xg)
        
        return ev_gol, dep_gol
    
    def run_simulation(self):
        results = {
            "ev_kazanir": 0, "berabere": 0, "dep_kazanir": 0,
            "ust_15": 0, "ust_25": 0, "ust_35": 0,
            "kg_var": 0, "kg_yok": 0,
            "skorlar": defaultdict(int),
            "toplam_gol": [],
            "iy_gol": 0
        }
        
        for _ in range(self.simulations):
            ev, dep = self.simulate_match()
            toplam = ev + dep
            
            if ev > dep:
                results["ev_kazanir"] += 1
            elif ev < dep:
                results["dep_kazanir"] += 1
            else:
                results["berabere"] += 1
            
            if toplam > 1.5:
                results["ust_15"] += 1
            if toplam > 2.5:
                results["ust_25"] += 1
            if toplam > 3.5:
                results["ust_35"] += 1
            
            if ev > 0 and dep > 0:
                results["kg_var"] += 1
            else:
                results["kg_yok"] += 1
            
            # Ä°lk yarÄ± gol tahmini (basit yaklaÅŸÄ±m)
            if toplam >= 1:
                results["iy_gol"] += 1
            
            results["skorlar"][f"{ev}-{dep}"] += 1
            results["toplam_gol"].append(toplam)
        
        # YÃ¼zdelere Ã§evir
        for key in ["ev_kazanir", "berabere", "dep_kazanir", "ust_15", "ust_25", "ust_35", "kg_var", "kg_yok", "iy_gol"]:
            results[key] = round(results[key] / self.simulations * 100, 1)
        
        results["en_sik_skorlar"] = sorted(results["skorlar"].items(), key=lambda x: x[1], reverse=True)[:5]
        results["ortalama_gol"] = round(sum(results["toplam_gol"]) / len(results["toplam_gol"]), 2)
        
        return results


# ============================================================
# ğŸ¯ GELÄ°ÅMÄ°Å MAÃ‡ PUANLAYICI (HATA 7 DÃœZELTMESÄ°)
# ============================================================
class MatchScorer:
    def __init__(self, veriler):
        self.veriler = veriler
    
    def _safe_float(self, val, default=0):
        """String'i gÃ¼venli ÅŸekilde float'a Ã§evir"""
        if val is None or val == "" or val == "?":
            return default
        try:
            # "100%" veya "85%" gibi deÄŸerleri temizle
            cleaned = str(val).replace("%", "").replace("/10", "").replace(",", ".").strip()
            return float(cleaned)
        except:
            return default
    
    def _safe_int(self, val, default=0):
        """String'i gÃ¼venli ÅŸekilde int'e Ã§evir"""
        if val is None or val == "" or val == "?":
            return default
        try:
            cleaned = str(val).replace("%", "").replace("/10", "").replace(",", ".").strip()
            return int(float(cleaned))
        except:
            return default
    
    def calculate_score(self):
        scores = {
            "xg_skoru": self._xg_score(),
            "gol_potansiyeli": self._gol_potansiyeli(),
            "savunma_zafiyeti": self._savunma_zafiyeti(),
            "form_durumu": self._form_durumu(),
            "oran_degeri": self._oran_degeri(),
            "lig_guvenilirligi": self._lig_guvenilirligi()
        }
        
        toplam = sum(scores.values())
        
        return {
            "toplam": min(100, toplam),
            "detay": scores,
            "seviye": self._get_seviye(toplam),
            "oneri": self._get_oneri(toplam, scores)
        }
    
    def _xg_score(self):
        xg = self._safe_float(self.veriler.get("xg", 0), 0)
        if xg >= 4.0: return 20
        elif xg >= 3.5: return 18
        elif xg >= 3.0: return 16
        elif xg >= 2.5: return 14
        elif xg >= 2.0: return 12
        else: return max(0, int(xg * 5))
    
    def _gol_potansiyeli(self):
        ev = self._safe_float(self.veriler.get("ev_atan", 0), 0)
        dep = self._safe_float(self.veriler.get("dep_atan", 0), 0)
        return min(20, int((ev + dep) / 10))
    
    def _savunma_zafiyeti(self):
        ev = self._safe_float(self.veriler.get("ev_yiyen", 0), 0)
        dep = self._safe_float(self.veriler.get("dep_yiyen", 0), 0)
        return min(20, int((ev + dep) / 10))
    
    def _form_durumu(self):
        guven = self._safe_int(self.veriler.get("guven", 5), 5)
        return min(15, int(guven * 1.5))
    
    def _oran_degeri(self):
        ust_25 = self._safe_float(self.veriler.get("ust_25", 50), 50)
        if ust_25 >= 70: return 15
        elif ust_25 >= 60: return 12
        elif ust_25 >= 50: return 10
        else: return 5
    
    def _lig_guvenilirligi(self):
        lig = self.veriler.get("lig", "")
        if any(elit in str(lig) for elit in ELIT_LIGLER):
            return 10
        elif str(lig) in GIZLI_HAZINE_LIGLERI:
            return 8
        else:
            return 5
    
    def _get_seviye(self, toplam):
        if toplam >= 85: return "ğŸ’ BANKO"
        elif toplam >= 70: return "âœ… Ä°YÄ°"
        elif toplam >= 50: return "âš ï¸ RÄ°SKLÄ°"
        else: return "âŒ UZAK DUR"
    
    def _get_oneri(self, toplam, scores):
        if toplam >= 85:
            return "Bu maÃ§a gÃ¼venle girebilirsin!"
        elif toplam >= 70:
            return "Ä°yi gÃ¶rÃ¼nÃ¼yor ama dikkatli ol."
        elif toplam >= 50:
            return "Riskli, dÃ¼ÅŸÃ¼k miktarla oyna."
        else:
            return "Bu maÃ§tan uzak dur!"


# ============================================================
# ğŸ¤– GELÄ°ÅMÄ°Å TELEGRAM BOT (HATA 2, 15 DÃœZELTMESÄ°)
# ============================================================
class TelegramBot:
    def __init__(self, token, chat_id):
        self.token = token
        self.chat_id = chat_id
        self.base_url = f"https://api.telegram.org/bot{token}"
        self.channels = []  # Ã‡oklu kanal desteÄŸi
    
    def load_channels(self, path):
        """KayÄ±tlÄ± kanallarÄ± yÃ¼kle"""
        if os.path.exists(path):
            try:
                with open(path, "r", encoding="utf-8") as f:
                    self.channels = json.load(f)
            except:
                self.channels = []
        return self.channels
    
    def save_channels(self, path):
        """KanallarÄ± kaydet"""
        with open(path, "w", encoding="utf-8") as f:
            json.dump(self.channels, f, ensure_ascii=False, indent=2)
    
    def add_channel(self, name, chat_id, channel_type="kanal"):
        """Yeni kanal ekle"""
        self.channels.append({
            "name": name,
            "chat_id": chat_id,
            "type": channel_type,
            "active": True
        })
    
    def send(self, message, chat_id=None, parse_mode="Markdown"):
        """Mesaj gÃ¶nder"""
        try:
            target = chat_id or self.chat_id
            url = f"{self.base_url}/sendMessage"
            data = {"chat_id": target, "text": message, "parse_mode": parse_mode}
            response = requests.post(url, data=data, timeout=10)
            return response.status_code == 200, response.text
        except Exception as e:
            return False, str(e)
    
    def send_to_multiple(self, message, chat_ids):
        """Birden fazla kanala gÃ¶nder"""
        results = []
        for cid in chat_ids:
            ok, result = self.send(message, chat_id=cid)
            results.append({"chat_id": cid, "success": ok, "result": result})
        return results
    
    def send_photo(self, photo_path, caption="", chat_id=None):
        """FotoÄŸraf gÃ¶nder"""
        try:
            target = chat_id or self.chat_id
            url = f"{self.base_url}/sendPhoto"
            with open(photo_path, 'rb') as photo:
                data = {"chat_id": target, "caption": caption, "parse_mode": "Markdown"}
                files = {"photo": photo}
                response = requests.post(url, data=data, files=files, timeout=30)
            return response.status_code == 200, response.text
        except Exception as e:
            return False, str(e)
    
    def format_analysis_detailed(self, mac_data, last_result=None):
        """V5.8 DÃœZELTÄ°LMÄ°Å - DetaylÄ± format"""
        tarih = mac_data.get("tarih", datetime.now().strftime("%d.%m.%Y"))
        
        # Son analiz metni varsa oradan Ã§ek
        text = last_result or ""
        
        def get_from_text(patterns, mac_key, default="?"):
            # Ã–nce mac_data'dan dene
            val = mac_data.get(mac_key, "")
            if val and val != "?" and val != "[" and not str(val).startswith("["):
                return str(val).replace("[", "").replace("]", "")
            
            # Sonra text'ten regex ile dene
            for pattern in (patterns if isinstance(patterns, list) else [patterns]):
                match = re.search(pattern, text, re.IGNORECASE)
                if match:
                    return match.group(1).replace("[", "").replace("]", "").replace("**", "").strip()
            return default
        
        # Verileri al
        banko = get_from_text([
            r'âœ…\s*\*?\*?BANKO\s*\([^)]*\)\s*:?\s*\*?\*?\s*([^\n\*]+)',
            r'âœ…\s*\*?\*?BANKO\s*:?\s*\*?\*?\s*([^\n\*]+)',
            r'ğŸ¯\s*\*?\*?BANKO\s*:?\s*\*?\*?\s*([^\n\*]+)',
        ], "banko", "MS 1.5 ÃœST")
        
        # Banko temizleme
        if banko:
            banko = banko.strip().replace("**", "").replace("*", "").strip()
            if "GÃ¼ven" in banko:
                banko = banko.split("GÃ¼ven")[0].strip()
            banko = banko.split("\n")[0].strip()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # SÄ°GORTA - BANKONUN 1 TIK ALTI (EN YÃœKSEK GÃœVEN BAHÄ°SÄ°)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        sigorta = self._sigorta_belirle(banko)
        
        guven = get_from_text([r'GÃ¼ven\s*:?\s*(\d+)\s*/\s*10'], "guven", "7")
        
        ev_atan = get_from_text([r'EV\s*GOL\s*GÃœCÃœ.*?(\d+)%?'], "ev_atan", "85")
        dep_atan = get_from_text([r'DEP\s*GOL\s*GÃœCÃœ.*?(\d+)%?'], "dep_atan", "75")
        ust_15 = get_from_text([r'MS\s*1\.5\s*ÃœST.*?(\d+)%?'], "ust_15", "85")
        ust_25 = get_from_text([r'MS\s*2\.5\s*ÃœST.*?(\d+)%?'], "ust_25", "55")
        xg = get_from_text([r'Toplam.*?xG.*?(\d+\.?\d*)'], "xg", "2.5")
        lig = get_from_text([r'\|\s*ğŸ†\s*([^\n]+)'], "lig", mac_data.get("lig", "?"))
        mac = mac_data.get("mac", mac_data.get("mac_adi", "?")).replace("_", " ")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # KASA - GÃœVENE GÃ–RE (KASA_ORANLARI sÃ¶zlÃ¼ÄŸÃ¼nden)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        try:
            guven_sayi = int(str(guven).split("/")[0])
        except:
            guven_sayi = 7
        kasa = KASA_ORANLARI.get(guven_sayi, {"oran": 10})["oran"]
        
        msg = f"""ğŸ“Š *DETAYLI ANALÄ°Z*
âš½ï¸ {mac}
ğŸ“… {tarih} | ğŸ† {lig}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ *TAHMÄ°N*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… *BANKO:* {banko}
ğŸ›¡ï¸ *SÄ°GORTA:* {sigorta}
ğŸ“Š *GÃœVEN:* {guven_sayi}/10
ğŸ’° *KASA:* %{kasa}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“± _90 DAKÄ°KA ANALÄ°Z_"""
        
        return msg
    
    def _sigorta_belirle(self, banko):
        """Bankoya gÃ¶re sigorta belirle - HER ZAMAN BANKONUN 1 TIK ALTI"""
        if not banko:
            return "MS 0.5 ÃœST"
        
        banko_upper = banko.upper()
        
        # 3.5 ÃœST â†’ 2.5 ÃœST
        if "3.5" in banko_upper and "ÃœST" in banko_upper:
            return "MS 2.5 ÃœST"
        
        # 2.5 ÃœST â†’ 1.5 ÃœST
        if "2.5" in banko_upper and "ÃœST" in banko_upper:
            return "MS 1.5 ÃœST"
        
        # 1.5 ÃœST â†’ 0.5 ÃœST
        if "1.5" in banko_upper and "ÃœST" in banko_upper:
            return "MS 0.5 ÃœST"
        
        # 0.5 ÃœST â†’ Ã‡ifte Åans
        if "0.5" in banko_upper and "ÃœST" in banko_upper:
            return "Ã‡ifte Åans (1X veya X2)"
        
        # KG VAR â†’ MS 1.5 ÃœST
        if "KG" in banko_upper and "VAR" in banko_upper:
            return "MS 1.5 ÃœST"
        
        # KG YOK â†’ MS 1.5 ALT
        if "KG" in banko_upper and "YOK" in banko_upper:
            return "MS 2.5 ALT"
        
        # MS1 veya MS2 â†’ Ã‡ifte Åans
        if "MS1" in banko_upper or "MS 1" in banko_upper:
            return "1X (Ã‡ifte Åans)"
        if "MS2" in banko_upper or "MS 2" in banko_upper:
            return "X2 (Ã‡ifte Åans)"
        
        # TakÄ±m bazlÄ± bahisler
        if "EV" in banko_upper and ("1.5" in banko_upper or "2.5" in banko_upper):
            if "2.5" in banko_upper:
                return "EV 1.5 ÃœST"
            if "1.5" in banko_upper:
                return "EV 0.5 ÃœST"
        
        if "DEP" in banko_upper and ("1.5" in banko_upper or "2.5" in banko_upper):
            if "2.5" in banko_upper:
                return "DEP 1.5 ÃœST"
            if "1.5" in banko_upper:
                return "DEP 0.5 ÃœST"
        
        # VarsayÄ±lan
        return "MS 0.5 ÃœST"


# ============================================================
# ğŸ“ˆ PERFORMANS TAKÄ°P
# ============================================================
class PerformanceTracker:
    def __init__(self, path):
        self.path = path
        self.data = self.load()
    
    def load(self):
        if os.path.exists(self.path):
            try:
                with open(self.path, "r", encoding="utf-8") as f:
                    return json.load(f)
            except:
                pass
        return {"maclar": [], "kurallar": {}, "ligler": {}, "gunluk": {}, "oranlar": {}}
    
    def save(self):
        with open(self.path, "w", encoding="utf-8") as f:
            json.dump(self.data, f, ensure_ascii=False, indent=2)
    
    def add_match(self, m):
        self.data["maclar"].append(m)
        self.save()
    
    def update_result(self, mac_id, sonuc, skor):
        for m in self.data["maclar"]:
            if m.get("id") == mac_id:
                m["sonuc"] = sonuc
                m["gercek_skor"] = skor
                
                # GÃ¼nlÃ¼k stats
                tarih = m.get("tarih", "?")
                if tarih not in self.data["gunluk"]:
                    self.data["gunluk"][tarih] = {"kazanan": 0, "kaybeden": 0}
                if sonuc == "KAZANDI":
                    self.data["gunluk"][tarih]["kazanan"] += 1
                else:
                    self.data["gunluk"][tarih]["kaybeden"] += 1
                
                # Lig stats
                lig = m.get("lig", "Diger")
                if lig not in self.data["ligler"]:
                    self.data["ligler"][lig] = {"kazanan": 0, "kaybeden": 0}
                if sonuc == "KAZANDI":
                    self.data["ligler"][lig]["kazanan"] += 1
                else:
                    self.data["ligler"][lig]["kaybeden"] += 1
                break
        self.save()
    
    def get_stats(self):
        toplam = len([m for m in self.data["maclar"] if m.get("sonuc")])
        kazanan = len([m for m in self.data["maclar"] if m.get("sonuc") == "KAZANDI"])
        return {
            "toplam": toplam,
            "kazanan": kazanan,
            "kaybeden": toplam - kazanan,
            "basari": round(kazanan / toplam * 100, 1) if toplam > 0 else 0
        }
    
    def get_daily_stats(self):
        return self.data.get("gunluk", {})
    
    def get_league_stats(self):
        result = {}
        for lig, d in self.data.get("ligler", {}).items():
            toplam = d["kazanan"] + d["kaybeden"]
            result[lig] = {
                "kazanan": d["kazanan"],
                "toplam": toplam,
                "basari": round(d["kazanan"] / toplam * 100, 1) if toplam > 0 else 0
            }
        return dict(sorted(result.items(), key=lambda x: x[1]["basari"], reverse=True))
    
    def get_by_type(self):
        stats = {}
        for m in self.data["maclar"]:
            if not m.get("sonuc"):
                continue
            banko = m.get("banko", "?")
            if banko not in stats:
                stats[banko] = {"kazanan": 0, "toplam": 0}
            stats[banko]["toplam"] += 1
            if m["sonuc"] == "KAZANDI":
                stats[banko]["kazanan"] += 1
        result = {}
        for k, v in stats.items():
            result[k] = {
                "kazanan": v["kazanan"],
                "toplam": v["toplam"],
                "basari": round(v["kazanan"] / v["toplam"] * 100, 1) if v["toplam"] > 0 else 0
            }
        return dict(sorted(result.items(), key=lambda x: x[1]["basari"], reverse=True))


# ============================================================
# ğŸ§  Ã–ÄRENEN SÄ°STEM
# ============================================================
class LearningSystem:
    def __init__(self, path):
        self.path = path
        self.data = self.load()
    
    def load(self):
        if os.path.exists(self.path):
            try:
                with open(self.path, "r", encoding="utf-8") as f:
                    return json.load(f)
            except:
                pass
        return {"oneriler": [], "kurallar": []}
    
    def save(self):
        with open(self.path, "w", encoding="utf-8") as f:
            json.dump(self.data, f, ensure_ascii=False, indent=2)
    
    def analyze(self, perf):
        suggestions = []
        for lig, stats in perf.get_league_stats().items():
            if stats["toplam"] >= 5 and stats["basari"] < 55:
                suggestions.append({
                    "tip": "LIG_ZAYIF",
                    "konu": lig,
                    "basari": stats["basari"],
                    "oneri": f"{lig} liginde %{stats['basari']} baÅŸarÄ±. Ek -1 puan kesintisi Ã¶nerilir."
                })
        for tur, stats in perf.get_by_type().items():
            if stats["toplam"] >= 10 and stats["basari"] < 55:
                suggestions.append({
                    "tip": "BAHIS_ZAYIF",
                    "konu": tur,
                    "basari": stats["basari"],
                    "oneri": f"{tur} bahis tÃ¼rÃ¼nde %{stats['basari']} baÅŸarÄ±. Baraj yÃ¼kseltilmeli."
                })
        self.data["oneriler"] = suggestions
        self.save()
        return suggestions


# ============================================================
# ğŸ”¬ LABORATUVAR SÄ°STEMÄ°
# ============================================================
class LabSystem:
    def __init__(self, path):
        self.path = path
        self.data = self.load()
    
    def load(self):
        if os.path.exists(self.path):
            try:
                with open(self.path, "r", encoding="utf-8") as f:
                    return json.load(f)
            except:
                pass
        return {"kurallar": [], "test_sonuclari": []}
    
    def save(self):
        with open(self.path, "w", encoding="utf-8") as f:
            json.dump(self.data, f, ensure_ascii=False, indent=2)
    
    def add_rule(self, kural):
        self.data["kurallar"].append(kural)
        self.save()
    
    def test_rule(self, kural, maclar):
        dogru = 0
        yanlis = 0
        eslesen_maclar = []
        
        for mac in maclar:
            if not mac.get("sonuc"):
                continue
            
            gecti = True
            sartlar = kural.get("sartlar", {})
            
            # xG kontrolÃ¼
            if "xg" in sartlar:
                mac_xg = float(mac.get("xg", 0) or 0)
                if mac_xg < float(sartlar["xg"]):
                    gecti = False
            
            # Conv kontrolÃ¼
            if "conv" in sartlar and gecti:
                mac_conv = float(mac.get("conv", 0) or 0)
                if mac_conv < float(sartlar["conv"]):
                    gecti = False
            
            # 2.5Ãœ kontrolÃ¼
            if "ust_25" in sartlar and gecti:
                mac_ust = float(mac.get("ust_25", 0) or 0)
                if mac_ust < float(sartlar["ust_25"]):
                    gecti = False
            
            if gecti:
                eslesen_maclar.append(mac)
                if mac["sonuc"] == "KAZANDI":
                    dogru += 1
                else:
                    yanlis += 1
        
        toplam = dogru + yanlis
        basari = round(dogru / toplam * 100, 1) if toplam > 0 else 0
        
        return {
            "dogru": dogru,
            "yanlis": yanlis,
            "toplam": toplam,
            "basari": basari,
            "eslesen_maclar": eslesen_maclar
        }


# ============================================================
# ğŸ¨ MARKA YÃ–NETÄ°CÄ°SÄ°
# ============================================================
class BrandManager:
    def __init__(self, path):
        self.path = path
        self.settings = self.load()
    
    def load(self):
        if os.path.exists(self.path):
            try:
                with open(self.path, "r", encoding="utf-8") as f:
                    return json.load(f)
            except:
                pass
        return DEFAULT_BRAND.copy()
    
    def save(self):
        with open(self.path, "w", encoding="utf-8") as f:
            json.dump(self.settings, f, ensure_ascii=False, indent=2)
    
    def get(self, key):
        return self.settings.get(key, DEFAULT_BRAND.get(key))
    
    def set(self, key, value):
        self.settings[key] = value
        self.save()


# ============================================================
# ğŸ“Š ORAN TAKÄ°P SÄ°STEMÄ° (HATA 14)
# ============================================================
class OranTracker:
    def __init__(self, path):
        self.path = path
        self.data = self.load()
    
    def load(self):
        if os.path.exists(self.path):
            try:
                with open(self.path, "r", encoding="utf-8") as f:
                    return json.load(f)
            except:
                pass
        return {"oranlar": [], "araliklar": {}}
    
    def save(self):
        with open(self.path, "w", encoding="utf-8") as f:
            json.dump(self.data, f, ensure_ascii=False, indent=2)
    
    def add_oran(self, mac_id, bahis_turu, oran, istatistik, sonuc=None):
        self.data["oranlar"].append({
            "mac_id": mac_id,
            "bahis_turu": bahis_turu,
            "oran": oran,
            "istatistik": istatistik,
            "sonuc": sonuc,
            "tarih": datetime.now().isoformat()
        })
        self.save()
    
    def update_sonuc(self, mac_id, sonuc):
        for o in self.data["oranlar"]:
            if o["mac_id"] == mac_id:
                o["sonuc"] = sonuc
        self.save()
    
    def get_aralik_stats(self):
        araliklar = {
            "1.00-1.30": {"kazanan": 0, "toplam": 0},
            "1.31-1.50": {"kazanan": 0, "toplam": 0},
            "1.51-1.80": {"kazanan": 0, "toplam": 0},
            "1.81-2.20": {"kazanan": 0, "toplam": 0},
            "2.20+": {"kazanan": 0, "toplam": 0}
        }
        
        for o in self.data["oranlar"]:
            if not o.get("sonuc"):
                continue
            
            oran = float(o.get("oran", 0) or 0)
            
            if oran <= 1.30:
                key = "1.00-1.30"
            elif oran <= 1.50:
                key = "1.31-1.50"
            elif oran <= 1.80:
                key = "1.51-1.80"
            elif oran <= 2.20:
                key = "1.81-2.20"
            else:
                key = "2.20+"
            
            araliklar[key]["toplam"] += 1
            if o["sonuc"] == "KAZANDI":
                araliklar[key]["kazanan"] += 1
        
        result = {}
        for k, v in araliklar.items():
            basari = round(v["kazanan"] / v["toplam"] * 100, 1) if v["toplam"] > 0 else 0
            result[k] = {
                "kazanan": v["kazanan"],
                "toplam": v["toplam"],
                "basari": basari
            }
        
        return result


# ============================================================
# PART 1 SONU - PART 2'DE DEVAM
# ============================================================
# ============================================================
# PART 2/6 - ANA SINIF VE SEKMELER (ANALÄ°Z â†’ TELEGRAM)
# ============================================================
# Bu dosyayÄ± PART 1'in SONUNA ekle
# ============================================================


class XrayCommanderV70:
    def __init__(self, root):
        self.root = root
        self.root.title(f"XG-XRAY COMMANDER V70 THE ENDGAME | {TOPLAM_KURAL} KURAL")
        self.root.geometry("1800x1000")
        
        # Tema
        self.current_theme = "ğŸŒ™ Koyu"
        self.theme = THEMES[self.current_theme]
        self.root.configure(bg=self.theme["bg"])
        
        # DeÄŸiÅŸkenler
        self.gorsel_listesi = []
        self.skor_gorseli = []
        self.var_model = tk.StringVar(value="Gemini 2.5 Pro (Ã–nerilen)")
        self.last_result = ""
        self.mac_id_map = {}
        self.alarmlar = []
        self.secili_kanallar = []
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # V70: FÄ°L HAFIZASI - Global VeritabanÄ± SÃ¶zlÃ¼ÄŸÃ¼
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.mac_arsivi = {}  # {"mac_adi": {tÃ¼m_veri}} - GLOBAL ERÄ°ÅÄ°M
        self.current_analysis = None
        self.son_silinen = None
        
        # YÃ¶neticiler - API KEY HATASI KORUMASI
        self.performance = PerformanceTracker(PERFORMANCE_FILE)
        self.learning = LearningSystem(LEARNING_FILE)
        
        # Telegram - hata korumalÄ±
        try:
            self.telegram = TelegramBot(TELEGRAM_BOT_TOKEN, TELEGRAM_CHAT_ID)
            self.telegram.load_channels(CHANNELS_FILE)
        except Exception as e:
            print(f"âš ï¸ Telegram baÅŸlatma hatasÄ±: {e}")
            self.telegram = None
        
        # DiÄŸer yÃ¶neticiler - hata korumalÄ±
        try:
            self.brand = BrandManager(BRAND_FILE)
        except:
            self.brand = None
        try:
            self.lab = LabSystem(LAB_FILE)
        except:
            self.lab = None
        try:
            self.oran_tracker = OranTracker(ORAN_FILE)
        except:
            self.oran_tracker = None
        
        # Listeler - V70 GÃ¼ncelleme ile otomatik senkronize
        self.liste_35ust = []
        self.liste_25ust = []
        self.liste_kgvar = []
        self.liste_favori = []
        self.liste_iygol = []
        self.listeler = {}  # {"2.5_ust": [...], "kg_var": [...], ...}
        
        # KÄ±sayollar
        self.root.bind_all('<Control-v>', self.panodan_yapistir_event)
        self.root.bind_all('<Control-s>', lambda e: self.word_kaydet())
        self.root.bind_all('<Control-t>', lambda e: self.telegram_gonder())
        
        # KlasÃ¶r oluÅŸtur
        os.makedirs(BASE_DIR, exist_ok=True)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # V70: FÄ°L HAFIZASI YÃœKLEME - Program aÃ§Ä±lÄ±ÅŸÄ±nda TÃœM veriyi yÃ¼kle
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.db_yukle()  # mac_db'yi yÃ¼kle
        self._fil_hafizasi_yukle()  # mac_arsivi'yi yÃ¼kle
        self.ayarlar_yukle()
        self.kurallar_yukle()
        
        # V5.7 YENÄ°: Ek veritabanlarÄ±nÄ± yÃ¼kle
        self.canli_db = self._load_json(CANLI_BAHIS_FILE, [])
        self.telegram_kanallari = self._load_json(CHANNELS_FILE, [])
        self.ayarlar = {}
        
        # FIX #16: telegram.channels ile senkronize et
        if hasattr(self, 'telegram') and self.telegram and self.telegram.channels:
            self.telegram_kanallari = []
            for ch in self.telegram.channels:
                self.telegram_kanallari.append({
                    "ad": ch.get("name", "Kanal"),
                    "id": ch.get("chat_id", "")
                })
        
        self.setup_ui()
        
        # V70: BaÅŸlangÄ±Ã§ta sekmeleri senkronize et
        self.root.after(1000, self._sekme_senkronizasyonu)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # HOÅGELDÄ°NÄ°Z MESAJI VE BAÅLANGIÃ‡
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.root.after(500, self._hosgeldin_mesaji)
        
        # Alarm kontrolÃ¼
        self.alarm_kontrol()
    
    def _hosgeldin_mesaji(self):
        """Program aÃ§Ä±lÄ±ÅŸÄ±nda hoÅŸgeldiniz mesajÄ±"""
        from datetime import datetime
        saat = datetime.now().hour
        
        if saat < 12:
            selamlama = "GÃ¼naydÄ±n"
        elif saat < 18:
            selamlama = "Ä°yi gÃ¼nler"
        else:
            selamlama = "Ä°yi akÅŸamlar"
        
        messagebox.showinfo(
            "ğŸ‘‹ HoÅŸ Geldiniz!",
            f"{selamlama}!\n\n"
            f"ğŸ¯ XG-XRAY Commander V{APP_VERSION}\n"
            f"ğŸ“Š {len(self.mac_db)} maÃ§ arÅŸivde\n\n"
            f"BaÅŸarÄ±lÄ± analizler dileriz! âš½"
        )
    
    def _fil_hafizasi_yukle(self):
        """V70: FÄ°L HAFIZASI - mac_db'yi mac_arsivi sÃ¶zlÃ¼ÄŸÃ¼ne dÃ¶nÃ¼ÅŸtÃ¼r"""
        self.mac_arsivi = {}
        for mac in self.mac_db:
            mac_adi = mac.get("mac", mac.get("mac_adi", ""))
            if mac_adi:
                # Normalize et
                mac_key = mac_adi.replace(" ", "_").replace("-", "_").lower()
                self.mac_arsivi[mac_key] = mac
        print(f"ğŸ˜ FÄ°L HAFIZASI: {len(self.mac_arsivi)} maÃ§ yÃ¼klendi")
    
    def _fil_hafizasi_kaydet(self, data):
        """V70: Analiz sonrasÄ± FÄ°L HAFIZASINA ekle"""
        mac_adi = data.get("mac", data.get("mac_adi", ""))
        if mac_adi:
            mac_key = mac_adi.replace(" ", "_").replace("-", "_").lower()
            self.mac_arsivi[mac_key] = data
            print(f"ğŸ˜ FÄ°L HAFIZASI: {mac_adi} kaydedildi")
    
    def _sekme_senkronizasyonu(self):
        """V70: TÃ¼m sekmeleri veritabanÄ± ile senkronize et"""
        try:
            # ArÅŸiv sekmesini gÃ¼ncelle
            if hasattr(self, 'arsiv_yenile'):
                self.arsiv_yenile()
            # Listeleri gÃ¼ncelle
            if hasattr(self, '_listeleri_guncelle'):
                self._listeleri_guncelle()
            print("ğŸ”„ V70: Sekme senkronizasyonu tamamlandÄ±")
        except Exception as e:
            print(f"âš ï¸ Sekme senkronizasyonu hatasÄ±: {e}")
    
    def db_yukle(self):
        print(f"ğŸ“ VeritabanÄ± dosyasÄ±: {DB_FILE}")
        print(f"ğŸ“ Dosya mevcut: {os.path.exists(DB_FILE)}")
        
        if os.path.exists(DB_FILE):
            try:
                with open(DB_FILE, "r", encoding="utf-8") as f:
                    self.mac_db = json.load(f)
                print(f"âœ… VeritabanÄ± yÃ¼klendi: {len(self.mac_db)} maÃ§")
            except Exception as e:
                print(f"âŒ VeritabanÄ± yÃ¼kleme hatasÄ±: {e}")
                self.mac_db = []
        else:
            print(f"âš ï¸ VeritabanÄ± dosyasÄ± bulunamadÄ±, yeni oluÅŸturulacak")
            self.mac_db = []
    
    def db_kaydet(self):
        with open(DB_FILE, "w", encoding="utf-8") as f:
            json.dump(self.mac_db, f, ensure_ascii=False, indent=2)
    
    def _load_json(self, filepath, default=None):
        """JSON dosyasÄ± yÃ¼kle - V5.7"""
        if default is None:
            default = []
        try:
            if os.path.exists(filepath):
                with open(filepath, "r", encoding="utf-8") as f:
                    return json.load(f)
        except Exception as e:
            print(f"JSON yÃ¼kleme hatasÄ± ({filepath}): {e}")
        return default
    
    def _save_json(self, filepath, data):
        """JSON dosyasÄ±na kaydet - V5.7"""
        try:
            os.makedirs(os.path.dirname(filepath), exist_ok=True)
            with open(filepath, "w", encoding="utf-8") as f:
                json.dump(data, f, ensure_ascii=False, indent=2)
            return True
        except Exception as e:
            print(f"JSON kaydetme hatasÄ± ({filepath}): {e}")
            self._sonuc_ekle("K_BI_1", "KALDI", "TARANDI", "Åart saÄŸlanmadÄ±")
        return False
    
    def _get_current_analysis(self):
        """
        V70: FÄ°L HAFIZASI - Mevcut analizi al
        3 aÅŸamalÄ± arama: current_analysis â†’ mac_db â†’ mac_arsivi
        Bulamazsa None dÃ¶ner
        """
        # 1. current_analysis
        if hasattr(self, 'current_analysis') and self.current_analysis:
            return self.current_analysis
        
        # 2. mac_db (son analiz)
        if self.mac_db:
            self.current_analysis = self.mac_db[-1]
            return self.current_analysis
        
        # 3. mac_arsivi (son deÄŸer)
        if hasattr(self, 'mac_arsivi') and self.mac_arsivi:
            self.current_analysis = list(self.mac_arsivi.values())[-1]
            return self.current_analysis
        
        return None
    
    def _analiz_kontrol(self, goster_uyari=True):
        """
        V70: Analiz var mÄ± kontrolÃ¼
        Return: True (analiz var) / False (yok)
        """
        # Debug
        print(f"ğŸ” _analiz_kontrol Ã§aÄŸrÄ±ldÄ±")
        print(f"   current_analysis: {self.current_analysis is not None}")
        print(f"   mac_db uzunluk: {len(self.mac_db) if self.mac_db else 0}")
        print(f"   mac_arsivi uzunluk: {len(self.mac_arsivi) if hasattr(self, 'mac_arsivi') and self.mac_arsivi else 0}")
        
        analiz = self._get_current_analysis()
        if analiz:
            print(f"   âœ… Analiz bulundu: {analiz.get('mac', 'N/A')}")
            return True
        
        print(f"   âŒ Analiz bulunamadÄ±!")
        if goster_uyari:
            messagebox.showwarning("UyarÄ±", "HenÃ¼z analiz yapÄ±lmamÄ±ÅŸ!\n\nLÃ¼tfen Ã¶nce bir gÃ¶rsel yÃ¼kleyip analiz yapÄ±n.")
        return False
    
    def ayarlar_yukle(self):
        global TELEGRAM_BOT_TOKEN, TELEGRAM_CHAT_ID
        
        # Tema ve diÄŸer ayarlarÄ± ayarlar.json'dan yÃ¼kle
        if os.path.exists(SETTINGS_FILE):
            try:
                with open(SETTINGS_FILE, "r", encoding="utf-8") as f:
                    s = json.load(f)
                    self.current_theme = s.get("theme", "ğŸŒ™ Koyu")
                    self.theme = THEMES.get(self.current_theme, THEMES["ğŸŒ™ Koyu"])
                    self.alarmlar = s.get("alarmlar", [])
            except:
                pass
        
        # Telegram bilgilerini config.json'dan yÃ¼kle (GÃœVENLÄ°K)
        config = _load_config()
        TELEGRAM_BOT_TOKEN = config.get("telegram_bot_token", "")
        TELEGRAM_CHAT_ID = config.get("telegram_chat_id", "")
        self.telegram = TelegramBot(TELEGRAM_BOT_TOKEN, TELEGRAM_CHAT_ID)
        self.telegram.load_channels(CHANNELS_FILE)
    
    def ayarlar_kaydet(self):
        # Tema ve diÄŸer ayarlarÄ± ayarlar.json'a kaydet (hassas bilgi YOK)
        with open(SETTINGS_FILE, "w", encoding="utf-8") as f:
            json.dump({
                "theme": self.current_theme,
                "alarmlar": self.alarmlar
            }, f, ensure_ascii=False)
        
        # Telegram bilgilerini config.json'a kaydet (GÃœVENLÄ°K)
        config = _load_config()
        config["telegram_bot_token"] = TELEGRAM_BOT_TOKEN
        config["telegram_chat_id"] = TELEGRAM_CHAT_ID
        _save_config(config)
    
    def kurallar_yukle(self):
        try:
            with open(RULES_FILE, "r", encoding="utf-8") as f:
                self.kurallar_tam = f.read()
        except:
            self.kurallar_tam = "KURAL DOSYASI YOK"
    
    
    def setup_ui(self):
        """PRO Sidebar ArayÃ¼zÃ¼"""
        self.root.title("ğŸ‘ï¸ XG-XRAY V5.6 PRO | ULTRA MODERN INTERFACE")
        
        # Ana container
        main = tk.Frame(self.root, bg=ModernTheme.BG_PRIMARY)
        main.pack(fill="both", expand=True)
        
        # SOL SIDEBAR
        self.sidebar = ModernSidebar(main, on_select=self._on_nav)
        self.sidebar.pack(side="left", fill="y")
        
        # Ana menÃ¼ butonlarÄ±
        self.sidebar.add_button("dashboard", "ğŸ“Š", "Dashboard")
        self.sidebar.add_button("analiz", "ğŸš€", "Analiz")
        self.sidebar.add_button("arsiv", "ğŸ“", "ArÅŸiv")
        self.sidebar.add_button("skor", "âš½", "Skorlar")
        
        self.sidebar.add_section("AraÃ§lar")
        self.sidebar.add_button("kupon", "ğŸ“‹", "Kupon")
        self.sidebar.add_button("listeler", "ğŸ“", "Listeler")
        self.sidebar.add_button("degerli", "ğŸ’", "DeÄŸerli")
        self.sidebar.add_button("karsilastir", "ğŸ“Š", "KarÅŸÄ±laÅŸtÄ±r")
        self.sidebar.add_button("telegram", "ğŸ“±", "Telegram")
        self.sidebar.add_button("oranlar", "ğŸ“ˆ", "Oranlar")
        
        self.sidebar.add_section("GeliÅŸmiÅŸ")
        self.sidebar.add_button("ogrenme", "ğŸ§ ", "Ã–ÄŸrenme")
        self.sidebar.add_button("sosyal", "ğŸ“£", "Sosyal")
        self.sidebar.add_button("excel", "ğŸ“‘", "Excel")
        self.sidebar.add_button("puanlayici", "ğŸ¯", "PuanlayÄ±cÄ±")
        self.sidebar.add_button("simulator", "ğŸ®", "SimÃ¼latÃ¶r")
        self.sidebar.add_button("alarm", "â°", "Alarm")
        
        self.sidebar.add_section("Sistem")
        self.sidebar.add_button("lab", "ğŸ”¬", "Lab")
        self.sidebar.add_button("hazine", "ğŸ’°", "Hazine")
        self.sidebar.add_button("gorsel", "ğŸ–¼ï¸", "GÃ¶rsel")
        self.sidebar.add_button("marka", "ğŸ·ï¸", "Marka")
        self.sidebar.add_button("canli", "ğŸ”´", "CanlÄ± Bahis")
        self.sidebar.add_button("ayarlar", "âš™ï¸", "Ayarlar")
        
        # SAÄ ANA ALAN
        right = tk.Frame(main, bg=ModernTheme.BG_PRIMARY)
        right.pack(side="right", fill="both", expand=True)
        
        # Ãœst baÅŸlÄ±k
        header = tk.Frame(right, bg=ModernTheme.BG_PRIMARY, height=60)
        header.pack(fill="x", padx=20, pady=(15, 0))
        header.pack_propagate(False)
        
        self.page_title = tk.Label(header, text="ğŸ“Š Dashboard", font=("Segoe UI", 20, "bold"),
                                   bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.page_title.pack(side="left")
        
        self.lbl_status = tk.Label(header, text="âœ… HazÄ±r", font=("Consolas", 10),
                                   bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_SUCCESS)
        self.lbl_status.pack(side="right", padx=10)
        
        tk.Label(header, text=f"ğŸ“… {datetime.now().strftime('%d.%m.%Y')}", font=("Segoe UI", 11),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack(side="right", padx=20)
        
        # Ä°Ã§erik alanÄ±
        self.content = tk.Frame(right, bg=ModernTheme.BG_PRIMARY)
        self.content.pack(fill="both", expand=True, padx=20, pady=15)
        
        # Sayfa frame'leri (her sayfa iÃ§in ayrÄ±)
        self.pages = {}
        self._create_all_pages()
        
        # Ä°lk sayfa
        self._show_page("dashboard")
        self.sidebar._set_active("dashboard")
        
        # V5.7 YENÄ°: Otomatik yedekleme baÅŸlat
        self.otomatik_yedekleme_baslat()
    
    def _on_nav(self, name):
        """Navigasyon deÄŸiÅŸimi"""
        titles = {
            "dashboard": "ğŸ“Š Dashboard", "analiz": "ğŸš€ Analiz", "arsiv": "ğŸ“ ArÅŸiv",
            "skor": "âš½ Skorlar", "kupon": "ğŸ“‹ Kupon", "listeler": "ğŸ“ Listeler",
            "degerli": "ğŸ’ DeÄŸerli", "karsilastir": "ğŸ“Š KarÅŸÄ±laÅŸtÄ±r", "telegram": "ğŸ“± Telegram",
            "oranlar": "ğŸ“ˆ Oranlar", "ogrenme": "ğŸ§  Ã–ÄŸrenme", "sosyal": "ğŸ“£ Sosyal",
            "excel": "ğŸ“‘ Excel", "puanlayici": "ğŸ¯ PuanlayÄ±cÄ±", "simulator": "ğŸ® SimÃ¼latÃ¶r",
            "alarm": "â° Alarm", "lab": "ğŸ”¬ Lab", "hazine": "ğŸ’° Hazine",
            "gorsel": "ğŸ–¼ï¸ GÃ¶rsel", "marka": "ğŸ·ï¸ Marka", "ayarlar": "âš™ï¸ Ayarlar"
        }
        self.page_title.config(text=titles.get(name, name))
        self._show_page(name)
    
    def _show_page(self, name):
        """SayfayÄ± gÃ¶ster"""
        for n, f in self.pages.items():
            f.pack_forget()
        if name in self.pages:
            self.pages[name].pack(fill="both", expand=True)
    
    def _create_all_pages(self):
        """TÃ¼m sayfalarÄ± oluÅŸtur"""
        # Dashboard
        self.pages["dashboard"] = self._create_dashboard()
        
        # Analiz
        self.pages["analiz"] = self._create_analiz()
        
        # ArÅŸiv
        self.pages["arsiv"] = self._create_arsiv()
        
        # Skor
        self.pages["skor"] = self._create_skor()
        
        # Kupon
        self.pages["kupon"] = self._create_kupon()
        
        # Listeler
        self.pages["listeler"] = self._create_listeler()
        
        # DeÄŸerli
        self.pages["degerli"] = self._create_degerli()
        
        # KarÅŸÄ±laÅŸtÄ±r
        self.pages["karsilastir"] = self._create_karsilastir()
        
        # Telegram
        self.pages["telegram"] = self._create_telegram()
        
        # Oranlar
        self.pages["oranlar"] = self._create_oranlar()
        
        # Ã–ÄŸrenme
        self.pages["ogrenme"] = self._create_ogrenme()
        
        # Sosyal
        self.pages["sosyal"] = self._create_sosyal()
        
        # Excel
        self.pages["excel"] = self._create_excel()
        
        # PuanlayÄ±cÄ±
        self.pages["puanlayici"] = self._create_puanlayici()
        
        # SimÃ¼latÃ¶r
        self.pages["simulator"] = self._create_simulator()
        
        # Alarm
        self.pages["alarm"] = self._create_alarm()
        
        # Lab
        self.pages["lab"] = self._create_lab()
        
        # Hazine
        self.pages["hazine"] = self._create_hazine()
        
        # GÃ¶rsel
        self.pages["gorsel"] = self._create_gorsel()
        
        # Marka
        self.pages["marka"] = self._create_marka()
        
        # YENÄ°: CanlÄ± Bahis
        self.pages["canli"] = self._create_canli()
        
        # Ayarlar
        self.pages["ayarlar"] = self._create_ayarlar()
    
    def _create_dashboard(self):
        """Dashboard sayfasÄ± - V70 GÃœNCEL SAAT EKLENDÄ°"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # V70: GÃœNCEL SAAT - ÃœST BARDA
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        saat_bar = tk.Frame(page, bg=ModernTheme.BG_CARD)
        saat_bar.pack(fill="x", pady=(0, 10))
        
        tk.Label(saat_bar, text="ğŸ  DASHBOARD", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=15, pady=10)
        
        # Saat label - saÄŸda
        self.lbl_saat = tk.Label(saat_bar, text="", font=("Segoe UI", 14, "bold"),
                                 bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        self.lbl_saat.pack(side="right", padx=15, pady=10)
        
        # Tarih label
        self.lbl_tarih = tk.Label(saat_bar, text="", font=("Segoe UI", 10),
                                  bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY)
        self.lbl_tarih.pack(side="right", padx=5, pady=10)
        
        # Saati gÃ¼ncelle fonksiyonu
        def saat_guncelle():
            now = datetime.now()
            self.lbl_saat.config(text=now.strftime("%H:%M:%S"))
            self.lbl_tarih.config(text=now.strftime("%d.%m.%Y"))
            page.after(1000, saat_guncelle)  # Her saniye gÃ¼ncelle
        
        saat_guncelle()  # BaÅŸlat
        
        # Ä°statistikleri hesapla
        total = len(self.mac_db)
        won = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…", "KAZANAN"]])
        lost = len([m for m in self.mac_db if m.get("sonuc") in ["KAYBETTÄ°", "âŒ", "KAYBEDEN"]])
        waiting = len([m for m in self.mac_db if m.get("sonuc") in ["BEKLÄ°YOR", "â³", "", None]])
        
        # BaÅŸarÄ± oranÄ± - BEKLÄ°YOR DAHÄ°L EDÄ°LMEZ
        decided = won + lost
        rate = (won / decided * 100) if decided > 0 else 0
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ÃœST KARTLAR - 5 KART
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        cards = tk.Frame(page, bg=ModernTheme.BG_PRIMARY)
        cards.pack(fill="x", pady=(0, 20))
        
        self.card_toplam = DashboardCard(cards, "TOPLAM ANALÄ°Z", total, "TÃ¼m zamanlar", "ğŸ“Š", ModernTheme.ACCENT_PRIMARY)
        self.card_toplam.pack(side="left", fill="x", expand=True, padx=(0, 8))
        self.card_toplam.bind("<Button-1>", lambda e: self._filtre_dashboard("TÃœMÃœ"))
        
        self.card_kazanan = DashboardCard(cards, "KAZANAN", won, f"%{rate:.0f} baÅŸarÄ±", "âœ…", ModernTheme.ACCENT_SUCCESS)
        self.card_kazanan.pack(side="left", fill="x", expand=True, padx=8)
        self.card_kazanan.bind("<Button-1>", lambda e: self._filtre_dashboard("KAZANDI"))
        
        self.card_kaybeden = DashboardCard(cards, "KAYBEDEN", lost, "Toplam kayÄ±p", "âŒ", ModernTheme.ACCENT_DANGER)
        self.card_kaybeden.pack(side="left", fill="x", expand=True, padx=8)
        self.card_kaybeden.bind("<Button-1>", lambda e: self._filtre_dashboard("KAYBETTÄ°"))
        
        # YENÄ°: BEKLÄ°YOR kartÄ±
        self.card_bekliyor = DashboardCard(cards, "BEKLÄ°YOR", waiting, "SonuÃ§ bekleniyor", "â³", ModernTheme.ACCENT_WARNING)
        self.card_bekliyor.pack(side="left", fill="x", expand=True, padx=8)
        self.card_bekliyor.bind("<Button-1>", lambda e: self._filtre_dashboard("BEKLÄ°YOR"))
        
        self.card_basari = DashboardCard(cards, "BAÅARI ORANI", f"%{rate:.0f}", "Genel performans", "ğŸ“ˆ", ModernTheme.ACCENT_PURPLE)
        self.card_basari.pack(side="left", fill="x", expand=True, padx=(8, 0))
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ORTA KISIM - SON MAÃ‡LAR + HIZLI Ä°ÅLEMLER
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        bottom = tk.Frame(page, bg=ModernTheme.BG_PRIMARY)
        bottom.pack(fill="both", expand=True)
        
        # Sol: Son MaÃ§lar
        left = tk.Frame(bottom, bg=ModernTheme.BG_CARD)
        left.pack(side="left", fill="both", expand=True, padx=(0, 10))
        
        left_header = tk.Frame(left, bg=ModernTheme.BG_CARD)
        left_header.pack(fill="x", padx=15, pady=10)
        
        tk.Label(left_header, text="ğŸ“‹ SON MAÃ‡LAR", font=("Segoe UI", 14, "bold"),
                bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        
        tk.Button(left_header, text="ğŸ”„ GÃ¼ncelle", command=self._dashboard_guncelle,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="right")
        
        # Tablo
        cols = ("tarih", "mac", "banko", "skor", "sonuc")
        self.dash_tree = ttk.Treeview(left, columns=cols, show="headings", height=12)
        for c, w in [("tarih", 85), ("mac", 220), ("banko", 130), ("skor", 60), ("sonuc", 100)]:
            self.dash_tree.heading(c, text=c.upper())
            self.dash_tree.column(c, width=w, anchor="center")
        
        # Tag'ler - RENKLENDÄ°RME
        self.dash_tree.tag_configure("kazandi", background=ModernTheme.KAZANDI_BG, foreground=ModernTheme.KAZANDI_FG)
        self.dash_tree.tag_configure("kaybetti", background=ModernTheme.KAYBETTI_BG, foreground=ModernTheme.KAYBETTI_FG)
        self.dash_tree.tag_configure("bekliyor", background=ModernTheme.BEKLIYOR_BG, foreground=ModernTheme.BEKLIYOR_FG)
        
        self.dash_tree.pack(fill="both", expand=True, padx=10, pady=(0, 10))
        
        # Verileri yÃ¼kle
        self._dashboard_maclari_yukle()
        
        # SaÄŸ Panel - HÄ±zlÄ± Ä°ÅŸlemler + GÃ¼nlÃ¼k BaÅŸarÄ± - FIX #4: SCROLL EKLENDÄ°
        right_container = tk.Frame(bottom, bg=ModernTheme.BG_CARD, width=320)
        right_container.pack(side="right", fill="y")
        right_container.pack_propagate(False)
        
        # Canvas ve Scrollbar
        right_canvas = tk.Canvas(right_container, bg=ModernTheme.BG_CARD, highlightthickness=0, width=300)
        right_scrollbar = ttk.Scrollbar(right_container, orient="vertical", command=right_canvas.yview)
        right = tk.Frame(right_canvas, bg=ModernTheme.BG_CARD)
        
        right.bind("<Configure>", lambda e: right_canvas.configure(scrollregion=right_canvas.bbox("all")))
        right_canvas.create_window((0, 0), window=right, anchor="nw")
        right_canvas.configure(yscrollcommand=right_scrollbar.set)
        
        right_scrollbar.pack(side="right", fill="y")
        right_canvas.pack(side="left", fill="both", expand=True)
        
        # Mouse wheel scroll
        def _on_mousewheel(event):
            right_canvas.yview_scroll(int(-1*(event.delta/120)), "units")
        right_canvas.bind_all("<MouseWheel>", _on_mousewheel)
        
        tk.Label(right, text="âš¡ HIZLI Ä°ÅLEMLER", font=("Segoe UI", 14, "bold"),
                bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(anchor="w", padx=15, pady=10)
        
        btn_frame = tk.Frame(right, bg=ModernTheme.BG_CARD)
        btn_frame.pack(fill="x", padx=15)
        
        tk.Button(btn_frame, text="ğŸš€ Yeni Analiz", 
                  command=lambda: [self._show_page("analiz"), self.sidebar._set_active("analiz")],
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸ”´ CanlÄ± Bahis", 
                  command=lambda: [self._show_page("canli"), self.sidebar._set_active("canli")],
                  bg=ModernTheme.ACCENT_DANGER, fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸ“‹ HaftalÄ±k Rapor", 
                  command=self.haftalik_rapor_goster,
                  bg="#6f42c1", fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸ“Š AylÄ±k Rapor", 
                  command=self.aylik_rapor_goster,
                  bg="#17a2b8", fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸ¯ Sniper Modu", 
                  command=self.sniper_modu_popup,
                  bg="#dc3545", fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸ” Pattern Finder", 
                  command=self.pattern_finder_popup,
                  bg="#fd7e14", fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸŒ¡ï¸ SÄ±caklÄ±k HaritasÄ±", 
                  command=self.sicaklik_haritasi_popup,
                  bg="#e83e8c", fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸ’ Gizli Bankolar", 
                  command=self.gizli_banko_popup,
                  bg="#FFD700", fg="black", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸ’° Kasa DanÄ±ÅŸmanÄ±", 
                  command=self.kasa_danismani_popup,
                  bg="#20c997", fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸ† GÃ¼nlÃ¼k Turnuva", 
                  command=self.gunluk_turnuva_goster,
                  bg="#ffc107", fg="black", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸ’¡ GÃ¼nÃ¼n Ä°pucu", 
                  command=self.gunun_ipucu_popup,
                  bg="#28a745", fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸš¨ Panik Modu", 
                  command=self._toggle_panik_modu,
                  bg="#ff0000", fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸ“Š Lig PerformansÄ±", 
                  command=self.lig_performans_popup,
                  bg="#6610f2", fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="ğŸ“ˆ Trend Analizi", 
                  command=self.trend_analizi_popup,
                  bg="#007bff", fg="white", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        tk.Button(btn_frame, text="â­ Favorilerim", 
                  command=self.favoriler_popup,
                  bg="#ffc107", fg="black", font=("Segoe UI", 9), 
                  relief="flat", pady=3).pack(fill="x", pady=1)
        
        # V5.7 YENÄ°: Ä°leri DÃ¼zey AraÃ§lar
        tk.Label(right, text="ğŸ› ï¸ Ä°LERÄ° ARAÃ‡LAR", font=("Segoe UI", 10, "bold"),
                bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PURPLE).pack(anchor="w", padx=15, pady=(8, 3))
        
        btn_frame2 = tk.Frame(right, bg=ModernTheme.BG_CARD)
        btn_frame2.pack(fill="x", padx=15)
        
        tk.Button(btn_frame2, text="ğŸ’¹ ROI Hesapla", 
                  command=self.roi_hesaplama_popup,
                  bg="#198754", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame2, text="ğŸ”¥ Streak Takip", 
                  command=self.streak_takip_popup,
                  bg="#fd7e14", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame2, text="â° Saat Analizi", 
                  command=self.saat_analizi_popup,
                  bg="#0dcaf0", fg="black", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame2, text="ğŸ“… GÃ¼n Analizi", 
                  command=self.gun_analizi_popup,
                  bg="#6f42c1", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame2, text="ğŸ’° KazanÃ§ SimÃ¼latÃ¶rÃ¼", 
                  command=self.kazanc_simulatoru_popup,
                  bg="#20c997", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame2, text="âš¡ Quick Bet", 
                  command=self.quick_bet_popup,
                  bg="#e83e8c", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame2, text="ğŸ“Š DetaylÄ± Ä°statistik", 
                  command=self.detayli_istatistik_popup,
                  bg="#343a40", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        # V5.7 YENÄ°: ÃœÃ§Ã¼ncÃ¼ Buton Grubu - Ekstra AraÃ§lar
        tk.Label(right, text="ğŸ”¬ EKSTRA ARAÃ‡LAR", font=("Segoe UI", 10, "bold"),
                bg=ModernTheme.BG_CARD, fg="#e83e8c").pack(anchor="w", padx=15, pady=(8, 3))
        
        btn_frame3 = tk.Frame(right, bg=ModernTheme.BG_CARD)
        btn_frame3.pack(fill="x", padx=15)
        
        tk.Button(btn_frame3, text="ğŸ“‰ KayÄ±p Analizi", 
                  command=self.kayip_analizi_popup,
                  bg="#dc3545", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame3, text="ğŸ­ Ã‡ift Kontrol", 
                  command=self.cift_kontrol_popup,
                  bg="#6610f2", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame3, text="ğŸ§² Manyetik Lig", 
                  command=self.manyetik_lig_popup,
                  bg="#0d6efd", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame3, text="ğŸª SÃ¼rpriz Radar", 
                  command=self.surpriz_radar_popup,
                  bg="#d63384", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame3, text="ğŸ§  HafÄ±za Modu", 
                  command=self.hafiza_modu_popup,
                  bg="#9b59b6", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame3, text="ğŸ“Š KarÅŸÄ±laÅŸtÄ±rma Grafik", 
                  command=self.karsilastirmali_grafik_popup,
                  bg="#17a2b8", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame3, text="ğŸ† HaftalÄ±k Turnuva", 
                  command=self.haftalik_turnuva_popup,
                  bg="#ffc107", fg="black", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        tk.Button(btn_frame3, text="ğŸ“‹ GÃ¼nlÃ¼k GÃ¶revler", 
                  command=self.gunluk_gorev_popup,
                  bg="#28a745", fg="white", font=("Segoe UI", 8), 
                  relief="flat", pady=2).pack(fill="x", pady=1)
        
        # YENÄ°: GÃ¼nÃ¼n MVP'si
        tk.Label(right, text="ğŸ… GÃœNÃœN MVP", font=("Segoe UI", 10, "bold"),
                bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_WARNING).pack(anchor="w", padx=15, pady=(8, 2))
        
        self.lbl_mvp = tk.Label(right, text="HenÃ¼z analiz yok", font=("Segoe UI", 8),
                                bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY, wraplength=280, justify="left")
        self.lbl_mvp.pack(anchor="w", padx=15)
        
        # YENÄ°: BugÃ¼n Ã¶zeti
        tk.Label(right, text="ğŸ“Š BUGÃœN", font=("Segoe UI", 11, "bold"),
                bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY).pack(anchor="w", padx=15, pady=(10, 3))
        
        self.lbl_bugun = tk.Label(right, text="", font=("Segoe UI", 9),
                                  bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY)
        self.lbl_bugun.pack(anchor="w", padx=15)
        
        # Ã–zet ve MVP gÃ¼ncelle
        self._bugun_ozet_guncelle()
        self._mvp_bul()
        
        return page
    
    def _dashboard_maclari_yukle(self):
        """Dashboard'a maÃ§larÄ± yÃ¼kle - RENKLÄ°"""
        for item in self.dash_tree.get_children():
            self.dash_tree.delete(item)
        
        # V70 FIX: TÃ¼m maÃ§larÄ± gÃ¶ster (son 50)
        print(f"ğŸ“Š Dashboard: mac_db'de {len(self.mac_db)} maÃ§ var")
        
        for mac in reversed(self.mac_db[-50:]):
            sonuc = mac.get("sonuc", "BEKLÄ°YOR")
            
            # Tag ve metin belirle
            if sonuc in ["KAZANDI", "âœ…", "KAZANAN"]:
                tag = "kazandi"
                sonuc_text = "âœ… KAZANDI"
            elif sonuc in ["KAYBETTÄ°", "âŒ", "KAYBEDEN"]:
                tag = "kaybetti"
                sonuc_text = "âŒ KAYBETTÄ°"
            else:
                tag = "bekliyor"
                sonuc_text = "â³ BEKLÄ°YOR"
            
            self.dash_tree.insert("", 0, values=(
                mac.get("tarih", "-"),
                mac.get("mac", mac.get("mac_adi", "-")).replace("_", " ")[:28],
                mac.get("banko", "-")[:18],
                mac.get("skor", mac.get("gercek_skor", "-")),
                sonuc_text
            ), tags=(tag,))
    
    def _dashboard_guncelle(self):
        """Dashboard'u gÃ¼ncelle"""
        total = len(self.mac_db)
        won = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…", "KAZANAN"]])
        lost = len([m for m in self.mac_db if m.get("sonuc") in ["KAYBETTÄ°", "âŒ", "KAYBEDEN"]])
        waiting = len([m for m in self.mac_db if m.get("sonuc") in ["BEKLÄ°YOR", "â³", "", None]])
        
        decided = won + lost
        rate = (won / decided * 100) if decided > 0 else 0
        
        # KartlarÄ± gÃ¼ncelle
        self.card_toplam.update_value(total)
        self.card_kazanan.update_value(won, f"%{rate:.0f} baÅŸarÄ±")
        self.card_kaybeden.update_value(lost)
        self.card_bekliyor.update_value(waiting)
        self.card_basari.update_value(f"%{rate:.0f}")
        
        self._dashboard_maclari_yukle()
        self._bugun_ozet_guncelle()
        self._mvp_bul()
        
        self.lbl_status.config(text="âœ… GÃ¼ncellendi")
        # FIX #1: GÃ¼ncelleme mesajÄ± gÃ¶ster
        messagebox.showinfo("âœ…", f"Dashboard gÃ¼ncellendi!\n\nğŸ“Š Toplam: {total}\nâœ… Kazanan: {won}\nâŒ Kaybeden: {lost}\nâ³ Bekleyen: {waiting}")

    def _filtre_dashboard(self, filtre):
        """FIX #2: Dashboard'da karta tÄ±klayÄ±nca filtreleme"""
        for item in self.dash_tree.get_children():
            self.dash_tree.delete(item)
        
        for mac in reversed(self.mac_db[-100:]):
            sonuc = mac.get("sonuc", "BEKLÄ°YOR")
            
            # Filtreleme
            if filtre == "KAZANDI" and sonuc not in ["KAZANDI", "âœ…", "KAZANAN"]:
                continue
            elif filtre == "KAYBETTÄ°" and sonuc not in ["KAYBETTÄ°", "âŒ", "KAYBEDEN"]:
                continue
            elif filtre == "BEKLÄ°YOR" and sonuc not in ["BEKLÄ°YOR", "â³", "", None]:
                continue
            
            # Tag ve metin belirle
            if sonuc in ["KAZANDI", "âœ…", "KAZANAN"]:
                tag = "kazandi"
                sonuc_text = "âœ… KAZANDI"
            elif sonuc in ["KAYBETTÄ°", "âŒ", "KAYBEDEN"]:
                tag = "kaybetti"
                sonuc_text = "âŒ KAYBETTÄ°"
            else:
                tag = "bekliyor"
                sonuc_text = "â³ BEKLÄ°YOR"
            
            self.dash_tree.insert("", "end", values=(
                mac.get("tarih", "-"),
                mac.get("mac", mac.get("mac_adi", "-")).replace("_", " ")[:28],
                mac.get("banko", "-")[:18],
                mac.get("skor", mac.get("gercek_skor", "-")),
                sonuc_text
            ), tags=(tag,))
        
        # Filtre bilgisi gÃ¶ster
        self.lbl_status.config(text=f"ğŸ” Filtre: {filtre}")
    
    def _bugun_ozet_guncelle(self):
        """BugÃ¼nkÃ¼ analiz Ã¶zetini gÃ¼ncelle"""
        bugun = datetime.now().strftime("%d.%m.%Y")
        bugun_maclar = [m for m in self.mac_db if m.get("tarih") == bugun]
        
        toplam = len(bugun_maclar)
        kazanan = len([m for m in bugun_maclar if m.get("sonuc") in ["KAZANDI", "âœ…"]])
        kaybeden = len([m for m in bugun_maclar if m.get("sonuc") in ["KAYBETTÄ°", "âŒ"]])
        bekleyen = toplam - kazanan - kaybeden
        
        self.lbl_bugun.config(text=f"Toplam: {toplam} | âœ… {kazanan} | âŒ {kaybeden} | â³ {bekleyen}")
    
    def _mvp_bul(self):
        """GÃ¼nÃ¼n MVP maÃ§Ä±nÄ± bul"""
        bugun = datetime.now().strftime("%d.%m.%Y")
        bugun_maclar = [m for m in self.mac_db if m.get("tarih") == bugun]
        
        if not bugun_maclar:
            self.lbl_mvp.config(text="BugÃ¼n analiz yok")
            return
        
        mvp = None
        max_guven = 0
        
        for mac in bugun_maclar:
            guven = mac.get("guven", 0)
            if isinstance(guven, str):
                try:
                    guven = int(guven.split("/")[0])
                except:
                    guven = 0
            if guven > max_guven:
                max_guven = guven
                mvp = mac
        
        if mvp:
            mac_adi = mvp.get("mac", mvp.get("mac_adi", "?")).replace("_", " ")[:25]
            banko = mvp.get("banko", "?")[:15]
            kasa = KASA_ORANLARI.get(max_guven, {}).get("oran", 10)
            emoji = KASA_ORANLARI.get(max_guven, {}).get("emoji", "")
            self.lbl_mvp.config(text=f"â­ {mac_adi}\nğŸ¯ {banko}\n{emoji} GÃ¼ven: {max_guven}/10 | Kasa: %{kasa}")
    
    def _gunluk_basari_popup(self):
        """GÃ¼nlÃ¼k baÅŸarÄ± popup'Ä±"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“Š GÃ¼nlÃ¼k BaÅŸarÄ± Raporu")
        popup.geometry("550x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        popup.grab_set()
        
        tk.Label(popup, text="ğŸ“Š GÃœNLÃœK BAÅARI RAPORU", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=15)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 11), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Son 10 gÃ¼nÃ¼ hesapla
        gunler = {}
        for mac in self.mac_db:
            tarih = mac.get("tarih", "?")
            if tarih not in gunler:
                gunler[tarih] = {"toplam": 0, "kazanan": 0, "kaybeden": 0}
            gunler[tarih]["toplam"] += 1
            sonuc = mac.get("sonuc", "")
            if sonuc in ["KAZANDI", "âœ…"]:
                gunler[tarih]["kazanan"] += 1
            elif sonuc in ["KAYBETTÄ°", "âŒ"]:
                gunler[tarih]["kaybeden"] += 1
        
        sorted_gunler = sorted(gunler.items(), reverse=True)[:10]
        
        rapor = "â•" * 50 + "\n"
        rapor += " ğŸ“… TARÄ°H       | ğŸ“Š TOP | âœ… KAZ | âŒ KAY | ğŸ“ˆ BAÅARI\n"
        rapor += "â•" * 50 + "\n"
        
        for tarih, data in sorted_gunler:
            toplam = data["toplam"]
            kazanan = data["kazanan"]
            kaybeden = data["kaybeden"]
            decided = kazanan + kaybeden
            basari = (kazanan / decided * 100) if decided > 0 else 0
            emoji = "ğŸ”¥" if basari >= 70 else ("âœ…" if basari >= 50 else "âš ï¸")
            rapor += f" {tarih:12}  | {toplam:5} | {kazanan:5} | {kaybeden:5} | {emoji} %{basari:.0f}\n"
        
        rapor += "â•" * 50 + "\n"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)
    
    def _create_analiz(self):
        """Analiz sayfasÄ±"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        # Ãœst kontroller
        top = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        top.pack(fill="x", pady=(0, 10))
        
        tk.Label(top, text="API:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY).pack(side="left", padx=(10, 5))
        self.entry_api = tk.Entry(top, width=40, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY, insertbackground=ModernTheme.TEXT_PRIMARY)
        self.entry_api.insert(0, DEFAULT_API_KEY)
        self.entry_api.pack(side="left", padx=5)
        
        tk.Label(top, text="Tarih:", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_WARNING).pack(side="left", padx=(20, 5))
        self.entry_date = tk.Entry(top, width=10, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY, insertbackground=ModernTheme.TEXT_PRIMARY)
        self.entry_date.insert(0, datetime.now().strftime("%d.%m.%Y"))
        self.entry_date.pack(side="left")
        
        self.var_model = tk.StringVar(value="Gemini 2.5 Pro (Ã–nerilen)")
        ttk.Combobox(top, textvariable=self.var_model, values=list(GEMINI_MODELS.keys()), width=22, state="readonly").pack(side="left", padx=20)
        
        self.lbl_count = tk.Label(top, text="0/15", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_WARNING, font=("Arial", 11, "bold"))
        self.lbl_count.pack(side="right", padx=10)
        
        tk.Button(top, text="ğŸ“‚", command=self.dosya_sec, bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="right", padx=2)
        tk.Button(top, text="ğŸ“‹", command=self.panodan_yapistir, bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="right", padx=2)
        tk.Button(top, text="ğŸ—‘ï¸", command=self.temizle, bg=ModernTheme.ACCENT_DANGER, fg="white", relief="flat").pack(side="right", padx=2)
        
        # Notlar - V70 GENÄ°ÅLETÄ°LDÄ°
        frm_notlar = tk.LabelFrame(page, text="ğŸ“ NOTLAR (SakatlÄ±k, Seri, ORANLAR, H2H, Motivasyon)", 
                                   bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_notlar.pack(fill="x", pady=5)
        
        self.txt_notes = tk.Text(frm_notlar, height=4, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY, 
                                 insertbackground=ModernTheme.TEXT_PRIMARY, wrap="word")
        self.txt_notes.pack(fill="x", padx=5, pady=5)
        self.txt_notes.insert("1.0", "Ã–rnek: Ev 3 maÃ§tÄ±r yenilmiyor | Dep golcÃ¼sÃ¼ sakat | H2H: Son 5 maÃ§ta 4 Ã¼st | Derbi maÃ§Ä±")
        self.txt_notes.bind("<FocusIn>", lambda e: self.txt_notes.delete("1.0", tk.END) if "Ã–rnek:" in self.txt_notes.get("1.0", tk.END) else None)
        
        # Analiz butonu
        self.btn_analyze = tk.Button(page, text=f"ğŸš€ ANALÄ°ZÄ° BAÅLAT ({TOPLAM_KURAL} KURAL)", command=self.analizi_baslat,
                                     bg=ModernTheme.ACCENT_SUCCESS, fg="white", font=("Arial", 14, "bold"), height=2, relief="flat")
        self.btn_analyze.pack(fill="x", pady=10)
        
        # Progress
        self.progress_frame = tk.Frame(page, bg=ModernTheme.BG_PRIMARY)
        self.progress = ttk.Progressbar(self.progress_frame, mode="determinate", length=400)
        self.progress.pack(side="left", padx=10)
        self.lbl_progress = tk.Label(self.progress_frame, text="", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY, font=("Consolas", 10))
        self.lbl_progress.pack(side="left", padx=10)
        
        # SonuÃ§
        self.txt_result = scrolledtext.ScrolledText(page, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00", insertbackground="#00ff00")
        self.txt_result.pack(fill="both", expand=True, pady=10)
        
        # Alt butonlar - 2 SATIR
        btm = tk.Frame(page, bg=ModernTheme.BG_PRIMARY)
        btm.pack(fill="x")
        
        # SatÄ±r 1
        row1 = tk.Frame(btm, bg=ModernTheme.BG_PRIMARY)
        row1.pack(fill="x", pady=2)
        
        tk.Button(row1, text="ğŸ“Š EXCEL", command=self.excel_ekle, bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=2)
        tk.Button(row1, text="ğŸ“ WORD", command=self.word_kaydet, bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=2)
        tk.Button(row1, text="ğŸ“± TELEGRAM", command=self._telegram_popup, bg="#0088cc", fg="white", relief="flat").pack(side="left", padx=2)
        tk.Button(row1, text="ğŸ“¤ Ã–ZET", command=self.telegram_ozet_gonder, bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(side="left", padx=2)
        tk.Button(row1, text="ğŸ” KURAL TARAMA", command=self.kural_popup, bg=ModernTheme.ACCENT_PURPLE, fg="white", relief="flat").pack(side="right", padx=2)
        
        # SatÄ±r 2 - YENÄ° BUTONLAR
        row2 = tk.Frame(btm, bg=ModernTheme.BG_PRIMARY)
        row2.pack(fill="x", pady=2)
        
        tk.Button(row2, text="ğŸ“± SOSYAL MEDYA", command=self.sosyal_sablon_popup, bg="#e83e8c", fg="white", relief="flat").pack(side="left", padx=2)
        tk.Button(row2, text="ğŸ” BENZER MAÃ‡", command=self._benzer_mac_popup, bg="#fd7e14", fg="white", relief="flat").pack(side="left", padx=2)
        tk.Button(row2, text="ğŸ“ YORUM OLUÅTUR", command=self._mac_yorumu_popup, bg="#6f42c1", fg="white", relief="flat").pack(side="left", padx=2)
        tk.Button(row2, text="â­ FAVORÄ°YE EKLE", command=self._favoriye_ekle, bg="#ffc107", fg="black", relief="flat").pack(side="left", padx=2)
        tk.Button(row2, text="âš ï¸ RÄ°SK ANALÄ°ZÄ°", command=self.risk_analizi_popup, bg="#dc3545", fg="white", relief="flat").pack(side="right", padx=2)
        tk.Button(row2, text="ğŸ­ Ã‡Ä°FT KONTROL", command=self.cift_kontrol_popup, bg="#6610f2", fg="white", relief="flat").pack(side="right", padx=2)
        
        return page
    
    def _create_arsiv(self):
        """ArÅŸiv sayfasÄ± - V5.7 TAM Ã–ZELLÄ°KLÄ°"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        # Ãœst kontroller
        top = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        top.pack(fill="x", pady=(0, 10))
        
        tk.Label(top, text="Ara:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.entry_search = tk.Entry(top, width=25, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_search.pack(side="left", padx=5)
        tk.Button(top, text="ğŸ”", command=self.arsiv_ara, bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left")
        tk.Button(top, text="ğŸ”„", command=self.arsiv_yenile, bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=5)
        
        tk.Label(top, text="Filtre:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.combo_filtre = ttk.Combobox(top, values=["TÃ¼mÃ¼", "KAZANDI", "KAYBETTÄ°", "BEKLÄ°YOR"], width=12)
        self.combo_filtre.set("TÃ¼mÃ¼")
        self.combo_filtre.pack(side="left")
        self.combo_filtre.bind("<<ComboboxSelected>>", lambda e: self.arsiv_yenile())
        
        # YENÄ°: SaÄŸ taraf butonlarÄ±
        tk.Button(top, text="ğŸ“¥ EXCEL'E Ã‡IKAR", command=self._arsiv_excel_cikar, 
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="right", padx=3)
        tk.Button(top, text="ğŸ’¾ YEDEKLE", command=self._arsiv_yedekle, 
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="right", padx=3)
        tk.Button(top, text="â†©ï¸ GERÄ° AL", command=self._arsiv_geri_al, 
                  bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(side="right", padx=3)
        tk.Button(top, text="ğŸ—‘ï¸ TÃœMÃœNÃœ SÄ°L", command=self._arsiv_tumunu_sil, 
                  bg="#aa0000", fg="white", relief="flat").pack(side="right", padx=3)
        tk.Button(top, text="ğŸ—‘ï¸ SEÃ‡Ä°LÄ° SÄ°L", command=self.arsiv_secili_sil, 
                  bg=ModernTheme.ACCENT_DANGER, fg="white", relief="flat").pack(side="right", padx=3)
        
        # Tablo - KASA sÃ¼tunu eklendi
        cols = ("tarih", "mac", "banko", "sigorta", "guven", "kasa", "sonuc")
        self.tree_arsiv = ttk.Treeview(page, columns=cols, show="headings", height=20, selectmode="extended")
        for c, w in [("tarih", 85), ("mac", 200), ("banko", 120), ("sigorta", 120), ("guven", 55), ("kasa", 55), ("sonuc", 90)]:
            self.tree_arsiv.heading(c, text=c.upper())
            self.tree_arsiv.column(c, width=w, anchor="center")
        
        # Tag'ler - RENKLENDÄ°RME
        self.tree_arsiv.tag_configure("kazandi", background=ModernTheme.KAZANDI_BG, foreground=ModernTheme.KAZANDI_FG)
        self.tree_arsiv.tag_configure("kaybetti", background=ModernTheme.KAYBETTI_BG, foreground=ModernTheme.KAYBETTI_FG)
        self.tree_arsiv.tag_configure("bekliyor", background=ModernTheme.BEKLIYOR_BG, foreground=ModernTheme.BEKLIYOR_FG)
        
        self.tree_arsiv.pack(fill="both", expand=True)
        self.tree_arsiv.bind("<Double-1>", self.arsiv_detay)
        
        # YENÄ°: SaÄŸ tÄ±k menÃ¼sÃ¼
        self.tree_arsiv.bind("<Button-3>", self._arsiv_sag_tik)
        self.arsiv_menu = tk.Menu(self.root, tearoff=0)
        self.arsiv_menu.add_command(label="ğŸ” Ä°NCELE (Otopsi)", command=self._arsiv_incele)
        self.arsiv_menu.add_command(label="ğŸ“¤ TELEGRAM'A GÃ–NDER", command=self._arsiv_telegram)
        self.arsiv_menu.add_separator()
        self.arsiv_menu.add_command(label="ğŸ—‘ï¸ SÄ°L", command=self.arsiv_secili_sil)
        
        self.arsiv_yenile()
        return page
    
    def _arsiv_sag_tik(self, event):
        """ArÅŸivde saÄŸ tÄ±k menÃ¼sÃ¼"""
        item = self.tree_arsiv.identify_row(event.y)
        if item:
            self.tree_arsiv.selection_set(item)
            self.arsiv_menu.post(event.x_root, event.y_root)
    
    def _arsiv_incele(self):
        """SeÃ§ili maÃ§Ä± incele - Otopsi"""
        selection = self.tree_arsiv.selection()
        if not selection:
            messagebox.showwarning("UyarÄ±", "Bir maÃ§ seÃ§in!")
            return
        item = self.tree_arsiv.item(selection[0])
        mac_adi = item["values"][1]
        
        mac = None
        for m in self.mac_db:
            if m.get("mac", m.get("mac_adi", "")).replace("_", " ") == str(mac_adi).replace("_", " "):
                mac = m
                break
        
        if mac:
            self._otopsi_popup(mac)
        else:
            messagebox.showwarning("UyarÄ±", "MaÃ§ bulunamadÄ±!")
    
    def _otopsi_popup(self, mac):
        """FIX #15: DetaylÄ± MaÃ§ Otopsisi - hangi kural yanÄ±lttÄ± gÃ¶ster"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ” MaÃ§ Otopsisi")
        popup.geometry("750x700")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ” DETAYLI MAÃ‡ OTOPSÄ°SÄ°", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        sonuc = mac.get("sonuc", "BEKLÄ°YOR")
        banko = mac.get("banko", "?")
        skor = mac.get("skor", mac.get("gercek_skor", "?"))
        guven = mac.get("guven", "?")
        
        # SonuÃ§ analizi
        if sonuc in ["KAYBETTÄ°", "âŒ"]:
            sonuc_emoji = "âŒ"
            sonuc_renk = "KAYBEDEN"
            neden_analizi = self._kayip_nedeni_analiz(mac, banko, skor)
        elif sonuc in ["KAZANDI", "âœ…"]:
            sonuc_emoji = "âœ…"
            sonuc_renk = "KAZANAN"
            neden_analizi = "âœ… Tahmin doÄŸru Ã§Ä±ktÄ±!"
        else:
            sonuc_emoji = "â³"
            sonuc_renk = "BEKLÄ°YOR"
            neden_analizi = "â³ MaÃ§ henÃ¼z oynanmadÄ±"
        
        info = f"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸ” DETAYLI MAÃ‡ OTOPSÄ°SÄ°                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£

ğŸ“… TARÄ°H: {mac.get("tarih", "?")}
âš½ MAÃ‡: {mac.get("mac", mac.get("mac_adi", "?"))}
ğŸ† LÄ°G: {mac.get("lig", "?")}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ TAHMÄ°N BÄ°LGÄ°LERÄ°:
   â€¢ BANKO: {banko}
   â€¢ SÄ°GORTA: {mac.get("sigorta", "?")}
   â€¢ GÃœVEN: {guven}/10
   â€¢ KASA: %{mac.get("kasa", "?")}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š SONUÃ‡:
   â€¢ SKOR: {skor}
   â€¢ SONUÃ‡: {sonuc_emoji} {sonuc_renk}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”¬ NEDEN ANALÄ°ZÄ°:
{neden_analizi}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ˆ Ä°STATÄ°STÄ°KSEL VERÄ°LER:
   â€¢ xG: {mac.get("xg", mac.get("xg_toplam", "?"))}
   â€¢ MS 2.5Ãœ: %{mac.get("ms_25", "?")}
   â€¢ KG VAR: %{mac.get("kg_var", "?")}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ’¡ DERS:
{self._ders_cikar(mac, sonuc, banko, skor)}

â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""
        text.insert("1.0", info)
        text.config(state="disabled")
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    def _kayip_nedeni_analiz(self, mac, banko, skor):
        """KaybÄ±n nedenini analiz et"""
        nedenler = []
        
        try:
            if skor and "-" in str(skor):
                skorlar = str(skor).split("-")
                ev_gol = int(skorlar[0].strip())
                dep_gol = int(skorlar[1].strip())
                toplam_gol = ev_gol + dep_gol
                
                banko_lower = banko.lower() if banko else ""
                
                if "2.5 Ã¼st" in banko_lower and toplam_gol < 3:
                    nedenler.append(f"âŒ 2.5 Ãœst tahmini - MaÃ§ta sadece {toplam_gol} gol atÄ±ldÄ±")
                    nedenler.append("   ğŸ’¡ TakÄ±mlarÄ±n son maÃ§ formu dÃ¼ÅŸÃ¼k olabilir")
                
                if "1.5 Ã¼st" in banko_lower and toplam_gol < 2:
                    nedenler.append(f"âŒ 1.5 Ãœst tahmini - MaÃ§ta sadece {toplam_gol} gol atÄ±ldÄ±")
                    nedenler.append("   ğŸ’¡ Defansif maÃ§ beklenmemeliydi")
                
                if "kg var" in banko_lower and (ev_gol == 0 or dep_gol == 0):
                    nedenler.append(f"âŒ KG VAR tahmini - Bir takÄ±m gol atamadÄ±")
                    nedenler.append("   ğŸ’¡ Gol yeme istatistikleri yanÄ±ltÄ±cÄ± olabilir")
                
                if "ms 1" in banko_lower and ev_gol <= dep_gol:
                    nedenler.append(f"âŒ MS1 tahmini - Ev sahibi kazanamadÄ± ({skor})")
                
                if "ms 2" in banko_lower and dep_gol <= ev_gol:
                    nedenler.append(f"âŒ MS2 tahmini - Deplasman kazanamadÄ± ({skor})")
        except:
            pass
        
        if not nedenler:
            nedenler.append("âš ï¸ Tahmin tutmadÄ± - DetaylÄ± analiz iÃ§in verileri kontrol et")
        
        return "\n".join(nedenler)

    def _ders_cikar(self, mac, sonuc, banko, skor):
        """MaÃ§tan ders Ã§Ä±kar"""
        guven = mac.get("guven", 5)
        if isinstance(guven, str):
            try: guven = int(guven.split("/")[0])
            except: guven = 5
        
        if sonuc in ["KAYBETTÄ°", "âŒ"]:
            if guven >= 9:
                return "âš ï¸ YÃ¼ksek gÃ¼venli tahmin yattÄ±!\n   Bu lig/takÄ±m iÃ§in dikkatli ol."
            elif guven >= 7:
                return "ğŸ“Š Orta gÃ¼venli tahmin yattÄ±.\n   Ä°statistikleri tekrar gÃ¶zden geÃ§ir."
            else:
                return "ğŸ’¡ DÃ¼ÅŸÃ¼k gÃ¼venli tahmin zaten riskliydi.\n   DÃ¼ÅŸÃ¼k gÃ¼venli maÃ§lardan kaÃ§Ä±n."
        else:
            return "âœ… Tahmin tuttu! Stratejine devam et."
    
    def _arsiv_telegram(self):
        """SeÃ§ili maÃ§Ä± Telegram'a gÃ¶nder"""
        selection = self.tree_arsiv.selection()
        if not selection:
            messagebox.showwarning("UyarÄ±", "Bir maÃ§ seÃ§in!")
            return
        item = self.tree_arsiv.item(selection[0])
        mac_adi = item["values"][1]
        
        for mac in self.mac_db:
            if mac.get("mac", mac.get("mac_adi", "")).replace("_", " ") == str(mac_adi).replace("_", " "):
                self.current_analysis = mac
                self._telegram_popup()
                return
        messagebox.showwarning("UyarÄ±", "MaÃ§ bulunamadÄ±!")
    
    def _arsiv_tumunu_sil(self):
        """TÃ¼m arÅŸivi sil"""
        if not self.mac_db:
            messagebox.showinfo("Bilgi", "ArÅŸiv zaten boÅŸ!")
            return
        
        onay = messagebox.askyesno("âš ï¸ DÄ°KKAT", 
                                   f"TÃ¼m arÅŸiv silinecek!\n({len(self.mac_db)} maÃ§)\n\nEmin misiniz?")
        if onay:
            self.son_silinen = self.mac_db.copy()
            self.mac_db = []
            self._save_json(DB_FILE, self.mac_db)
            self.arsiv_yenile()
            messagebox.showinfo("âœ…", "ArÅŸiv temizlendi!\nGeri almak iÃ§in â†©ï¸ GERÄ° AL butonunu kullanÄ±n.")
    
    def _arsiv_geri_al(self):
        """Son silinen verileri geri al"""
        if not hasattr(self, 'son_silinen') or not self.son_silinen:
            messagebox.showinfo("Bilgi", "Geri alÄ±nacak veri yok!")
            return
        
        self.mac_db = self.son_silinen
        self.son_silinen = None
        self._save_json(DB_FILE, self.mac_db)
        self.arsiv_yenile()
        messagebox.showinfo("âœ…", "Veriler geri alÄ±ndÄ±!")
    
    def _arsiv_excel_cikar(self):
        """ArÅŸivi Excel'e Ã§Ä±kar"""
        if not EXCEL_AVAILABLE:
            messagebox.showerror("Hata", "openpyxl modÃ¼lÃ¼ yÃ¼klÃ¼ deÄŸil!")
            return
        if not self.mac_db:
            messagebox.showinfo("Bilgi", "ArÅŸiv boÅŸ!")
            return
        
        dosya = filedialog.asksaveasfilename(
            defaultextension=".xlsx", filetypes=[("Excel", "*.xlsx")],
            initialfilename=f"arsiv_{datetime.now().strftime('%Y%m%d_%H%M%S')}.xlsx")
        
        if not dosya:
            return
        
        try:
            wb = Workbook()
            ws = wb.active
            ws.title = "ArÅŸiv"
            headers = ["Tarih", "MaÃ§", "Lig", "Banko", "Sigorta", "GÃ¼ven", "Kasa", "Skor", "SonuÃ§"]
            for col, h in enumerate(headers, 1):
                ws.cell(row=1, column=col, value=h)
            
            for row, mac in enumerate(self.mac_db, 2):
                ws.cell(row=row, column=1, value=mac.get("tarih", ""))
                ws.cell(row=row, column=2, value=mac.get("mac", mac.get("mac_adi", "")))
                ws.cell(row=row, column=3, value=mac.get("lig", ""))
                ws.cell(row=row, column=4, value=mac.get("banko", ""))
                ws.cell(row=row, column=5, value=mac.get("sigorta", ""))
                ws.cell(row=row, column=6, value=mac.get("guven", ""))
                ws.cell(row=row, column=7, value=mac.get("kasa", ""))
                ws.cell(row=row, column=8, value=mac.get("skor", mac.get("gercek_skor", "")))
                ws.cell(row=row, column=9, value=mac.get("sonuc", ""))
            
            wb.save(dosya)
            messagebox.showinfo("âœ…", f"ArÅŸiv Excel'e aktarÄ±ldÄ±:\n{dosya}")
        except Exception as e:
            messagebox.showerror("Hata", f"Excel hatasÄ±: {e}")
    
    def _arsiv_yedekle(self):
        """ArÅŸivi JSON olarak yedekle"""
        if not self.mac_db:
            messagebox.showinfo("Bilgi", "ArÅŸiv boÅŸ!")
            return
        
        dosya = filedialog.asksaveasfilename(
            defaultextension=".json", filetypes=[("JSON", "*.json")],
            initialfilename=f"arsiv_yedek_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json")
        
        if not dosya:
            return
        
        try:
            with open(dosya, "w", encoding="utf-8") as f:
                json.dump(self.mac_db, f, ensure_ascii=False, indent=2)
            messagebox.showinfo("âœ…", f"ArÅŸiv yedeklendi:\n{dosya}")
        except Exception as e:
            messagebox.showerror("Hata", f"Yedekleme hatasÄ±: {e}")
    
    def _create_skor(self):
        """Skor sayfasÄ± - TAM VERSÄ°YON"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ† SKOR KONTROL (OTOMATÄ°K EÅLEÅTÄ°RME)", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(pady=10)
        
        # Ãœst kontroller - Tarih ve GÃ¶rsel
        frm = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        frm.pack(fill="x", padx=20, pady=5)
        
        tk.Label(frm, text="Tarih:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.entry_skor_tarih = tk.Entry(frm, width=12, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_skor_tarih.insert(0, datetime.now().strftime("%d.%m.%Y"))
        self.entry_skor_tarih.pack(side="left", padx=5)
        
        tk.Button(frm, text="ğŸ“‚ GÃœNÃœN MAÃ‡LARI", command=self.skor_yukle,
                bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=5)
        
        tk.Button(frm, text="ğŸ“· GÃ–RSEL SKOR YÃœKLE", command=self.skor_gorsel_yukle,
                bg="#ff6600", fg="white", font=("Arial", 10, "bold"), relief="flat").pack(side="left", padx=10)
        tk.Button(frm, text="ğŸ“‹ PANODAN SKOR", command=self.skor_panodan,
                bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=5)
        
        # Manuel giriÅŸ
        frm2 = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        frm2.pack(fill="x", padx=20, pady=5)
        
        tk.Label(frm2, text="MaÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.combo_skor_mac = ttk.Combobox(frm2, width=40, state="readonly")
        self.combo_skor_mac.pack(side="left", padx=5)
        self._skor_combo_guncelle()
        
        tk.Label(frm2, text="SonuÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.combo_sonuc = ttk.Combobox(frm2, values=["KAZANDI", "KAYBETTÄ°"], width=12)
        self.combo_sonuc.pack(side="left", padx=5)
        
        tk.Label(frm2, text="Skor:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.entry_gercek_skor = tk.Entry(frm2, width=8, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_gercek_skor.pack(side="left", padx=5)
        
        tk.Button(frm2, text="âœ… KAYDET", command=self.skor_kaydet,
                bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=10)
        
        # Toplu iÅŸlemler
        frm3 = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        frm3.pack(fill="x", padx=20, pady=5)
        
        tk.Button(frm3, text="âœ… HEPSÄ°NÄ° KAZANDI", command=lambda: self.toplu_sonuc("KAZANDI"),
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(frm3, text="âŒ HEPSÄ°NÄ° KAYBETTÄ°", command=lambda: self.toplu_sonuc("KAYBETTÄ°"),
                  bg=ModernTheme.ACCENT_DANGER, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(frm3, text="ğŸ’¾ OTOMATÄ°K EÅLEÅTÄ°R & KAYDET", command=self.skor_otomatik_kaydet,
                  bg=ModernTheme.ACCENT_PURPLE, fg="white", font=("Arial", 10, "bold"), relief="flat").pack(side="left", padx=10)
        
        # SonuÃ§ alanÄ±
        self.txt_skor = scrolledtext.ScrolledText(page, height=18, bg="#0a0a0a",
                                                fg=ModernTheme.ACCENT_PRIMARY, font=("Consolas", 10))
        self.txt_skor.pack(fill="both", expand=True, padx=20, pady=10)
        
        return page
    
    def _skor_combo_guncelle(self):
        """Skor combo'yu gÃ¼ncelle"""
        bekleyenler = [f"{m.get('tarih', '')} - {m.get('mac', m.get('mac_adi', ''))}" 
                      for m in self.mac_db if not m.get("skor") and not m.get("gercek_skor")]
        if hasattr(self, 'combo_skor_mac'):
            self.combo_skor_mac["values"] = bekleyenler
    
    def _create_kupon(self):
        """Kupon sayfasÄ± - TAM VERSÄ°YON"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ° KUPON OLUÅTURUCU", font=("Segoe UI", 16, "bold"), 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        # Tarih seÃ§imi
        frm_tarih = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=5)
        frm_tarih.pack(fill="x", padx=20)
        
        tk.Label(frm_tarih, text="Tarih:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY).pack(side="left", padx=5)
        self.entry_kupon_tarih = tk.Entry(frm_tarih, width=12, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_kupon_tarih.insert(0, datetime.now().strftime("%d.%m.%Y"))
        self.entry_kupon_tarih.pack(side="left", padx=5)
        
        # Kupon butonlarÄ±
        frm = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        frm.pack(fill="x", padx=20, pady=10)
        
        tk.Button(frm, text="ğŸ’° KASA", command=lambda: self.kupon_olustur("KASA"), 
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", width=12, font=("Arial", 10), relief="flat").pack(side="left", padx=5)
        tk.Button(frm, text="ğŸ”¥ KARMA", command=lambda: self.kupon_olustur("KARMA"), 
                  bg="#ff8800", fg="black", width=12, font=("Arial", 10), relief="flat").pack(side="left", padx=5)
        tk.Button(frm, text="âš ï¸ RÄ°SKLÄ°", command=lambda: self.kupon_olustur("RISK"), 
                  bg=ModernTheme.ACCENT_DANGER, fg="white", width=12, font=("Arial", 10), relief="flat").pack(side="left", padx=5)
        tk.Button(frm, text="ğŸ† TOP 3", command=self.gunun_en_iyi_3, 
                  bg=ModernTheme.ACCENT_PURPLE, fg="white", width=12, font=("Arial", 10), relief="flat").pack(side="left", padx=5)
        
        # SonuÃ§ alanÄ±
        self.txt_kupon = scrolledtext.ScrolledText(page, font=("Consolas", 11), bg="#0a0a0a", fg=ModernTheme.ACCENT_SUCCESS)
        self.txt_kupon.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Alt butonlar
        btm = tk.Frame(page, bg=ModernTheme.BG_PRIMARY)
        btm.pack(fill="x", padx=20, pady=5)
        
        tk.Button(btm, text="ğŸ“¸ GÃ–RSEL KAYDET", command=self.kupon_gorsel_kaydet, 
                  bg="#2b5797", fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(btm, text="ğŸ“¤ TELEGRAM", command=self.kupon_telegram, 
                  bg="#0088cc", fg="white", relief="flat").pack(side="left", padx=5)
        
        return page
    
    def _create_listeler(self):
        """Listeler sayfasÄ± - TAM VERSÄ°YON"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ“‹ Ã–ZEL LÄ°STELER", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        # Ãœst kontroller
        top = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        top.pack(fill="x", padx=10)
        
        tk.Label(top, text="Tarih:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY).pack(side="left", padx=5)
        self.entry_liste_tarih = tk.Entry(top, width=12, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_liste_tarih.insert(0, datetime.now().strftime("%d.%m.%Y"))
        self.entry_liste_tarih.pack(side="left", padx=5)
        
        tk.Button(top, text="ğŸ”„ GÃœNCELLE", command=self.listeleri_guncelle,
                  bg="#ff6600", fg="white", font=("Arial", 10, "bold"), relief="flat").pack(side="left", padx=10)
        tk.Button(top, text="ğŸ“¤ TELEGRAM'A GÃ–NDER", command=self.listeleri_telegrama_gonder,
                  bg="#0088cc", fg="white", font=("Arial", 10, "bold"), relief="flat").pack(side="left", padx=10)
        
        # Liste container
        lists_frame = tk.Frame(page, bg=ModernTheme.BG_CARD)
        lists_frame.pack(fill="both", expand=True, padx=10, pady=10)
        
        # Checkbox deÄŸiÅŸkenleri
        self.chk_35_var = tk.BooleanVar(value=True)
        self.chk_25_var = tk.BooleanVar(value=True)
        self.chk_kg_var = tk.BooleanVar(value=True)
        self.chk_fav_var = tk.BooleanVar(value=True)
        self.chk_iy_var = tk.BooleanVar(value=True)
        self.chk_deger_var = tk.BooleanVar(value=True)
        
        # Ãœst sÄ±ra - 3.5 ÃœST, 2.5 ÃœST, KG VAR
        row1 = tk.Frame(lists_frame, bg=ModernTheme.BG_CARD)
        row1.pack(fill="both", expand=True, pady=5)
        
        # ğŸ”¥ 3.5 ÃœST
        f1 = tk.LabelFrame(row1, text="ğŸ”¥ 3.5 ÃœST", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_DANGER)
        f1.pack(side="left", fill="both", expand=True, padx=5)
        tk.Checkbutton(f1, text="Telegram'a GÃ¶nder", variable=self.chk_35_var,
                       bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY, selectcolor=ModernTheme.BG_PRIMARY).pack(anchor="w")
        self.lst_35 = tk.Listbox(f1, height=8, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.lst_35.pack(fill="both", expand=True)
        
        # âš½ 2.5 ÃœST
        f2 = tk.LabelFrame(row1, text="âš½ 2.5 ÃœST", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_WARNING)
        f2.pack(side="left", fill="both", expand=True, padx=5)
        tk.Checkbutton(f2, text="Telegram'a GÃ¶nder", variable=self.chk_25_var,
                       bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY, selectcolor=ModernTheme.BG_PRIMARY).pack(anchor="w")
        self.lst_25 = tk.Listbox(f2, height=8, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.lst_25.pack(fill="both", expand=True)
        
        # ğŸ¤ KG VAR
        f3 = tk.LabelFrame(row1, text="ğŸ¤ KG VAR", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_SUCCESS)
        f3.pack(side="left", fill="both", expand=True, padx=5)
        tk.Checkbutton(f3, text="Telegram'a GÃ¶nder", variable=self.chk_kg_var,
                       bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY, selectcolor=ModernTheme.BG_PRIMARY).pack(anchor="w")
        self.lst_kg = tk.Listbox(f3, height=8, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.lst_kg.pack(fill="both", expand=True)
        
        # Alt sÄ±ra - FAVORÄ°, Ä°Y GOL, DEÄER
        row2 = tk.Frame(lists_frame, bg=ModernTheme.BG_CARD)
        row2.pack(fill="both", expand=True, pady=5)
        
        # ğŸ‘‘ FAVORÄ°
        f4 = tk.LabelFrame(row2, text="ğŸ‘‘ FAVORÄ°", bg=ModernTheme.BG_CARD, fg="#ff00ff")
        f4.pack(side="left", fill="both", expand=True, padx=5)
        tk.Checkbutton(f4, text="Telegram'a GÃ¶nder", variable=self.chk_fav_var,
                       bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY, selectcolor=ModernTheme.BG_PRIMARY).pack(anchor="w")
        self.lst_fav = tk.Listbox(f4, height=8, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.lst_fav.pack(fill="both", expand=True)
        
        # â±ï¸ Ä°Y GOL
        f5 = tk.LabelFrame(row2, text="â±ï¸ Ä°Y GOL", bg=ModernTheme.BG_CARD, fg="#00ffff")
        f5.pack(side="left", fill="both", expand=True, padx=5)
        tk.Checkbutton(f5, text="Telegram'a GÃ¶nder", variable=self.chk_iy_var,
                       bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY, selectcolor=ModernTheme.BG_PRIMARY).pack(anchor="w")
        self.lst_iy = tk.Listbox(f5, height=8, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.lst_iy.pack(fill="both", expand=True)
        
        # ğŸ’ XG 5+
        f6 = tk.LabelFrame(row2, text="ğŸ’ XG 5+", bg=ModernTheme.BG_CARD, fg="#ffd700")
        f6.pack(side="left", fill="both", expand=True, padx=5)
        tk.Checkbutton(f6, text="Telegram'a GÃ¶nder", variable=self.chk_deger_var,
                       bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY, selectcolor=ModernTheme.BG_PRIMARY).pack(anchor="w")
        self.lst_deger = tk.Listbox(f6, height=8, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.lst_deger.pack(fill="both", expand=True)
        
        return page
    
    def _create_degerli(self):
        """ğŸ’ DEÄERLÄ° BAHÄ°S ANALÄ°ZÄ° - KAPSAMLI VERSÄ°YON"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ’ DEÄERLÄ° BAHÄ°S ANALÄ°ZÄ°", font=("Segoe UI", 16, "bold"), 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(pady=10)
        
        # Ãœst kontrol paneli
        top_frame = tk.Frame(page, bg=ModernTheme.BG_CARD)
        top_frame.pack(fill="x", padx=10, pady=5)
        
        # Tarama butonlarÄ±
        tk.Button(top_frame, text="ğŸ” OTOMATÄ°K TARA", command=self.deger_otomatik_tara,
                  bg=ModernTheme.ACCENT_WARNING, fg="black", font=("Arial", 11, "bold"),
                  relief="flat", width=18).pack(side="left", padx=10, pady=10)
        
        tk.Button(top_frame, text="ğŸ’ DEÄER BAHÄ°S BUL", command=self.deger_bahis_bul,
                  bg="#ffd700", fg="black", font=("Arial", 11, "bold"),
                  relief="flat", width=18).pack(side="left", padx=5, pady=10)
        
        tk.Button(top_frame, text="ğŸš€ YÃœKSEK POTANSÄ°YEL", command=self.deger_yuksek_potansiyel,
                  bg=ModernTheme.ACCENT_DANGER, fg="white", font=("Arial", 11, "bold"),
                  relief="flat", width=18).pack(side="left", padx=5, pady=10)
        
        tk.Button(top_frame, text="ğŸŒ GÄ°ZLÄ° HAZÄ°NE", command=self.deger_gizli_hazine,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", font=("Arial", 11, "bold"),
                  relief="flat", width=18).pack(side="left", padx=5, pady=10)
        
        # Filtre paneli
        filter_frame = tk.LabelFrame(page, text="âš™ï¸ FÄ°LTRELER", bg=ModernTheme.BG_CARD, 
                                     fg=ModernTheme.ACCENT_PRIMARY)
        filter_frame.pack(fill="x", padx=10, pady=5)
        
        filter_row = tk.Frame(filter_frame, bg=ModernTheme.BG_CARD)
        filter_row.pack(fill="x", padx=10, pady=5)
        
        tk.Label(filter_row, text="Min xG:", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.spin_min_xg = tk.Spinbox(filter_row, from_=2.0, to=6.0, increment=0.5, width=5)
        self.spin_min_xg.delete(0, tk.END)
        self.spin_min_xg.insert(0, "3.0")
        self.spin_min_xg.pack(side="left", padx=5)
        
        tk.Label(filter_row, text="Min Oran:", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=15)
        self.spin_min_oran = tk.Spinbox(filter_row, from_=1.40, to=3.00, increment=0.10, width=5)
        self.spin_min_oran.delete(0, tk.END)
        self.spin_min_oran.insert(0, "1.60")
        self.spin_min_oran.pack(side="left", padx=5)
        
        tk.Label(filter_row, text="Min Ä°statistik %:", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=15)
        self.spin_min_istat = tk.Spinbox(filter_row, from_=60, to=95, increment=5, width=5)
        self.spin_min_istat.delete(0, tk.END)
        self.spin_min_istat.insert(0, "75")
        self.spin_min_istat.pack(side="left", padx=5)
        
        # SonuÃ§ alanÄ±
        self.txt_deger = scrolledtext.ScrolledText(page, font=("Consolas", 11), 
                                                    bg="#0a0a0a", fg="#ffd700")
        self.txt_deger.pack(fill="both", expand=True, padx=10, pady=10)
        
        # Alt butonlar
        bottom_frame = tk.Frame(page, bg=ModernTheme.BG_PRIMARY)
        bottom_frame.pack(fill="x", padx=10, pady=5)
        
        tk.Button(bottom_frame, text="ğŸ“‹ KOPYALA", command=lambda: self._kopyala_text(self.txt_deger),
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=5)
        
        tk.Button(bottom_frame, text="ğŸ“± TELEGRAM", command=self.deger_telegram_gonder,
                  bg="#0088cc", fg="white", relief="flat").pack(side="left", padx=5)
        
        return page
    
    def _create_karsilastir(self):
        """KarÅŸÄ±laÅŸtÄ±r sayfasÄ±"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ“Š MAÃ‡ KARÅILAÅTIR", font=("Segoe UI", 16, "bold"), bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        frm = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        frm.pack(fill="x")
        
        mac_listesi = [f"{m.get('tarih', '')} - {m.get('mac', m.get('mac_adi', ''))}" for m in self.mac_db[-20:]]
        
        tk.Label(frm, text="MaÃ§ 1:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.combo_kars1 = ttk.Combobox(frm, values=mac_listesi, width=35)
        self.combo_kars1.pack(side="left", padx=5)
        
        tk.Label(frm, text="MaÃ§ 2:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.combo_kars2 = ttk.Combobox(frm, values=mac_listesi, width=35)
        self.combo_kars2.pack(side="left", padx=5)
        
        tk.Button(frm, text="âš–ï¸ KARÅILAÅTIR", command=self.maclari_karsilastir, bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=20)
        
        self.txt_karsilastir = scrolledtext.ScrolledText(page, font=("Consolas", 11), bg="#0a0a0a", fg="#00ff00")
        self.txt_karsilastir.pack(fill="both", expand=True, pady=10)
        
        return page
    
    def _create_telegram(self):
        """Telegram sayfasÄ± - TAM VERSÄ°YON"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ¤– TELEGRAM KANAL YÃ–NETÄ°CÄ°SÄ°", font=("Segoe UI", 16, "bold"), 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # Bot AyarlarÄ±
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_ayar = tk.LabelFrame(page, text="âš™ï¸ Bot AyarlarÄ±", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_ayar.pack(fill="x", padx=20, pady=5)
        
        frm = tk.Frame(frm_ayar, bg=ModernTheme.BG_CARD)
        frm.pack(pady=5)
        
        tk.Label(frm, text="Bot Token:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=0, column=0, sticky="e", padx=5)
        self.entry_tg_token = tk.Entry(frm, width=50, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_tg_token.insert(0, TELEGRAM_BOT_TOKEN)
        self.entry_tg_token.grid(row=0, column=1, padx=5, pady=2)
        
        tk.Label(frm, text="VarsayÄ±lan Chat ID:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=1, column=0, sticky="e", padx=5)
        self.entry_tg_chat = tk.Entry(frm, width=50, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_tg_chat.insert(0, TELEGRAM_CHAT_ID)
        self.entry_tg_chat.grid(row=1, column=1, padx=5, pady=2)
        
        frm_btn = tk.Frame(frm_ayar, bg=ModernTheme.BG_CARD)
        frm_btn.pack(pady=5)
        tk.Button(frm_btn, text="ğŸ’¾ KAYDET", command=self.telegram_kaydet, 
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ§ª TEST", command=self.telegram_test, 
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=5)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # Kanal/Grup YÃ¶netimi
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_kanal = tk.LabelFrame(page, text="ğŸ“¢ Kanal/Grup YÃ¶netimi", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_kanal.pack(fill="x", padx=20, pady=5)
        
        frm_yeni = tk.Frame(frm_kanal, bg=ModernTheme.BG_CARD)
        frm_yeni.pack(fill="x", pady=5, padx=5)
        
        tk.Label(frm_yeni, text="Kanal AdÄ±:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        self.entry_kanal_ad = tk.Entry(frm_yeni, width=20, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_kanal_ad.pack(side="left", padx=3)
        
        tk.Label(frm_yeni, text="Chat ID:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        self.entry_kanal_id = tk.Entry(frm_yeni, width=20, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_kanal_id.pack(side="left", padx=3)
        
        tk.Button(frm_yeni, text="â• EKLE", command=self.kanal_ekle, 
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(frm_yeni, text="ğŸ—‘ï¸ SÄ°L", command=self.kanal_sil, 
                  bg=ModernTheme.ACCENT_DANGER, fg="white", relief="flat").pack(side="left", padx=2)
        tk.Button(frm_yeni, text="ğŸ§¹ TÃœMÃœNÃœ SÄ°L", command=self.kanal_tumunu_sil, 
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=2)
        
        # Kanal listesi
        self.listbox_kanallar = tk.Listbox(frm_kanal, height=4, bg=ModernTheme.BG_PRIMARY, 
                                           fg=ModernTheme.TEXT_PRIMARY, selectmode=tk.MULTIPLE)
        self.listbox_kanallar.pack(fill="x", padx=5, pady=5)
        self.kanal_listele()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # Mesaj GÃ¶nderimi
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_format = tk.LabelFrame(page, text="ğŸ“¤ MESAJ GÃ–NDERÄ°MÄ°", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_format.pack(fill="x", padx=20, pady=5)
        
        frm_mac = tk.Frame(frm_format, bg=ModernTheme.BG_CARD)
        frm_mac.pack(fill="x", pady=5, padx=5)
        
        # FIX #25: Tarihe gÃ¶re maÃ§ seÃ§imi
        tk.Label(frm_mac, text="Tarih:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        self.tg_tarih = tk.Entry(frm_mac, width=12, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.tg_tarih.insert(0, datetime.now().strftime("%d.%m.%Y"))
        self.tg_tarih.pack(side="left", padx=5)
        
        tk.Label(frm_mac, text="MaÃ§ SeÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=(10,0))
        self.combo_tg_mac = ttk.Combobox(frm_mac, width=35, state="readonly")
        self.combo_tg_mac.pack(side="left", padx=5)
        tk.Button(frm_mac, text="ğŸ”„", command=self.tg_maclari_yukle, 
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left")
        self.tg_maclari_yukle()
        
        # FIX #27: CanlÄ± bildirim gÃ¶nder butonu
        tk.Button(frm_mac, text="ğŸ“¢ CANLI BÄ°LDÄ°RÄ°M", command=self.canli_bildirim_gonder,
                  bg="#ff6600", fg="white", relief="flat").pack(side="right", padx=5)
        
        # Format butonlarÄ±
        frm_butonlar = tk.Frame(frm_format, bg=ModernTheme.BG_CARD)
        frm_butonlar.pack(pady=10)
        
        tk.Button(frm_butonlar, text="ğŸ¯ TAHMÄ°N\n(KÄ±sa)", command=lambda: self.tg_format_gonder("kisa"),
                  bg="#17a2b8", fg="white", width=14, height=2, relief="flat").pack(side="left", padx=3)
        tk.Button(frm_butonlar, text="ğŸ“Š DETAYLI\n(Ä°statistikli)", command=lambda: self.tg_format_gonder("detayli"),
                  bg=ModernTheme.ACCENT_PURPLE, fg="white", width=14, height=2, relief="flat").pack(side="left", padx=3)
        tk.Button(frm_butonlar, text="â° CANLI\n(HatÄ±rlatma)", command=lambda: self.tg_format_gonder("canli"),
                  bg="#fd7e14", fg="white", width=14, height=2, relief="flat").pack(side="left", padx=3)
        tk.Button(frm_butonlar, text="âœ… SONUÃ‡\n(MaÃ§ bitti)", command=lambda: self.tg_format_gonder("sonuc"),
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", width=14, height=2, relief="flat").pack(side="left", padx=3)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # Ã–nizleme
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        tk.Label(page, text="ğŸ“ Ã–nizleme:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack(anchor="w", padx=20)
        self.txt_tg_preview = scrolledtext.ScrolledText(page, height=8, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 10))
        self.txt_tg_preview.pack(fill="both", expand=True, padx=20, pady=5)
        
        return page
    
    def _create_oranlar(self):
        """ğŸ“Š ORANLAR & VERÄ°TABANI - YENÄ° SÄ°STEM"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ“Š ORAN TAKÄ°P & VERÄ°TABANI", font=("Segoe UI", 16, "bold"), 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        # Ãœst kontrol paneli
        top = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        top.pack(fill="x", padx=10)
        
        tk.Button(top, text="ğŸ“· GÃ–RSEL YÃœKLE", command=self.oran_gorsel_yukle, 
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(top, text="ğŸ“‹ PANODAN", command=self.oran_panodan, 
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=5)
        tk.Button(top, text="ğŸ’¾ KAYDET", command=self.oran_kaydet, 
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=5)
        
        # SaÄŸ taraf butonlarÄ±
        tk.Button(top, text="ğŸ“Š PERFORMANS", command=self.oran_performans_raporu, 
                  bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(side="right", padx=5)
        tk.Button(top, text="ğŸ” BACKTEST", command=self.oran_backtest_popup, 
                  bg="#9b59b6", fg="white", relief="flat").pack(side="right", padx=5)
        
        # Analiz maÃ§larÄ± Ã§ekme
        frm_analiz = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=8)
        frm_analiz.pack(fill="x", padx=10, pady=5)
        
        tk.Label(frm_analiz, text="ğŸ“‹ Analiz MaÃ§larÄ±:", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.combo_oran_mac = ttk.Combobox(frm_analiz, width=45)
        self.combo_oran_mac.pack(side="left", padx=5)
        
        tk.Button(frm_analiz, text="ğŸ“¥ ORANLARI Ã‡EK", command=self.oran_analizden_cek,
                  bg="#ff6600", fg="white", font=("Arial", 10, "bold"), relief="flat").pack(side="left", padx=10)
        tk.Button(frm_analiz, text="ğŸ“¥ TÃœM MAÃ‡LARI Ã‡EK", command=self.oran_tum_maclari_cek,
                  bg="#e74c3c", fg="white", relief="flat").pack(side="left", padx=5)
        
        self._oran_maclari_yukle()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ANA TABLO - TÃ¼m marketler yan yana + BANKO + SONUÃ‡
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        cols = ("mac", "lig", "skor", "ms1", "msx", "ms2", "u05", "u15", "u25", "kg", "banko", "sonuc")
        self.tree_oran = ttk.Treeview(page, columns=cols, show="headings", height=18)
        
        # SÃ¼tun baÅŸlÄ±klarÄ± ve geniÅŸlikleri
        headers = [
            ("mac", "MAÃ‡", 150),
            ("lig", "LÄ°G", 85),
            ("skor", "SKOR", 55),
            ("ms1", "MS 1", 50),
            ("msx", "MS X", 50),
            ("ms2", "MS 2", 50),
            ("u05", "0.5 Ãœ", 50),
            ("u15", "1.5 Ãœ", 50),
            ("u25", "2.5 Ãœ", 50),
            ("kg", "KG V", 50),
            ("banko", "BANKO", 90),
            ("sonuc", "SONUÃ‡", 70)
        ]
        
        for col, header, width in headers:
            self.tree_oran.heading(col, text=header)
            self.tree_oran.column(col, width=width, anchor="center")
        
        # Renk tag'leri
        self.tree_oran.tag_configure("kazandi", background="#1a472a", foreground="#00ff00")
        self.tree_oran.tag_configure("kaybetti", background="#4a1a1a", foreground="#ff6666")
        self.tree_oran.tag_configure("bekliyor", background="#1a1a2e", foreground="#aaaaaa")
        self.tree_oran.tag_configure("banko_kazandi", background="#0d5c0d", foreground="#00ff00")
        self.tree_oran.tag_configure("banko_kaybetti", background="#5c0d0d", foreground="#ff4444")
        
        # Scrollbar
        scrollbar = ttk.Scrollbar(page, orient="vertical", command=self.tree_oran.yview)
        self.tree_oran.configure(yscrollcommand=scrollbar.set)
        
        self.tree_oran.pack(side="left", fill="both", expand=True, pady=10, padx=(10,0))
        scrollbar.pack(side="right", fill="y", pady=10, padx=(0,10))
        
        # Ã‡ift tÄ±k ile skor giriÅŸi
        self.tree_oran.bind("<Double-1>", self._oran_skor_gir)
        
        # SaÄŸ tÄ±k menÃ¼sÃ¼
        self.tree_oran.bind("<Button-3>", self._oran_sag_tik_menu)
        
        # SaÄŸ tÄ±k menÃ¼sÃ¼ oluÅŸtur
        self.oran_menu = tk.Menu(self.tree_oran, tearoff=0)
        self.oran_menu.add_command(label="âœ… KAZANDI", command=lambda: self._oran_sonuc_gir("KAZANDI"))
        self.oran_menu.add_command(label="âŒ KAYBETTÄ°", command=lambda: self._oran_sonuc_gir("KAYBETTÄ°"))
        self.oran_menu.add_separator()
        self.oran_menu.add_command(label="ğŸ“± Telegram'a GÃ¶nder", command=self._oran_telegrama_gonder)
        self.oran_menu.add_command(label="ğŸ“‹ Detay GÃ¶ster", command=self._oran_detay_goster)
        self.oran_menu.add_separator()
        self.oran_menu.add_command(label="ğŸ—‘ï¸ Sil", command=self.oran_secili_sil)
        
        # Alt bilgi paneli
        bottom = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=8)
        bottom.pack(fill="x", padx=10, pady=5)
        
        self.lbl_oran_ozet = tk.Label(bottom, text="ğŸ“Š Toplam: 0 maÃ§ | âœ… Kazanan: 0 | âŒ Kaybeden: 0 | â³ Bekleyen: 0", 
                                       bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY, font=("Arial", 10))
        self.lbl_oran_ozet.pack(side="left", padx=10)
        
        tk.Button(bottom, text="ğŸ—‘ï¸ SEÃ‡Ä°LÄ° SÄ°L", command=self.oran_secili_sil,
                  bg=ModernTheme.ACCENT_DANGER, fg="white", relief="flat").pack(side="right", padx=5)
        tk.Button(bottom, text="ğŸ“¤ EXCEL'E AKTAR", command=self.oran_excel_aktar,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="right", padx=5)
        
        return page
    
    def _oran_maclari_yukle(self):
        """Analiz edilmiÅŸ maÃ§larÄ± yÃ¼kle"""
        maclar = [f"{m.get('tarih', '')} - {m.get('mac', m.get('mac_adi', ''))}" for m in self.mac_db[-30:]]
        if hasattr(self, 'combo_oran_mac'):
            self.combo_oran_mac["values"] = maclar
            if maclar:
                self.combo_oran_mac.set(maclar[0])
    
    def oran_analizden_cek(self):
        """ğŸ“¥ SeÃ§ili analizden oranlarÄ± tabloya Ã§ek - TEK SATIR FORMAT"""
        secim = self.combo_oran_mac.get() if hasattr(self, 'combo_oran_mac') else ""
        if not secim:
            messagebox.showwarning("UyarÄ±", "Ã–nce bir maÃ§ seÃ§in!")
            return
        
        mac_data = None
        for m in self.mac_db:
            mac_str = f"{m.get('tarih', '')} - {m.get('mac', m.get('mac_adi', ''))}"
            if secim in mac_str or mac_str in secim:
                mac_data = m
                break
        
        if not mac_data:
            messagebox.showwarning("UyarÄ±", "MaÃ§ bulunamadÄ±!")
            return
        
        self._oran_mac_ekle(mac_data)
        self._oran_ozet_guncelle()
        messagebox.showinfo("âœ…", f"MaÃ§ eklendi!")
    
    def oran_tum_maclari_cek(self):
        """ğŸ“¥ TÃ¼m analiz edilmiÅŸ maÃ§larÄ± tabloya Ã§ek"""
        if not self.mac_db:
            messagebox.showwarning("UyarÄ±", "Analiz edilmiÅŸ maÃ§ yok!")
            return
        
        # Mevcut tabloyu temizle
        for item in self.tree_oran.get_children():
            self.tree_oran.delete(item)
        
        # TÃ¼m maÃ§larÄ± ekle
        for mac_data in self.mac_db:
            self._oran_mac_ekle(mac_data)
        
        self._oran_ozet_guncelle()
        messagebox.showinfo("âœ…", f"{len(self.mac_db)} maÃ§ eklendi!")
    
    def _oran_mac_ekle(self, mac_data):
        """Tek maÃ§Ä± tabloya ekle - TEK SATIR FORMAT - V70 GENÄ°ÅLETÄ°LMÄ°Å
        
        OranlarÄ± birden fazla kaynaktan almayÄ± dener:
        1. Ana analiz sonucu (oran_ms1, oran_x vb.)
        2. OCR verisi (ocr_data iÃ§inde)
        3. VarsayÄ±lan deÄŸerler
        """
        mac_adi = mac_data.get("mac", mac_data.get("mac_adi", "?")).replace("_", " ")[:25]
        lig = mac_data.get("lig", "?")[:15]
        
        # OCR verisini de kontrol et
        ocr_data = mac_data.get("ocr_data", mac_data.get("ocr", {})) or {}
        
        def get_oran(keys, default="-"):
            """Birden fazla key'den oran almayÄ± dene"""
            if isinstance(keys, str):
                keys = [keys]
            
            # Ã–nce ana mac_data'dan dene
            for key in keys:
                val = mac_data.get(key)
                if val and val != "?" and val != "" and val != "-":
                    try:
                        return f"{float(str(val).replace(',', '.')):.2f}"
                    except:
                        pass
            
            # Sonra OCR verisinden dene
            for key in keys:
                val = ocr_data.get(key)
                if val and val != "?" and val != "" and val != "-":
                    try:
                        return f"{float(str(val).replace(',', '.')):.2f}"
                    except:
                        pass
            
            return default
        
        # OranlarÄ± Ã§oklu key'lerden al
        ms1 = get_oran(["oran_ms1", "oran_1", "ms1", "ms_1", "home_odds"], "-")
        msx = get_oran(["oran_x", "oran_0", "x", "draw_odds"], "-")
        ms2 = get_oran(["oran_ms2", "oran_2", "ms2", "ms_2", "away_odds"], "-")
        u05 = get_oran(["oran_05u", "oran_05_ust", "o05", "over_05"], "-")
        u15 = get_oran(["oran_15u", "oran_15_ust", "o15", "over_15"], "-")
        u25 = get_oran(["oran_25u", "oran_25_ust", "o25", "over_25", "ust_25_oran"], "-")
        kg = get_oran(["oran_kg", "oran_kg_var", "btts", "btts_yes", "kg_oran"], "-")
        
        # Tahmin belirle - ARTIK BANKO GÃ–STERÄ°LECEK
        banko = mac_data.get("banko", mac_data.get("nihai_banko", "-"))
        if banko:
            banko = str(banko).replace("**", "").replace("*", "").strip()[:15]
        if not banko or banko == "?" or banko == "None":
            banko = "-"
        
        guven = str(mac_data.get("guven", "0")).replace("/10", "")
        try:
            guven_int = int(guven)
        except:
            guven_int = 0
        
        # Skor (henÃ¼z girilmemiÅŸ)
        skor = mac_data.get("gercek_skor", mac_data.get("skor", "-"))
        
        # SonuÃ§ (henÃ¼z belirlenmemiÅŸ)
        sonuc = mac_data.get("sonuc", "-")
        
        # Tag belirleme
        if sonuc in ["KAZANDI", "âœ…", "WIN"]:
            tag = "kazandi"
        elif sonuc in ["KAYBETTÄ°", "âŒ", "LOSS"]:
            tag = "kaybetti"
        else:
            tag = "bekliyor"
        
        # Tabloya ekle
        item_id = self.tree_oran.insert("", "end", values=(
            mac_adi, lig, skor, ms1, msx, ms2, u05, u15, u25, kg, banko, sonuc
        ), tags=(tag,))
        
        # MaÃ§ verisini item'a baÄŸla (sonuÃ§ kontrolÃ¼ iÃ§in)
        self.tree_oran.set(item_id, "mac", mac_adi)
    
    def _oran_tahmin_belirle(self, mac_data, guven_int):
        """Tahmin kategorisini belirle"""
        banko = str(mac_data.get("banko", "")).upper()
        
        def safe_float(val, default=0):
            if val is None or val == "" or val == "?":
                return default
            try:
                return float(str(val).replace("%", "").replace(",", ".").strip())
            except:
                return default
        
        ev_atan = safe_float(mac_data.get("ev_atan", mac_data.get("ev_atan_05", 0)))
        dep_atan = safe_float(mac_data.get("dep_atan", mac_data.get("dep_atan_05", 0)))
        
        # AÄIR FAVORÄ°: GÃ¼ven 9+ veya bir taraf %90+ gol atÄ±yor
        if guven_int >= 9 or ev_atan >= 90 or dep_atan >= 90:
            if "MS1" in banko or "MS 1" in banko:
                return "A.FAVORÄ° ğŸ "
            elif "MS2" in banko or "MS 2" in banko:
                return "A.FAVORÄ° âœˆï¸"
            elif "KAZANIR" in banko:
                return "A.FAVORÄ°"
        
        # HAFÄ°F FAVORÄ°: GÃ¼ven 7-8 veya bir taraf %75-89 gol atÄ±yor
        if guven_int >= 7 or (75 <= ev_atan < 90) or (75 <= dep_atan < 90):
            if "MS1" in banko or "MS 1" in banko:
                return "H.FAVORÄ° ğŸ "
            elif "MS2" in banko or "MS 2" in banko:
                return "H.FAVORÄ° âœˆï¸"
        
        # BANKO: GÃ¼ven 8+ ve spesifik tahmin
        if guven_int >= 8:
            if "2.5" in banko and "ÃœST" in banko:
                return "BANKO 2.5Ãœ"
            elif "KG VAR" in banko:
                return "BANKO KG"
            elif "Ä°Y" in banko:
                return "BANKO Ä°Y"
            else:
                return "BANKO"
        
        # Normal tahminler
        if "2.5" in banko:
            return "2.5 ÃœST"
        elif "KG" in banko:
            return "KG VAR"
        elif "MS" in banko:
            return "MS TAHMÄ°N"
        
        return "-"
    
    def _oran_skor_gir(self, event):
        """Ã‡ift tÄ±k ile skor giriÅŸi ve otomatik renklendirme"""
        selection = self.tree_oran.selection()
        if not selection:
            return
        
        item = selection[0]
        values = list(self.tree_oran.item(item, "values"))
        
        # Skor giriÅŸi popup
        skor = simpledialog.askstring("Skor Gir", "MaÃ§ skorunu girin (Ã¶rn: 2-1):", parent=self.root)
        if not skor or "-" not in skor:
            return
        
        try:
            ev_gol, dep_gol = map(int, skor.split("-"))
            toplam_gol = ev_gol + dep_gol
        except:
            messagebox.showerror("Hata", "GeÃ§ersiz skor formatÄ±! (Ã¶rn: 2-1)")
            return
        
        # Skoru gÃ¼ncelle
        values[2] = skor
        
        # KazananÄ± belirle
        if ev_gol > dep_gol:
            kazanan = "EV"
        elif dep_gol > ev_gol:
            kazanan = "DEP"
        else:
            kazanan = "X"
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # OTOMATÄ°K RENKLENDÄ°RME - YeÅŸil nokta sistemi
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        # MS 1 kontrolÃ¼ (index 3)
        if kazanan == "EV" and values[3] != "-":
            values[3] = f"ğŸŸ¢ {values[3]}"
        elif values[3] != "-":
            values[3] = f"ğŸ”´ {values[3]}"
        
        # MS X kontrolÃ¼ (index 4)
        if kazanan == "X" and values[4] != "-":
            values[4] = f"ğŸŸ¢ {values[4]}"
        elif values[4] != "-":
            values[4] = f"ğŸ”´ {values[4]}"
        
        # MS 2 kontrolÃ¼ (index 5)
        if kazanan == "DEP" and values[5] != "-":
            values[5] = f"ğŸŸ¢ {values[5]}"
        elif values[5] != "-":
            values[5] = f"ğŸ”´ {values[5]}"
        
        # 0.5 Ãœst kontrolÃ¼ (index 6) - 1+ gol
        if toplam_gol >= 1 and values[6] != "-":
            values[6] = f"ğŸŸ¢ {values[6]}"
        elif values[6] != "-":
            values[6] = f"ğŸ”´ {values[6]}"
        
        # 1.5 Ãœst kontrolÃ¼ (index 7) - 2+ gol
        if toplam_gol >= 2 and values[7] != "-":
            values[7] = f"ğŸŸ¢ {values[7]}"
        elif values[7] != "-":
            values[7] = f"ğŸ”´ {values[7]}"
        
        # 2.5 Ãœst kontrolÃ¼ (index 8) - 3+ gol
        if toplam_gol >= 3 and values[8] != "-":
            values[8] = f"ğŸŸ¢ {values[8]}"
        elif values[8] != "-":
            values[8] = f"ğŸ”´ {values[8]}"
        
        # KG VAR kontrolÃ¼ (index 9) - iki takÄ±m da gol attÄ±
        if ev_gol >= 1 and dep_gol >= 1 and values[9] != "-":
            values[9] = f"ğŸŸ¢ {values[9]}"
        elif values[9] != "-":
            values[9] = f"ğŸ”´ {values[9]}"
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BANKO/TAHMÄ°N DOÄRULAMA
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        banko_org = values[10]  # BANKO kolonu
        tahmin_kazandi = False
        guven_yuksek = "BANKO" in str(banko_org).upper() or "FAVORÄ°" in str(banko_org).upper()
        
        # Banko tÃ¼rÃ¼ne gÃ¶re sonuÃ§ kontrolÃ¼
        banko_upper = str(banko_org).upper()
        
        if "3.5" in banko_upper and "ÃœST" in banko_upper:
            tahmin_kazandi = toplam_gol >= 4
        elif "2.5" in banko_upper and "ÃœST" in banko_upper:
            tahmin_kazandi = toplam_gol >= 3
        elif "1.5" in banko_upper and "ÃœST" in banko_upper:
            tahmin_kazandi = toplam_gol >= 2
        elif "0.5" in banko_upper and "ÃœST" in banko_upper:
            tahmin_kazandi = toplam_gol >= 1
        elif "KG" in banko_upper and "VAR" in banko_upper:
            tahmin_kazandi = (ev_gol >= 1 and dep_gol >= 1)
        elif "KG" in banko_upper and "YOK" in banko_upper:
            tahmin_kazandi = (ev_gol == 0 or dep_gol == 0)
        elif "MS1" in banko_upper or "MS 1" in banko_upper or "EV" in banko_upper:
            tahmin_kazandi = kazanan == "EV"
        elif "MS2" in banko_upper or "MS 2" in banko_upper or "DEP" in banko_upper:
            tahmin_kazandi = kazanan == "DEP"
        elif "ALT" in banko_upper:
            if "2.5" in banko_upper:
                tahmin_kazandi = toplam_gol < 3
            elif "1.5" in banko_upper:
                tahmin_kazandi = toplam_gol < 2
        
        # Tabloyu gÃ¼ncelle - SONUÃ‡ kolonunu da gÃ¼ncelle
        if tahmin_kazandi:
            values[11] = "KAZANDI âœ…"
            tag = "banko_kazandi" if guven_yuksek else "kazandi"
        else:
            values[11] = "KAYBETTÄ° âŒ"
            tag = "banko_kaybetti" if guven_yuksek else "kaybetti"
        
        # Tabloyu gÃ¼ncelle
        self.tree_oran.item(item, values=values, tags=(tag,))
        self._oran_ozet_guncelle()
    
    def _oran_sag_tik_menu(self, event):
        """SaÄŸ tÄ±k menÃ¼sÃ¼nÃ¼ gÃ¶ster"""
        # TÄ±klanan satÄ±rÄ± seÃ§
        iid = self.tree_oran.identify_row(event.y)
        if iid:
            self.tree_oran.selection_set(iid)
            self.oran_menu.post(event.x_root, event.y_root)
    
    def _oran_sonuc_gir(self, sonuc):
        """SaÄŸ tÄ±k ile sonuÃ§ giriÅŸi"""
        selection = self.tree_oran.selection()
        if not selection:
            return
        
        item = selection[0]
        values = list(self.tree_oran.item(item, "values"))
        
        # SonuÃ§ kolonunu gÃ¼ncelle (index 11)
        if sonuc == "KAZANDI":
            values[11] = "KAZANDI âœ…"
            tag = "kazandi"
        else:
            values[11] = "KAYBETTÄ° âŒ"
            tag = "kaybetti"
        
        self.tree_oran.item(item, values=values, tags=(tag,))
        self._oran_ozet_guncelle()
    
    def _oran_telegrama_gonder(self):
        """SeÃ§ili maÃ§Ä± Telegram'a gÃ¶nder"""
        selection = self.tree_oran.selection()
        if not selection:
            return
        
        item = selection[0]
        values = self.tree_oran.item(item, "values")
        
        mac_adi = values[0]
        lig = values[1]
        skor = values[2]
        banko = values[10]
        sonuc = values[11]
        
        msg = f"""âš½ï¸ {mac_adi}
ğŸ† {lig}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¯ BANKO: {banko}
ğŸ“Š Skor: {skor}
ğŸ“ SonuÃ§: {sonuc}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“± 90 DAKÄ°KA"""
        
        self.kanal_sec_ve_gonder(msg, "Oran Sonucu")
    
    def _oran_detay_goster(self):
        """SeÃ§ili maÃ§Ä±n detaylarÄ±nÄ± gÃ¶ster"""
        selection = self.tree_oran.selection()
        if not selection:
            return
        
        item = selection[0]
        values = self.tree_oran.item(item, "values")
        
        detay = f"""
MAÃ‡: {values[0]}
LÄ°G: {values[1]}
SKOR: {values[2]}

MS 1: {values[3]}
MS X: {values[4]}
MS 2: {values[5]}

0.5 Ãœ: {values[6]}
1.5 Ãœ: {values[7]}
2.5 Ãœ: {values[8]}

KG VAR: {values[9]}
BANKO: {values[10]}
SONUÃ‡: {values[11]}
"""
        messagebox.showinfo("MaÃ§ DetayÄ±", detay)
    
    def _oran_ozet_guncelle(self):
        """Alt bilgi Ã¶zetini gÃ¼ncelle"""
        toplam = 0
        kazanan = 0
        kaybeden = 0
        bekleyen = 0
        
        for item in self.tree_oran.get_children():
            toplam += 1
            values = self.tree_oran.item(item, "values")
            skor = values[2] if len(values) > 2 else "-"
            sonuc = values[11] if len(values) > 11 else ""  # SONUÃ‡ kolonu
            
            if skor == "-":
                bekleyen += 1
            elif "KAZANDI" in sonuc:
                kazanan += 1
            elif "KAYBETTÄ°" in sonuc:
                kaybeden += 1
            else:
                bekleyen += 1
        
        basari = (kazanan / (kazanan + kaybeden) * 100) if (kazanan + kaybeden) > 0 else 0
        
        ozet = f"ğŸ“Š Toplam: {toplam} maÃ§ | âœ… Kazanan: {kazanan} | âŒ Kaybeden: {kaybeden} | â³ Bekleyen: {bekleyen}"
        if kazanan + kaybeden > 0:
            ozet += f" | ğŸ“ˆ BaÅŸarÄ±: %{basari:.1f}"
        
        if hasattr(self, 'lbl_oran_ozet'):
            self.lbl_oran_ozet.config(text=ozet)
    
    def oran_backtest_popup(self):
        """ğŸ” BACKTEST - Filtreleme ve analiz popup"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ” Backtest Analizi")
        popup.geometry("600x500")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ” BACKTEST ANALÄ°ZÄ°", font=("Segoe UI", 14, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        # Filtre seÃ§enekleri
        frm_filtre = tk.LabelFrame(popup, text="âš™ï¸ FÄ°LTRELER", bg=ModernTheme.BG_CARD, 
                                   fg=ModernTheme.ACCENT_PRIMARY)
        frm_filtre.pack(fill="x", padx=20, pady=10)
        
        # Oran aralÄ±ÄŸÄ±
        row1 = tk.Frame(frm_filtre, bg=ModernTheme.BG_CARD)
        row1.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row1, text="MS 1 Oran AralÄ±ÄŸÄ±:", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.bt_ms1_min = tk.Entry(row1, width=6)
        self.bt_ms1_min.insert(0, "1.80")
        self.bt_ms1_min.pack(side="left", padx=2)
        tk.Label(row1, text="-", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        self.bt_ms1_max = tk.Entry(row1, width=6)
        self.bt_ms1_max.insert(0, "1.90")
        self.bt_ms1_max.pack(side="left", padx=2)
        
        # Soru tipi
        row2 = tk.Frame(frm_filtre, bg=ModernTheme.BG_CARD)
        row2.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row2, text="Soru:", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.bt_soru = ttk.Combobox(row2, width=40, values=[
            "MS 1 oranÄ± X-Y arasÄ± olan kaÃ§ maÃ§ 2.5 Ãœst bitmiÅŸ?",
            "MS 1 oranÄ± X-Y arasÄ± olan kaÃ§ maÃ§ Ev KazanmÄ±ÅŸ?",
            "2.5 Ãœst oranÄ± X-Y arasÄ± olan kaÃ§ maÃ§ 3+ gol olmuÅŸ?",
            "KG VAR oranÄ± X-Y arasÄ± olan kaÃ§ maÃ§ KG olmuÅŸ?",
            "BANKO tahminlerin baÅŸarÄ± oranÄ± nedir?",
            "AÄIR FAVORÄ° tahminlerin baÅŸarÄ± oranÄ± nedir?"
        ])
        self.bt_soru.current(0)
        self.bt_soru.pack(side="left", padx=5)
        
        tk.Button(frm_filtre, text="ğŸ” ANALÄ°Z ET", command=lambda: self._backtest_analiz(popup),
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", font=("Arial", 11, "bold"),
                  relief="flat").pack(pady=10)
        
        # SonuÃ§ alanÄ±
        self.txt_backtest = scrolledtext.ScrolledText(popup, font=("Consolas", 10), 
                                                       bg="#0a0a0a", fg="#00ff00", height=15)
        self.txt_backtest.pack(fill="both", expand=True, padx=20, pady=10)
    
    def _backtest_analiz(self, popup):
        """Backtest analizi yap"""
        try:
            ms1_min = float(self.bt_ms1_min.get())
            ms1_max = float(self.bt_ms1_max.get())
        except:
            ms1_min, ms1_max = 1.80, 1.90
        
        soru = self.bt_soru.get()
        
        self.txt_backtest.delete(1.0, tk.END)
        self.txt_backtest.insert(tk.END, f"ğŸ” BACKTEST SONUÃ‡LARI\n")
        self.txt_backtest.insert(tk.END, f"â•"*50 + "\n")
        self.txt_backtest.insert(tk.END, f"ğŸ“Š Filtre: MS 1 oranÄ± {ms1_min} - {ms1_max} arasÄ±\n")
        self.txt_backtest.insert(tk.END, f"â“ Soru: {soru}\n\n")
        
        # Tablodan verileri Ã§ek ve analiz et
        uygun = 0
        basarili = 0
        
        for item in self.tree_oran.get_children():
            values = self.tree_oran.item(item, "values")
            if len(values) < 11:
                continue
            
            skor = values[2]
            ms1_str = values[3].replace("ğŸŸ¢", "").replace("ğŸ”´", "").strip()
            tahmin = values[10]
            
            if skor == "-":
                continue
            
            try:
                ms1_oran = float(ms1_str)
            except:
                continue
            
            # Oran aralÄ±ÄŸÄ±nda mÄ±?
            if ms1_min <= ms1_oran <= ms1_max:
                uygun += 1
                
                # Skoru parse et
                try:
                    ev_gol, dep_gol = map(int, skor.split("-"))
                    toplam_gol = ev_gol + dep_gol
                except:
                    continue
                
                # Soruya gÃ¶re baÅŸarÄ± kontrolÃ¼
                if "2.5 Ãœst" in soru and toplam_gol >= 3:
                    basarili += 1
                elif "Ev KazanmÄ±ÅŸ" in soru and ev_gol > dep_gol:
                    basarili += 1
                elif "BANKO" in soru and "BANKO" in tahmin and "âœ…" in tahmin:
                    basarili += 1
                elif "FAVORÄ°" in soru and "FAVORÄ°" in tahmin and "âœ…" in tahmin:
                    basarili += 1
        
        if uygun > 0:
            oran = basarili / uygun * 100
            self.txt_backtest.insert(tk.END, f"ğŸ“Š SONUÃ‡:\n")
            self.txt_backtest.insert(tk.END, f"   â€¢ Kritere uyan maÃ§: {uygun}\n")
            self.txt_backtest.insert(tk.END, f"   â€¢ BaÅŸarÄ±lÄ±: {basarili}\n")
            self.txt_backtest.insert(tk.END, f"   â€¢ BaÅŸarÄ± OranÄ±: %{oran:.1f}\n")
        else:
            self.txt_backtest.insert(tk.END, "âŒ Kritere uyan maÃ§ bulunamadÄ±.\n")
    
    def oran_performans_raporu(self):
        """ğŸ“Š Genel performans raporu"""
        toplam = 0
        kazanan = 0
        kaybeden = 0
        
        banko_k, banko_t = 0, 0
        favori_k, favori_t = 0, 0
        ust25_k, ust25_t = 0, 0
        
        for item in self.tree_oran.get_children():
            values = self.tree_oran.item(item, "values")
            if len(values) < 11:
                continue
            
            skor = values[2]
            tahmin = values[10]
            
            if skor == "-":
                continue
            
            toplam += 1
            
            if "âœ…" in tahmin:
                kazanan += 1
                if "BANKO" in tahmin:
                    banko_k += 1
                    banko_t += 1
                elif "FAVORÄ°" in tahmin:
                    favori_k += 1
                    favori_t += 1
                elif "2.5" in tahmin:
                    ust25_k += 1
                    ust25_t += 1
            elif "âŒ" in tahmin:
                kaybeden += 1
                if "BANKO" in tahmin:
                    banko_t += 1
                elif "FAVORÄ°" in tahmin:
                    favori_t += 1
                elif "2.5" in tahmin:
                    ust25_t += 1
        
        rapor = f"""ğŸ“Š PERFORMANS RAPORU
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ˆ GENEL Ä°STATÄ°STÄ°KLER:
   â€¢ Toplam MaÃ§: {toplam}
   â€¢ Kazanan: {kazanan}
   â€¢ Kaybeden: {kaybeden}
   â€¢ Genel BaÅŸarÄ±: %{(kazanan/toplam*100) if toplam > 0 else 0:.1f}

ğŸ¯ KATEGORÄ° BAZLI:
   â€¢ BANKO: {banko_k}/{banko_t} (%{(banko_k/banko_t*100) if banko_t > 0 else 0:.1f})
   â€¢ FAVORÄ°: {favori_k}/{favori_t} (%{(favori_k/favori_t*100) if favori_t > 0 else 0:.1f})
   â€¢ 2.5 ÃœST: {ust25_k}/{ust25_t} (%{(ust25_k/ust25_t*100) if ust25_t > 0 else 0:.1f})
"""
        messagebox.showinfo("ğŸ“Š Performans", rapor)
    
    def oran_secili_sil(self):
        """SeÃ§ili satÄ±rlarÄ± sil"""
        selection = self.tree_oran.selection()
        if not selection:
            messagebox.showwarning("UyarÄ±", "Silmek iÃ§in satÄ±r seÃ§in!")
            return
        
        if messagebox.askyesno("Onay", f"{len(selection)} satÄ±r silinecek?"):
            for item in selection:
                self.tree_oran.delete(item)
            self._oran_ozet_guncelle()
    
    def oran_excel_aktar(self):
        """Excel'e aktar"""
        try:
            import openpyxl
            from openpyxl.styles import Font, PatternFill, Alignment
            
            wb = openpyxl.Workbook()
            ws = wb.active
            ws.title = "Oran Takip"
            
            # BaÅŸlÄ±klar
            headers = ["MAÃ‡", "LÄ°G", "SKOR", "MS 1", "MS X", "MS 2", "0.5 Ãœ", "1.5 Ãœ", "2.5 Ãœ", "KG V", "TAHMÄ°N"]
            for col, header in enumerate(headers, 1):
                cell = ws.cell(row=1, column=col, value=header)
                cell.font = Font(bold=True)
                cell.fill = PatternFill(start_color="1a1a2e", end_color="1a1a2e", fill_type="solid")
            
            # Veriler
            for row, item in enumerate(self.tree_oran.get_children(), 2):
                values = self.tree_oran.item(item, "values")
                for col, val in enumerate(values, 1):
                    ws.cell(row=row, column=col, value=str(val).replace("ğŸŸ¢", "âœ“").replace("ğŸ”´", "âœ—"))
            
            # Kaydet
            filename = filedialog.asksaveasfilename(
                defaultextension=".xlsx",
                filetypes=[("Excel", "*.xlsx")],
                initialfilename=f"oran_takip_{datetime.now().strftime('%Y%m%d')}.xlsx"
            )
            if filename:
                wb.save(filename)
                messagebox.showinfo("âœ…", f"Excel'e aktarÄ±ldÄ±: {filename}")
        except ImportError:
            messagebox.showerror("Hata", "openpyxl kÃ¼tÃ¼phanesi gerekli!")
    
    def _create_ogrenme(self):
        """Ã–ÄŸrenme sayfasÄ±"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ§  Ã–ÄRENME SÄ°STEMÄ°", font=("Segoe UI", 16, "bold"), bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        tk.Button(page, text="ğŸ“Š ANALÄ°Z ET", command=self.ogrenme_analiz, bg=ModernTheme.ACCENT_PRIMARY, fg="white", font=("Arial", 12), relief="flat").pack(pady=10)
        
        self.txt_ogrenme = scrolledtext.ScrolledText(page, font=("Consolas", 11), bg="#0a0a0a", fg="#00ff00")
        self.txt_ogrenme.pack(fill="both", expand=True)
        
        return page
    
    def _create_sosyal(self):
        """ğŸ“£ SOSYAL MEDYA - V70 CANLI SENARYO MODLU"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ“£ SOSYAL MEDYA", font=("Segoe UI", 16, "bold"), 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        top = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        top.pack(fill="x", padx=10)
        
        tk.Label(top, text="MaÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.combo_sosyal_mac = ttk.Combobox(top, width=40)
        self.combo_sosyal_mac.pack(side="left", padx=5)
        self.sosyal_maclari_yukle()
        
        tk.Button(top, text="ğŸ“ ANALÄ°Z Ã‡EK", command=self.sosyal_analiz_cek, 
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=10)
        
        # TakÄ±m ve Tahmin entry'leri
        frm2 = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        frm2.pack(fill="x", padx=10, pady=5)
        
        tk.Label(frm2, text="TakÄ±m:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.sosyal_takim = tk.Entry(frm2, width=30, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.sosyal_takim.pack(side="left", padx=5)
        
        tk.Label(frm2, text="Tahmin:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        # TAM TAHMÄ°N LÄ°STESÄ° - 0.5 ÃœST DAHÄ°L
        self.sosyal_tahmin = ttk.Combobox(frm2, width=18, values=[
            "0.5 ÃœST", "1.5 ÃœST", "2.5 ÃœST", "3.5 ÃœST", "4.5 ÃœST", "5.5 ÃœST",
            "0.5 ALT", "1.5 ALT", "2.5 ALT", "3.5 ALT",
            "MS 1", "MS 2", "MS X",
            "KG VAR", "KG YOK",
            "Ä°Y 0.5 ÃœST", "Ä°Y 1.5 ÃœST",
            "Handikap 1", "Handikap 2"
        ])
        self.sosyal_tahmin.pack(side="left", padx=5)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # V70 YENÄ°: CANLI SENARYO MODU - HATA 7
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_canli = tk.LabelFrame(page, text="ğŸ”´ CANLI SENARYO MODU", bg=ModernTheme.BG_CARD, fg="#ff4444")
        frm_canli.pack(fill="x", padx=10, pady=5)
        
        tk.Label(frm_canli, text="Senaryo:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.combo_canli_senaryo = ttk.Combobox(frm_canli, width=25, values=[
            "MaÃ§ Ã–nÃ¼ (VarsayÄ±lan)",
            "CanlÄ± - Dk 45-60 ArasÄ± (Risk Azalt)",
            "CanlÄ± - Dk 70-80 ArasÄ± (Son FÄ±rsat)"
        ])
        self.combo_canli_senaryo.set("MaÃ§ Ã–nÃ¼ (VarsayÄ±lan)")
        self.combo_canli_senaryo.pack(side="left", padx=5)
        
        tk.Label(frm_canli, text="ğŸ’¡ CanlÄ± modda tahmin otomatik 0.5 ÃœST'e Ã§ekilir, gÃ¼ven MAX olur", 
                bg=ModernTheme.BG_CARD, fg="#ffaa00", font=("Arial", 9)).pack(side="left", padx=10)
        
        # Prompt oluÅŸtur butonu
        frm_btn = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        frm_btn.pack(fill="x", padx=10)
        
        tk.Button(frm_btn, text="âœ¨ PROMPT OLUÅTUR", command=self.sosyal_prompt_olustur, 
                  bg=ModernTheme.ACCENT_WARNING, fg="black", font=("Arial", 10, "bold"), 
                  relief="flat").pack(side="left", padx=15)
        
        self.txt_sosyal = scrolledtext.ScrolledText(page, font=("Consolas", 11), bg="#0a0a0a", fg="#00ff00")
        self.txt_sosyal.pack(fill="both", expand=True, padx=10, pady=10)
        
        btm = tk.Frame(page, bg=ModernTheme.BG_PRIMARY)
        btm.pack(fill="x", padx=10)
        tk.Button(btm, text="ğŸ“‹ KOPYALA", command=self.sosyal_kopyala, 
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=5)
        tk.Button(btm, text="ğŸ“± TELEGRAM", command=self.sosyal_telegram_gonder, 
                  bg="#0088cc", fg="white", relief="flat").pack(side="left", padx=5)
        
        return page
    
    def _create_excel(self):
        """ğŸ“Š EXCEL TAKÄ°P - YENÄ° OTOMATÄ°K SÄ°STEM"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ“Š EXCEL OTOMATÄ°K TAKÄ°P", font=("Segoe UI", 16, "bold"), 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_SUCCESS).pack(pady=10)
        
        # Ãœst kontrol paneli
        top = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        top.pack(fill="x", padx=10)
        
        tk.Label(top, text="ğŸ“ Dosya:", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.entry_excel_path = tk.Entry(top, width=50, bg=ModernTheme.BG_PRIMARY, 
                                         fg=ModernTheme.TEXT_PRIMARY)
        self.entry_excel_path.insert(0, EXCEL_FILE)
        self.entry_excel_path.pack(side="left", padx=5)
        
        tk.Button(top, text="ğŸ“‚ SEÃ‡", command=self.excel_dosya_sec, 
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=5)
        tk.Button(top, text="ğŸ“ AÃ‡", command=self.excel_ac, 
                  bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(side="left", padx=5)
        
        # Kontrol butonlarÄ±
        btn_frame = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=8)
        btn_frame.pack(fill="x", padx=10, pady=5)
        
        tk.Button(btn_frame, text="ğŸ”„ TABLOYU YÃœKLE", command=self.excel_tabloyu_yukle,
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(btn_frame, text="ğŸ’¾ EXCEL'E KAYDET", command=self.excel_kaydet,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(btn_frame, text="ğŸ“Š PERFORMANS", command=self.excel_performans_raporu,
                  bg="#9b59b6", fg="white", relief="flat").pack(side="left", padx=5)
        
        # V70 FIX: Ä°Ã§eriÄŸi Sil ve Geri Al butonlarÄ±
        tk.Label(btn_frame, text="  â”‚  ", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_SECONDARY).pack(side="left")
        tk.Button(btn_frame, text="ğŸ—‘ï¸ Ä°Ã‡ERÄ°ÄÄ° SÄ°L", command=self.excel_icerigi_sil,
                  bg=ModernTheme.ACCENT_DANGER, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(btn_frame, text="â†©ï¸ GERÄ° AL", command=self.excel_geri_al,
                  bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(side="left", padx=5)
        
        # Otomatik ekleme checkbox
        self.var_excel_auto = tk.BooleanVar(value=True)
        tk.Checkbutton(btn_frame, text="ğŸ”„ Analiz sonrasÄ± otomatik ekle", 
                       variable=self.var_excel_auto, bg=ModernTheme.BG_CARD, 
                       fg=ModernTheme.TEXT_PRIMARY, selectcolor=ModernTheme.BG_PRIMARY,
                       activebackground=ModernTheme.BG_CARD).pack(side="right", padx=10)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ANA TABLO - Grid yapÄ±sÄ±
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # SÃ¼tunlar: Tarih|Saat|MaÃ§|Lig|Banko|GÃ¼ven|xG Ev|xG Dep|xG Top|Ev Atan%|Dep Atan%|Ev Yiyen%|Dep Yiyen%|Lig Ort|Oran|Skor|SonuÃ§
        
        cols = ("tarih", "saat", "mac", "lig", "banko", "guven", "xg_ev", "xg_dep", "xg_top", 
                "ev_atan", "dep_atan", "ev_yiyen", "dep_yiyen", "lig_ort", "oran", "skor", "sonuc")
        
        # Treeview frame with scrollbars
        tree_frame = tk.Frame(page, bg=ModernTheme.BG_PRIMARY)
        tree_frame.pack(fill="both", expand=True, padx=10, pady=5)
        
        # Horizontal scrollbar
        h_scroll = ttk.Scrollbar(tree_frame, orient="horizontal")
        h_scroll.pack(side="bottom", fill="x")
        
        # Vertical scrollbar
        v_scroll = ttk.Scrollbar(tree_frame, orient="vertical")
        v_scroll.pack(side="right", fill="y")
        
        self.tree_excel = ttk.Treeview(tree_frame, columns=cols, show="headings", height=18,
                                        xscrollcommand=h_scroll.set, yscrollcommand=v_scroll.set)
        
        h_scroll.config(command=self.tree_excel.xview)
        v_scroll.config(command=self.tree_excel.yview)
        
        # SÃ¼tun baÅŸlÄ±klarÄ± ve geniÅŸlikleri
        headers = [
            ("tarih", "TARÄ°H", 75),
            ("saat", "SAAT", 50),
            ("mac", "MAÃ‡", 150),
            ("lig", "LÄ°G", 100),
            ("banko", "BANKO", 80),
            ("guven", "GÃœVEN", 55),
            ("xg_ev", "xG EV", 55),
            ("xg_dep", "xG DEP", 55),
            ("xg_top", "xG TOP", 55),
            ("ev_atan", "EV AT%", 55),
            ("dep_atan", "DEP AT%", 55),
            ("ev_yiyen", "EV YE%", 55),
            ("dep_yiyen", "DEP YE%", 55),
            ("lig_ort", "LÄ°G ORT", 55),
            ("oran", "ORAN", 50),
            ("skor", "SKOR", 50),
            ("sonuc", "SONUÃ‡", 80)
        ]
        
        for col, header, width in headers:
            self.tree_excel.heading(col, text=header)
            self.tree_excel.column(col, width=width, anchor="center", minwidth=40)
        
        # Renk tag'leri
        self.tree_excel.tag_configure("kazandi", background="#1a472a", foreground="#00ff00")
        self.tree_excel.tag_configure("kaybetti", background="#4a1a1a", foreground="#ff6666")
        self.tree_excel.tag_configure("bekliyor", background="#1a1a2e", foreground="#aaaaaa")
        
        self.tree_excel.pack(fill="both", expand=True)
        
        # SaÄŸ tÄ±k menÃ¼sÃ¼
        self.excel_menu = tk.Menu(self.tree_excel, tearoff=0)
        self.excel_menu.add_command(label="ğŸ“ Skor Gir/GÃ¼ncelle", command=self.excel_skor_gir)
        self.excel_menu.add_command(label="ğŸ—‘ï¸ SatÄ±rÄ± Sil", command=self.excel_satir_sil)
        self.excel_menu.add_separator()
        self.excel_menu.add_command(label="ğŸ“‹ Kopyala", command=self.excel_satir_kopyala)
        
        self.tree_excel.bind("<Button-3>", self._excel_sag_tik)
        self.tree_excel.bind("<Double-1>", lambda e: self.excel_skor_gir())
        
        # Alt bilgi paneli
        bottom = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=8)
        bottom.pack(fill="x", padx=10, pady=5)
        
        self.lbl_excel_ozet = tk.Label(bottom, 
            text="ğŸ“Š Toplam: 0 | âœ… Kazanan: 0 | âŒ Kaybeden: 0 | â³ Bekleyen: 0 | ğŸ“ˆ BaÅŸarÄ±: %0", 
            bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY, font=("Arial", 10))
        self.lbl_excel_ozet.pack(side="left", padx=10)
        
        # BaÅŸlangÄ±Ã§ta tabloyu yÃ¼kle
        self.root.after(1000, self.excel_tabloyu_yukle)
        
        return page
    
    def _excel_sag_tik(self, event):
        """SaÄŸ tÄ±k menÃ¼sÃ¼nÃ¼ gÃ¶ster"""
        item = self.tree_excel.identify_row(event.y)
        if item:
            self.tree_excel.selection_set(item)
            self.excel_menu.post(event.x_root, event.y_root)
    
    def excel_tabloyu_yukle(self):
        """Excel dosyasÄ±ndan tabloyu yÃ¼kle"""
        if not EXCEL_AVAILABLE:
            return
        
        excel_path = self.entry_excel_path.get() if hasattr(self, 'entry_excel_path') else EXCEL_FILE
        
        # Tabloyu temizle
        for item in self.tree_excel.get_children():
            self.tree_excel.delete(item)
        
        if not os.path.exists(excel_path):
            return
        
        try:
            wb = load_workbook(excel_path)
            ws = wb.active
            
            # Ä°lk satÄ±r baÅŸlÄ±k, 2. satÄ±rdan itibaren veri
            for row in ws.iter_rows(min_row=2, values_only=True):
                if row and row[0]:  # BoÅŸ satÄ±rlarÄ± atla
                    # 17 sÃ¼tun olmalÄ±
                    values = list(row)
                    while len(values) < 17:
                        values.append("")
                    
                    # Sonuca gÃ¶re tag belirle
                    sonuc = str(values[16] or "").upper()
                    if "KAZANDI" in sonuc or "âœ…" in sonuc:
                        tag = "kazandi"
                    elif "KAYBETTÄ°" in sonuc or "âŒ" in sonuc:
                        tag = "kaybetti"
                    else:
                        tag = "bekliyor"
                    
                    self.tree_excel.insert("", "end", values=values[:17], tags=(tag,))
            
            wb.close()
            self._excel_ozet_guncelle()
            
        except Exception as e:
            print(f"Excel yÃ¼kleme hatasÄ±: {e}")
    
    def excel_otomatik_ekle(self, mac_data):
        """Analiz sonrasÄ± otomatik Excel'e ekle"""
        if not EXCEL_AVAILABLE:
            return
        
        # Otomatik ekleme kapalÄ±ysa Ã§Ä±k
        if hasattr(self, 'var_excel_auto') and not self.var_excel_auto.get():
            return
        
        # Verileri hazÄ±rla
        def safe_get(key, default=""):
            val = mac_data.get(key, default)
            return str(val).replace("%", "") if val else default
        
        tarih = mac_data.get("tarih", datetime.now().strftime("%d.%m.%Y"))
        saat = mac_data.get("saat", datetime.now().strftime("%H:%M"))
        mac_adi = mac_data.get("mac", mac_data.get("mac_adi", "?")).replace("_", " ")
        lig = mac_data.get("lig", "?")
        banko = mac_data.get("banko", "?")
        guven = safe_get("guven", "?")
        xg_ev = safe_get("xg_ev", "?")
        xg_dep = safe_get("xg_dep", "?")
        
        # xG toplam hesapla
        try:
            xg_top = float(xg_ev) + float(xg_dep)
            xg_top = f"{xg_top:.2f}"
        except:
            xg_top = safe_get("xg", safe_get("xg_toplam", "?"))
        
        ev_atan = safe_get("ev_atan", safe_get("ev_atan_05", "?"))
        dep_atan = safe_get("dep_atan", safe_get("dep_atan_05", "?"))
        ev_yiyen = safe_get("ev_yiyen", "?")
        dep_yiyen = safe_get("dep_yiyen", "?")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # V70 FIX: LÄ°G ORTALAMASI - HATA 9
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        lig_ort = safe_get("lig_gol_ort", "")
        if not lig_ort or lig_ort == "?":
            # Lig istatistiklerinden hesapla
            ocr_data = mac_data.get("ocr_data", {}) or {}
            lig_ort = ocr_data.get("lig_gol_ort", "")
            
            # Hala yoksa mac_db'den hesapla
            if not lig_ort:
                lig_maclar = [m for m in self.mac_db if m.get("lig") == lig]
                toplam_gol = 0
                mac_sayisi = 0
                for m in lig_maclar:
                    skor_str = m.get("skor", m.get("gercek_skor", ""))
                    if skor_str and "-" in str(skor_str):
                        try:
                            parcalar = str(skor_str).replace(":", "-").split("-")
                            toplam_gol += int(parcalar[0].strip()) + int(parcalar[1].strip())
                            mac_sayisi += 1
                        except:
                            pass
                if mac_sayisi > 0:
                    lig_ort = f"{toplam_gol / mac_sayisi:.2f}"
                else:
                    lig_ort = "2.50"  # VarsayÄ±lan
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # V70 FIX: ORAN - BANKO'YA GÃ–RE Ã‡EKILECEK - HATA 9
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        oran = ""
        banko_upper = str(banko).upper()
        ocr_data = mac_data.get("ocr_data", {}) or {}
        
        # Banko tipine gÃ¶re oranÄ± Ã§ek
        if "1.5 ÃœST" in banko_upper or "1.5 Ãœ" in banko_upper:
            oran = ocr_data.get("oran_15u", mac_data.get("oran_15u", ""))
        elif "2.5 ÃœST" in banko_upper or "2.5 Ãœ" in banko_upper:
            oran = ocr_data.get("oran_25u", mac_data.get("oran_25u", ""))
        elif "3.5 ÃœST" in banko_upper or "3.5 Ãœ" in banko_upper:
            oran = ocr_data.get("oran_35u", mac_data.get("oran_35u", ""))
        elif "0.5 ÃœST" in banko_upper or "0.5 Ãœ" in banko_upper:
            oran = ocr_data.get("oran_05u", mac_data.get("oran_05u", ""))
        elif "KG VAR" in banko_upper:
            oran = ocr_data.get("oran_kg", mac_data.get("oran_kg", ""))
        elif "MS 1" in banko_upper or "MS1" in banko_upper:
            oran = ocr_data.get("oran_ms1", mac_data.get("oran_ms1", ""))
        elif "MS 2" in banko_upper or "MS2" in banko_upper:
            oran = ocr_data.get("oran_ms2", mac_data.get("oran_ms2", ""))
        elif "MS X" in banko_upper or "MSX" in banko_upper:
            oran = ocr_data.get("oran_x", mac_data.get("oran_x", ""))
        
        if not oran:
            oran = "-"
        else:
            try:
                oran = f"{float(oran):.2f}"
            except:
                pass
        
        skor = "-"
        sonuc = "BEKLÄ°YOR"
        
        # Tabloya ekle
        values = (tarih, saat, mac_adi, lig, banko, guven, xg_ev, xg_dep, xg_top,
                  ev_atan, dep_atan, ev_yiyen, dep_yiyen, lig_ort, oran, skor, sonuc)
        
        self.tree_excel.insert("", "end", values=values, tags=("bekliyor",))
        
        # Excel dosyasÄ±na da kaydet
        self._excel_dosyaya_kaydet()
        self._excel_ozet_guncelle()
    
    def excel_skor_gir(self):
        """Skor giriÅŸi popup'Ä±"""
        selection = self.tree_excel.selection()
        if not selection:
            messagebox.showwarning("UyarÄ±", "Ã–nce bir satÄ±r seÃ§in!")
            return
        
        item = selection[0]
        values = list(self.tree_excel.item(item, "values"))
        
        # Popup oluÅŸtur
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“ Skor Gir")
        popup.geometry("300x150")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        popup.grab_set()
        
        # MaÃ§ adÄ±
        mac_adi = values[2] if len(values) > 2 else "?"
        tk.Label(popup, text=f"âš½ {mac_adi}", font=("Arial", 11, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        # Skor giriÅŸi
        frm = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        frm.pack(pady=10)
        
        tk.Label(frm, text="Ev:", bg=ModernTheme.BG_PRIMARY, 
                fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        entry_ev = tk.Entry(frm, width=5, font=("Arial", 14), justify="center")
        entry_ev.pack(side="left", padx=5)
        entry_ev.insert(0, "0")
        
        tk.Label(frm, text=" - ", bg=ModernTheme.BG_PRIMARY, 
                fg=ModernTheme.TEXT_PRIMARY, font=("Arial", 14)).pack(side="left")
        
        tk.Label(frm, text="Dep:", bg=ModernTheme.BG_PRIMARY, 
                fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        entry_dep = tk.Entry(frm, width=5, font=("Arial", 14), justify="center")
        entry_dep.pack(side="left", padx=5)
        entry_dep.insert(0, "0")
        
        def kaydet():
            try:
                ev_gol = int(entry_ev.get())
                dep_gol = int(entry_dep.get())
            except:
                messagebox.showerror("Hata", "GeÃ§erli sayÄ± girin!")
                return
            
            skor = f"{ev_gol}-{dep_gol}"
            toplam_gol = ev_gol + dep_gol
            
            # Banko'yu al ve sonucu hesapla
            banko = str(values[4]).upper() if len(values) > 4 else ""
            sonuc = self._excel_sonuc_hesapla(banko, ev_gol, dep_gol, toplam_gol)
            
            # DeÄŸerleri gÃ¼ncelle
            values[15] = skor  # Skor sÃ¼tunu
            values[16] = sonuc  # SonuÃ§ sÃ¼tunu
            
            # Tag belirle
            if "KAZANDI" in sonuc:
                tag = "kazandi"
            else:
                tag = "kaybetti"
            
            self.tree_excel.item(item, values=values, tags=(tag,))
            
            # Excel'e kaydet
            self._excel_dosyaya_kaydet()
            self._excel_ozet_guncelle()
            
            popup.destroy()
        
        tk.Button(popup, text="ğŸ’¾ KAYDET", command=kaydet,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", font=("Arial", 11, "bold"),
                  relief="flat").pack(pady=15)
        
        entry_ev.focus()
        entry_ev.select_range(0, tk.END)
    
    def _excel_sonuc_hesapla(self, banko, ev_gol, dep_gol, toplam_gol):
        """Banko'ya gÃ¶re sonucu otomatik hesapla"""
        banko = banko.upper()
        
        # MS 1 (Ev kazanÄ±r)
        if "MS 1" in banko or "MS1" in banko or "EV KAZANIR" in banko:
            return "KAZANDI âœ…" if ev_gol > dep_gol else "KAYBETTÄ° âŒ"
        
        # MS 2 (Deplasman kazanÄ±r)
        if "MS 2" in banko or "MS2" in banko or "DEP KAZANIR" in banko or "DEPLASMAN" in banko:
            return "KAZANDI âœ…" if dep_gol > ev_gol else "KAYBETTÄ° âŒ"
        
        # MS X (Beraberlik)
        if "MS X" in banko or "MSX" in banko or "BERABERLÄ°K" in banko:
            return "KAZANDI âœ…" if ev_gol == dep_gol else "KAYBETTÄ° âŒ"
        
        # KG VAR (KarÅŸÄ±lÄ±klÄ± gol)
        if "KG VAR" in banko or "KGVAR" in banko:
            return "KAZANDI âœ…" if ev_gol >= 1 and dep_gol >= 1 else "KAYBETTÄ° âŒ"
        
        # KG YOK
        if "KG YOK" in banko or "KGYOK" in banko:
            return "KAZANDI âœ…" if ev_gol == 0 or dep_gol == 0 else "KAYBETTÄ° âŒ"
        
        # Gol bahisleri (ÃœST)
        if "5.5 ÃœST" in banko:
            return "KAZANDI âœ…" if toplam_gol >= 6 else "KAYBETTÄ° âŒ"
        if "4.5 ÃœST" in banko:
            return "KAZANDI âœ…" if toplam_gol >= 5 else "KAYBETTÄ° âŒ"
        if "3.5 ÃœST" in banko:
            return "KAZANDI âœ…" if toplam_gol >= 4 else "KAYBETTÄ° âŒ"
        if "2.5 ÃœST" in banko:
            return "KAZANDI âœ…" if toplam_gol >= 3 else "KAYBETTÄ° âŒ"
        if "1.5 ÃœST" in banko:
            return "KAZANDI âœ…" if toplam_gol >= 2 else "KAYBETTÄ° âŒ"
        if "0.5 ÃœST" in banko:
            return "KAZANDI âœ…" if toplam_gol >= 1 else "KAYBETTÄ° âŒ"
        
        # Gol bahisleri (ALT)
        if "3.5 ALT" in banko:
            return "KAZANDI âœ…" if toplam_gol <= 3 else "KAYBETTÄ° âŒ"
        if "2.5 ALT" in banko:
            return "KAZANDI âœ…" if toplam_gol <= 2 else "KAYBETTÄ° âŒ"
        if "1.5 ALT" in banko:
            return "KAZANDI âœ…" if toplam_gol <= 1 else "KAYBETTÄ° âŒ"
        if "0.5 ALT" in banko:
            return "KAZANDI âœ…" if toplam_gol == 0 else "KAYBETTÄ° âŒ"
        
        # Ä°Y bahisleri
        if "Ä°Y" in banko or "IY" in banko:
            # Ä°lk yarÄ± verisi olmadÄ±ÄŸÄ± iÃ§in genel kontrol
            if "1.5 ÃœST" in banko:
                return "KAZANDI âœ…" if toplam_gol >= 2 else "KAYBETTÄ° âŒ"
            if "0.5 ÃœST" in banko:
                return "KAZANDI âœ…" if toplam_gol >= 1 else "KAYBETTÄ° âŒ"
        
        # Handikap
        if "HANDÄ°KAP" in banko or "H1" in banko or "H2" in banko:
            fark = ev_gol - dep_gol
            if "H1" in banko or "HANDÄ°KAP 1" in banko:
                return "KAZANDI âœ…" if fark >= 2 else "KAYBETTÄ° âŒ"
            if "H2" in banko or "HANDÄ°KAP 2" in banko:
                return "KAZANDI âœ…" if fark <= -2 else "KAYBETTÄ° âŒ"
        
        # Bilinmeyen bahis tipi
        return "BELÄ°RSÄ°Z âš ï¸"
    
    def excel_satir_sil(self):
        """SeÃ§ili satÄ±rÄ± sil"""
        selection = self.tree_excel.selection()
        if not selection:
            messagebox.showwarning("UyarÄ±", "Ã–nce bir satÄ±r seÃ§in!")
            return
        
        if not messagebox.askyesno("Onay", "Bu satÄ±r silinecek. Emin misiniz?"):
            return
        
        for item in selection:
            self.tree_excel.delete(item)
        
        # Excel'e kaydet
        self._excel_dosyaya_kaydet()
        self._excel_ozet_guncelle()
    
    def excel_satir_kopyala(self):
        """SeÃ§ili satÄ±rÄ± kopyala"""
        selection = self.tree_excel.selection()
        if not selection:
            return
        
        item = selection[0]
        values = self.tree_excel.item(item, "values")
        text = " | ".join(str(v) for v in values)
        
        self.root.clipboard_clear()
        self.root.clipboard_append(text)
        messagebox.showinfo("âœ…", "SatÄ±r kopyalandÄ±!")
    
    def _excel_dosyaya_kaydet(self):
        """Tabloyu Excel dosyasÄ±na kaydet"""
        if not EXCEL_AVAILABLE:
            return
        
        excel_path = self.entry_excel_path.get() if hasattr(self, 'entry_excel_path') else EXCEL_FILE
        
        try:
            wb = Workbook()
            ws = wb.active
            ws.title = "Analizler"
            
            # BaÅŸlÄ±k satÄ±rÄ±
            headers = ["Tarih", "Saat", "MaÃ§", "Lig", "Banko", "GÃ¼ven", "xG Ev", "xG Dep", "xG Top",
                       "Ev Atan%", "Dep Atan%", "Ev Yiyen%", "Dep Yiyen%", "Lig Ort", "Oran", "Skor", "SonuÃ§"]
            ws.append(headers)
            
            # Verileri ekle
            for item in self.tree_excel.get_children():
                values = self.tree_excel.item(item, "values")
                ws.append(list(values))
            
            # SÃ¼tun geniÅŸlikleri
            col_widths = [10, 6, 25, 15, 12, 8, 8, 8, 8, 10, 10, 10, 10, 8, 8, 8, 12]
            for i, width in enumerate(col_widths, 1):
                ws.column_dimensions[chr(64 + i)].width = width
            
            wb.save(excel_path)
            
        except Exception as e:
            print(f"Excel kaydetme hatasÄ±: {e}")
    
    def excel_kaydet(self):
        """Manuel Excel kaydetme"""
        self._excel_dosyaya_kaydet()
        messagebox.showinfo("âœ…", "Excel kaydedildi!")
    
    def excel_icerigi_sil(self):
        """V70 FIX: Excel tablosundaki tÃ¼m iÃ§eriÄŸi sil"""
        children = self.tree_excel.get_children()
        if not children:
            messagebox.showinfo("Bilgi", "Tablo zaten boÅŸ!")
            return
        
        cevap = messagebox.askyesno(
            "âš ï¸ Ä°Ã§eriÄŸi Sil",
            f"Tablodaki {len(children)} satÄ±rÄ± silmek istediÄŸinize emin misiniz?\n\n"
            "Bu iÅŸlem geri alÄ±nabilir (Geri Al butonu ile)."
        )
        
        if cevap:
            # Geri alma iÃ§in mevcut verileri kaydet
            self.excel_geri_al_verisi = []
            for item in children:
                values = self.tree_excel.item(item, "values")
                self.excel_geri_al_verisi.append(values)
            
            # Tabloyu temizle
            for item in children:
                self.tree_excel.delete(item)
            
            self._excel_ozet_guncelle()
            messagebox.showinfo("âœ…", f"{len(self.excel_geri_al_verisi)} satÄ±r silindi!\n\nGeri almak iÃ§in 'GERÄ° AL' butonuna tÄ±klayÄ±n.")
    
    def excel_geri_al(self):
        """V70 FIX: Silinen iÃ§eriÄŸi geri al"""
        if not hasattr(self, 'excel_geri_al_verisi') or not self.excel_geri_al_verisi:
            messagebox.showinfo("Bilgi", "Geri alÄ±nacak veri yok!")
            return
        
        cevap = messagebox.askyesno(
            "â†©ï¸ Geri Al",
            f"{len(self.excel_geri_al_verisi)} satÄ±rÄ± geri yÃ¼klemek istediÄŸinize emin misiniz?"
        )
        
        if cevap:
            # Verileri geri yÃ¼kle
            for values in self.excel_geri_al_verisi:
                # Sonuca gÃ¶re tag belirle
                sonuc = str(values[16]).upper() if len(values) > 16 else ""
                if "KAZANDI" in sonuc or "âœ…" in sonuc:
                    tag = "kazandi"
                elif "KAYBETTÄ°" in sonuc or "âŒ" in sonuc:
                    tag = "kaybetti"
                else:
                    tag = "bekliyor"
                
                self.tree_excel.insert("", "end", values=values, tags=(tag,))
            
            geri_yuklenen = len(self.excel_geri_al_verisi)
            self.excel_geri_al_verisi = []  # Temizle
            
            self._excel_ozet_guncelle()
            messagebox.showinfo("âœ…", f"{geri_yuklenen} satÄ±r geri yÃ¼klendi!")
    
    def _excel_ozet_guncelle(self):
        """Alt bilgi Ã¶zetini gÃ¼ncelle"""
        toplam = 0
        kazanan = 0
        kaybeden = 0
        bekleyen = 0
        
        for item in self.tree_excel.get_children():
            toplam += 1
            values = self.tree_excel.item(item, "values")
            sonuc = str(values[16]).upper() if len(values) > 16 else ""
            
            if "KAZANDI" in sonuc or "âœ…" in sonuc:
                kazanan += 1
            elif "KAYBETTÄ°" in sonuc or "âŒ" in sonuc:
                kaybeden += 1
            else:
                bekleyen += 1
        
        basari = (kazanan / (kazanan + kaybeden) * 100) if (kazanan + kaybeden) > 0 else 0
        
        ozet = f"ğŸ“Š Toplam: {toplam} | âœ… Kazanan: {kazanan} | âŒ Kaybeden: {kaybeden} | â³ Bekleyen: {bekleyen} | ğŸ“ˆ BaÅŸarÄ±: %{basari:.1f}"
        
        if hasattr(self, 'lbl_excel_ozet'):
            self.lbl_excel_ozet.config(text=ozet)
    
    def excel_performans_raporu(self):
        """DetaylÄ± performans raporu"""
        toplam = 0
        kazanan = 0
        kaybeden = 0
        
        # Bahis tipi bazlÄ± istatistikler
        bahis_stats = {}
        
        for item in self.tree_excel.get_children():
            values = self.tree_excel.item(item, "values")
            if len(values) < 17:
                continue
            
            banko = str(values[4]).upper()
            sonuc = str(values[16]).upper()
            
            if "BEKLÄ°YOR" in sonuc or not sonuc:
                continue
            
            toplam += 1
            
            # Bahis tipini normalize et
            bahis_tipi = "DÄ°ÄER"
            if "2.5 ÃœST" in banko:
                bahis_tipi = "2.5 ÃœST"
            elif "1.5 ÃœST" in banko:
                bahis_tipi = "1.5 ÃœST"
            elif "0.5 ÃœST" in banko:
                bahis_tipi = "0.5 ÃœST"
            elif "3.5 ÃœST" in banko:
                bahis_tipi = "3.5 ÃœST"
            elif "KG VAR" in banko:
                bahis_tipi = "KG VAR"
            elif "KG YOK" in banko:
                bahis_tipi = "KG YOK"
            elif "MS 1" in banko or "MS1" in banko:
                bahis_tipi = "MS 1"
            elif "MS 2" in banko or "MS2" in banko:
                bahis_tipi = "MS 2"
            elif "Ä°Y" in banko:
                bahis_tipi = "Ä°Y GOL"
            
            if bahis_tipi not in bahis_stats:
                bahis_stats[bahis_tipi] = {"k": 0, "t": 0}
            
            bahis_stats[bahis_tipi]["t"] += 1
            
            if "KAZANDI" in sonuc or "âœ…" in sonuc:
                kazanan += 1
                bahis_stats[bahis_tipi]["k"] += 1
            else:
                kaybeden += 1
        
        # Rapor oluÅŸtur
        rapor = f"""ğŸ“Š PERFORMANS RAPORU
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ˆ GENEL Ä°STATÄ°STÄ°KLER:
   â€¢ Toplam MaÃ§: {toplam}
   â€¢ Kazanan: {kazanan}
   â€¢ Kaybeden: {kaybeden}
   â€¢ Genel BaÅŸarÄ±: %{(kazanan/toplam*100) if toplam > 0 else 0:.1f}

ğŸ¯ BAHÄ°S TÄ°PÄ° BAZLI:
"""
        
        for bahis, stats in sorted(bahis_stats.items(), key=lambda x: x[1]["t"], reverse=True):
            k, t = stats["k"], stats["t"]
            oran = (k/t*100) if t > 0 else 0
            rapor += f"   â€¢ {bahis}: {k}/{t} (%{oran:.1f})\n"
        
        messagebox.showinfo("ğŸ“Š Performans Raporu", rapor)
    
    def _create_puanlayici(self):
        """PuanlayÄ±cÄ± sayfasÄ±"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ¯ MAÃ‡ PUANLAYICI", font=("Segoe UI", 16, "bold"), bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(pady=10)
        
        top = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        top.pack(fill="x")
        
        tk.Label(top, text="MaÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.combo_puan_mac = ttk.Combobox(top, width=40)
        self.combo_puan_mac.pack(side="left", padx=5)
        self.puan_maclari_yukle()
        
        tk.Button(top, text="ğŸ“ ANALÄ°Z Ã‡EK", command=self.puan_analiz_cek, bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=10)
        tk.Button(top, text="ğŸ¯ PUANLA", command=self.mac_puanla, bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(side="left")
        tk.Button(top, text="ğŸ“Š GÃœNÃœN MAÃ‡LARI", command=self.gunun_maclarini_puanla, bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=10)
        
        self.txt_puan = scrolledtext.ScrolledText(page, font=("Consolas", 11), bg="#0a0a0a", fg="#ffd700")
        self.txt_puan.pack(fill="both", expand=True, pady=10)
        
        return page
    
    def _create_simulator(self):
        """ğŸ® MONTE CARLO SÄ°MÃœLATÃ–RÃœ - V70 GÃœNCELLENDÄ°
        
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        ğŸ¯ SÄ°MÃœLATÃ–R NASIL Ã‡ALIÅIR?
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        Monte Carlo simÃ¼lasyonu, rastgele sayÄ±lar kullanarak bir maÃ§Ä±n olasÄ± 
        sonuÃ§larÄ±nÄ± binlerce kez hesaplayan istatistiksel bir yÃ¶ntemdir.
        
        ğŸ“Œ GÄ°RDÄ°LER (PARAMETRELER):
        1. Ev xG: Ev sahibinin beklenen gol sayÄ±sÄ± (Ã¶rn: 1.50)
        2. Dep xG: Deplasman takÄ±mÄ±nÄ±n beklenen gol sayÄ±sÄ± (Ã¶rn: 1.20)
        3. Ev Atan%: Ev sahibinin gol atma yÃ¼zdesi (Ã¶rn: %70)
        4. Dep Atan%: Deplasman gol atma yÃ¼zdesi (Ã¶rn: %65)
        5. Ä°terasyon: SimÃ¼lasyon tekrar sayÄ±sÄ± (varsayÄ±lan: 10.000)
        
        ğŸ“Œ HESAPLAMA MANTIÄI:
        1. Her iterasyonda Poisson daÄŸÄ±lÄ±mÄ± kullanarak rastgele gol sayÄ±sÄ± Ã¼retilir
        2. Poisson(Î») formÃ¼lÃ¼nde Î» = xG deÄŸeri kullanÄ±lÄ±r
        3. Gol atma yÃ¼zdeleri, takÄ±mÄ±n o maÃ§ta gol atÄ±p atmayacaÄŸÄ±nÄ± belirler
        4. 10.000 farklÄ± senaryo simÃ¼le edilir
        
        ğŸ“Œ Ã‡IKTILAR:
        â€¢ Ev KazanÄ±r: %X (kaÃ§ senaryoda ev sahibi kazandÄ±)
        â€¢ Berabere: %X (kaÃ§ senaryoda berabere bitti)
        â€¢ Dep KazanÄ±r: %X (kaÃ§ senaryoda deplasman kazandÄ±)
        â€¢ 0.5 ÃœST: %X (kaÃ§ senaryoda en az 1 gol atÄ±ldÄ±)
        â€¢ 1.5 ÃœST: %X (kaÃ§ senaryoda en az 2 gol atÄ±ldÄ±)
        â€¢ 2.5 ÃœST: %X (kaÃ§ senaryoda en az 3 gol atÄ±ldÄ±)
        â€¢ 3.5 ÃœST: %X (kaÃ§ senaryoda en az 4 gol atÄ±ldÄ±)
        â€¢ KG VAR: %X (kaÃ§ senaryoda iki takÄ±m da gol attÄ±)
        â€¢ Ortalama Gol: X.XX (tÃ¼m senaryolarÄ±n gol ortalamasÄ±)
        
        ğŸ“Œ YORUMLAMA:
        â€¢ %60+ sonuÃ§lar gÃ¼venilir kabul edilir
        â€¢ %70+ sonuÃ§lar "BANKO" iÃ§in uygundur
        â€¢ %80+ sonuÃ§lar Ã§ok gÃ¼Ã§lÃ¼ tahmin gÃ¶stergesidir
        
        ğŸ“Œ Ã–RNEK:
        Ev xG=1.8, Dep xG=1.2 â†’ SimÃ¼lasyon 10.000 kez Ã§alÄ±ÅŸÄ±r:
        - 2.5 Ãœst: %62 (6.200 senaryoda 3+ gol Ã§Ä±ktÄ±)
        - KG VAR: %58 (5.800 senaryoda iki takÄ±m da attÄ±)
        - Ortalama Gol: 3.0
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        """
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ® MONTE CARLO SÄ°MÃœLATÃ–RÃœ", font=("Segoe UI", 16, "bold"), bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PURPLE).pack(pady=10)
        
        # AÃ§Ä±klama etiketi
        tk.Label(page, text="ğŸ“Š xG ve istatistik verileriyle 10.000x sanal maÃ§ simÃ¼lasyonu yapar", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        
        top = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        top.pack(fill="x")
        
        tk.Label(top, text="MaÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.combo_sim_mac = ttk.Combobox(top, width=40)
        self.combo_sim_mac.pack(side="left", padx=5)
        self.sim_maclari_yukle()
        
        tk.Button(top, text="ğŸ“ ANALÄ°Z Ã‡EK", command=self.sim_analiz_cek, bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=10)
        tk.Button(top, text="ğŸ® SÄ°MÃœLASYON", command=self.simulasyon_baslat, bg=ModernTheme.ACCENT_PURPLE, fg="white", relief="flat").pack(side="left")
        tk.Button(top, text="â„¹ï¸ NASIL Ã‡ALIÅIR?", command=self._sim_nasil_calisir, bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=10)
        
        params = tk.LabelFrame(page, text="ğŸ“Š Parametreler (Analiz Ã‡ek ile otomatik dolar)", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        params.pack(fill="x", pady=10)
        
        self.sim_entries = {}
        for i, (key, label, default) in enumerate([("ev_xg", "Ev xG", "1.50"), ("dep_xg", "Dep xG", "1.20"), 
                                                    ("ev_atan", "Ev Atan%", "70"), ("dep_atan", "Dep Atan%", "65"),
                                                    ("iterasyon", "Ä°terasyon", "10000")]):
            tk.Label(params, text=f"{label}:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=i//3, column=(i%3)*2, sticky="w", padx=10, pady=5)
            e = tk.Entry(params, width=10, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
            e.insert(0, default)
            e.grid(row=i//3, column=(i%3)*2+1, padx=5, pady=5)
            self.sim_entries[key] = e
        
        self.txt_sim = scrolledtext.ScrolledText(page, font=("Consolas", 11), bg="#0a0a0a", fg="#a371f7")
        self.txt_sim.pack(fill="both", expand=True, pady=10)
        
        return page
    
    def _sim_nasil_calisir(self):
        """SimÃ¼latÃ¶r nasÄ±l Ã§alÄ±ÅŸÄ±r aÃ§Ä±klamasÄ±"""
        popup = tk.Toplevel(self.root)
        popup.title("â„¹ï¸ Monte Carlo SimÃ¼latÃ¶rÃ¼ NasÄ±l Ã‡alÄ±ÅŸÄ±r?")
        popup.geometry("600x550")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        txt = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        txt.pack(fill="both", expand=True, padx=10, pady=10)
        
        aciklama = """
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ® MONTE CARLO SÄ°MÃœLATÃ–RÃœ - DETAYLI AÃ‡IKLAMA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ NEDÄ°R?
Monte Carlo simÃ¼lasyonu, rastgele sayÄ±lar kullanarak olasÄ±lÄ±klarÄ±
hesaplayan gÃ¼Ã§lÃ¼ bir istatistiksel yÃ¶ntemdir. AdÄ±nÄ± Monte Carlo
kumarhanesinden alÄ±r.

ğŸ“Œ NASIL Ã‡ALIÅIR?
1. Girdi olarak xG (expected goals) ve gol yÃ¼zdeleri alÄ±nÄ±r
2. Poisson daÄŸÄ±lÄ±mÄ± kullanÄ±larak rastgele gol sayÄ±sÄ± Ã¼retilir
3. Bu iÅŸlem 10.000 kez tekrarlanÄ±r (sanal maÃ§)
4. SonuÃ§lar toplanarak yÃ¼zdeler hesaplanÄ±r

ğŸ“Œ POÄ°SSON DAÄILIMI NEDÄ°R?
Belirli bir zaman diliminde kaÃ§ olay olacaÄŸÄ±nÄ± tahmin eden
olasÄ±lÄ±k daÄŸÄ±lÄ±mÄ±dÄ±r. Futbolda gol sayÄ±sÄ± tahmini iÃ§in idealdir.
FormÃ¼l: P(k gol) = (Î»^k * e^-Î») / k!
Burada Î» = xG (beklenen gol sayÄ±sÄ±)

ğŸ“Œ Ã–RNEK HESAPLAMA:
Ev xG = 1.8 ise:
- 0 gol olasÄ±lÄ±ÄŸÄ±: %16.5
- 1 gol olasÄ±lÄ±ÄŸÄ±: %29.7
- 2 gol olasÄ±lÄ±ÄŸÄ±: %26.8
- 3+ gol olasÄ±lÄ±ÄŸÄ±: %27.0

ğŸ“Œ SÄ°MÃœLASYON Ã‡IKTILARI:
â€¢ MS 1: Ev sahibi kaÃ§ senaryoda kazandÄ±
â€¢ MS X: KaÃ§ senaryoda berabere bitti
â€¢ MS 2: Deplasman kaÃ§ senaryoda kazandÄ±
â€¢ X.5 ÃœST: KaÃ§ senaryoda X'ten fazla gol Ã§Ä±ktÄ±
â€¢ KG VAR: KaÃ§ senaryoda iki takÄ±m da gol attÄ±
â€¢ ORT GOL: TÃ¼m senaryolarÄ±n gol ortalamasÄ±

ğŸ“Œ GÃœVENÄ°LÄ°RLÄ°K:
â€¢ 10.000 iterasyon ile hata payÄ± Â±%1 civarÄ±ndadÄ±r
â€¢ %60+ sonuÃ§lar gÃ¼venilir kabul edilir
â€¢ %70+ sonuÃ§lar BANKO iÃ§in uygundur
â€¢ %80+ sonuÃ§lar Ã§ok gÃ¼Ã§lÃ¼ tahmindir

ğŸ“Œ KULLANIM:
1. MaÃ§ seÃ§in ve "ANALÄ°Z Ã‡EK" butonuna basÄ±n
2. Parametreler otomatik dolacaktÄ±r
3. "SÄ°MÃœLASYON" butonuna basÄ±n
4. SonuÃ§larÄ± analiz edin

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""
        txt.insert("1.0", aciklama)
        txt.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)
    
    def _create_alarm(self):
        """Alarm sayfasÄ±"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="â° ALARM SÄ°STEMÄ°", font=("Segoe UI", 16, "bold"), bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_DANGER).pack(pady=10)
        
        top = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        top.pack(fill="x")
        
        tk.Label(top, text="MaÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.entry_alarm_mac = tk.Entry(top, width=30, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_alarm_mac.pack(side="left", padx=5)
        
        tk.Label(top, text="Saat:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.entry_alarm_saat = tk.Entry(top, width=8, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_alarm_saat.pack(side="left")
        
        tk.Button(top, text="â• EKLE", command=self.alarm_ekle, bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=10)
        tk.Button(top, text="ğŸ—‘ï¸ SÄ°L", command=self.alarm_sil, bg=ModernTheme.ACCENT_DANGER, fg="white", relief="flat").pack(side="left")
        
        # Alarm treeview (alarm_listele iÃ§in gerekli)
        cols = ("mac", "saat", "durum")
        self.tree_alarm = ttk.Treeview(page, columns=cols, show="headings", height=12)
        for c, w in [("mac", 250), ("saat", 80), ("durum", 100)]:
            self.tree_alarm.heading(c, text=c.upper())
            self.tree_alarm.column(c, width=w, anchor="center")
        self.tree_alarm.pack(fill="both", expand=True, pady=10)
        
        self.alarm_listele()
        
        return page
    
    def _create_lab(self):
        """FIX #35, #36: Lab sayfasÄ± - Kural test ve Ã¶neri sistemi"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ”¬ KURAL LABORATUVARI", font=("Segoe UI", 16, "bold"), 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        # Ãœst: Kural seÃ§imi
        frm_kural = tk.LabelFrame(page, text="ğŸ“‹ KURAL SEÃ‡Ä°MÄ°", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_kural.pack(fill="x", padx=20, pady=5)
        
        row1 = tk.Frame(frm_kural, bg=ModernTheme.BG_CARD)
        row1.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row1, text="Kural SeÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        
        # TÃ¼m kurallarÄ± listele - Yeni yapÄ±ya uyumlu
        kural_listesi = []
        for bolum in TUM_BOLUMLER:
            bolum_adi = bolum.get("bolum", "")
            # Ana kurallar
            if "kurallar" in bolum and isinstance(bolum["kurallar"], list):
                for kural in bolum["kurallar"]:
                    if isinstance(kural, dict):
                        kural_id = kural.get('id', 'N/A')
                        kural_aciklama = kural.get('aciklama', kural.get('baslik', kural.get('tanim', '')))
                        if kural_aciklama:
                            kural_listesi.append(f"[{kural_id}] {str(kural_aciklama)[:50]}")
            # A grubu kurallar (BÃ–LÃœM 4 gibi)
            if "a_grubu" in bolum and "kurallar" in bolum["a_grubu"]:
                for kural in bolum["a_grubu"]["kurallar"]:
                    if isinstance(kural, dict):
                        kural_id = kural.get('id', 'N/A')
                        kural_aciklama = kural.get('baslik', kural.get('tanim', kural.get('aciklama', '')))
                        if kural_aciklama:
                            kural_listesi.append(f"[{kural_id}] {str(kural_aciklama)[:50]}")
            # B grubu kurallar
            if "b_grubu" in bolum and "kurallar" in bolum["b_grubu"]:
                for kural in bolum["b_grubu"]["kurallar"]:
                    if isinstance(kural, dict):
                        kural_id = kural.get('id', 'N/A')
                        kural_aciklama = kural.get('baslik', kural.get('tanim', kural.get('aciklama', '')))
                        if kural_aciklama:
                            kural_listesi.append(f"[{kural_id}] {str(kural_aciklama)[:50]}")
            # AÅŸama kurallarÄ± (BÃ–LÃœM 5 gibi)
            for asama in ["asama_0", "asama_1", "asama_2", "asama_3", "asama_4", "asama_5", "asama_6"]:
                if asama in bolum and "kurallar" in bolum[asama]:
                    for kural in bolum[asama]["kurallar"]:
                        if isinstance(kural, dict):
                            kural_id = kural.get('id', 'N/A')
                            kural_aciklama = kural.get('baslik', kural.get('tanim', kural.get('aciklama', '')))
                            if kural_aciklama:
                                kural_listesi.append(f"[{kural_id}] {str(kural_aciklama)[:50]}")
            # Prensipler (BÃ–LÃœM 11 gibi)
            if "prensipler" in bolum:
                for kural in bolum["prensipler"]:
                    if isinstance(kural, dict):
                        kural_id = kural.get('id', 'N/A')
                        kural_aciklama = kural.get('baslik', kural.get('aciklama', ''))
                        if kural_aciklama:
                            kural_listesi.append(f"[{kural_id}] {str(kural_aciklama)[:50]}")
        
        self.combo_lab_kural = ttk.Combobox(row1, values=kural_listesi, width=60)
        self.combo_lab_kural.pack(side="left", padx=10)
        
        row2 = tk.Frame(frm_kural, bg=ModernTheme.BG_CARD)
        row2.pack(fill="x", padx=10, pady=5)
        
        tk.Button(row2, text="ğŸ§ª KURAL TEST ET", command=self.lab_kural_test,
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(row2, text="ğŸ“Š KURAL PERFORMANSI", command=self.lab_kural_performans,
                  bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(side="left", padx=5)
        tk.Button(row2, text="ğŸ¤– KURAL Ã–NER", command=self.lab_kural_oner,
                  bg=ModernTheme.ACCENT_PURPLE, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(row2, text="âœï¸ YENÄ° KURAL YAZ", command=self.lab_yeni_kural,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=5)
        
        # MaÃ§ seÃ§imi
        frm_mac = tk.LabelFrame(page, text="âš½ MAÃ‡ SEÃ‡Ä°MÄ°", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_mac.pack(fill="x", padx=20, pady=5)
        
        row3 = tk.Frame(frm_mac, bg=ModernTheme.BG_CARD)
        row3.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row3, text="MaÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        self.combo_lab_mac = ttk.Combobox(row3, width=50)
        mac_listesi = [f"{m.get('tarih', '')} - {m.get('mac', m.get('mac_adi', ''))}" for m in self.mac_db[-30:]]
        self.combo_lab_mac["values"] = mac_listesi
        self.combo_lab_mac.pack(side="left", padx=10)
        
        # SonuÃ§ alanÄ±
        self.txt_lab = scrolledtext.ScrolledText(page, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        self.txt_lab.pack(fill="both", expand=True, pady=10, padx=20)
        
        return page
    
    def lab_kural_performans(self):
        """FIX #35: SeÃ§ili kuralÄ±n geÃ§miÅŸ performansÄ±nÄ± gÃ¶ster"""
        kural_sec = self.combo_lab_kural.get() if hasattr(self, 'combo_lab_kural') else ""
        if not kural_sec:
            messagebox.showwarning("UyarÄ±", "Ã–nce bir kural seÃ§in!")
            return
        
        kural_id = kural_sec.split("]")[0].replace("[", "").strip() if "]" in kural_sec else kural_sec
        
        # ArÅŸivde bu kuralla ilgili maÃ§larÄ± tara
        kazanan = 0
        kaybeden = 0
        toplam = 0
        
        self.txt_lab.delete("1.0", tk.END)
        self.txt_lab.insert(tk.END, f"ğŸ“Š KURAL PERFORMANS ANALÄ°ZÄ°\n")
        self.txt_lab.insert(tk.END, f"{'â•' * 60}\n")
        self.txt_lab.insert(tk.END, f"ğŸ” Kural: {kural_sec}\n\n")
        
        for mac in self.mac_db:
            sonuc = mac.get("sonuc", "")
            if sonuc in ["KAZANDI", "âœ…"]:
                kazanan += 1
                toplam += 1
            elif sonuc in ["KAYBETTÄ°", "âŒ"]:
                kaybeden += 1
                toplam += 1
        
        basari = (kazanan / toplam * 100) if toplam > 0 else 0
        
        self.txt_lab.insert(tk.END, f"ğŸ“ˆ SONUÃ‡LAR:\n")
        self.txt_lab.insert(tk.END, f"   âœ… Kazanan: {kazanan}\n")
        self.txt_lab.insert(tk.END, f"   âŒ Kaybeden: {kaybeden}\n")
        self.txt_lab.insert(tk.END, f"   ğŸ“Š BaÅŸarÄ±: %{basari:.1f}\n\n")
        
        if basari >= 70:
            self.txt_lab.insert(tk.END, "ğŸ’¡ Ã–NERÄ°: Bu kural Ã§ok baÅŸarÄ±lÄ±! Kullanmaya devam et.\n")
        elif basari >= 50:
            self.txt_lab.insert(tk.END, "ğŸ’¡ Ã–NERÄ°: Orta seviye baÅŸarÄ±. Ek filtrelerle destekle.\n")
        else:
            self.txt_lab.insert(tk.END, "âš ï¸ Ã–NERÄ°: DÃ¼ÅŸÃ¼k baÅŸarÄ±. Bu kuralÄ± revize et veya kaldÄ±r.\n")
    
    def lab_kural_oner(self):
        """FIX #36: Yapay zeka kural Ã¶nerisi"""
        self.txt_lab.delete("1.0", tk.END)
        self.txt_lab.insert(tk.END, "ğŸ¤– YAPAY ZEKA KURAL Ã–NERÄ°SÄ°\n")
        self.txt_lab.insert(tk.END, "â•" * 60 + "\n\n")
        
        # Kaybeden maÃ§larÄ± analiz et
        kaybeden_maclar = [m for m in self.mac_db if m.get("sonuc") in ["KAYBETTÄ°", "âŒ"]]
        
        if not kaybeden_maclar:
            self.txt_lab.insert(tk.END, "âœ… HenÃ¼z kaybeden maÃ§ yok! Harika gidiyorsun.\n")
            return
        
        self.txt_lab.insert(tk.END, f"ğŸ“Š Kaybeden MaÃ§ Analizi ({len(kaybeden_maclar)} maÃ§):\n\n")
        
        # Ortak Ã¶zellikleri bul
        dusuk_guven = 0
        dusuk_xg = 0
        
        for mac in kaybeden_maclar:
            guven = mac.get("guven", 5)
            if isinstance(guven, str):
                try: guven = int(guven.split("/")[0])
                except: guven = 5
            if guven < 7:
                dusuk_guven += 1
            
            xg = mac.get("xg", mac.get("xg_toplam", 0))
            if isinstance(xg, str):
                try: xg = float(xg)
                except: xg = 0
            if xg and xg < 2.5:
                dusuk_xg += 1
        
        self.txt_lab.insert(tk.END, "ğŸ” BULUNAN PROBLEMLER:\n")
        if dusuk_guven > len(kaybeden_maclar) * 0.5:
            self.txt_lab.insert(tk.END, f"   âš ï¸ DÃ¼ÅŸÃ¼k gÃ¼venli maÃ§lar: {dusuk_guven}/{len(kaybeden_maclar)}\n")
            self.txt_lab.insert(tk.END, "   ğŸ’¡ Ã–NERÄ°: GÃ¼ven < 7 olan maÃ§larÄ± oynama\n\n")
        
        if dusuk_xg > len(kaybeden_maclar) * 0.5:
            self.txt_lab.insert(tk.END, f"   âš ï¸ DÃ¼ÅŸÃ¼k xG'li maÃ§lar: {dusuk_xg}/{len(kaybeden_maclar)}\n")
            self.txt_lab.insert(tk.END, "   ğŸ’¡ Ã–NERÄ°: xG < 2.5 olan maÃ§larda 2.5 Ãœst oynama\n\n")
        
        self.txt_lab.insert(tk.END, "\nğŸ¯ Ã–NERÄ°LEN YENÄ° KURAL:\n")
        self.txt_lab.insert(tk.END, "   [YENI-1] GÃ¼ven >= 7 VE xG >= 2.5 â†’ Oyna\n")
        self.txt_lab.insert(tk.END, "   [YENI-2] GÃ¼ven < 7 VEYA xG < 2.5 â†’ VETO\n")
    
    def lab_yeni_kural(self):
        """Yeni kural yazma popup'Ä±"""
        popup = tk.Toplevel(self.root)
        popup.title("âœï¸ Yeni Kural Yaz")
        popup.geometry("500x300")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(popup, text="âœï¸ YENÄ° KURAL TANIMLA", font=("Segoe UI", 14, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        tk.Label(popup, text="Kural ID:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack(anchor="w", padx=20)
        entry_id = tk.Entry(popup, width=30, bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY)
        entry_id.pack(padx=20, pady=5)
        
        tk.Label(popup, text="AÃ§Ä±klama:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack(anchor="w", padx=20)
        entry_acik = tk.Entry(popup, width=50, bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY)
        entry_acik.pack(padx=20, pady=5)
        
        def kaydet():
            messagebox.showinfo("âœ…", f"Kural '{entry_id.get()}' kaydedildi!")
            popup.destroy()
        
        tk.Button(popup, text="ğŸ’¾ KAYDET", command=kaydet,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(pady=20)
    
    def _create_hazine(self):
        """V70 GÃœNCELLENDÄ°: Hazine sayfasÄ± - Analiz edilen liglerin DÄ°NAMÄ°K istatistikleri
        
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        ğŸ¯ BU TABLO NASIL Ã‡ALIÅIR?
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        1. VERÄ° KAYNAÄI:
           - Bu tablo veritabanÄ±ndan veya geÃ§miÅŸten veri Ã‡EKMEZ
           - Sadece mac_db'deki (analiz listeniz) maÃ§larÄ± kullanÄ±r
           - GÃœNCELLE butonuna bastÄ±ÄŸÄ±nÄ±zda o anki analiz sonuÃ§larÄ±na gÃ¶re hesaplar
        
        2. DÄ°NAMÄ°K HESAPLAMA:
           - Analiz listenize yeni maÃ§ ekledikÃ§e tablo gÃ¼ncellenir
           - MaÃ§ silseniz istatistikler de gÃ¼ncellenir
           - Her lig iÃ§in ayrÄ± hesaplama yapÄ±lÄ±r
        
        3. SÃœTUNLAR:
           - MAÃ‡ SAYISI: O ligden kaÃ§ maÃ§ analiz edilmiÅŸ
           - GOL ORT: Ortalama gol sayÄ±sÄ± (gerÃ§ek skorlardan)
           - KG ORANI: Ä°ki takÄ±mÄ±n da gol attÄ±ÄŸÄ± maÃ§ yÃ¼zdesi
           - 1.5/2.5/3.5 ÃœST: Belirtilen gol sayÄ±sÄ±nÄ± aÅŸan maÃ§ yÃ¼zdesi
           - BAÅARI: BankolarÄ±nÄ±zÄ±n o ligdeki baÅŸarÄ± oranÄ±
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        """
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ’° LÄ°G Ä°STATÄ°STÄ°KLERÄ° (DÄ°NAMÄ°K)", font=("Segoe UI", 16, "bold"), 
                bg=ModernTheme.BG_PRIMARY, fg="#ffd700").pack(pady=10)
        
        tk.Label(page, text="ğŸ“Š Bu tablo sadece analiz listenizde bulunan maÃ§lara gÃ¶re hesaplanÄ±r", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        
        frm_btn = tk.Frame(page, bg=ModernTheme.BG_PRIMARY)
        frm_btn.pack(pady=10)
        
        tk.Button(frm_btn, text="ğŸ”„ GÃœNCELLE", command=self.hazine_guncelle, 
                  bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ—‘ï¸ TÃœMÃœNÃœ SÄ°L", command=self.hazine_temizle, 
                  bg=ModernTheme.ACCENT_DANGER, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(frm_btn, text="â„¹ï¸ NASIL Ã‡ALIÅIR?", command=self._hazine_nasil_calisir, 
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=5)
        
        # V70: SÃ¼tun isimleri dÃ¼zeltildi
        cols = ("lig", "mac_sayisi", "gol_ort", "kg_oran", "ust_15", "ust_25", "ust_35", "basari")
        self.tree_hazine = ttk.Treeview(page, columns=cols, show="headings", height=15)
        
        # V70 FIX: SÃ¼tun baÅŸlÄ±klarÄ± dÃ¼zeltildi
        headers = [
            ("lig", "LÄ°G", 180),
            ("mac_sayisi", "MAÃ‡ SAYISI", 80),
            ("gol_ort", "GOL ORT", 70),
            ("kg_oran", "KG ORAN", 70),
            ("ust_15", "1.5 ÃœST", 70),  # DeÄŸiÅŸtirildi
            ("ust_25", "2.5 ÃœST", 70),  # DeÄŸiÅŸtirildi
            ("ust_35", "3.5 ÃœST", 70),  # DeÄŸiÅŸtirildi
            ("basari", "BAÅARI", 70)
        ]
        
        for col, header, width in headers:
            self.tree_hazine.heading(col, text=header)
            self.tree_hazine.column(col, width=width, anchor="center")
        
        # Renk tag'leri
        self.tree_hazine.tag_configure("elite", background="#1a472a", foreground="#00ff00")
        self.tree_hazine.tag_configure("good", background="#1a1a4a", foreground="#00ccff")
        self.tree_hazine.tag_configure("normal", background="#1a1a1a", foreground="#aaaaaa")
        
        self.tree_hazine.pack(fill="both", expand=True, pady=10, padx=20)
        
        self.hazine_guncelle()
        
        return page
    
    def _hazine_nasil_calisir(self):
        """Lig istatistikleri nasÄ±l Ã§alÄ±ÅŸÄ±r aÃ§Ä±klamasÄ±"""
        popup = tk.Toplevel(self.root)
        popup.title("â„¹ï¸ Lig Ä°statistikleri NasÄ±l Ã‡alÄ±ÅŸÄ±r?")
        popup.geometry("500x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        txt = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        txt.pack(fill="both", expand=True, padx=10, pady=10)
        
        aciklama = """
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ LÄ°G Ä°STATÄ°STÄ°KLERÄ° TABLOSU - DETAYLI AÃ‡IKLAMA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ VERÄ° KAYNAÄI:
Bu tablo veritabanÄ±ndan veya dÄ±ÅŸarÄ±dan veri Ã‡EKMEZ.
Sadece sizin analiz ettiÄŸiniz maÃ§larÄ± (mac_db) kullanÄ±r.

ğŸ“Œ HESAPLAMA MANTIÄI:
GÃœNCELLE butonuna bastÄ±ÄŸÄ±nÄ±zda:
1. Analiz listenizdeki tÃ¼m maÃ§lar liglerine gÃ¶re gruplandÄ±rÄ±lÄ±r
2. Her lig iÃ§in ayrÄ± istatistik hesaplanÄ±r
3. Sadece gerÃ§ek skor girilen maÃ§lar sayÄ±lÄ±r

ğŸ“Œ SÃœTUNLAR:
â€¢ MAÃ‡ SAYISI: O ligden kaÃ§ maÃ§ analiz ettiniz
â€¢ GOL ORT: Ortalama gol sayÄ±sÄ± (ev + dep skorlarÄ±ndan)
â€¢ KG ORAN: %X - Ä°ki takÄ±mÄ±n da gol attÄ±ÄŸÄ± maÃ§ yÃ¼zdesi
â€¢ 1.5 ÃœST: %X - 2+ gol Ã§Ä±kan maÃ§ yÃ¼zdesi
â€¢ 2.5 ÃœST: %X - 3+ gol Ã§Ä±kan maÃ§ yÃ¼zdesi
â€¢ 3.5 ÃœST: %X - 4+ gol Ã§Ä±kan maÃ§ yÃ¼zdesi
â€¢ BAÅARI: %X - BankolarÄ±nÄ±zÄ±n o ligde kazanma oranÄ±

ğŸ“Œ KULLANIM:
1. MaÃ§larÄ± analiz edin
2. SkorlarÄ± girin (Skor sekmesinden)
3. GÃœNCELLE'ye basÄ±n
4. En baÅŸarÄ±lÄ± liglerÄ±nÄ±zÄ± gÃ¶rÃ¼n!

ğŸ“Œ RENK KODLARI:
ğŸŸ¢ YEÅÄ°L: Elit performans (%70+ baÅŸarÄ±)
ğŸ”µ MAVÄ°: Ä°yi performans (%50-70 baÅŸarÄ±)
âšª GRÄ°: Normal performans

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""
        txt.insert("1.0", aciklama)
        txt.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)
    
    def hazine_guncelle(self):
        """V70 GÃœNCELLENDÄ°: Analizlerden lig istatistiklerini hesapla - DÄ°NAMÄ°K"""
        for item in self.tree_hazine.get_children():
            self.tree_hazine.delete(item)
        
        lig_data = {}
        
        for mac in self.mac_db:
            lig = mac.get("lig", "Bilinmeyen")
            if not lig or lig == "?" or lig == "":
                continue
            
            if lig not in lig_data:
                lig_data[lig] = {
                    "mac_sayisi": 0,
                    "toplam_gol": 0,
                    "kg_var": 0,
                    "ust_15": 0,
                    "ust_25": 0,
                    "ust_35": 0,
                    "kazanan": 0,
                    "sonuclu": 0,
                    "skorlu": 0  # Skoru girilen maÃ§ sayÄ±sÄ±
                }
            
            lig_data[lig]["mac_sayisi"] += 1
            
            # Skor varsa gol hesapla
            skor = mac.get("skor", mac.get("gercek_skor", ""))
            if skor and "-" in str(skor):
                try:
                    parcalar = str(skor).replace(":", "-").split("-")
                    ev = int(parcalar[0].strip())
                    dep = int(parcalar[1].strip())
                    toplam = ev + dep
                    
                    lig_data[lig]["toplam_gol"] += toplam
                    lig_data[lig]["skorlu"] += 1
                    
                    if ev > 0 and dep > 0:
                        lig_data[lig]["kg_var"] += 1
                    if toplam >= 2:  # 1.5 Ã¼st = 2+ gol
                        lig_data[lig]["ust_15"] += 1
                    if toplam >= 3:  # 2.5 Ã¼st = 3+ gol
                        lig_data[lig]["ust_25"] += 1
                    if toplam >= 4:  # 3.5 Ã¼st = 4+ gol
                        lig_data[lig]["ust_35"] += 1
                except:
                    pass
            
            sonuc = mac.get("sonuc", "")
            if sonuc in ["KAZANDI", "âœ…", "WIN"]:
                lig_data[lig]["kazanan"] += 1
                lig_data[lig]["sonuclu"] += 1
            elif sonuc in ["KAYBETTÄ°", "âŒ", "LOSS"]:
                lig_data[lig]["sonuclu"] += 1
        
        for lig, data in sorted(lig_data.items(), key=lambda x: x[1]["mac_sayisi"], reverse=True):
            mac_sayisi = data["mac_sayisi"]
            skorlu = data["skorlu"] if data["skorlu"] > 0 else 1  # SÄ±fÄ±ra bÃ¶lme engeli
            
            gol_ort = data["toplam_gol"] / skorlu if skorlu > 0 else 0
            kg_oran = data["kg_var"] / skorlu * 100 if skorlu > 0 else 0
            ust_15 = data["ust_15"] / skorlu * 100 if skorlu > 0 else 0
            ust_25 = data["ust_25"] / skorlu * 100 if skorlu > 0 else 0
            ust_35 = data["ust_35"] / skorlu * 100 if skorlu > 0 else 0
            basari = data["kazanan"] / data["sonuclu"] * 100 if data["sonuclu"] > 0 else 0
            
            # Renk tag'i belirle
            if basari >= 70:
                tag = "elite"
            elif basari >= 50:
                tag = "good"
            else:
                tag = "normal"
            
            self.tree_hazine.insert("", "end", values=(
                lig[:25], mac_sayisi, f"{gol_ort:.2f}", f"%{kg_oran:.0f}",
                f"%{ust_15:.0f}", f"%{ust_25:.0f}", f"%{ust_35:.0f}", f"%{basari:.0f}"
            ), tags=(tag,))
    
    def hazine_temizle(self):
        """Hazine tablosunu temizle"""
        for item in self.tree_hazine.get_children():
            self.tree_hazine.delete(item)
    
    def _create_gorsel(self):
        """GÃ¶rsel sayfasÄ± - V70 GÃœNCELLENDÄ°"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ–¼ï¸ GÃ–RSEL OLUÅTURUCU", font=("Segoe UI", 16, "bold"), bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ÃœST PANEL - MaÃ§ SeÃ§imi
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        top = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        top.pack(fill="x", padx=10)
        
        tk.Label(top, text="MaÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.combo_gorsel_mac = ttk.Combobox(top, width=40)
        self.combo_gorsel_mac.pack(side="left", padx=5)
        self.combo_gorsel_mac["values"] = [f"{m.get('tarih', '')} - {m.get('mac', m.get('mac_adi', ''))}" for m in self.mac_db[-20:]]
        
        tk.Button(top, text="ğŸ“ ANALÄ°Z Ã‡EK", command=self.gorsel_analiz_cek, bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=10)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # GÃ–RSEL VERÄ° GÄ°RÄ°Å ALANLARI - V70 YENÄ°
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_veri = tk.LabelFrame(page, text="ğŸ“ GÃ–RSEL VERÄ°LERÄ°", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_veri.pack(fill="x", padx=10, pady=5)
        
        # SatÄ±r 1: BaÅŸlÄ±k ve MaÃ§
        row1 = tk.Frame(frm_veri, bg=ModernTheme.BG_CARD)
        row1.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row1, text="BaÅŸlÄ±k:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY, width=10).pack(side="left")
        self.entry_gorsel_baslik = tk.Entry(row1, width=25, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_gorsel_baslik.insert(0, "GÃœNÃœN BANKOSI")
        self.entry_gorsel_baslik.pack(side="left", padx=5)
        
        tk.Label(row1, text="MaÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY, width=8).pack(side="left")
        self.entry_gorsel_mac = tk.Entry(row1, width=30, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_gorsel_mac.pack(side="left", padx=5)
        
        # SatÄ±r 2: Tahmin ve GÃ¼ven
        row2 = tk.Frame(frm_veri, bg=ModernTheme.BG_CARD)
        row2.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row2, text="Tahmin:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY, width=10).pack(side="left")
        self.entry_gorsel_tahmin = tk.Entry(row2, width=20, bg=ModernTheme.BG_PRIMARY, fg="#00ff00")
        self.entry_gorsel_tahmin.pack(side="left", padx=5)
        
        tk.Label(row2, text="GÃ¼ven:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY, width=8).pack(side="left")
        self.entry_gorsel_guven = tk.Entry(row2, width=8, bg=ModernTheme.BG_PRIMARY, fg="#ffd700")
        self.entry_gorsel_guven.insert(0, "8/10")
        self.entry_gorsel_guven.pack(side="left", padx=5)
        
        # SatÄ±r 3: Kritik Veriler
        row3 = tk.Frame(frm_veri, bg=ModernTheme.BG_CARD)
        row3.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row3, text="Kritik 1:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY, width=10).pack(side="left")
        self.entry_gorsel_g1 = tk.Entry(row3, width=50, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_gorsel_g1.pack(side="left", padx=5)
        
        row4 = tk.Frame(frm_veri, bg=ModernTheme.BG_CARD)
        row4.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row4, text="Kritik 2:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY, width=10).pack(side="left")
        self.entry_gorsel_g2 = tk.Entry(row4, width=50, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_gorsel_g2.pack(side="left", padx=5)
        
        row5 = tk.Frame(frm_veri, bg=ModernTheme.BG_CARD)
        row5.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row5, text="Kritik 3:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY, width=10).pack(side="left")
        self.entry_gorsel_g3 = tk.Entry(row5, width=50, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_gorsel_g3.pack(side="left", padx=5)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BUTONLAR
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        btm = tk.Frame(page, bg=ModernTheme.BG_CARD, pady=10)
        btm.pack(fill="x", pady=10, padx=10)
        
        tk.Button(btm, text="ğŸ¨ GÃ–RSEL OLUÅTUR", command=self.gorsel_olustur, bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=10)
        tk.Button(btm, text="ğŸ¤– AI GÃ–RSEL", command=self.gorsel_ai_olustur, bg=ModernTheme.ACCENT_PURPLE, fg="white", relief="flat").pack(side="left")
        tk.Button(btm, text="ğŸ’¾ KAYDET", command=self.gorsel_kaydet, bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(side="left", padx=10)
        tk.Button(btm, text="ğŸ“± TELEGRAM", command=self.gorsel_telegram_gonder, bg="#0088cc", fg="white", relief="flat").pack(side="left")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # Ã–NÄ°ZLEME CANVAS
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.canvas_gorsel = tk.Canvas(page, bg="#0a0a0a", width=700, height=400)
        self.canvas_gorsel.pack(pady=10)
        
        # V70: GÃ¶rsel Ã¶nizleme iÃ§in label (AI gÃ¶rsel iÃ§in)
        self.lbl_gorsel_onizleme = tk.Label(page, bg="#0a0a0a")
        self.lbl_gorsel_onizleme.pack()
        
        self.gorsel_image = None
        
        return page
        
    def _create_marka(self):
        """Marka sayfasÄ±"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ·ï¸ MARKA KÄ°MLÄ°ÄÄ°", font=("Segoe UI", 16, "bold"), bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        frm = tk.LabelFrame(page, text="Kanal Bilgileri", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm.pack(fill="x", padx=20, pady=10)
        
        self.marka_entries = {}
        for i, (key, label) in enumerate([("kanal_adi", "Kanal AdÄ±"), ("telegram", "Telegram"), ("twitter", "Twitter"), ("instagram", "Instagram"), ("slogan", "Slogan")]):
            tk.Label(frm, text=f"{label}:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=i, column=0, sticky="w", padx=10, pady=5)
            e = tk.Entry(frm, width=50, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
            e.insert(0, self.brand.get(key) or "")
            e.grid(row=i, column=1, padx=10, pady=5)
            self.marka_entries[key] = e
        
        tk.Button(page, text="ğŸ’¾ KAYDET", command=self.marka_kaydet, bg=ModernTheme.ACCENT_SUCCESS, fg="white", font=("Arial", 12), relief="flat").pack(pady=20)
        
        return page
    
    def _create_ayarlar(self):
        """Ayarlar sayfasÄ± - V5.7 GÃœNCELLENDÄ°"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="âš™ï¸ AYARLAR", font=("Segoe UI", 16, "bold"), bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack(pady=10)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ğŸ”„ GÃœNCELLEME SÄ°STEMÄ° - V70 YENÄ°
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_update = tk.LabelFrame(page, text="ğŸ”„ GÃœNCELLEME SÄ°STEMÄ°", bg=ModernTheme.BG_CARD, fg="#00d4ff")
        frm_update.pack(fill="x", padx=20, pady=10)
        
        # Versiyon bilgisi
        update_row1 = tk.Frame(frm_update, bg=ModernTheme.BG_CARD)
        update_row1.pack(fill="x", padx=10, pady=5)
        
        tk.Label(update_row1, text=f"ğŸ“Œ Mevcut Versiyon: ", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        tk.Label(update_row1, text=f"v{APP_VERSION}", bg=ModernTheme.BG_CARD, 
                fg="#00ff00", font=("Arial", 11, "bold")).pack(side="left")
        tk.Label(update_row1, text=f"  |  ğŸ“… {BUILD_DATE}", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_SECONDARY).pack(side="left")
        
        # GÃ¼ncelleme durumu
        self.lbl_update_status = tk.Label(update_row1, text="", bg=ModernTheme.BG_CARD, 
                                          fg=ModernTheme.TEXT_SECONDARY)
        self.lbl_update_status.pack(side="right", padx=10)
        
        # Butonlar
        update_row2 = tk.Frame(frm_update, bg=ModernTheme.BG_CARD)
        update_row2.pack(fill="x", padx=10, pady=8)
        
        tk.Button(update_row2, text="ğŸ” GÃœNCELLEME KONTROL ET", command=self._guncelleme_kontrol,
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat", 
                  font=("Arial", 10, "bold")).pack(side="left", padx=5)
        tk.Button(update_row2, text="â¬‡ï¸ GÃœNCELLEME Ä°NDÄ°R", command=self._guncelleme_indir,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat",
                  font=("Arial", 10, "bold")).pack(side="left", padx=5)
        tk.Button(update_row2, text="ğŸ”„ PROGRAMI YENÄ°DEN BAÅLAT", command=self._programi_yeniden_baslat,
                  bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(side="left", padx=5)
        
        # GitHub bilgisi
        update_row3 = tk.Frame(frm_update, bg=ModernTheme.BG_CARD)
        update_row3.pack(fill="x", padx=10, pady=5)
        
        tk.Label(update_row3, text="ğŸ”— GitHub: ", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_SECONDARY).pack(side="left")
        self.lbl_github_url = tk.Label(update_row3, text=f"github.com/{GITHUB_USER}/{GITHUB_REPO}", 
                                        bg=ModernTheme.BG_CARD, fg="#00d4ff", cursor="hand2")
        self.lbl_github_url.pack(side="left")
        self.lbl_github_url.bind("<Button-1>", lambda e: self._github_ac())
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        # FIX #45: KASA YÃ–NETÄ°MÄ°
        frm_kasa = tk.LabelFrame(page, text="ğŸ’° KASA YÃ–NETÄ°MÄ°", bg=ModernTheme.BG_CARD, fg="#ffd700")
        frm_kasa.pack(fill="x", padx=20, pady=10)
        
        kasa_row1 = tk.Frame(frm_kasa, bg=ModernTheme.BG_CARD)
        kasa_row1.pack(fill="x", padx=10, pady=5)
        
        tk.Label(kasa_row1, text="GÃ¼ncel Kasa:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        self.entry_kasa = tk.Entry(kasa_row1, width=15, bg=ModernTheme.BG_PRIMARY, fg="#ffd700", font=("Arial", 12, "bold"))
        self.entry_kasa.insert(0, "1000")
        self.entry_kasa.pack(side="left", padx=10)
        tk.Label(kasa_row1, text="TL", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        
        tk.Button(kasa_row1, text="ğŸ’¾ KAYDET", command=self._kasa_kaydet,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=20)
        
        # GÃ¼ven bazlÄ± kasa hesaplama tablosu
        kasa_row2 = tk.Frame(frm_kasa, bg=ModernTheme.BG_CARD)
        kasa_row2.pack(fill="x", padx=10, pady=10)
        
        tk.Label(kasa_row2, text="ğŸ“Š GÃœVENE GÃ–RE BAHÄ°S MÄ°KTARI:", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.ACCENT_PRIMARY, font=("Arial", 10, "bold")).pack(anchor="w")
        
        self.lbl_kasa_tablo = tk.Label(kasa_row2, text="", bg=ModernTheme.BG_CARD, 
                                        fg=ModernTheme.TEXT_PRIMARY, font=("Consolas", 9), justify="left")
        self.lbl_kasa_tablo.pack(anchor="w", pady=5)
        self._kasa_tablosu_guncelle()
        
        # Tema
        frm = tk.LabelFrame(page, text="Tema", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm.pack(fill="x", padx=20, pady=10)
        
        for tema in THEMES.keys():
            tk.Radiobutton(frm, text=tema, variable=tk.StringVar(value=self.current_theme), value=tema,
                          command=lambda t=tema: self.tema_degistir(t), bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY,
                          selectcolor=ModernTheme.BG_HOVER).pack(anchor="w", padx=20, pady=3)
        
        # Yedekleme
        frm2 = tk.LabelFrame(page, text="Veri YÃ¶netimi", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm2.pack(fill="x", padx=20, pady=10)
        
        tk.Button(frm2, text="ğŸ’¾ VERÄ°LERÄ° YEDEKLE", command=self.verileri_yedekle, bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=10, pady=10)
        tk.Button(frm2, text="ğŸ§¹ Ã–NBELLEK TEMÄ°ZLE", command=self.onbellek_temizle, bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(side="left", padx=10)
        tk.Button(frm2, text="ğŸ—‘ï¸ VERÄ°LERÄ° SIFIRLA", command=self._verileri_sifirla, bg="#dc3545", fg="white", relief="flat").pack(side="left", padx=10)
        
        # V5.7 YENÄ°: Kara Liste / AltÄ±n Liste
        frm3 = tk.LabelFrame(page, text="ğŸ’€ KARA LÄ°STE / âœ¨ ALTIN LÄ°STE", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_DANGER)
        frm3.pack(fill="x", padx=20, pady=10)
        
        row1 = tk.Frame(frm3, bg=ModernTheme.BG_CARD)
        row1.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row1, text="TakÄ±m/Lig:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        self.entry_liste_ekle = tk.Entry(row1, width=30, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_liste_ekle.pack(side="left", padx=10)
        
        tk.Button(row1, text="ğŸ’€ Kara Listeye Ekle", command=self._kara_liste_ekle_ui,
                  bg="#dc3545", fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(row1, text="âœ¨ AltÄ±n Listeye Ekle", command=self._altin_liste_ekle_ui,
                  bg="#ffc107", fg="black", relief="flat").pack(side="left", padx=5)
        
        row2 = tk.Frame(frm3, bg=ModernTheme.BG_CARD)
        row2.pack(fill="x", padx=10, pady=5)
        
        tk.Button(row2, text="ğŸ“‹ Kara Listeyi GÃ¶ster", command=self._kara_liste_goster,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=5)
        tk.Button(row2, text="ğŸ“‹ AltÄ±n Listeyi GÃ¶ster", command=self._altin_liste_goster,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=5)
        
        # V5.7 YENÄ°: Kasa YÃ¶netimi
        frm4 = tk.LabelFrame(page, text="ğŸ’° KASA YÃ–NETÄ°MÄ°", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_SUCCESS)
        frm4.pack(fill="x", padx=20, pady=10)
        
        kasa_info = """
ğŸ’ 10/10 = %25 (ELÄ°T)     ğŸ”¥ 9/10 = %20 (Ã‡ok GÃ¼Ã§lÃ¼)
ğŸ’ª 8/10 = %15 (GÃ¼Ã§lÃ¼)     âš–ï¸ 7/10 = %10 (Standart)
âš ï¸ 6/10 = %8 (Dikkat)    â“ 5/10 = %5 (Riskli)
"""
        tk.Label(frm4, text=kasa_info, bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY,
                font=("Consolas", 9), justify="left").pack(padx=10, pady=5)
        
        return page
    
    def _kara_liste_ekle_ui(self):
        """Kara listeye ekle - UI"""
        deger = self.entry_liste_ekle.get().strip()
        if not deger:
            messagebox.showwarning("UyarÄ±", "TakÄ±m veya lig adÄ± girin!")
            return
        if self.kara_liste_ekle(deger):
            messagebox.showinfo("âœ…", f"'{deger}' kara listeye eklendi!")
            self.entry_liste_ekle.delete(0, tk.END)
        else:
            messagebox.showinfo("Bilgi", "Zaten listede!")
    
    def _altin_liste_ekle_ui(self):
        """AltÄ±n listeye ekle - UI"""
        deger = self.entry_liste_ekle.get().strip()
        if not deger:
            messagebox.showwarning("UyarÄ±", "TakÄ±m veya lig adÄ± girin!")
            return
        if self.altin_liste_ekle(deger):
            messagebox.showinfo("âœ…", f"'{deger}' altÄ±n listeye eklendi!")
            self.entry_liste_ekle.delete(0, tk.END)
        else:
            messagebox.showinfo("Bilgi", "Zaten listede!")
    
    def _kara_liste_goster(self):
        """Kara listeyi popup'ta gÃ¶ster"""
        kara = self._load_json(KARA_LISTE_FILE, [])
        if not kara:
            messagebox.showinfo("ğŸ’€ Kara Liste", "Liste boÅŸ!")
            return
        
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ’€ Kara Liste")
        popup.geometry("400x300")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(popup, text="ğŸ’€ KARA LÄ°STE", font=("Segoe UI", 14, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_DANGER).pack(pady=10)
        
        listbox = tk.Listbox(popup, bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY, height=10)
        listbox.pack(fill="both", expand=True, padx=20, pady=10)
        
        for item in kara:
            listbox.insert(tk.END, f"â›” {item}")
        
        def sil():
            sel = listbox.curselection()
            if sel:
                idx = sel[0]
                kara.pop(idx)
                self._save_json(KARA_LISTE_FILE, kara)
                listbox.delete(idx)
        
        tk.Button(popup, text="ğŸ—‘ï¸ SeÃ§iliyi Sil", command=sil,
                  bg=ModernTheme.ACCENT_DANGER, fg="white", relief="flat").pack(pady=10)
    
    def _altin_liste_goster(self):
        """AltÄ±n listeyi popup'ta gÃ¶ster"""
        altin = self._load_json(ALTIN_LISTE_FILE, [])
        if not altin:
            messagebox.showinfo("âœ¨ AltÄ±n Liste", "Liste boÅŸ!")
            return
        
        popup = tk.Toplevel(self.root)
        popup.title("âœ¨ AltÄ±n Liste")
        popup.geometry("400x300")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(popup, text="âœ¨ ALTIN LÄ°STE", font=("Segoe UI", 14, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg="#ffc107").pack(pady=10)
        
        listbox = tk.Listbox(popup, bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY, height=10)
        listbox.pack(fill="both", expand=True, padx=20, pady=10)
        
        for item in altin:
            listbox.insert(tk.END, f"â­ {item}")
        
        def sil():
            sel = listbox.curselection()
            if sel:
                idx = sel[0]
                altin.pop(idx)
                self._save_json(ALTIN_LISTE_FILE, altin)
                listbox.delete(idx)
        
        tk.Button(popup, text="ğŸ—‘ï¸ SeÃ§iliyi Sil", command=sil,
                  bg=ModernTheme.ACCENT_WARNING, fg="black", relief="flat").pack(pady=10)

    def _tab_analiz(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸš€ ANALÄ°Z")
        
        # Ãœst kontroller
        frm = tk.Frame(tab, bg=self.theme["card_bg"], pady=10)
        frm.pack(fill="x", padx=10)
        
        tk.Label(frm, text="API:", bg=self.theme["card_bg"], fg="gray").pack(side="left")
        self.entry_api = tk.Entry(frm, width=40, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_api.insert(0, DEFAULT_API_KEY)
        self.entry_api.pack(side="left", padx=5)
        
        tk.Label(frm, text="Tarih:", bg=self.theme["card_bg"], fg=self.theme["warning"]).pack(side="left", padx=10)
        self.entry_date = tk.Entry(frm, width=10, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_date.insert(0, datetime.now().strftime("%d.%m.%Y"))
        self.entry_date.pack(side="left")
        
        ttk.Combobox(frm, textvariable=self.var_model, values=list(GEMINI_MODELS.keys()),
                     width=22, state="readonly").pack(side="left", padx=10)
        
        tk.Button(frm, text="ğŸ“‚ GÃ¶rsel", command=self.dosya_sec,
                  bg=self.theme["button"], fg=self.theme["fg"]).pack(side="right", padx=2)
        tk.Button(frm, text="ğŸ“‹", command=self.panodan_yapistir,
                  bg="#007acc", fg="white").pack(side="right", padx=2)
        tk.Button(frm, text="ğŸ—‘ï¸", command=self.temizle,
                  bg=self.theme["error"], fg="white").pack(side="right", padx=2)
        
        self.lbl_count = tk.Label(frm, text="0/15", bg=self.theme["card_bg"],
                                  fg=self.theme["warning"], font=("Arial", 11, "bold"))
        self.lbl_count.pack(side="right", padx=10)
        
        # Notlar
        tk.Label(tab, text="ğŸ“ Notlar (SakatlÄ±k, Seri, ORANLAR):",
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(anchor="w", padx=10)
        self.txt_notes = tk.Text(tab, height=2, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.txt_notes.pack(fill="x", padx=10, pady=3)
        
        # Analiz butonu
        self.btn_analyze = tk.Button(tab, text=f"ğŸš€ ANALÄ°ZÄ° BAÅLAT ({TOPLAM_KURAL} KURAL)",
                                     command=self.analizi_baslat,
                                     bg="#00aa66", fg="white",
                                     font=("Arial", 14, "bold"), height=2)
        self.btn_analyze.pack(fill="x", padx=20, pady=8)
        
        # Progress
        self.progress_frame = tk.Frame(tab, bg=self.theme["card_bg"])
        self.progress = ttk.Progressbar(self.progress_frame, mode="determinate", length=400)
        self.progress.pack(side="left", padx=10)
        self.lbl_progress = tk.Label(self.progress_frame, text="", bg=self.theme["card_bg"],
                                      fg=self.theme["accent"], font=("Consolas", 10))
        self.lbl_progress.pack(side="left", padx=10)
        
        # SonuÃ§ alanÄ±
        self.txt_result = scrolledtext.ScrolledText(tab, font=("Consolas", 10),
                                                     bg="#050505", fg="#00ff00")
        self.txt_result.pack(expand=True, fill="both", padx=10, pady=5)
        
        # Alt butonlar
        btm = tk.Frame(tab, bg=self.theme["card_bg"])
        btm.pack(fill="x", padx=10, pady=5)
        
        tk.Button(btm, text="ğŸ“‹ KURAL TARAMA", command=self.kural_popup,
                  bg="#ff6600", fg="white").pack(side="right", padx=3)
        tk.Button(btm, text="ğŸ“Š Ã–ZET GÃ–NDER", command=self.telegram_ozet_gonder,
                  bg="#17a2b8", fg="white").pack(side="right", padx=3)
        tk.Button(btm, text="ğŸ“¤ TELEGRAM", command=self.telegram_gonder,
                  bg="#0088cc", fg="white").pack(side="right", padx=3)
        tk.Button(btm, text="ğŸ’¾ WORD", command=self.word_kaydet,
                  bg="#2b5797", fg="white").pack(side="right", padx=3)
        tk.Button(btm, text="ğŸ“Š EXCEL", command=self.excel_ekle,
                  bg="#1d6f42", fg="white").pack(side="right", padx=3)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: ARÅÄ°V
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_arsiv(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ“‚ ARÅÄ°V")
        
        frm = tk.Frame(tab, bg=self.theme["card_bg"], pady=10)
        frm.pack(fill="x", padx=10)
        
        tk.Label(frm, text="Ara:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.entry_search = tk.Entry(frm, width=25, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_search.pack(side="left", padx=5)
        tk.Button(frm, text="ğŸ”", command=self.arsiv_ara, bg="#007acc", fg="white").pack(side="left")
        tk.Button(frm, text="ğŸ”„", command=self.arsiv_yenile, bg=self.theme["button"], fg=self.theme["fg"]).pack(side="left", padx=5)
        
        tk.Label(frm, text="Filtre:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left", padx=10)
        self.combo_filtre = ttk.Combobox(frm, values=["TÃ¼mÃ¼", "KAZANDI", "KAYBETTÄ°", "BEKLÄ°YOR"], width=12)
        self.combo_filtre.set("TÃ¼mÃ¼")
        self.combo_filtre.pack(side="left")
        self.combo_filtre.bind("<<ComboboxSelected>>", lambda e: self.arsiv_yenile())
        
        # SÄ°L butonlarÄ±
        tk.Button(frm, text="ğŸ—‘ï¸ SEÃ‡Ä°LÄ° SÄ°L", command=self.arsiv_secili_sil,
                bg="#dc3545", fg="white").pack(side="left", padx=10)
        tk.Button(frm, text="ğŸ§¹ TÃœMÃœNÃœ SÄ°L", command=self.arsiv_tumunu_sil,
                bg="#6c757d", fg="white").pack(side="left", padx=5)
        
        cols = ("tarih", "mac", "banko", "sigorta", "guven", "sonuc")
        self.tree_arsiv = ttk.Treeview(tab, columns=cols, show="headings", height=20, selectmode="extended")
        for c, w in [("tarih", 80), ("mac", 200), ("banko", 120), ("sigorta", 120), ("guven", 60), ("sonuc", 80)]:
            self.tree_arsiv.heading(c, text=c.upper())
            self.tree_arsiv.column(c, width=w, anchor="center")  # ORTALAMA
        self.tree_arsiv.pack(expand=True, fill="both", padx=10, pady=5)
        self.tree_arsiv.bind("<Double-1>", self.arsiv_detay)
        self.tree_arsiv.bind("<Delete>", lambda e: self.arsiv_secili_sil())  # Delete tuÅŸu ile sil
        self.tree_arsiv.bind("<Button-3>", self.arsiv_sag_tik)  # SaÄŸ tÄ±k menÃ¼sÃ¼
        
        self.arsiv_yenile()
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: SKOR (HATA 13 - GÃ–RSEL SKOR YÃœKLE)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_skor(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ† SKOR")
        
        tk.Label(tab, text="ğŸ† SKOR KONTROL (OTOMATÄ°K EÅLEÅTÄ°RME)", font=("Segoe UI", 14, "bold"),
                bg=self.theme["card_bg"], fg=self.theme["warning"]).pack(pady=10)
        
        # Ãœst kontroller
        frm = tk.Frame(tab, bg=self.theme["card_bg"])
        frm.pack(fill="x", padx=20, pady=5)
        
        tk.Label(frm, text="Tarih:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.entry_skor_tarih = tk.Entry(frm, width=12, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_skor_tarih.insert(0, datetime.now().strftime("%d.%m.%Y"))
        self.entry_skor_tarih.pack(side="left", padx=5)
        
        tk.Button(frm, text="ğŸ“‚ GÃœNÃœN MAÃ‡LARI", command=self.skor_yukle,
                bg=self.theme["button"], fg=self.theme["fg"]).pack(side="left", padx=5)
        
        # HATA 13 - GÃ¶rsel skor yÃ¼kle
        tk.Button(frm, text="ğŸ“· GÃ–RSEL SKOR YÃœKLE", command=self.skor_gorsel_yukle,
                bg="#ff6600", fg="white", font=("Arial", 10, "bold")).pack(side="left", padx=10)
        tk.Button(frm, text="ğŸ“‹ PANODAN SKOR", command=self.skor_panodan,
                bg="#007acc", fg="white").pack(side="left", padx=5)
        
        # Manuel giriÅŸ
        frm2 = tk.Frame(tab, bg=self.theme["card_bg"])
        frm2.pack(fill="x", padx=20, pady=5)
        
        tk.Label(frm2, text="MaÃ§:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=0)
        self.combo_skor_mac = ttk.Combobox(frm2, width=40, state="readonly")
        self.combo_skor_mac.grid(row=0, column=1, padx=5)
        
        tk.Label(frm2, text="SonuÃ§:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=2)
        self.combo_sonuc = ttk.Combobox(frm2, values=["KAZANDI", "KAYBETTÄ°"], width=12)
        self.combo_sonuc.grid(row=0, column=3, padx=5)
        
        tk.Label(frm2, text="Skor:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=4)
        self.entry_gercek_skor = tk.Entry(frm2, width=8, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_gercek_skor.grid(row=0, column=5, padx=5)
        
        tk.Button(frm2, text="âœ… KAYDET", command=self.skor_kaydet,
                bg="#28a745", fg="white").grid(row=0, column=6, padx=10)
        
        # Toplu
        frm3 = tk.Frame(tab, bg=self.theme["card_bg"])
        frm3.pack(fill="x", padx=20, pady=5)
        
        tk.Button(frm3, text="âœ… HEPSÄ°NÄ° KAZANDI", command=lambda: self.toplu_sonuc("KAZANDI"),
                  bg="#28a745", fg="white").pack(side="left", padx=5)
        tk.Button(frm3, text="âŒ HEPSÄ°NÄ° KAYBETTÄ°", command=lambda: self.toplu_sonuc("KAYBETTÄ°"),
                  bg="#dc3545", fg="white").pack(side="left", padx=5)
        tk.Button(frm3, text="ğŸ’¾ OTOMATÄ°K EÅLEÅTÄ°R & KAYDET", command=self.skor_otomatik_kaydet,
                  bg="#6f42c1", fg="white", font=("Arial", 10, "bold")).pack(side="left", padx=10)
        
        # SonuÃ§ alanÄ±
        self.txt_skor = scrolledtext.ScrolledText(tab, height=18, bg="#0a0a0a",
                                                fg=self.theme["accent"], font=("Consolas", 10))
        self.txt_skor.pack(fill="both", expand=True, padx=10, pady=5)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: KUPON
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_kupon(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ’° KUPON")
        
        tk.Label(tab, text="ğŸ° KUPON OLUÅTURUCU", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(pady=10)
        
        frm_tarih = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_tarih.pack()
        tk.Label(frm_tarih, text="Tarih:", bg=self.theme["card_bg"], fg="gray").pack(side="left")
        self.entry_kupon_tarih = tk.Entry(frm_tarih, width=12, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_kupon_tarih.insert(0, datetime.now().strftime("%d.%m.%Y"))
        self.entry_kupon_tarih.pack(side="left", padx=5)
        
        frm = tk.Frame(tab, bg=self.theme["card_bg"])
        frm.pack(pady=10)
        
        tk.Button(frm, text="ğŸ’° KASA", command=lambda: self.kupon_olustur("KASA"),
                  bg="#28a745", fg="white", font=("Arial", 9), width=12).pack(side="left", padx=3)
        tk.Button(frm, text="ğŸ”¥ KARMA", command=lambda: self.kupon_olustur("KARMA"),
                  bg="#ff8800", fg="black", font=("Arial", 9), width=12).pack(side="left", padx=3)
        tk.Button(frm, text="âš ï¸ RÄ°SKLÄ°", command=lambda: self.kupon_olustur("RISK"),
                  bg="#dc3545", fg="white", font=("Arial", 9), width=12).pack(side="left", padx=3)
        tk.Button(frm, text="ğŸ† TOP 3", command=self.gunun_en_iyi_3,
                  bg="#6f42c1", fg="white", font=("Arial", 9), width=12).pack(side="left", padx=3)
        
        self.txt_kupon = scrolledtext.ScrolledText(tab, height=14, bg=self.theme["entry_bg"],
                                                    fg=self.theme["success"], font=("Consolas", 11))
        self.txt_kupon.pack(fill="both", expand=True, padx=20, pady=10)
        
        btm = tk.Frame(tab, bg=self.theme["card_bg"])
        btm.pack(fill="x", padx=20, pady=5)
        
        # HATA 3 - GÃ¶rsel kaydet dÃ¼zeltildi
        tk.Button(btm, text="ğŸ“¸ GÃ–RSEL KAYDET", command=self.kupon_gorsel_kaydet,
                  bg="#2b5797", fg="white").pack(side="left", padx=5)
        tk.Button(btm, text="ğŸ“¤ TELEGRAM", command=self.kupon_telegram,
                  bg="#0088cc", fg="white").pack(side="left", padx=5)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: LÄ°STELER
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_listeler(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ“‹ LÄ°STELER")
        
        tk.Label(tab, text="ğŸ“‹ Ã–ZEL LÄ°STELER", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        frm_top = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_top.pack()
        
        tk.Label(frm_top, text="Tarih:", bg=self.theme["card_bg"], fg="gray").pack(side="left")
        self.entry_liste_tarih = tk.Entry(frm_top, width=12, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_liste_tarih.insert(0, datetime.now().strftime("%d.%m.%Y"))
        self.entry_liste_tarih.pack(side="left", padx=5)
        
        tk.Button(frm_top, text="ğŸ”„ GÃœNCELLE", command=self.listeleri_guncelle,
                  bg="#ff6600", fg="white", font=("Arial", 10, "bold")).pack(side="left", padx=10)
        
        tk.Button(frm_top, text="ğŸ“¤ TELEGRAM'A GÃ–NDER", command=self.listeleri_telegrama_gonder,
                  bg="#0088cc", fg="white", font=("Arial", 10, "bold")).pack(side="left", padx=10)
        
        frm = tk.Frame(tab, bg=self.theme["card_bg"])
        frm.pack(expand=True, fill="both", padx=10, pady=5)
        
        # Liste kutularÄ± + Checkbox'lar
        # ğŸ”¥ 3.5 ÃœST
        f1 = tk.LabelFrame(frm, text="ğŸ”¥ 3.5 ÃœST", bg=self.theme["card_bg"], fg=self.theme["error"])
        f1.grid(row=0, column=0, padx=5, pady=5, sticky="nsew")
        self.chk_35_var = tk.BooleanVar(value=True)
        tk.Checkbutton(f1, text="Telegram'a GÃ¶nder", variable=self.chk_35_var,
                       bg=self.theme["card_bg"], fg="gray", selectcolor=self.theme["entry_bg"]).pack(anchor="w")
        self.lst_35 = tk.Listbox(f1, height=7, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.lst_35.pack(fill="both", expand=True)
        
        # âš½ 2.5 ÃœST
        f2 = tk.LabelFrame(frm, text="âš½ 2.5 ÃœST", bg=self.theme["card_bg"], fg=self.theme["warning"])
        f2.grid(row=0, column=1, padx=5, pady=5, sticky="nsew")
        self.chk_25_var = tk.BooleanVar(value=True)
        tk.Checkbutton(f2, text="Telegram'a GÃ¶nder", variable=self.chk_25_var,
                       bg=self.theme["card_bg"], fg="gray", selectcolor=self.theme["entry_bg"]).pack(anchor="w")
        self.lst_25 = tk.Listbox(f2, height=7, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.lst_25.pack(fill="both", expand=True)
        
        # ğŸ¤ KG VAR
        f3 = tk.LabelFrame(frm, text="ğŸ¤ KG VAR", bg=self.theme["card_bg"], fg=self.theme["success"])
        f3.grid(row=0, column=2, padx=5, pady=5, sticky="nsew")
        self.chk_kg_var = tk.BooleanVar(value=True)
        tk.Checkbutton(f3, text="Telegram'a GÃ¶nder", variable=self.chk_kg_var,
                       bg=self.theme["card_bg"], fg="gray", selectcolor=self.theme["entry_bg"]).pack(anchor="w")
        self.lst_kg = tk.Listbox(f3, height=7, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.lst_kg.pack(fill="both", expand=True)
        
        # ğŸ‘‘ FAVORÄ°
        f4 = tk.LabelFrame(frm, text="ğŸ‘‘ FAVORÄ°", bg=self.theme["card_bg"], fg="#ff00ff")
        f4.grid(row=1, column=0, padx=5, pady=5, sticky="nsew")
        self.chk_fav_var = tk.BooleanVar(value=True)
        tk.Checkbutton(f4, text="Telegram'a GÃ¶nder", variable=self.chk_fav_var,
                       bg=self.theme["card_bg"], fg="gray", selectcolor=self.theme["entry_bg"]).pack(anchor="w")
        self.lst_fav = tk.Listbox(f4, height=7, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.lst_fav.pack(fill="both", expand=True)
        
        # â±ï¸ Ä°Y GOL
        f5 = tk.LabelFrame(frm, text="â±ï¸ Ä°Y GOL", bg=self.theme["card_bg"], fg="#00ffff")
        f5.grid(row=1, column=1, padx=5, pady=5, sticky="nsew")
        self.chk_iy_var = tk.BooleanVar(value=True)
        tk.Checkbutton(f5, text="Telegram'a GÃ¶nder", variable=self.chk_iy_var,
                       bg=self.theme["card_bg"], fg="gray", selectcolor=self.theme["entry_bg"]).pack(anchor="w")
        self.lst_iy = tk.Listbox(f5, height=7, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.lst_iy.pack(fill="both", expand=True)
        
        # ğŸ’ XG 5+
        f6 = tk.LabelFrame(frm, text="ğŸ’ XG 5+", bg=self.theme["card_bg"], fg="#ffd700")
        f6.grid(row=1, column=2, padx=5, pady=5, sticky="nsew")
        self.chk_deger_var = tk.BooleanVar(value=True)
        tk.Checkbutton(f6, text="Telegram'a GÃ¶nder", variable=self.chk_deger_var,
                       bg=self.theme["card_bg"], fg="gray", selectcolor=self.theme["entry_bg"]).pack(anchor="w")
        self.lst_deger = tk.Listbox(f6, height=7, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.lst_deger.pack(fill="both", expand=True)
        
        for i in range(3):
            frm.columnconfigure(i, weight=1)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: DEÄERLÄ° (HATA 4 - AÃ‡IKLAMALI)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_degerli(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ’ DEÄERLÄ°")
        
        tk.Label(tab, text="ğŸ’ DEÄERLÄ° BAHÄ°S BULUCU", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        # HATA 4 - AÃ§Ä±klama eklendi
        aciklama = """
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’¡ NASIL Ã‡ALIÅIR?                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Ä°statistik %70 diyor (2.5 ÃœST olma ihtimali)                            â”‚
â”‚  â€¢ Oran 1.60 (bahisÃ§i %62 olasÄ±lÄ±k ima ediyor: 100/1.60 = 62.5)            â”‚
â”‚  â€¢ FARK = 70 - 62 = +8 puan                                                â”‚
â”‚  â€¢ Bu fark ne kadar bÃ¼yÃ¼kse, bahis o kadar DEÄERLÄ°!                        â”‚
â”‚  â€¢ Min DeÄŸer FarkÄ± = Minimum kaÃ§ puan fark olsun istiyorsun?               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
"""
        tk.Label(tab, text=aciklama, bg=self.theme["card_bg"], fg="gray", 
                 font=("Consolas", 9), justify="left").pack()
        
        frm = tk.Frame(tab, bg=self.theme["card_bg"])
        frm.pack(pady=10)
        
        tk.Label(frm, text="Min DeÄŸer FarkÄ±:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.spin_deger_fark = tk.Spinbox(frm, from_=5, to=50, width=5)
        self.spin_deger_fark.delete(0, tk.END)
        self.spin_deger_fark.insert(0, "10")
        self.spin_deger_fark.pack(side="left", padx=5)
        
        tk.Button(frm, text="ğŸ” DEÄER BAHÄ°S BUL", command=self.deger_bahis_bul,
                  bg="#ffd700", fg="black", font=("Arial", 11, "bold")).pack(side="left", padx=10)
        
        self.txt_degerli = scrolledtext.ScrolledText(tab, height=18, bg=self.theme["entry_bg"],
                                                      fg=self.theme["warning"], font=("Consolas", 11))
        self.txt_degerli.pack(fill="both", expand=True, padx=20, pady=10)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: DASHBOARD
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_dashboard(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ“Š DASHBOARD")
        
        tk.Label(tab, text="ğŸ“ˆ GELÄ°ÅMÄ°Å PERFORMANS DASHBOARD", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        frm_cards = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_cards.pack(fill="x", padx=20, pady=10)
        
        self.lbl_toplam = tk.Label(frm_cards, text="ğŸ“Š Toplam: 0", font=("Segoe UI", 11, "bold"),
                                   bg=self.theme["card_bg"], fg=self.theme["fg"])
        self.lbl_toplam.pack(side="left", padx=15)
        
        self.lbl_kazanan = tk.Label(frm_cards, text="âœ… Kazanan: 0", font=("Segoe UI", 11, "bold"),
                                    bg=self.theme["card_bg"], fg=self.theme["success"])
        self.lbl_kazanan.pack(side="left", padx=15)
        
        self.lbl_kaybeden = tk.Label(frm_cards, text="âŒ Kaybeden: 0", font=("Segoe UI", 11, "bold"),
                                     bg=self.theme["card_bg"], fg=self.theme["error"])
        self.lbl_kaybeden.pack(side="left", padx=15)
        
        self.lbl_basari = tk.Label(frm_cards, text="ğŸ“ˆ BaÅŸarÄ±: %0", font=("Segoe UI", 12, "bold"),
                                   bg=self.theme["card_bg"], fg=self.theme["warning"])
        self.lbl_basari.pack(side="left", padx=15)
        
        tk.Button(frm_cards, text="ğŸ”„ GÃœNCELLE", command=self.dashboard_guncelle,
                  bg=self.theme["button"], fg=self.theme["fg"]).pack(side="right", padx=10)
        
        self.txt_dashboard = scrolledtext.ScrolledText(tab, font=("Consolas", 10),
                                                        bg="#0a0a0a", fg=self.theme["accent"])
        self.txt_dashboard.pack(expand=True, fill="both", padx=10, pady=5)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: KARÅILAÅTIR
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_karsilastir(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="âš–ï¸ KARÅILAÅTIR")
        
        tk.Label(tab, text="âš–ï¸ Ã‡OKLU MAÃ‡ KARÅILAÅTIRMA", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        frm = tk.Frame(tab, bg=self.theme["card_bg"])
        frm.pack()
        
        tk.Label(frm, text="Tarih:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.entry_kars_tarih = tk.Entry(frm, width=12, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_kars_tarih.insert(0, datetime.now().strftime("%d.%m.%Y"))
        self.entry_kars_tarih.pack(side="left", padx=10)
        
        tk.Button(frm, text="ğŸ“Š KARÅILAÅTIR", command=self.maclari_karsilastir,
                  bg="#ff6600", fg="white").pack(side="left", padx=5)
        
        cols = ("mac", "banko", "sigorta", "guven", "puan", "lig")
        self.tree_kars = ttk.Treeview(tab, columns=cols, show="headings", height=15)
        for c, w in [("mac", 200), ("banko", 100), ("sigorta", 100), ("guven", 60), ("puan", 60), ("lig", 150)]:
            self.tree_kars.heading(c, text=c.upper())
            self.tree_kars.column(c, width=w)
        self.tree_kars.pack(expand=True, fill="both", padx=10, pady=10)
        
        self.lbl_kars = tk.Label(tab, text="", bg=self.theme["card_bg"],
                                 fg=self.theme["warning"], font=("Consolas", 11))
        self.lbl_kars.pack(pady=5)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: TELEGRAM (HATA 5, 15 - MAÃ‡ SEÃ‡Ä°CÄ° + Ã‡OKLU KANAL)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_telegram(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ¤– TELEGRAM")
        
        tk.Label(tab, text="ğŸ¤– TELEGRAM KANAL YÃ–NETÄ°CÄ°SÄ°", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        # Ayarlar
        frm_ayar = tk.LabelFrame(tab, text="âš™ï¸ Bot AyarlarÄ±", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_ayar.pack(fill="x", padx=20, pady=5)
        
        frm = tk.Frame(frm_ayar, bg=self.theme["card_bg"])
        frm.pack(pady=5)
        
        tk.Label(frm, text="Bot Token:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=0, sticky="e")
        self.entry_tg_token = tk.Entry(frm, width=45, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_tg_token.insert(0, TELEGRAM_BOT_TOKEN)
        self.entry_tg_token.grid(row=0, column=1, padx=5, pady=2)
        
        tk.Label(frm, text="VarsayÄ±lan Chat ID:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=1, column=0, sticky="e")
        self.entry_tg_chat = tk.Entry(frm, width=45, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_tg_chat.insert(0, TELEGRAM_CHAT_ID)
        self.entry_tg_chat.grid(row=1, column=1, padx=5, pady=2)
        
        frm_btn = tk.Frame(frm_ayar, bg=self.theme["card_bg"])
        frm_btn.pack(pady=5)
        tk.Button(frm_btn, text="ğŸ’¾ KAYDET", command=self.telegram_kaydet, bg="#28a745", fg="white").pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ§ª TEST", command=self.telegram_test, bg="#007acc", fg="white").pack(side="left", padx=5)
        
        # HATA 15 - Ã‡oklu kanal yÃ¶netimi
        frm_kanal = tk.LabelFrame(tab, text="ğŸ“¢ Kanal/Grup YÃ¶netimi", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_kanal.pack(fill="x", padx=20, pady=5)
        
        frm_yeni = tk.Frame(frm_kanal, bg=self.theme["card_bg"])
        frm_yeni.pack(fill="x", pady=5, padx=5)
        
        tk.Label(frm_yeni, text="Kanal AdÄ±:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.entry_kanal_ad = tk.Entry(frm_yeni, width=20, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_kanal_ad.pack(side="left", padx=3)
        
        tk.Label(frm_yeni, text="Chat ID:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.entry_kanal_id = tk.Entry(frm_yeni, width=20, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_kanal_id.pack(side="left", padx=3)
        
        tk.Button(frm_yeni, text="â• EKLE", command=self.kanal_ekle, bg="#28a745", fg="white").pack(side="left", padx=5)
        tk.Button(frm_yeni, text="ğŸ—‘ï¸ SÄ°L", command=self.kanal_sil, bg="#dc3545", fg="white").pack(side="left", padx=2)
        tk.Button(frm_yeni, text="ğŸ§¹ TÃœMÃœNÃœ SÄ°L", command=self.kanal_tumunu_sil, bg="#6c757d", fg="white").pack(side="left", padx=2)
        
        # Kanal listesi
        self.listbox_kanallar = tk.Listbox(frm_kanal, height=4, bg=self.theme["entry_bg"], fg=self.theme["fg"], selectmode=tk.MULTIPLE)
        self.listbox_kanallar.pack(fill="x", padx=5, pady=5)
        self.kanal_listele()
        
        # HATA 5 - MaÃ§ seÃ§ici + formatlar
        frm_format = tk.LabelFrame(tab, text="ğŸ“¤ MESAJ GÃ–NDERÄ°MÄ°", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_format.pack(fill="x", padx=20, pady=5)
        
        frm_mac = tk.Frame(frm_format, bg=self.theme["card_bg"])
        frm_mac.pack(fill="x", pady=5, padx=5)
        
        tk.Label(frm_mac, text="MaÃ§ SeÃ§:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.combo_tg_mac = ttk.Combobox(frm_mac, width=40, state="readonly")
        self.combo_tg_mac.pack(side="left", padx=5)
        tk.Button(frm_mac, text="ğŸ”„", command=self.tg_maclari_yukle, bg=self.theme["button"], fg=self.theme["fg"]).pack(side="left")
        
        frm_butonlar = tk.Frame(frm_format, bg=self.theme["card_bg"])
        frm_butonlar.pack(pady=5)
        
        tk.Button(frm_butonlar, text="ğŸ¯ TAHMÄ°N\n(KÄ±sa)", command=lambda: self.tg_format_gonder("kisa"),
                  bg="#17a2b8", fg="white", width=12, height=2).pack(side="left", padx=3)
        tk.Button(frm_butonlar, text="ğŸ“Š DETAYLI\n(Ä°statistikli)", command=lambda: self.tg_format_gonder("detayli"),
                  bg="#6f42c1", fg="white", width=12, height=2).pack(side="left", padx=3)
        tk.Button(frm_butonlar, text="â° CANLI\n(HatÄ±rlatma)", command=lambda: self.tg_format_gonder("canli"),
                  bg="#fd7e14", fg="white", width=12, height=2).pack(side="left", padx=3)
        tk.Button(frm_butonlar, text="âœ… SONUÃ‡\n(MaÃ§ bitti)", command=lambda: self.tg_format_gonder("sonuc"),
                  bg="#28a745", fg="white", width=12, height=2).pack(side="left", padx=3)
        
        # Ã–nizleme
        tk.Label(tab, text="ğŸ“ Ã–nizleme:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(anchor="w", padx=20)
        self.txt_tg_preview = scrolledtext.ScrolledText(tab, height=10, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 9))
        self.txt_tg_preview.pack(fill="both", expand=True, padx=20, pady=5)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: Ã–ÄRENME
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_ogrenme(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ§  Ã–ÄRENME")
        
        tk.Label(tab, text="ğŸ§  Ã–ÄRENEN SÄ°STEM", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=15)
        
        tk.Button(tab, text="ğŸ” ANALÄ°Z ET VE Ã–NERÄ° AL", command=self.ogrenme_analiz,
                  bg="#ff6600", fg="white", font=("Arial", 12, "bold")).pack(pady=10)
        
        self.txt_ogrenme = scrolledtext.ScrolledText(tab, font=("Consolas", 11),
                                                      bg="#0a0a0a", fg=self.theme["warning"])
        self.txt_ogrenme.pack(expand=True, fill="both", padx=20, pady=10)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: SOSYAL (HATA 6 - 3 GEREKÃ‡E)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_sosyal(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ“± SOSYAL")
        
        tk.Label(tab, text="ğŸ“± CANLI BAHÄ°S PROMPT OLUÅTURUCU", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        frm = tk.Frame(tab, bg=self.theme["card_bg"])
        frm.pack(fill="x", padx=20, pady=5)
        
        # HATA 6 - Analiz seÃ§ici eklendi
        tk.Label(frm, text="Analiz SeÃ§:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=0, sticky="w", pady=3)
        self.combo_sosyal_mac = ttk.Combobox(frm, width=50, state="readonly")
        self.combo_sosyal_mac.grid(row=0, column=1, sticky="we", pady=3, padx=5)
        tk.Button(frm, text="ğŸ”„", command=self.sosyal_maclari_yukle, bg=self.theme["button"], fg=self.theme["fg"]).grid(row=0, column=2)
        
        tk.Label(frm, text="TakÄ±mlar:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=1, column=0, sticky="w", pady=3)
        self.sosyal_takim = tk.Entry(frm, width=50, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.sosyal_takim.grid(row=1, column=1, sticky="we", pady=3, padx=5)
        
        tk.Label(frm, text="Tahmin:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=2, column=0, sticky="w", pady=3)
        self.sosyal_tahmin = tk.Entry(frm, width=50, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.sosyal_tahmin.grid(row=2, column=1, sticky="we", pady=3, padx=5)
        
        tk.Button(frm, text="ğŸ“¥ ANALÄ°ZDEN Ã‡EK", command=self.sosyal_analiz_cek,
                  bg="#007acc", fg="white").grid(row=3, column=1, sticky="w", pady=5, padx=5)
        
        frm.columnconfigure(1, weight=1)
        
        btn_frm = tk.Frame(tab, bg=self.theme["card_bg"])
        btn_frm.pack(pady=10)
        
        tk.Button(btn_frm, text="ğŸ“ PROMPT OLUÅTUR", command=self.sosyal_prompt_olustur,
                  bg="#28a745", fg="white", font=("Arial", 10, "bold")).pack(side="left", padx=5)
        tk.Button(btn_frm, text="ğŸ“‹ KOPYALA", command=self.sosyal_kopyala,
                  bg="#ff6600", fg="white").pack(side="left", padx=5)
        tk.Button(btn_frm, text="ğŸ“¤ TELEGRAM", command=self.sosyal_telegram_gonder,
                  bg="#0088cc", fg="white").pack(side="left", padx=5)
        
        tk.Label(tab, text="ğŸ“¤ Ã‡Ä±ktÄ±:", bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(anchor="w", padx=20)
        self.sosyal_sonuc = scrolledtext.ScrolledText(tab, height=14, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 10))
        self.sosyal_sonuc.pack(fill="both", expand=True, padx=20, pady=5)


# ============================================================
# PART 2 SONU - PART 3'E DEVAM
# ============================================================
# ============================================================
# PART 3/6 - YENÄ° SEKMELER (EXCEL â†’ AYARLAR)
# ============================================================
# Bu dosyayÄ± PART 2'nin SONUNA ekle
# ============================================================

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: EXCEL
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_excel(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ“Š EXCEL")
        
        tk.Label(tab, text="ğŸ“Š EXCEL OTOMATÄ°K DOLDURMA", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        if not EXCEL_AVAILABLE:
            tk.Label(tab, text="âš ï¸ openpyxl modÃ¼lÃ¼ yÃ¼klÃ¼ deÄŸil!\npip install openpyxl",
                     bg=self.theme["card_bg"], fg=self.theme["error"], font=("Arial", 12)).pack(pady=20)
            return
        
        frm_file = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_file.pack(fill="x", padx=20, pady=10)
        
        tk.Label(frm_file, text="Excel DosyasÄ±:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.entry_excel_path = tk.Entry(frm_file, width=50, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_excel_path.insert(0, EXCEL_FILE)
        self.entry_excel_path.pack(side="left", padx=5)
        tk.Button(frm_file, text="ğŸ“‚", command=self.excel_dosya_sec, bg=self.theme["button"], fg=self.theme["fg"]).pack(side="left")
        
        frm_btn = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_btn.pack(pady=10)
        
        tk.Button(frm_btn, text="ğŸ“¥ SON ANALÄ°ZÄ° EKLE", command=self.excel_ekle,
                  bg="#1d6f42", fg="white", font=("Arial", 11, "bold")).pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ“Š GÃœNÃœN HEPSÄ°NÄ° EKLE", command=self.excel_gunun_hepsini_ekle,
                  bg="#28a745", fg="white", font=("Arial", 11, "bold")).pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ“‚ EXCEL'Ä° AÃ‡", command=self.excel_ac,
                  bg="#007acc", fg="white", font=("Arial", 11)).pack(side="left", padx=5)
        
        tk.Label(tab, text="ğŸ“ Ä°ÅŸlem Logu:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(anchor="w", padx=20, pady=5)
        self.txt_excel_log = scrolledtext.ScrolledText(tab, height=15, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 10))
        self.txt_excel_log.pack(fill="both", expand=True, padx=20, pady=5)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: PUANLAYICI (HATA 7 - TÃœM VERÄ°LER)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_puanlayici(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ¯ PUANLAYICI")
        
        tk.Label(tab, text="ğŸ¯ YAPAY ZEKA MAÃ‡ PUANLAYICI", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        tk.Label(tab, text="85+ = ğŸ’ BANKO | 70-84 = âœ… Ä°YÄ° | 50-69 = âš ï¸ RÄ°SKLÄ° | <50 = âŒ UZAK DUR",
                 bg=self.theme["card_bg"], fg="gray").pack()
        
        # HATA 7 - MaÃ§ seÃ§ici eklendi
        frm_mac = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_mac.pack(fill="x", padx=20, pady=5)
        
        tk.Label(frm_mac, text="Analiz SeÃ§:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.combo_puan_mac = ttk.Combobox(frm_mac, width=45, state="readonly")
        self.combo_puan_mac.pack(side="left", padx=5)
        tk.Button(frm_mac, text="ğŸ”„", command=self.puan_maclari_yukle, bg=self.theme["button"], fg=self.theme["fg"]).pack(side="left")
        tk.Button(frm_mac, text="ğŸ“¥ VERÄ°LERÄ° Ã‡EK", command=self.puan_analiz_cek,
                  bg="#007acc", fg="white").pack(side="left", padx=10)
        
        # Manuel giriÅŸ
        frm_manuel = tk.LabelFrame(tab, text="ğŸ“Š Veri GiriÅŸi", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_manuel.pack(fill="x", padx=20, pady=10)
        
        frm_left = tk.Frame(frm_manuel, bg=self.theme["card_bg"])
        frm_left.pack(side="left", padx=20, pady=10)
        
        tk.Label(frm_left, text="xG Toplam:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=0, sticky="w")
        self.entry_puan_xg = tk.Entry(frm_left, width=10, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_puan_xg.grid(row=0, column=1, padx=5, pady=2)
        
        tk.Label(frm_left, text="Ev Atan %:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=1, column=0, sticky="w")
        self.entry_puan_ev_atan = tk.Entry(frm_left, width=10, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_puan_ev_atan.grid(row=1, column=1, padx=5, pady=2)
        
        tk.Label(frm_left, text="Dep Atan %:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=2, column=0, sticky="w")
        self.entry_puan_dep_atan = tk.Entry(frm_left, width=10, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_puan_dep_atan.grid(row=2, column=1, padx=5, pady=2)
        
        frm_right = tk.Frame(frm_manuel, bg=self.theme["card_bg"])
        frm_right.pack(side="left", padx=20, pady=10)
        
        tk.Label(frm_right, text="Ev Yiyen %:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=0, sticky="w")
        self.entry_puan_ev_yiyen = tk.Entry(frm_right, width=10, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_puan_ev_yiyen.grid(row=0, column=1, padx=5, pady=2)
        
        tk.Label(frm_right, text="Dep Yiyen %:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=1, column=0, sticky="w")
        self.entry_puan_dep_yiyen = tk.Entry(frm_right, width=10, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_puan_dep_yiyen.grid(row=1, column=1, padx=5, pady=2)
        
        tk.Label(frm_right, text="2.5Ãœ Ort %:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=2, column=0, sticky="w")
        self.entry_puan_ust25 = tk.Entry(frm_right, width=10, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_puan_ust25.grid(row=2, column=1, padx=5, pady=2)
        
        frm_btn = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_btn.pack(pady=10)
        
        tk.Button(frm_btn, text="ğŸ¯ PUANLA", command=self.mac_puanla,
                  bg="#ffd700", fg="black", font=("Arial", 12, "bold")).pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ“Š GÃœNÃœN TÃœM MAÃ‡LARINI PUANLA", command=self.gunun_maclarini_puanla,
                  bg="#28a745", fg="white", font=("Arial", 11)).pack(side="left", padx=5)
        
        self.txt_puan_sonuc = scrolledtext.ScrolledText(tab, height=14, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 11))
        self.txt_puan_sonuc.pack(fill="both", expand=True, padx=20, pady=10)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: SÄ°MÃœLATÃ–R (HATA 8 - GENÄ°ÅLETÄ°LMÄ°Å)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_simulator(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ® SÄ°MÃœLATÃ–R")
        
        tk.Label(tab, text="ğŸ® GELÄ°ÅMÄ°Å CANLI MAÃ‡ SÄ°MÃœLATÃ–RÃœ", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        tk.Label(tab, text="xG + Atan/Yiyen + Conversion + Lig Gol Ort ile 1000x simÃ¼lasyon",
                 bg=self.theme["card_bg"], fg="gray").pack()
        
        # HATA 8 - MaÃ§ seÃ§ici
        frm_mac = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_mac.pack(fill="x", padx=20, pady=5)
        
        tk.Label(frm_mac, text="Analiz SeÃ§:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.combo_sim_mac = ttk.Combobox(frm_mac, width=45, state="readonly")
        self.combo_sim_mac.pack(side="left", padx=5)
        tk.Button(frm_mac, text="ğŸ”„", command=self.sim_maclari_yukle, bg=self.theme["button"], fg=self.theme["fg"]).pack(side="left")
        tk.Button(frm_mac, text="ğŸ“¥ VERÄ°LERÄ° Ã‡EK", command=self.sim_analiz_cek,
                  bg="#007acc", fg="white").pack(side="left", padx=10)
        
        # HATA 8 - GeniÅŸletilmiÅŸ parametreler
        frm_input = tk.LabelFrame(tab, text="ğŸ“Š SimÃ¼lasyon Parametreleri", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_input.pack(fill="x", padx=20, pady=10)
        
        frm1 = tk.Frame(frm_input, bg=self.theme["card_bg"])
        frm1.pack(pady=5)
        
        tk.Label(frm1, text="Ev xG:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.entry_sim_ev_xg = tk.Entry(frm1, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_sim_ev_xg.insert(0, "1.50")
        self.entry_sim_ev_xg.pack(side="left", padx=3)
        
        tk.Label(frm1, text="Dep xG:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left", padx=5)
        self.entry_sim_dep_xg = tk.Entry(frm1, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_sim_dep_xg.insert(0, "1.20")
        self.entry_sim_dep_xg.pack(side="left", padx=3)
        
        tk.Label(frm1, text="Lig Gol Ort:", bg=self.theme["card_bg"], fg=self.theme["warning"]).pack(side="left", padx=5)
        self.entry_sim_lig_ort = tk.Entry(frm1, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_sim_lig_ort.insert(0, "2.50")
        self.entry_sim_lig_ort.pack(side="left", padx=3)
        
        tk.Label(frm1, text="SimÃ¼lasyon:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left", padx=5)
        self.entry_sim_count = tk.Entry(frm1, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_sim_count.insert(0, "1000")
        self.entry_sim_count.pack(side="left", padx=3)
        
        frm2 = tk.Frame(frm_input, bg=self.theme["card_bg"])
        frm2.pack(pady=5)
        
        tk.Label(frm2, text="Ev Atan %:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.entry_sim_ev_atan = tk.Entry(frm2, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_sim_ev_atan.insert(0, "70")
        self.entry_sim_ev_atan.pack(side="left", padx=3)
        
        tk.Label(frm2, text="Dep Atan %:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left", padx=5)
        self.entry_sim_dep_atan = tk.Entry(frm2, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_sim_dep_atan.insert(0, "70")
        self.entry_sim_dep_atan.pack(side="left", padx=3)
        
        tk.Label(frm2, text="Ev Yiyen %:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left", padx=5)
        self.entry_sim_ev_yiyen = tk.Entry(frm2, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_sim_ev_yiyen.insert(0, "50")
        self.entry_sim_ev_yiyen.pack(side="left", padx=3)
        
        tk.Label(frm2, text="Dep Yiyen %:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left", padx=5)
        self.entry_sim_dep_yiyen = tk.Entry(frm2, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_sim_dep_yiyen.insert(0, "50")
        self.entry_sim_dep_yiyen.pack(side="left", padx=3)
        
        frm3 = tk.Frame(frm_input, bg=self.theme["card_bg"])
        frm3.pack(pady=5)
        
        tk.Label(frm3, text="Conv Ev %:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.entry_sim_conv_ev = tk.Entry(frm3, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_sim_conv_ev.insert(0, "12")
        self.entry_sim_conv_ev.pack(side="left", padx=3)
        
        tk.Label(frm3, text="Conv Dep %:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left", padx=5)
        self.entry_sim_conv_dep = tk.Entry(frm3, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_sim_conv_dep.insert(0, "12")
        self.entry_sim_conv_dep.pack(side="left", padx=3)
        
        tk.Button(frm_input, text="ğŸ® SÄ°MÃœLASYON BAÅLAT", command=self.simulasyon_baslat,
                  bg="#6f42c1", fg="white", font=("Arial", 12, "bold")).pack(pady=10)
        
        self.txt_sim_sonuc = scrolledtext.ScrolledText(tab, height=12, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 11))
        self.txt_sim_sonuc.pack(fill="both", expand=True, padx=20, pady=5)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: ALARM
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_alarm(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ”” ALARM")
        
        tk.Label(tab, text="ğŸ”” ALARM SÄ°STEMÄ°", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        frm_yeni = tk.LabelFrame(tab, text="â• Yeni Alarm", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_yeni.pack(fill="x", padx=20, pady=10)
        
        frm = tk.Frame(frm_yeni, bg=self.theme["card_bg"])
        frm.pack(pady=10)
        
        tk.Label(frm, text="MaÃ§:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=0)
        self.entry_alarm_mac = tk.Entry(frm, width=30, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_alarm_mac.grid(row=0, column=1, padx=5)
        
        tk.Label(frm, text="Saat (HH:MM):", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=2)
        self.entry_alarm_saat = tk.Entry(frm, width=8, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_alarm_saat.grid(row=0, column=3, padx=5)
        
        tk.Label(frm, text="dk Ã¶nce:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=4)
        self.spin_alarm_dk = tk.Spinbox(frm, from_=5, to=60, width=5)
        self.spin_alarm_dk.delete(0, tk.END)
        self.spin_alarm_dk.insert(0, "30")
        self.spin_alarm_dk.grid(row=0, column=5, padx=5)
        
        tk.Button(frm, text="â• EKLE", command=self.alarm_ekle, bg="#28a745", fg="white").grid(row=0, column=6, padx=10)
        
        cols = ("mac", "saat", "hatirlatma", "durum")
        self.tree_alarm = ttk.Treeview(tab, columns=cols, show="headings", height=8)
        for c, w in [("mac", 250), ("saat", 80), ("hatirlatma", 100), ("durum", 100)]:
            self.tree_alarm.heading(c, text=c.upper())
            self.tree_alarm.column(c, width=w)
        self.tree_alarm.pack(fill="x", padx=20, pady=5)
        
        frm_btn = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_btn.pack(pady=5)
        tk.Button(frm_btn, text="ğŸ—‘ï¸ SÄ°L", command=self.alarm_sil, bg="#dc3545", fg="white").pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ”„ YENÄ°LE", command=self.alarm_listele, bg=self.theme["button"], fg=self.theme["fg"]).pack(side="left", padx=5)
        
        self.alarm_listele()
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: LABORATUVAR (HATA 9 - AÃ‡IKLAMALI)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_laboratuvar(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ”¬ LAB")
        
        tk.Label(tab, text="ğŸ”¬ KURAL LABORATUVARI", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        # HATA 9 - AÃ§Ä±klama eklendi
        aciklama = """
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’¡ NASIL Ã‡ALIÅIR?                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Kendi kuralÄ±nÄ± oluÅŸtur: "EÄER xG > 2.5 VE Conv > 12 VE 2.5Ãœ > 75 â†’ 2.5 ÃœST"   â”‚
â”‚  2. "KURALI TEST ET" dediÄŸinde geÃ§miÅŸ analizlerdeki maÃ§lara bu kuralÄ± uygular     â”‚
â”‚  3. KaÃ§ maÃ§ bu kurala uyuyor, kaÃ§Ä± KAZANDI, kaÃ§Ä± KAYBETTÄ° gÃ¶sterir                â”‚
â”‚  4. BaÅŸarÄ± %70+ ise "Bu kural Ã§alÄ±ÅŸÄ±yor!" der, sisteme ekleyebilirsin              â”‚
â”‚  âš ï¸ NOT: En az 10 sonuÃ§lu analiz lazÄ±m, yoksa test yapÄ±lamaz!                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
"""
        tk.Label(tab, text=aciklama, bg=self.theme["card_bg"], fg="gray", 
                 font=("Consolas", 9), justify="left").pack()
        
        frm_kural = tk.LabelFrame(tab, text="ğŸ“ Kural TanÄ±mla", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_kural.pack(fill="x", padx=20, pady=10)
        
        frm = tk.Frame(frm_kural, bg=self.theme["card_bg"])
        frm.pack(pady=10)
        
        tk.Label(frm, text="EÄER", bg=self.theme["card_bg"], fg=self.theme["warning"], font=("Arial", 10, "bold")).grid(row=0, column=0)
        
        tk.Label(frm, text="xG >", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=1, padx=5)
        self.entry_lab_xg = tk.Entry(frm, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_lab_xg.insert(0, "2.50")
        self.entry_lab_xg.grid(row=0, column=2)
        
        tk.Label(frm, text="VE Conv >", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=3, padx=5)
        self.entry_lab_conv = tk.Entry(frm, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_lab_conv.insert(0, "12")
        self.entry_lab_conv.grid(row=0, column=4)
        
        tk.Label(frm, text="VE 2.5Ãœ >", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=5, padx=5)
        self.entry_lab_ust = tk.Entry(frm, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_lab_ust.insert(0, "55")
        self.entry_lab_ust.grid(row=0, column=6)
        
        tk.Label(frm, text="â†’ BAHÄ°S:", bg=self.theme["card_bg"], fg=self.theme["success"], font=("Arial", 10, "bold")).grid(row=0, column=7, padx=10)
        self.combo_lab_bahis = ttk.Combobox(frm, values=["MS 2.5 ÃœST", "MS 1.5 ÃœST", "KG VAR", "MS 3.5 ÃœST"], width=12)
        self.combo_lab_bahis.set("MS 2.5 ÃœST")
        self.combo_lab_bahis.grid(row=0, column=8)
        
        frm_btn = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_btn.pack(pady=10)
        
        tk.Button(frm_btn, text="ğŸ§ª TEST ET", command=self.lab_kural_test,
                  bg="#6f42c1", fg="white", font=("Arial", 11, "bold")).pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ’¾ KAYDET", command=self.lab_kural_kaydet,
                  bg="#28a745", fg="white").pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ“‹ KAYITLILAR", command=self.lab_kurallari_listele,
                  bg="#17a2b8", fg="white").pack(side="left", padx=5)
        
        self.txt_lab_sonuc = scrolledtext.ScrolledText(tab, height=12, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 11))
        self.txt_lab_sonuc.pack(fill="both", expand=True, padx=20, pady=10)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: GÄ°ZLÄ° HAZÄ°NE (HATA 10 - GÃœNCELLE)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_hazine(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ HAZÄ°NE")
        
        tk.Label(tab, text="ğŸ GÄ°ZLÄ° HAZÄ°NE MODU", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        tk.Label(tab, text="Kimsenin bakmadÄ±ÄŸÄ± kÃ¼Ã§Ã¼k liglerde deÄŸer bahisler bul!",
                 bg=self.theme["card_bg"], fg="gray").pack()
        
        frm_ligler = tk.LabelFrame(tab, text="ğŸ’ Gizli Hazine Ligleri", bg=self.theme["card_bg"], fg=self.theme["warning"])
        frm_ligler.pack(fill="x", padx=20, pady=10)
        
        cols = ("lig", "gol_ort", "kg_oran", "bahisci_basari", "senin_basari", "firsat")
        self.tree_hazine = ttk.Treeview(frm_ligler, columns=cols, show="headings", height=8)
        for c, w in [("lig", 150), ("gol_ort", 70), ("kg_oran", 70), ("bahisci_basari", 100), ("senin_basari", 100), ("firsat", 80)]:
            self.tree_hazine.heading(c, text=c.upper().replace("_", " "))
            self.tree_hazine.column(c, width=w)
        self.tree_hazine.pack(fill="x", padx=10, pady=5)
        
        # HATA 10 - GÃ¼ncelle butonu
        frm_btn = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_btn.pack(pady=5)
        tk.Button(frm_btn, text="ğŸ”„ VERÄ°LERÄ° GÃœNCELLE", command=self.hazine_guncelle,
                  bg="#ff6600", fg="white", font=("Arial", 10, "bold")).pack(side="left", padx=5)
        
        self.hazine_listele()
        
        frm_analiz = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_analiz.pack(fill="x", padx=20, pady=5)
        
        tk.Label(frm_analiz, text="Lig SeÃ§:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.combo_hazine_lig = ttk.Combobox(frm_analiz, values=list(GIZLI_HAZINE_LIGLERI.keys()), width=25)
        self.combo_hazine_lig.pack(side="left", padx=5)
        tk.Button(frm_analiz, text="ğŸ” ANALÄ°Z", command=self.hazine_analiz,
                  bg="#ffd700", fg="black", font=("Arial", 10, "bold")).pack(side="left", padx=10)
        
        self.txt_hazine_sonuc = scrolledtext.ScrolledText(tab, height=8, bg="#0a0a0a", fg="#ffd700", font=("Consolas", 11))
        self.txt_hazine_sonuc.pack(fill="both", expand=True, padx=20, pady=5)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: GÃ–RSEL (YENÄ° HÄ°BRÄ°T SÄ°STEM)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_gorsel(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ¨ GÃ–RSEL")
        
        tk.Label(tab, text="ğŸ¨ PROFESYONEL GÃ–RSEL OLUÅTURUCU", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ÃœST PANEL - MaÃ§ SeÃ§imi
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_mac = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_mac.pack(fill="x", padx=20, pady=5)
        
        tk.Label(frm_mac, text="ğŸ“‹ MaÃ§:", bg=self.theme["card_bg"], 
                fg=self.theme["fg"]).pack(side="left", padx=5)
        self.combo_gorsel_mac = ttk.Combobox(frm_mac, width=45)
        self.combo_gorsel_mac.pack(side="left", padx=5)
        self._gorsel_maclari_yukle()
        
        tk.Button(frm_mac, text="ğŸ“¥ ANALÄ°ZDEN Ã‡EK", command=self.gorsel_analiz_cek,
                  bg="#007acc", fg="white", relief="flat").pack(side="left", padx=10)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ÅABLON SEÃ‡Ä°MÄ° - 3 MOD
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_modlar = tk.LabelFrame(tab, text="ğŸ­ ÅABLON SEÃ‡Ä°MÄ°", bg=self.theme["card_bg"], 
                                   fg=self.theme["accent"])
        frm_modlar.pack(fill="x", padx=20, pady=10)
        
        self.gorsel_mod = tk.StringVar(value="prediction")
        
        mod_frame = tk.Frame(frm_modlar, bg=self.theme["card_bg"])
        mod_frame.pack(pady=10)
        
        # VS Mode
        frm_vs = tk.Frame(mod_frame, bg="#1a1a2e", padx=15, pady=10, relief="ridge", bd=2)
        frm_vs.pack(side="left", padx=10)
        tk.Radiobutton(frm_vs, text="ğŸ† VS MODE", variable=self.gorsel_mod, value="vs",
                      bg="#1a1a2e", fg="#00ff00", selectcolor="#0a0a1a", 
                      font=("Arial", 11, "bold")).pack()
        tk.Label(frm_vs, text="TakÄ±m vs TakÄ±m\nLogolar + Renkler", bg="#1a1a2e", 
                fg="gray", font=("Arial", 9)).pack()
        
        # Prediction Mode
        frm_pred = tk.Frame(mod_frame, bg="#1a1a2e", padx=15, pady=10, relief="ridge", bd=2)
        frm_pred.pack(side="left", padx=10)
        tk.Radiobutton(frm_pred, text="ğŸ”¥ TAHMÄ°N MODE", variable=self.gorsel_mod, value="prediction",
                      bg="#1a1a2e", fg="#ff6600", selectcolor="#0a0a1a",
                      font=("Arial", 11, "bold")).pack()
        tk.Label(frm_pred, text="BÃ¼yÃ¼k Tahmin\nNeon Efekt", bg="#1a1a2e", 
                fg="gray", font=("Arial", 9)).pack()
        
        # Stats Mode
        frm_stats = tk.Frame(mod_frame, bg="#1a1a2e", padx=15, pady=10, relief="ridge", bd=2)
        frm_stats.pack(side="left", padx=10)
        tk.Radiobutton(frm_stats, text="ğŸ“Š STATS MODE", variable=self.gorsel_mod, value="stats",
                      bg="#1a1a2e", fg="#00ffff", selectcolor="#0a0a1a",
                      font=("Arial", 11, "bold")).pack()
        tk.Label(frm_stats, text="xG + Ä°statistik\nProgress Barlar", bg="#1a1a2e", 
                fg="gray", font=("Arial", 9)).pack()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # AYARLAR
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_ayar = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_ayar.pack(fill="x", padx=20, pady=5)
        
        tk.Label(frm_ayar, text="Boyut:", bg=self.theme["card_bg"], 
                fg=self.theme["fg"]).pack(side="left", padx=5)
        self.combo_gorsel_boyut = ttk.Combobox(frm_ayar, values=[
            "Instagram Post (1080x1350)",
            "Instagram Story (1080x1920)",
            "Twitter Post (1200x675)",
            "Kare (1080x1080)"
        ], width=22)
        self.combo_gorsel_boyut.set("Instagram Post (1080x1350)")
        self.combo_gorsel_boyut.pack(side="left", padx=5)
        
        tk.Label(frm_ayar, text="Efekt:", bg=self.theme["card_bg"], 
                fg=self.theme["fg"]).pack(side="left", padx=10)
        self.combo_gorsel_efekt = ttk.Combobox(frm_ayar, values=[
            "ğŸ”¥ Neon Glow",
            "ğŸ’ Metalik",
            "âš¡ Elektrik",
            "ğŸŒŸ AltÄ±n"
        ], width=15)
        self.combo_gorsel_efekt.set("ğŸ”¥ Neon Glow")
        self.combo_gorsel_efekt.pack(side="left", padx=5)
        
        # Checkbox'lar
        frm_check = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_check.pack(fill="x", padx=20, pady=5)
        
        self.var_gorsel_logo = tk.BooleanVar(value=True)
        self.var_gorsel_vignette = tk.BooleanVar(value=True)
        self.var_gorsel_scanlines = tk.BooleanVar(value=True)
        self.var_gorsel_gradient = tk.BooleanVar(value=True)
        
        tk.Checkbutton(frm_check, text="ğŸ† TakÄ±m LogolarÄ±", variable=self.var_gorsel_logo,
                      bg=self.theme["card_bg"], fg=self.theme["fg"], 
                      selectcolor=self.theme["entry_bg"]).pack(side="left", padx=10)
        tk.Checkbutton(frm_check, text="ğŸŒ‘ Vignette", variable=self.var_gorsel_vignette,
                      bg=self.theme["card_bg"], fg=self.theme["fg"],
                      selectcolor=self.theme["entry_bg"]).pack(side="left", padx=10)
        tk.Checkbutton(frm_check, text="ğŸ“º Scanlines", variable=self.var_gorsel_scanlines,
                      bg=self.theme["card_bg"], fg=self.theme["fg"],
                      selectcolor=self.theme["entry_bg"]).pack(side="left", padx=10)
        tk.Checkbutton(frm_check, text="ğŸ¨ TakÄ±m Renkleri", variable=self.var_gorsel_gradient,
                      bg=self.theme["card_bg"], fg=self.theme["fg"],
                      selectcolor=self.theme["entry_bg"]).pack(side="left", padx=10)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BUTONLAR
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_btn = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_btn.pack(pady=10)
        
        tk.Button(frm_btn, text="ğŸ¨ HIZLI OLUÅTUR", command=self.gorsel_olustur_v2,
                  bg="#28a745", fg="white", font=("Arial", 11, "bold"), 
                  relief="flat", padx=15).pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ¤– AI ARKA PLAN", command=self.gorsel_ai_arkaplan,
                  bg="#9933ff", fg="white", font=("Arial", 11, "bold"),
                  relief="flat", padx=15).pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ’¾ KAYDET", command=self.gorsel_kaydet,
                  bg="#2b5797", fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ“¤ TELEGRAM", command=self.gorsel_telegram_gonder,
                  bg="#0088cc", fg="white", relief="flat").pack(side="left", padx=5)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # Ã–NÄ°ZLEME
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.frm_gorsel_onizleme = tk.Frame(tab, bg="#0a0a0a", width=450, height=500)
        self.frm_gorsel_onizleme.pack(pady=10)
        self.frm_gorsel_onizleme.pack_propagate(False)
        
        self.lbl_gorsel_onizleme = tk.Label(self.frm_gorsel_onizleme, text="ğŸ“· Ã–nizleme\n\nMaÃ§ seÃ§ip OLUÅTUR'a tÄ±klayÄ±n",
                                            bg="#0a0a0a", fg="gray", font=("Arial", 12))
        self.lbl_gorsel_onizleme.pack(expand=True)
        
        self.gorsel_image = None
        self.gorsel_pil_image = None
    
    def _gorsel_maclari_yukle(self):
        """Analiz edilmiÅŸ maÃ§larÄ± dropdown'a yÃ¼kle"""
        if hasattr(self, 'combo_gorsel_mac'):
            maclar = [f"{m.get('tarih', '')} - {m.get('mac', m.get('mac_adi', ''))}" for m in self.mac_db[-30:]]
            self.combo_gorsel_mac["values"] = maclar
            if maclar:
                self.combo_gorsel_mac.set(maclar[-1])
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: ORANLAR - DETAYLI ARÅÄ°V (YENÄ°!)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_oranlar(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ“ˆ ORANLAR")
        
        tk.Label(tab, text="ğŸ“ˆ DETAYLI ARÅÄ°V & ORAN TAKÄ°P", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=5)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ÃœST KISIM - FÄ°LTRE VE BUTONLAR
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_top = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_top.pack(fill="x", padx=10, pady=5)
        
        tk.Label(frm_top, text="Tarih:", bg=self.theme["card_bg"], fg="gray").pack(side="left")
        self.entry_arsiv_tarih = tk.Entry(frm_top, width=12, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_arsiv_tarih.pack(side="left", padx=5)
        
        tk.Label(frm_top, text="Filtre:", bg=self.theme["card_bg"], fg="gray").pack(side="left", padx=5)
        self.combo_arsiv_filtre = ttk.Combobox(frm_top, values=["TÃ¼mÃ¼", "KAZANDI", "KAYBETTÄ°", "BEKLÄ°YOR"], width=10)
        self.combo_arsiv_filtre.set("TÃ¼mÃ¼")
        self.combo_arsiv_filtre.pack(side="left", padx=5)
        
        tk.Button(frm_top, text="ğŸ”„ GÃœNCELLE", command=self.detayli_arsiv_guncelle,
                  bg="#ff6600", fg="white", font=("Arial", 9, "bold")).pack(side="left", padx=10)
        
        tk.Button(frm_top, text="ğŸ“Š PERFORMANS", command=self.oran_performans_goster,
                  bg="#9933ff", fg="white", font=("Arial", 9, "bold")).pack(side="left", padx=5)
        
        tk.Button(frm_top, text="ğŸ“¤ EXCEL", command=self.arsiv_excel_aktar,
                  bg="#28a745", fg="white", font=("Arial", 9)).pack(side="left", padx=5)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ANA TABLO - DETAYLI ARÅÄ°V
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_tablo = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_tablo.pack(fill="both", expand=True, padx=10, pady=5)
        
        # SÃ¼tunlar
        columns = ("tarih", "mac", "lig", "banko", "guven", "skor", "sonuc", 
                   "oran_ms1", "oran_x", "oran_ms2", "oran_05u", "oran_15u", "oran_25u", "oran_35u", "oran_45u", "oran_kg")
        
        # Yatay ve dikey scrollbar
        frm_tree = tk.Frame(frm_tablo, bg=self.theme["card_bg"])
        frm_tree.pack(fill="both", expand=True)
        
        scroll_y = tk.Scrollbar(frm_tree, orient="vertical")
        scroll_y.pack(side="right", fill="y")
        
        scroll_x = tk.Scrollbar(frm_tree, orient="horizontal")
        scroll_x.pack(side="bottom", fill="x")
        
        # TABLO STÄ°LÄ° - DAHA OKUNUR VE KALIN YAZI (V5.6)
        style = ttk.Style()
        style.configure("Detayli.Treeview",
                       background="#1a1a1a",
                       foreground="#ffffff",
                       fieldbackground="#1a1a1a",
                       font=("Segoe UI", 11, "bold"),
                       rowheight=28)
        style.configure("Detayli.Treeview.Heading",
                       background="#333333",
                       foreground="#00ff00",
                       font=("Segoe UI", 10, "bold"))
        style.map("Detayli.Treeview",
                 background=[("selected", "#004400")],
                 foreground=[("selected", "#ffffff")])
        
        self.tree_detayli = ttk.Treeview(frm_tree, columns=columns, show="headings", height=15,
                                          yscrollcommand=scroll_y.set, xscrollcommand=scroll_x.set,
                                          style="Detayli.Treeview")
        self.tree_detayli.pack(fill="both", expand=True)
        
        scroll_y.config(command=self.tree_detayli.yview)
        scroll_x.config(command=self.tree_detayli.xview)
        
        # SÃ¼tun baÅŸlÄ±klarÄ± ve geniÅŸlikleri - GENÄ°ÅLETÄ°LMÄ°Å
        headers = {
            "tarih": ("TARÄ°H", 85),
            "mac": ("MAÃ‡", 200),
            "lig": ("LÄ°G", 120),
            "banko": ("BANKO", 120),
            "guven": ("GÃœV", 40),
            "skor": ("SKOR", 55),
            "sonuc": ("SONUÃ‡", 120),
            "oran_ms1": ("MS1", 60),
            "oran_x": ("X", 60),
            "oran_ms2": ("MS2", 60),
            "oran_05u": ("0.5Ãœ", 60),
            "oran_15u": ("1.5Ãœ", 60),
            "oran_25u": ("2.5Ãœ", 60),
            "oran_35u": ("3.5Ãœ", 60),
            "oran_45u": ("4.5Ãœ", 60),
            "oran_kg": ("KG", 60)
        }
        
        for col, (text, width) in headers.items():
            self.tree_detayli.heading(col, text=text)
            self.tree_detayli.column(col, width=width, anchor="center")
        
        # Ã‡ift tÄ±klama ile dÃ¼zenleme
        self.tree_detayli.bind("<Double-1>", self.detayli_arsiv_duzenle)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ALT KISIM - ORAN GÄ°RÄ°ÅÄ° VE PERFORMANS
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_alt = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_alt.pack(fill="x", padx=10, pady=5)
        
        # Sol - Oran giriÅŸi
        frm_oran_giris = tk.LabelFrame(frm_alt, text="ğŸ’° ORAN GÄ°RÄ°ÅÄ° (SeÃ§ili MaÃ§)", 
                                        bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_oran_giris.pack(side="left", fill="both", expand=True, padx=5)
        
        frm_oranlar = tk.Frame(frm_oran_giris, bg=self.theme["card_bg"])
        frm_oranlar.pack(pady=5)
        
        # Oran entry'leri
        oran_labels = [("MS1:", "oran_ms1"), ("X:", "oran_x"), ("MS2:", "oran_ms2"), 
                       ("0.5Ãœ:", "oran_05u"), ("1.5Ãœ:", "oran_15u"), ("2.5Ãœ:", "oran_25u"), 
                       ("3.5Ãœ:", "oran_35u"), ("4.5Ãœ:", "oran_45u"), ("KG:", "oran_kg")]
        
        self.oran_entries = {}
        for i, (label, key) in enumerate(oran_labels):
            tk.Label(frm_oranlar, text=label, bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=i*2, padx=2)
            entry = tk.Entry(frm_oranlar, width=6, bg=self.theme["entry_bg"], fg=self.theme["fg"])
            entry.grid(row=0, column=i*2+1, padx=2)
            self.oran_entries[key] = entry
        
        frm_skor = tk.Frame(frm_oran_giris, bg=self.theme["card_bg"])
        frm_skor.pack(pady=5)
        
        tk.Label(frm_skor, text="SKOR:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(side="left")
        self.entry_arsiv_skor = tk.Entry(frm_skor, width=8, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_arsiv_skor.pack(side="left", padx=5)
        
        tk.Button(frm_skor, text="ğŸ’¾ KAYDET", command=self.detayli_arsiv_kaydet,
                  bg="#28a745", fg="white").pack(side="left", padx=10)
        
        tk.Button(frm_skor, text="ğŸ”„ OTOMATÄ°K KONTROL", command=self.detayli_arsiv_otomatik_kontrol,
                  bg="#007acc", fg="white").pack(side="left", padx=5)
        
        # SaÄŸ - Performans Ã¶zeti
        frm_perf = tk.LabelFrame(frm_alt, text="ğŸ“Š ORAN PERFORMANSI", 
                                  bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_perf.pack(side="right", fill="both", expand=True, padx=5)
        
        self.txt_oran_perf = tk.Text(frm_perf, height=6, width=50, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 9))
        self.txt_oran_perf.pack(fill="both", expand=True, padx=5, pady=5)
        
        # Ä°lk yÃ¼kleme
        self.root.after(500, self.detayli_arsiv_guncelle)
    
    def detayli_arsiv_guncelle(self):
        """DetaylÄ± arÅŸiv tablosunu gÃ¼ncelle - V5.6 KAZANAN ORANLAR BELÄ°RGÄ°N"""
        # tree_detayli yoksa Ã§Ä±k
        if not hasattr(self, 'tree_detayli'):
            return
            
        # Tabloyu temizle
        for item in self.tree_detayli.get_children():
            self.tree_detayli.delete(item)
        
        # Filtreler - widget varsa kullan, yoksa varsayÄ±lan
        tarih_filtre = ""
        sonuc_filtre = "TÃ¼mÃ¼"
        if hasattr(self, 'entry_arsiv_tarih'):
            tarih_filtre = self.entry_arsiv_tarih.get().strip()
        if hasattr(self, 'combo_arsiv_filtre'):
            sonuc_filtre = self.combo_arsiv_filtre.get()
        
        for mac in reversed(self.mac_db[-200:]):  # Son 200 maÃ§
            tarih = mac.get("tarih", "?")
            
            # Tarih filtresi
            if tarih_filtre and tarih_filtre not in tarih:
                continue
            
            # SonuÃ§
            skor = mac.get("skor", "")
            sonuc = mac.get("sonuc", "BEKLÄ°YOR")
            
            # SonuÃ§ filtresi
            if sonuc_filtre != "TÃ¼mÃ¼" and sonuc != sonuc_filtre:
                continue
            
            mac_adi = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")[:25]
            lig = mac.get("lig", "?")[:15]
            banko = mac.get("banko", "?")[:15]
            guven = mac.get("guven", "?")
            
            # Oranlar - tÃ¼mÃ¼
            oran_ms1 = mac.get("oran_ms1", mac.get("oran", "-"))
            oran_x = mac.get("oran_x", "-")
            oran_ms2 = mac.get("oran_ms2", "-")
            oran_05u = mac.get("oran_05u", "-")
            oran_15u = mac.get("oran_15u", "-")
            oran_25u = mac.get("oran_25u", "-")
            oran_35u = mac.get("oran_35u", "-")
            oran_45u = mac.get("oran_45u", "-")
            oran_kg = mac.get("oran_kg", "-")
            
            # KAZANAN ORANLARI BELÄ°RLE (skor varsa)
            kazanan_oranlar = []
            if skor and "-" in skor:
                try:
                    ev_gol, dep_gol = map(int, skor.split("-"))
                    toplam_gol = ev_gol + dep_gol
                    
                    # MS sonucu
                    if ev_gol > dep_gol:
                        kazanan_oranlar.append("MS1")
                        oran_ms1 = f"âœ… {oran_ms1}"
                    elif dep_gol > ev_gol:
                        kazanan_oranlar.append("MS2")
                        oran_ms2 = f"âœ… {oran_ms2}"
                    else:
                        kazanan_oranlar.append("X")
                        oran_x = f"âœ… {oran_x}"
                        sonuc = "X KAZANDI"  # Beraberlik sonucu
                    
                    # Gol Ã¼stleri
                    if toplam_gol > 0:
                        oran_05u = f"âœ… {oran_05u}"
                        kazanan_oranlar.append("0.5Ãœ")
                    if toplam_gol > 1:
                        oran_15u = f"âœ… {oran_15u}"
                        kazanan_oranlar.append("1.5Ãœ")
                    if toplam_gol > 2:
                        oran_25u = f"âœ… {oran_25u}"
                        kazanan_oranlar.append("2.5Ãœ")
                    if toplam_gol > 3:
                        oran_35u = f"âœ… {oran_35u}"
                        kazanan_oranlar.append("3.5Ãœ")
                    if toplam_gol > 4:
                        oran_45u = f"âœ… {oran_45u}"
                        kazanan_oranlar.append("4.5Ãœ")
                    
                    # KG VAR
                    if ev_gol > 0 and dep_gol > 0:
                        oran_kg = f"âœ… {oran_kg}"
                        kazanan_oranlar.append("KG")
                except:
                    pass
            
            # SonuÃ§ metnini gÃ¼ncelle
            if skor and sonuc == "BEKLÄ°YOR":
                sonuc = "âœ… " + ", ".join(kazanan_oranlar[:3]) if kazanan_oranlar else "BELÄ°RLENMEDÄ°"
            
            # Renk belirleme - DAHA AÃ‡IK VE OKUNUR RENKLER
            tag = ""
            if sonuc == "KAZANDI" or "âœ…" in sonuc:
                tag = "kazandi"
            elif sonuc == "KAYBETTÄ°":
                tag = "kaybetti"
            elif "X KAZANDI" in sonuc:
                tag = "beraberlik"
            elif skor:
                tag = "skorlu"
            
            self.tree_detayli.insert("", "end", values=(
                tarih, mac_adi, lig, banko, guven, skor, sonuc,
                oran_ms1, oran_x, oran_ms2, oran_05u, oran_15u, oran_25u, oran_35u, oran_45u, oran_kg
            ), tags=(tag,))
        
        # RENKLENDÄ°RME - DAHA AÃ‡IK VE KALIN
        self.tree_detayli.tag_configure("kazandi", background="#0a4d0a", foreground="#00ff00", font=("Segoe UI", 10, "bold"))
        self.tree_detayli.tag_configure("kaybetti", background="#4d0a0a", foreground="#ff6666", font=("Segoe UI", 10, "bold"))
        self.tree_detayli.tag_configure("beraberlik", background="#0a0a4d", foreground="#66ff66", font=("Segoe UI", 10, "bold"))
        self.tree_detayli.tag_configure("skorlu", background="#2d2d00", foreground="#ffff00", font=("Segoe UI", 10, "bold"))
        
        # Performans gÃ¼ncelle
        self.oran_performans_hesapla()
    
    def detayli_arsiv_duzenle(self, event):
        """SeÃ§ili maÃ§Ä± dÃ¼zenle"""
        if not hasattr(self, 'tree_detayli') or not hasattr(self, 'oran_entries'):
            return
            
        selected = self.tree_detayli.selection()
        if not selected:
            return
        
        item = self.tree_detayli.item(selected[0])
        values = item["values"]
        
        if len(values) >= 13:
            # Entry'leri doldur
            if "oran_ms1" in self.oran_entries:
                self.oran_entries["oran_ms1"].delete(0, tk.END)
                self.oran_entries["oran_ms1"].insert(0, values[7] if values[7] != "-" else "")
            
            if "oran_x" in self.oran_entries:
                self.oran_entries["oran_x"].delete(0, tk.END)
                self.oran_entries["oran_x"].insert(0, values[8] if values[8] != "-" else "")
            
            if "oran_ms2" in self.oran_entries:
                self.oran_entries["oran_ms2"].delete(0, tk.END)
                self.oran_entries["oran_ms2"].insert(0, values[9] if values[9] != "-" else "")
            
            if "oran_25u" in self.oran_entries:
                self.oran_entries["oran_25u"].delete(0, tk.END)
                self.oran_entries["oran_25u"].insert(0, values[10] if values[10] != "-" else "")
            
            if "oran_35u" in self.oran_entries:
                self.oran_entries["oran_35u"].delete(0, tk.END)
                self.oran_entries["oran_35u"].insert(0, values[11] if values[11] != "-" else "")
            
            if "oran_kg" in self.oran_entries:
                self.oran_entries["oran_kg"].delete(0, tk.END)
                self.oran_entries["oran_kg"].insert(0, values[12] if values[12] != "-" else "")
            
            if hasattr(self, 'entry_arsiv_skor'):
                self.entry_arsiv_skor.delete(0, tk.END)
                self.entry_arsiv_skor.insert(0, values[5] if values[5] else "")
    
    def detayli_arsiv_kaydet(self):
        """SeÃ§ili maÃ§Ä±n oranlarÄ±nÄ± ve skorunu kaydet - V5.6 DÃœZELTÄ°LDÄ°"""
        if not hasattr(self, 'tree_detayli'):
            return
            
        selected = self.tree_detayli.selection()
        if not selected:
            messagebox.showwarning("UyarÄ±", "LÃ¼tfen bir maÃ§ seÃ§in!")
            return
        
        item = self.tree_detayli.item(selected[0])
        values = item["values"]
        tablo_tarih = str(values[0])
        tablo_mac = str(values[1])
        
        # MaÃ§Ä± bul - TARÄ°H + MAÃ‡ ADI ile eÅŸleÅŸtir
        bulunan = False
        for mac in self.mac_db:
            mac_tarih = mac.get("tarih", "")
            mac_adi_tam = mac.get("mac", mac.get("mac_adi", "")).replace("_", " ")
            mac_adi_kisa = mac_adi_tam[:25]
            
            # Tarih + kÄ±saltÄ±lmÄ±ÅŸ ad eÅŸleÅŸmesi
            if mac_tarih == tablo_tarih and mac_adi_kisa == tablo_mac:
                bulunan = True
                
                # OranlarÄ± kaydet
                for key, entry in self.oran_entries.items():
                    val = entry.get().strip()
                    if val:
                        try:
                            mac[key] = float(val.replace(",", "."))
                        except:
                            mac[key] = val
                
                # Skoru kaydet
                skor = self.entry_arsiv_skor.get().strip() if hasattr(self, "entry_arsiv_skor") else ""
                if skor:
                    mac["skor"] = skor
                    # Otomatik kontrol et
                    self._kontrol_bahisler(mac, skor)
                
                self.db_kaydet()
                self.detayli_arsiv_guncelle()
                messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… Kaydedildi!\nSkor: {skor}")
                return
        
        if not bulunan:
            # Alternatif arama - sadece maÃ§ adÄ± ile
            for mac in self.mac_db:
                mac_adi_tam = mac.get("mac", mac.get("mac_adi", "")).replace("_", " ")
                if tablo_mac in mac_adi_tam or mac_adi_tam[:25] == tablo_mac:
                    bulunan = True
                    
                    # OranlarÄ± kaydet
                    for key, entry in self.oran_entries.items():
                        val = entry.get().strip()
                        if val:
                            try:
                                mac[key] = float(val.replace(",", "."))
                            except:
                                mac[key] = val
                    
                    # Skoru kaydet
                    skor = self.entry_arsiv_skor.get().strip() if hasattr(self, "entry_arsiv_skor") else ""
                    if skor:
                        mac["skor"] = skor
                        self._kontrol_bahisler(mac, skor)
                    
                    self.db_kaydet()
                    self.detayli_arsiv_guncelle()
                    messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… Kaydedildi!\nSkor: {skor}")
                    return
        
        messagebox.showerror("Hata", f"MaÃ§ bulunamadÄ±!\nAranan: {tablo_mac}")
    
    def _kontrol_bahisler(self, mac, skor):
        """Skor'a gÃ¶re bahislerin tutup tutmadÄ±ÄŸÄ±nÄ± kontrol et - V5.6 GELÄ°ÅTÄ°RÄ°LDÄ°"""
        try:
            if "-" in skor:
                ev_gol, dep_gol = map(int, skor.split("-"))
                toplam_gol = ev_gol + dep_gol
                
                # MS Sonucu
                if ev_gol > dep_gol:
                    mac["tuttu_ms"] = "1"
                    mac["sonuc_ms"] = "MS1 KAZANDI"
                elif dep_gol > ev_gol:
                    mac["tuttu_ms"] = "2"
                    mac["sonuc_ms"] = "MS2 KAZANDI"
                else:
                    mac["tuttu_ms"] = "X"
                    mac["sonuc_ms"] = "X KAZANDI"
                
                # Gol Ã¼stleri
                mac["tuttu_05u"] = "âœ…" if toplam_gol > 0 else "âŒ"
                mac["tuttu_15u"] = "âœ…" if toplam_gol > 1 else "âŒ"
                mac["tuttu_25u"] = "âœ…" if toplam_gol > 2 else "âŒ"
                mac["tuttu_35u"] = "âœ…" if toplam_gol > 3 else "âŒ"
                mac["tuttu_45u"] = "âœ…" if toplam_gol > 4 else "âŒ"
                
                # KG VAR
                mac["tuttu_kg"] = "âœ…" if (ev_gol > 0 and dep_gol > 0) else "âŒ"
                
                # KAZANAN ORANLAR LÄ°STESÄ°
                kazananlar = []
                if mac["tuttu_ms"] == "1":
                    kazananlar.append("MS1")
                elif mac["tuttu_ms"] == "2":
                    kazananlar.append("MS2")
                else:
                    kazananlar.append("X")
                
                if toplam_gol > 0: kazananlar.append("0.5Ãœ")
                if toplam_gol > 1: kazananlar.append("1.5Ãœ")
                if toplam_gol > 2: kazananlar.append("2.5Ãœ")
                if toplam_gol > 3: kazananlar.append("3.5Ãœ")
                if ev_gol > 0 and dep_gol > 0: kazananlar.append("KG")
                
                mac["kazanan_oranlar"] = ", ".join(kazananlar)
                
                # BANKO sonucu kontrol
                banko = mac.get("banko", "").upper()
                
                # 0.5 Ãœst kontrolÃ¼
                if "0.5" in banko and "ÃœST" in banko:
                    mac["sonuc"] = "KAZANDI" if toplam_gol > 0 else "KAYBETTÄ°"
                # 1.5 Ãœst kontrolÃ¼
                elif "1.5" in banko and "ÃœST" in banko:
                    mac["sonuc"] = "KAZANDI" if toplam_gol > 1 else "KAYBETTÄ°"
                # 2.5 Ãœst kontrolÃ¼
                elif "2.5" in banko and "ÃœST" in banko:
                    mac["sonuc"] = "KAZANDI" if toplam_gol > 2 else "KAYBETTÄ°"
                # 3.5 Ãœst kontrolÃ¼
                elif "3.5" in banko and "ÃœST" in banko:
                    mac["sonuc"] = "KAZANDI" if toplam_gol > 3 else "KAYBETTÄ°"
                # KG VAR kontrolÃ¼
                elif "KG VAR" in banko or "KG-VAR" in banko:
                    mac["sonuc"] = "KAZANDI" if (ev_gol > 0 and dep_gol > 0) else "KAYBETTÄ°"
                # KG YOK kontrolÃ¼
                elif "KG YOK" in banko or "KG-YOK" in banko:
                    mac["sonuc"] = "KAZANDI" if not (ev_gol > 0 and dep_gol > 0) else "KAYBETTÄ°"
                # MS1 kontrolÃ¼
                elif "MS1" in banko or "MS 1" in banko or ("EV" in banko and "KAZANIR" in banko):
                    mac["sonuc"] = "KAZANDI" if ev_gol > dep_gol else "KAYBETTÄ°"
                # MS2 kontrolÃ¼
                elif "MS2" in banko or "MS 2" in banko or ("DEP" in banko and "KAZANIR" in banko):
                    mac["sonuc"] = "KAZANDI" if dep_gol > ev_gol else "KAYBETTÄ°"
                # Genel KAZANIR kontrolÃ¼
                elif "KAZANIR" in banko:
                    mac_adi = mac.get("mac_adi", mac.get("mac", ""))
                    if "VS" in mac_adi.upper():
                        parcalar = mac_adi.upper().split("VS")
                        dep = parcalar[1].strip() if len(parcalar) > 1 else ""
                        if any(word in banko for word in dep.split()[:2]):
                            mac["sonuc"] = "KAZANDI" if dep_gol > ev_gol else "KAYBETTÄ°"
                        else:
                            mac["sonuc"] = "KAZANDI" if ev_gol > dep_gol else "KAYBETTÄ°"
                else:
                    # VarsayÄ±lan olarak kazanan oranlarÄ± gÃ¶ster
                    mac["sonuc"] = f"âœ… {mac['kazanan_oranlar']}"
                    
        except Exception as e:
            print(f"Kontrol hatasÄ±: {e}")
    
    def detayli_arsiv_otomatik_kontrol(self):
        """TÃ¼m maÃ§larÄ±n bahis sonuÃ§larÄ±nÄ± kontrol et"""
        kontrol_edilen = 0
        for mac in self.mac_db:
            skor = mac.get("skor", "")
            if skor and "-" in skor:
                self._kontrol_bahisler(mac, skor)
                kontrol_edilen += 1
        
        self.db_kaydet()
        self.detayli_arsiv_guncelle()
        messagebox.showinfo("TamamlandÄ±", f"âœ… {kontrol_edilen} maÃ§ kontrol edildi!")
    
    def oran_performans_hesapla(self):
        """Oran performansÄ±nÄ± hesapla ve gÃ¶ster"""
        self.txt_oran_perf.delete(1.0, tk.END)
        
        stats = {
            "banko": {"kazandi": 0, "kaybetti": 0},
            "25u": {"tuttu": 0, "tutmadi": 0},
            "35u": {"tuttu": 0, "tutmadi": 0},
            "kg": {"tuttu": 0, "tutmadi": 0},
            "ms1": {"tuttu": 0, "tutmadi": 0},
            "ms2": {"tuttu": 0, "tutmadi": 0}
        }
        
        for mac in self.mac_db:
            # Banko performansÄ±
            sonuc = mac.get("sonuc", "")
            if sonuc == "KAZANDI":
                stats["banko"]["kazandi"] += 1
            elif sonuc == "KAYBETTÄ°":
                stats["banko"]["kaybetti"] += 1
            
            # 2.5Ãœ
            if mac.get("tuttu_25u") == "âœ…":
                stats["25u"]["tuttu"] += 1
            elif mac.get("tuttu_25u") == "âŒ":
                stats["25u"]["tutmadi"] += 1
            
            # 3.5Ãœ
            if mac.get("tuttu_35u") == "âœ…":
                stats["35u"]["tuttu"] += 1
            elif mac.get("tuttu_35u") == "âŒ":
                stats["35u"]["tutmadi"] += 1
            
            # KG
            if mac.get("tuttu_kg") == "âœ…":
                stats["kg"]["tuttu"] += 1
            elif mac.get("tuttu_kg") == "âŒ":
                stats["kg"]["tutmadi"] += 1
        
        # Rapor oluÅŸtur
        self.txt_oran_perf.insert(tk.END, "ğŸ“Š ORAN PERFORMANS RAPORU\n")
        self.txt_oran_perf.insert(tk.END, "â•" * 40 + "\n\n")
        
        # Banko
        b_k = stats["banko"]["kazandi"]
        b_kay = stats["banko"]["kaybetti"]
        b_toplam = b_k + b_kay
        b_oran = (b_k / b_toplam * 100) if b_toplam > 0 else 0
        self.txt_oran_perf.insert(tk.END, f"ğŸ¯ BANKO: {b_k}/{b_toplam} (%{b_oran:.1f})\n")
        
        # 2.5Ãœ
        u25_t = stats["25u"]["tuttu"]
        u25_tm = stats["25u"]["tutmadi"]
        u25_toplam = u25_t + u25_tm
        u25_oran = (u25_t / u25_toplam * 100) if u25_toplam > 0 else 0
        self.txt_oran_perf.insert(tk.END, f"âš½ 2.5 ÃœST: {u25_t}/{u25_toplam} (%{u25_oran:.1f})\n")
        
        # 3.5Ãœ
        u35_t = stats["35u"]["tuttu"]
        u35_tm = stats["35u"]["tutmadi"]
        u35_toplam = u35_t + u35_tm
        u35_oran = (u35_t / u35_toplam * 100) if u35_toplam > 0 else 0
        self.txt_oran_perf.insert(tk.END, f"ğŸ”¥ 3.5 ÃœST: {u35_t}/{u35_toplam} (%{u35_oran:.1f})\n")
        
        # KG
        kg_t = stats["kg"]["tuttu"]
        kg_tm = stats["kg"]["tutmadi"]
        kg_toplam = kg_t + kg_tm
        kg_oran = (kg_t / kg_toplam * 100) if kg_toplam > 0 else 0
        self.txt_oran_perf.insert(tk.END, f"ğŸ¤ KG VAR: {kg_t}/{kg_toplam} (%{kg_oran:.1f})\n")
    
    def oran_performans_goster(self):
        """DetaylÄ± performans popup'Ä±"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“Š DetaylÄ± Oran PerformansÄ±")
        popup.geometry("600x500")
        popup.configure(bg=self.theme["bg"])
        
        txt = scrolledtext.ScrolledText(popup, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 10))
        txt.pack(fill="both", expand=True, padx=10, pady=10)
        
        # Ä°statistikleri hesapla
        bahis_turleri = {}
        
        for mac in self.mac_db:
            banko = mac.get("banko", "").upper()
            sonuc = mac.get("sonuc", "")
            
            if sonuc in ["KAZANDI", "KAYBETTÄ°"]:
                # Bahis tÃ¼rÃ¼nÃ¼ belirle
                if "3.5" in banko and "ÃœST" in banko:
                    tur = "3.5 ÃœST"
                elif "2.5" in banko and "ÃœST" in banko:
                    tur = "2.5 ÃœST"
                elif "1.5" in banko and "ÃœST" in banko:
                    tur = "1.5 ÃœST"
                elif "KG VAR" in banko:
                    tur = "KG VAR"
                elif "MS1" in banko or "MS 1" in banko:
                    tur = "MS1"
                elif "MS2" in banko or "MS 2" in banko:
                    tur = "MS2"
                elif "KAZANIR" in banko:
                    tur = "TARAF"
                else:
                    tur = "DÄ°ÄER"
                
                if tur not in bahis_turleri:
                    bahis_turleri[tur] = {"kazandi": 0, "kaybetti": 0}
                
                if sonuc == "KAZANDI":
                    bahis_turleri[tur]["kazandi"] += 1
                else:
                    bahis_turleri[tur]["kaybetti"] += 1
        
        txt.insert(tk.END, "â•" * 50 + "\n")
        txt.insert(tk.END, "ğŸ“Š BAHÄ°S TÃœRÃœNE GÃ–RE PERFORMANS\n")
        txt.insert(tk.END, "â•" * 50 + "\n\n")
        
        # SÄ±ralÄ± gÃ¶ster (isabet oranÄ±na gÃ¶re)
        sirali = []
        for tur, data in bahis_turleri.items():
            toplam = data["kazandi"] + data["kaybetti"]
            oran = (data["kazandi"] / toplam * 100) if toplam > 0 else 0
            sirali.append((tur, data["kazandi"], data["kaybetti"], toplam, oran))
        
        sirali.sort(key=lambda x: x[4], reverse=True)
        
        for tur, k, kay, toplam, oran in sirali:
            bar = "â–ˆ" * int(oran / 5) + "â–‘" * (20 - int(oran / 5))
            emoji = "ğŸ†" if oran >= 70 else "âœ…" if oran >= 55 else "âš ï¸" if oran >= 40 else "âŒ"
            txt.insert(tk.END, f"{emoji} {tur:12} {bar} %{oran:5.1f} ({k}/{toplam})\n")
        
        txt.insert(tk.END, "\n" + "â•" * 50 + "\n")
        txt.insert(tk.END, "ğŸ’¡ Ã–NERÄ°LER:\n")
        txt.insert(tk.END, "â•" * 50 + "\n")
        
        for tur, k, kay, toplam, oran in sirali[:3]:
            txt.insert(tk.END, f"âœ… {tur} iyi performans gÃ¶steriyor (%{oran:.1f})\n")
        
        for tur, k, kay, toplam, oran in sirali[-2:]:
            if oran < 50 and toplam >= 5:
                txt.insert(tk.END, f"âš ï¸ {tur} dikkatli olunmalÄ± (%{oran:.1f})\n")
    
    def arsiv_excel_aktar(self):
        """ArÅŸivi Excel'e aktar"""
        try:
            from openpyxl import Workbook
            
            wb = Workbook()
            ws = wb.active
            ws.title = "DetaylÄ± ArÅŸiv"
            
            # BaÅŸlÄ±klar
            headers = ["Tarih", "MaÃ§", "Lig", "Banko", "GÃ¼ven", "Skor", "SonuÃ§",
                      "MS1", "X", "MS2", "2.5Ãœ", "3.5Ãœ", "KG",
                      "MS?", "2.5?", "3.5?", "KG?"]
            ws.append(headers)
            
            # Veriler
            for mac in self.mac_db:
                ws.append([
                    mac.get("tarih", ""),
                    mac.get("mac", mac.get("mac_adi", "")).replace("_", " "),
                    mac.get("lig", ""),
                    mac.get("banko", ""),
                    mac.get("guven", ""),
                    mac.get("skor", ""),
                    mac.get("sonuc", ""),
                    mac.get("oran_ms1", ""),
                    mac.get("oran_x", ""),
                    mac.get("oran_ms2", ""),
                    mac.get("oran_25u", ""),
                    mac.get("oran_35u", ""),
                    mac.get("oran_kg", ""),
                    mac.get("tuttu_ms", ""),
                    mac.get("tuttu_25u", ""),
                    mac.get("tuttu_35u", ""),
                    mac.get("tuttu_kg", "")
                ])
            
            dosya = os.path.join(BASE_DIR, f"arsiv_{datetime.now().strftime('%Y%m%d_%H%M%S')}.xlsx")
            wb.save(dosya)
            messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… Excel kaydedildi:\n{dosya}")
            os.startfile(dosya)
        except Exception as e:
            messagebox.showerror("Hata", f"Excel hatasÄ±: {e}")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: MARKA (HATA 12 - GELÄ°ÅMÄ°Å)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_marka(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="ğŸ·ï¸ MARKA")
        
        tk.Label(tab, text="ğŸ·ï¸ MARKA KÄ°MLÄ°ÄÄ° OLUÅTURUCU", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=10)
        
        frm_main = tk.Frame(tab, bg=self.theme["card_bg"])
        frm_main.pack(fill="both", expand=True, padx=20)
        
        # Kanal bilgileri
        frm_left = tk.LabelFrame(frm_main, text="ğŸ“ Kanal Bilgileri", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_left.pack(side="left", fill="y", padx=5, pady=10)
        
        tk.Label(frm_left, text="Kanal AdÄ±:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=0, sticky="w", pady=3)
        self.entry_marka_ad = tk.Entry(frm_left, width=25, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_marka_ad.insert(0, self.brand.get("kanal_adi"))
        self.entry_marka_ad.grid(row=0, column=1, padx=5, pady=3)
        
        tk.Label(frm_left, text="Telegram:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=1, column=0, sticky="w", pady=3)
        self.entry_marka_tg = tk.Entry(frm_left, width=25, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_marka_tg.insert(0, self.brand.get("telegram"))
        self.entry_marka_tg.grid(row=1, column=1, padx=5, pady=3)
        
        tk.Label(frm_left, text="Twitter:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=2, column=0, sticky="w", pady=3)
        self.entry_marka_tw = tk.Entry(frm_left, width=25, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_marka_tw.insert(0, self.brand.get("twitter"))
        self.entry_marka_tw.grid(row=2, column=1, padx=5, pady=3)
        
        tk.Label(frm_left, text="Instagram:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=3, column=0, sticky="w", pady=3)
        self.entry_marka_ig = tk.Entry(frm_left, width=25, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_marka_ig.insert(0, self.brand.get("instagram"))
        self.entry_marka_ig.grid(row=3, column=1, padx=5, pady=3)
        
        # Renk paleti
        frm_mid = tk.LabelFrame(frm_main, text="ğŸ¨ Renk Paleti", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_mid.pack(side="left", fill="y", padx=5, pady=10)
        
        tk.Label(frm_mid, text="Ana:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=0, column=0, sticky="w", pady=3)
        self.btn_renk_ana = tk.Button(frm_mid, text="    ", bg=self.brand.get("ana_renk"), width=5,
                                       command=lambda: self.renk_sec("ana"))
        self.btn_renk_ana.grid(row=0, column=1, padx=5, pady=3)
        
        tk.Label(frm_mid, text="Vurgu:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=1, column=0, sticky="w", pady=3)
        self.btn_renk_vurgu = tk.Button(frm_mid, text="    ", bg=self.brand.get("vurgu_renk"), width=5,
                                         command=lambda: self.renk_sec("vurgu"))
        self.btn_renk_vurgu.grid(row=1, column=1, padx=5, pady=3)
        
        tk.Label(frm_mid, text="Arkaplan:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=2, column=0, sticky="w", pady=3)
        self.btn_renk_bg = tk.Button(frm_mid, text="    ", bg=self.brand.get("arkaplan_renk"), width=5,
                                      command=lambda: self.renk_sec("arkaplan"))
        self.btn_renk_bg.grid(row=2, column=1, padx=5, pady=3)
        
        # HazÄ±r paletler
        tk.Label(frm_mid, text="HazÄ±r Palet:", bg=self.theme["card_bg"], fg=self.theme["fg"]).grid(row=3, column=0, sticky="w", pady=3)
        self.combo_palet = ttk.Combobox(frm_mid, values=[
            "ğŸŸ¢ Profesyonel (YeÅŸil)",
            "ğŸ”µ Spor (Mavi)",
            "ğŸŸ£ Neon (Mor)",
            "ğŸŸ¡ AltÄ±n (SarÄ±)",
            "ğŸ”´ AteÅŸ (KÄ±rmÄ±zÄ±)"
        ], width=18)
        self.combo_palet.grid(row=3, column=1, padx=5, pady=3)
        self.combo_palet.bind("<<ComboboxSelected>>", self.palet_uygula)
        
        # Watermark
        frm_right = tk.LabelFrame(frm_main, text="ğŸ’§ Watermark", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_right.pack(side="left", fill="y", padx=5, pady=10)
        
        self.var_watermark = tk.BooleanVar(value=self.brand.get("watermark_aktif"))
        tk.Checkbutton(frm_right, text="Watermark Ekle", variable=self.var_watermark,
                       bg=self.theme["card_bg"], fg=self.theme["fg"], selectcolor=self.theme["button"]).pack(anchor="w", pady=3)
        
        tk.Label(frm_right, text="Pozisyon:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(anchor="w")
        self.combo_wm_pos = ttk.Combobox(frm_right, values=["Sol Ãœst", "SaÄŸ Ãœst", "Sol Alt", "SaÄŸ Alt", "Orta"], width=12)
        self.combo_wm_pos.set(self.brand.get("watermark_pozisyon"))
        self.combo_wm_pos.pack(anchor="w", pady=3)
        
        tk.Label(frm_right, text="OpaklÄ±k:", bg=self.theme["card_bg"], fg=self.theme["fg"]).pack(anchor="w")
        self.scale_wm_opak = tk.Scale(frm_right, from_=10, to=100, orient="horizontal",
                                       bg=self.theme["card_bg"], fg=self.theme["fg"])
        self.scale_wm_opak.set(self.brand.get("watermark_opaklik"))
        self.scale_wm_opak.pack(anchor="w")
        
        tk.Button(tab, text="ğŸ’¾ MARKA AYARLARINI KAYDET", command=self.marka_kaydet,
                  bg="#28a745", fg="white", font=("Arial", 12, "bold")).pack(pady=15)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SEKME: AYARLAR
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _tab_ayarlar(self):
        tab = tk.Frame(self.notebook, bg=self.theme["card_bg"])
        self.notebook.add(tab, text="âš™ï¸ AYARLAR")
        
        tk.Label(tab, text="âš™ï¸ AYARLAR", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["card_bg"], fg=self.theme["accent"]).pack(pady=15)
        
        # Tema
        frm_tema = tk.LabelFrame(tab, text="ğŸ¨ Tema", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_tema.pack(fill="x", padx=30, pady=10)
        
        for tema in THEMES:
            tk.Radiobutton(frm_tema, text=tema, value=tema, bg=self.theme["card_bg"],
                           fg=self.theme["fg"], selectcolor=self.theme["button"],
                           command=lambda t=tema: self.tema_degistir(t)).pack(anchor="w", padx=20)
        
        # KÄ±sayollar
        frm_kisayol = tk.LabelFrame(tab, text="âŒ¨ï¸ KÄ±sayollar", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_kisayol.pack(fill="x", padx=30, pady=10)
        
        kisayollar = "Ctrl+V = GÃ¶rsel YapÄ±ÅŸtÄ±r | Ctrl+S = Word Kaydet | Ctrl+T = Telegram GÃ¶nder"
        tk.Label(frm_kisayol, text=kisayollar, bg=self.theme["card_bg"], fg="gray", font=("Consolas", 10)).pack(pady=10)
        
        # Sistem bilgisi
        tk.Label(tab, text=f"ğŸ“Š Sistem: {TOPLAM_KURAL} Kural | V5.6 CONSTITUTION | 15 DÃ¼zeltme",
                 bg=self.theme["card_bg"], fg="gray", font=("Arial", 10)).pack(pady=10)
        
        # Veri yÃ¶netimi
        frm_veri = tk.LabelFrame(tab, text="ğŸ—„ï¸ Veri YÃ¶netimi", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_veri.pack(fill="x", padx=30, pady=10)
        
        frm_btn = tk.Frame(frm_veri, bg=self.theme["card_bg"])
        frm_btn.pack(pady=10)
        
        tk.Button(frm_btn, text="ğŸ“‚ KlasÃ¶rÃ¼ AÃ§", command=lambda: os.startfile(BASE_DIR),
                  bg=self.theme["button"], fg=self.theme["fg"]).pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ—‘ï¸ Ã–nbellek Temizle", command=self.onbellek_temizle,
                  bg="#dc3545", fg="white").pack(side="left", padx=5)
        tk.Button(frm_btn, text="ğŸ“¤ Yedekle", command=self.verileri_yedekle,
                  bg="#28a745", fg="white").pack(side="left", padx=5)


# ============================================================
# PART 3 SONU - PART 4'E DEVAM
# ============================================================
# ============================================================
# PART 4/6 - FONKSÄ°YONLAR BÃ–LÃœM 1
# ============================================================
# Bu dosyayÄ± PART 3'Ã¼n SONUNA ekle
# ============================================================

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # GÃ–RSEL Ä°ÅLEMLERÄ°
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def dosya_sec(self):
        files = filedialog.askopenfilenames(filetypes=[("GÃ¶rseller", "*.png *.jpg *.jpeg *.webp")])
        for f in files:
            if len(self.gorsel_listesi) < 15:
                self.gorsel_listesi.append(f)
        self.lbl_count.config(text=f"{len(self.gorsel_listesi)}/15")
    
    def panodan_yapistir_event(self, event=None):
        self.panodan_yapistir()
    
    def panodan_yapistir(self):
        try:
            img = ImageGrab.grabclipboard()
            if img:
                path = os.path.join(BASE_DIR, f"pano_{datetime.now().strftime('%H%M%S')}.png")
                img.save(path)
                if len(self.gorsel_listesi) < 15:
                    self.gorsel_listesi.append(path)
                    self.lbl_count.config(text=f"{len(self.gorsel_listesi)}/15")
                    self.lbl_status.config(text="âœ… GÃ¶rsel yapÄ±ÅŸtÄ±rÄ±ldÄ±", fg=self.theme["success"])
        except Exception as e:
            self.lbl_status.config(text=f"âŒ YapÄ±ÅŸtÄ±rma hatasÄ±: {e}", fg=self.theme["error"])
    
    def temizle(self):
        self.gorsel_listesi.clear()
        self.lbl_count.config(text="0/15")
        self.txt_result.delete(1.0, tk.END)
        self.txt_notes.delete(1.0, tk.END)
        self.last_result = ""
        self.lbl_status.config(text="ğŸ—‘ï¸ Temizlendi - CTRL+V ile yeni gÃ¶rsel ekle", fg=self.theme["warning"])
        
        # CTRL+V binding'i yeniden aktif et (her ihtimale karÅŸÄ±)
        self.root.bind_all('<Control-v>', self.panodan_yapistir_event)
        
        # Focus'u ana pencereye ver
        self.root.focus_set()
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # KURAL POPUP
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def kural_popup(self):
        """
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        ğŸ”¥ CANLI MATRIX KURAL TARAMA PENCERESÄ° (V60)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        Ã–ZELLÄ°KLER:
        1. BaÅŸlangÄ±Ã§ TemizliÄŸi - Eski veriler temizlenir
        2. CanlÄ± Matrix Efekti - Kurallar tek tek eklenir
        3. Renk KodlamasÄ±:
           âœ… YEÅÄ°L: Kural geÃ§ti
           âŒ KIRMIZI: VETO
           âš ï¸ TURUNCU: UyarÄ±
           ğŸ“‹ GRÄ°: TarandÄ± ama ÅŸart saÄŸlanmadÄ±
        """
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # 1. BAÅLANGIÃ‡ TEMÄ°ZLÄ°ÄÄ°
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        # Pencere oluÅŸtur
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ” CANLI KURAL TARAMA - MATRIX MODU")
        popup.geometry("1000x800")
        popup.configure(bg="#0a0a0a")
        popup.attributes('-topmost', True)  # Ã–nde kalsÄ±n
        
        # BaÅŸlÄ±k
        header = tk.Frame(popup, bg="#0a0a0a")
        header.pack(fill=tk.X, padx=10, pady=10)
        
        title_lbl = tk.Label(header, text="ğŸ” CANLI KURAL TARAMA SÄ°STEMÄ°", 
                font=("Consolas", 20, "bold"),
                bg="#0a0a0a", fg="#00ffff")
        title_lbl.pack()
        
        # Durum labelÄ± (animasyonlu)
        status_lbl = tk.Label(header, text="â³ Sistem baÅŸlatÄ±lÄ±yor...", 
                font=("Consolas", 12),
                bg="#0a0a0a", fg="#ffff00")
        status_lbl.pack(pady=5)
        
        # SayaÃ§ frame
        counter_frame = tk.Frame(popup, bg="#1a1a2e", relief=tk.RIDGE, bd=2)
        counter_frame.pack(fill=tk.X, padx=10, pady=(0, 10))
        
        # SayaÃ§ labellarÄ± - baÅŸlangÄ±Ã§ta sÄ±fÄ±r
        counter_inner = tk.Frame(counter_frame, bg="#1a1a2e")
        counter_inner.pack(pady=10)
        
        gecen_lbl = tk.Label(counter_inner, text="âœ… GEÃ‡EN: 0", 
                font=("Consolas", 14, "bold"), fg="#00ff00", bg="#1a1a2e")
        gecen_lbl.pack(side=tk.LEFT, padx=20)
        
        veto_lbl = tk.Label(counter_inner, text="âŒ VETO: 0", 
                font=("Consolas", 14, "bold"), fg="#ff4444", bg="#1a1a2e")
        veto_lbl.pack(side=tk.LEFT, padx=20)
        
        uyari_lbl = tk.Label(counter_inner, text="âš ï¸ UYARI: 0", 
                font=("Consolas", 14, "bold"), fg="#ffaa00", bg="#1a1a2e")
        uyari_lbl.pack(side=tk.LEFT, padx=20)
        
        tarandi_lbl = tk.Label(counter_inner, text="ğŸ“‹ TARANDI: 0", 
                font=("Consolas", 14, "bold"), fg="#888888", bg="#1a1a2e")
        tarandi_lbl.pack(side=tk.LEFT, padx=20)
        
        toplam_lbl = tk.Label(counter_inner, text="ğŸ“Š TOPLAM: 0/130", 
                font=("Consolas", 14, "bold"), fg="#00ffff", bg="#1a1a2e")
        toplam_lbl.pack(side=tk.LEFT, padx=20)
        
        # Progress bar
        progress_frame = tk.Frame(popup, bg="#0a0a0a")
        progress_frame.pack(fill=tk.X, padx=10, pady=(0, 10))
        
        progress_canvas = tk.Canvas(progress_frame, height=20, bg="#1a1a1a", highlightthickness=0)
        progress_canvas.pack(fill=tk.X)
        progress_rect = progress_canvas.create_rectangle(0, 0, 0, 20, fill="#00ff00", outline="")
        
        # ScrolledText - TEMÄ°Z BAÅLA
        txt = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        txt.pack(expand=True, fill="both", padx=10, pady=10)
        
        # TEMÄ°ZLE - Eski veriler silinsin
        txt.delete("1.0", tk.END)
        
        # Renk tag'leri
        txt.tag_configure("gecti", foreground="#00ff00")
        txt.tag_configure("veto", foreground="#ff4444")
        txt.tag_configure("uyari", foreground="#ffaa00")
        txt.tag_configure("tarandi", foreground="#666666")
        txt.tag_configure("baslik", foreground="#00ffff", font=("Consolas", 12, "bold"))
        txt.tag_configure("matrix", foreground="#003300")  # Matrix arka plan efekti
        txt.tag_configure("scanning", foreground="#00ff00", font=("Consolas", 10, "bold"))
        
        # Kapat butonu
        btn_frame = tk.Frame(popup, bg="#0a0a0a")
        btn_frame.pack(pady=10)
        
        close_btn = tk.Button(btn_frame, text="âŒ KAPAT", command=popup.destroy,
                  font=("Consolas", 12, "bold"), bg="#ff4444", fg="white",
                  relief="flat", padx=20, pady=5)
        close_btn.pack()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # 2. VERÄ° HAZIRLA
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        mac_data = self.current_analysis if hasattr(self, 'current_analysis') and self.current_analysis else {}
        if not mac_data and hasattr(self, 'mac_db') and self.mac_db:
            mac_data = self.mac_db[-1]
        
        kural_veri = self._mac_data_to_kural_veri(mac_data)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # 3. CANLI MATRIX TARAMA
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        def matrix_tarama():
            """CanlÄ± tarama - ayrÄ± thread benzeri davranÄ±ÅŸ iÃ§in after kullanÄ±lÄ±yor"""
            
            # BaÅŸlÄ±k yaz
            txt.insert(tk.END, "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n", "baslik")
            txt.insert(tk.END, "â•‘                    ğŸ” CANLI KURAL TARAMA BAÅLADI                            â•‘\n", "baslik")
            txt.insert(tk.END, "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n", "baslik")
            txt.see(tk.END)
            popup.update()
            
            # KuralMotoru oluÅŸtur
            motor = KuralMotoru(kural_veri)
            
            # TÃ¼m K_ metodlarÄ±nÄ± al
            k_methods = [m for m in dir(motor) if m.startswith('K_') and callable(getattr(motor, m))]
            total_rules = len(k_methods)
            
            # SayaÃ§lar
            gecen = 0
            veto = 0
            uyari = 0
            tarandi = 0
            processed = 0
            
            # Her kuralÄ± tek tek Ã§alÄ±ÅŸtÄ±r ve gÃ¶ster
            for i, method_name in enumerate(k_methods):
                try:
                    method = getattr(motor, method_name)
                    
                    # Durumu gÃ¼ncelle
                    status_lbl.config(text=f"âš¡ Taranan: {method_name}")
                    
                    # KuralÄ± Ã§alÄ±ÅŸtÄ±r
                    old_sonuc_count = len(motor.sonuclar)
                    method()
                    new_sonuc_count = len(motor.sonuclar)
                    
                    # Yeni sonuÃ§larÄ± kontrol et
                    if new_sonuc_count > old_sonuc_count:
                        for s in motor.sonuclar[old_sonuc_count:]:
                            kural_id = s.get("kural_id", method_name)
                            durum = s.get("durum", "")
                            detay = s.get("detay", "")[:60]
                            
                            # "BAÅLADI" ve "TARANDI" durumlarÄ±nÄ± atla (sadece sonuÃ§ gÃ¶ster)
                            if durum in ["BAÅLADI", "TARANDI"]:
                                tarandi += 1
                                # GRÄ° renkte gÃ¶ster
                                txt.insert(tk.END, f"  ğŸ“‹ [{kural_id}] {detay}\n", "tarandi")
                            elif durum == "VETO":
                                veto += 1
                                txt.insert(tk.END, f"  âŒ [{kural_id}] {detay}\n", "veto")
                            elif durum in ["GEÃ‡ER", "GEÃ‡TÄ°"]:
                                gecen += 1
                                txt.insert(tk.END, f"  âœ… [{kural_id}] {detay}\n", "gecti")
                            elif durum == "UYARI":
                                uyari += 1
                                txt.insert(tk.END, f"  âš ï¸ [{kural_id}] {detay}\n", "uyari")
                            else:
                                tarandi += 1
                                txt.insert(tk.END, f"  ğŸ“‹ [{kural_id}] {detay}\n", "tarandi")
                    
                    processed += 1
                    
                    # SayaÃ§larÄ± gÃ¼ncelle
                    gecen_lbl.config(text=f"âœ… GEÃ‡EN: {gecen}")
                    veto_lbl.config(text=f"âŒ VETO: {veto}")
                    uyari_lbl.config(text=f"âš ï¸ UYARI: {uyari}")
                    tarandi_lbl.config(text=f"ğŸ“‹ TARANDI: {tarandi}")
                    toplam_lbl.config(text=f"ğŸ“Š TOPLAM: {processed}/{total_rules}")
                    
                    # Progress bar gÃ¼ncelle
                    progress_width = int((processed / total_rules) * progress_canvas.winfo_width())
                    progress_canvas.coords(progress_rect, 0, 0, progress_width, 20)
                    
                    # Auto-scroll
                    txt.see(tk.END)
                    
                    # DoEvents benzeri - UI donmasÄ±nÄ± Ã¶nle
                    popup.update()
                    
                    # Matrix efekti iÃ§in kÃ¼Ã§Ã¼k gecikme (isteÄŸe baÄŸlÄ±)
                    import time
                    time.sleep(0.01)  # 10ms gecikme
                    
                except Exception as e:
                    txt.insert(tk.END, f"  âš ï¸ HATA: {method_name} - {str(e)[:40]}\n", "uyari")
                    tarandi += 1
            
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            # 4. Ã–ZET RAPOR
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            txt.insert(tk.END, "\n")
            txt.insert(tk.END, "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n", "baslik")
            txt.insert(tk.END, "â•‘                         ğŸ“Š TARAMA TAMAMLANDI                                â•‘\n", "baslik")
            txt.insert(tk.END, "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n", "baslik")
            txt.insert(tk.END, f"\n", "baslik")
            txt.insert(tk.END, f"  âœ… GEÃ‡EN KURALLAR    : {gecen:3}\n", "gecti")
            txt.insert(tk.END, f"  âŒ VETO KURALLAR     : {veto:3}\n", "veto")
            txt.insert(tk.END, f"  âš ï¸ UYARI KURALLAR    : {uyari:3}\n", "uyari")
            txt.insert(tk.END, f"  ğŸ“‹ TARANDI (NÃ¶tr)    : {tarandi:3}\n", "tarandi")
            txt.insert(tk.END, f"  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n", "baslik")
            txt.insert(tk.END, f"  ğŸ“Š TOPLAM            : {processed}\n\n", "baslik")
            
            # Banko sonucu
            banko = motor.banko_sec()
            guven = motor.hesapla_guven_puani(banko)  # V70 FIX: banko parametresi eklendi
            
            txt.insert(tk.END, "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n", "baslik")
            txt.insert(tk.END, f"â•‘  ğŸ¯ NÄ°HAÄ° BANKO: {banko.get('tip', 'N/A'):20} GÃœVEN: {guven}/10                      â•‘\n", "gecti" if guven >= 6 else "veto")
            txt.insert(tk.END, f"â•‘  ğŸ“ SEBEP: {banko.get('sebep', 'N/A')[:55]:55}     â•‘\n", "baslik")
            txt.insert(tk.END, "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n", "baslik")
            
            # Durum gÃ¼ncelle
            status_lbl.config(text="âœ… TARAMA TAMAMLANDI!", fg="#00ff00")
            
            txt.see(tk.END)
        
        # TaramayÄ± baÅŸlat (100ms sonra - UI yÃ¼klensin)
        popup.after(100, matrix_tarama)
    
    def _mac_data_to_kural_veri(self, mac_data):
        """MaÃ§ verisini KuralMotoru formatÄ±na Ã§evir - V70 GENÄ°ÅLETÄ°LMÄ°Å
        
        Bu fonksiyon hem ana analiz verilerinden hem de OCR verilerinden
        key'leri kabul eder ve tutarlÄ± bir Ã§Ä±ktÄ± Ã¼retir.
        """
        
        def get_val(keys, default=0):
            """Birden fazla key denemesi yap"""
            if isinstance(keys, str):
                keys = [keys]
            for key in keys:
                val = mac_data.get(key)
                if val is not None and val != 0 and val != "":
                    try:
                        return float(str(val).replace("%", "").replace("/10", "").strip())
                    except:
                        pass
            return default
        
        return {
            # GOL ATMA - Birden fazla key destekle
            'ev_atan_05': get_val(["ev_atan_05", "ev_atan", "ev_gol_atan", "ev_gol"], 70),
            'dep_atan_05': get_val(["dep_atan_05", "dep_atan", "dep_gol_atan", "dep_gol"], 70),
            
            # GOL YEME - Birden fazla key destekle
            'ev_yenen_05': get_val(["ev_yenen_05", "ev_yiyen_05", "ev_yiyen", "ev_gol_yiyen"], 50),
            'dep_yenen_05': get_val(["dep_yenen_05", "dep_yiyen_05", "dep_yiyen", "dep_gol_yiyen"], 50),
            
            # GOL YEMEME
            'ev_yememe': get_val(["ev_yememe", "ev_cs", "ev_clean_sheet"], 30),
            'dep_yememe': get_val(["dep_yememe", "dep_cs", "dep_clean_sheet"], 30),
            
            # ÃœST/ALT ORANLARI - Birden fazla key destekle
            'ust_05': get_val(["ust_05_ort", "ust_05", "ms_05"], 90),
            'ust_15': get_val(["ust_15_ort", "ust_15", "ms_15", "ms15"], 70),
            'ust_25': get_val(["ust_25_ort", "ust_25", "ms_25", "ms25"], 55),
            'ust_35': get_val(["ust_35_ort", "ust_35", "ms_35", "ms35"], 35),
            
            # KG VAR
            'kg_var_ort': get_val(["kg_var_ort", "kg_var", "kg", "kg_ort"], 60),
            
            # xG VERÄ°LERÄ° - KRÄ°TÄ°K
            'xg_ev': get_val(["xg_ev", "xg_home"], 1.5),
            'xg_dep': get_val(["xg_dep", "xg_away"], 1.2),
            
            # ÅUT VERÄ°LERÄ°
            'sut_ev': get_val(["sut_ev", "shots_ev", "ev_sut"], 12),
            'sut_dep': get_val(["sut_dep", "shots_dep", "dep_sut"], 10),
            
            # GOL ORTALAMALARI
            'gol_ort_ev': get_val(["gol_ort_ev", "ev_gol_ort", "ev_avg_gol"], 1.5),
            'gol_ort_dep': get_val(["gol_ort_dep", "dep_gol_ort", "dep_avg_gol"], 1.2),
            'gol_yeme_ort_ev': get_val(["gol_yeme_ort_ev", "gol_yeme_ev", "ev_yedigi"], 1.0),
            'gol_yeme_ort_dep': get_val(["gol_yeme_ort_dep", "gol_yeme_dep", "dep_yedigi"], 1.0),
            
            # ORANLAR
            'oran_ms1': get_val(["oran_ms1", "oran_1", "ms1_oran"], 2.0),
            'oran_ms2': get_val(["oran_ms2", "oran_2", "ms2_oran"], 3.5),
            'oran_x': get_val(["oran_x", "x_oran"], 3.2),
            
            # Ä°LK YARI
            'iy_ev_gol': get_val(["iy_ev_gol", "ev_iy_atan", "iy_ev_atan", "iy_ev"], 60),
            'iy_dep_gol': get_val(["iy_dep_gol", "dep_iy_atan", "iy_dep_atan", "iy_dep"], 50),
            
            # LÄ°G
            'lig': mac_data.get("lig", mac_data.get("league", "Unknown")),
            'lig_gol_ort': get_val(["lig_gol_ort", "lig_ort"], 2.5),
            
            # KAZANMA YÃœZDE
            'kazanma_ev': get_val(["kazanma_ev", "ev_kazanma", "galibiyet_ev"], 50),
            'kazanma_dep': get_val(["kazanma_dep", "dep_kazanma", "galibiyet_dep"], 30),
            
            # GÃœVEN
            'guven': get_val(["guven"], 5),
            
            # 1.5 Ãœst iÃ§in ekstra
            'ev_atan_15': get_val(["ev_atan_15", "ev_15_ust"], 50),
            'dep_atan_15': get_val(["dep_atan_15", "dep_15_ust"], 50),
            'ev_yenen_15': get_val(["ev_yenen_15", "ev_yiyen_15"], 40),
            'dep_yenen_15': get_val(["dep_yenen_15", "dep_yiyen_15"], 40),
            
            # Conversion
            'conv_ev': get_val(["conv_ev", "conversion_ev"], 12),
            'conv_dep': get_val(["conv_dep", "conversion_dep"], 11),
        }
    
    def kural_popup_eski(self):
        """ESKÄ° VERSIYON - Yedek olarak tutuldu"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“‹ 172 KURAL TARAMA SONUÃ‡LARI")
        popup.geometry("900x700")
        popup.configure(bg=self.theme["bg"])
        
        tk.Label(popup, text="ğŸ“‹ 172 KURAL TARAMA SONUÃ‡LARI", font=("Segoe UI", 16, "bold"),
                bg=self.theme["bg"], fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        txt = scrolledtext.ScrolledText(popup, font=("Consolas", 9), bg="#0a0a0a", fg="#00ff00")
        txt.pack(expand=True, fill="both", padx=10, pady=10)
        
        # Tag'ler oluÅŸtur
        txt.tag_configure("gecti", foreground="#00ff00")
        txt.tag_configure("veto", foreground="#ff4444")
        txt.tag_configure("belirsiz", foreground="#888888")
        txt.tag_configure("baslik", foreground="#00ffff", font=("Consolas", 10, "bold"))
        
        # Analiz verilerini al
        mac_data = self.current_analysis if hasattr(self, 'current_analysis') and self.current_analysis else {}
        if not mac_data and self.mac_db:
            mac_data = self.mac_db[-1]
        
        # Ä°statistikleri Ã§Ä±kar
        ev_atan = self._get_num(mac_data, "ev_atan", 0)
        dep_atan = self._get_num(mac_data, "dep_atan", 0)
        ev_yiyen = self._get_num(mac_data, "ev_yiyen", 0)
        dep_yiyen = self._get_num(mac_data, "dep_yiyen", 0)
        ust_15 = self._get_num(mac_data, "ust_15", 0)
        ust_25 = self._get_num(mac_data, "ust_25", mac_data.get("ms_25", 0))
        ust_35 = self._get_num(mac_data, "ust_35", 0)
        kg_var = self._get_num(mac_data, "kg_var", 0)
        xg = self._get_num(mac_data, "xg", mac_data.get("xg_toplam", 0))
        guven = self._get_num(mac_data, "guven", 5)
        
        gecen_sayisi = 0
        veto_sayisi = 0
        belirsiz_sayisi = 0
        
        gecen_kurallar = []
        veto_kurallar = []
        belirsiz_kurallar = []
        
        # KurallarÄ± tek tek tara - Yeni yapÄ±ya uyumlu
        def tara_kurallar(kurallar_listesi, bolum_adi):
            nonlocal gecen_sayisi, veto_sayisi, belirsiz_sayisi
            for kural in kurallar_listesi:
                if not isinstance(kural, dict):
                    continue
                kural_id = kural.get('id', 'N/A')
                kural_adi = kural.get('aciklama', kural.get('baslik', kural.get('tanim', '')))
                if not kural_adi:
                    continue
                
                # Kural kontrolÃ¼ yap
                sonuc = self._kural_kontrol(kural_id, kural_adi, mac_data, 
                                           ev_atan, dep_atan, ev_yiyen, dep_yiyen,
                                           ust_15, ust_25, ust_35, kg_var, xg, guven)
                
                if sonuc == "GECTI":
                    gecen_kurallar.append((kural_id, kural_adi, bolum_adi))
                    gecen_sayisi += 1
                elif sonuc == "VETO":
                    veto_kurallar.append((kural_id, kural_adi, bolum_adi))
                    veto_sayisi += 1
                else:
                    belirsiz_kurallar.append((kural_id, kural_adi, bolum_adi))
                    belirsiz_sayisi += 1
        
        for bolum in TUM_BOLUMLER:
            bolum_adi = bolum.get('ad', '')
            # Ana kurallar
            if "kurallar" in bolum and isinstance(bolum["kurallar"], list):
                tara_kurallar(bolum["kurallar"], bolum_adi)
            # A grubu kurallar
            if "a_grubu" in bolum and "kurallar" in bolum["a_grubu"]:
                tara_kurallar(bolum["a_grubu"]["kurallar"], bolum_adi)
            # B grubu kurallar
            if "b_grubu" in bolum and "kurallar" in bolum["b_grubu"]:
                tara_kurallar(bolum["b_grubu"]["kurallar"], bolum_adi)
            # AÅŸama kurallarÄ±
            for asama in ["asama_0", "asama_1", "asama_2", "asama_3", "asama_4", "asama_5", "asama_6"]:
                if asama in bolum and "kurallar" in bolum[asama]:
                    tara_kurallar(bolum[asama]["kurallar"], bolum_adi)
            # Prensipler
            if "prensipler" in bolum:
                tara_kurallar(bolum["prensipler"], bolum_adi)
        
        toplam_kural = gecen_sayisi + veto_sayisi + belirsiz_sayisi
        
        # Rapor baÅŸlÄ±ÄŸÄ±
        txt.insert(tk.END, "â•”" + "â•"*70 + "â•—\n", "baslik")
        txt.insert(tk.END, f"â•‘           ğŸ“‹ {toplam_kural} KURAL TARAMA SONUÃ‡LARI                              â•‘\n", "baslik")
        txt.insert(tk.END, "â• " + "â•"*70 + "â•£\n", "baslik")
        txt.insert(tk.END, f"â•‘  âœ… GeÃ§en Kurallar  : {gecen_sayisi:3} / {toplam_kural}                                    â•‘\n")
        txt.insert(tk.END, f"â•‘  âŒ Veto Kurallar   : {veto_sayisi:3} / {toplam_kural}                                    â•‘\n")
        txt.insert(tk.END, f"â•‘  âšª Belirsiz        : {belirsiz_sayisi:3} / {toplam_kural}                                    â•‘\n")
        txt.insert(tk.END, "â•š" + "â•"*70 + "â•\n\n")
        
        # GeÃ§en kurallar
        txt.insert(tk.END, "âœ… GEÃ‡EN KURALLAR:\n", "gecti")
        txt.insert(tk.END, "â”€" * 70 + "\n")
        for kid, kadi, bolum in gecen_kurallar:
            txt.insert(tk.END, f"  âœ… [{kid}] {kadi[:55]}\n", "gecti")
        txt.insert(tk.END, "\n")
        
        # Veto kurallar
        txt.insert(tk.END, "âŒ VETO KURALLAR:\n", "veto")
        txt.insert(tk.END, "â”€" * 70 + "\n")
        for kid, kadi, bolum in veto_kurallar:
            txt.insert(tk.END, f"  âŒ [{kid}] {kadi[:55]}\n", "veto")
        txt.insert(tk.END, "\n")
        
        # Belirsiz kurallar
        txt.insert(tk.END, "âšª BELÄ°RSÄ°Z KURALLAR (Veri yetersiz):\n", "belirsiz")
        txt.insert(tk.END, "â”€" * 70 + "\n")
        for kid, kadi, bolum in belirsiz_kurallar[:30]:  # Ä°lk 30'u gÃ¶ster
            txt.insert(tk.END, f"  âšª [{kid}] {kadi[:55]}\n", "belirsiz")
        if len(belirsiz_kurallar) > 30:
            txt.insert(tk.END, f"  ... ve {len(belirsiz_kurallar)-30} kural daha\n", "belirsiz")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)
    
    def _get_num(self, data, key, default=0):
        """Veriyi sayÄ±ya Ã§evir"""
        val = data.get(key, default)
        if isinstance(val, str):
            val = val.replace("%", "").replace(",", ".").strip()
            try:
                return float(val)
            except:
                return default
        return float(val) if val else default
    
    def _kural_kontrol(self, kural_id, kural_adi, mac_data, ev_atan, dep_atan, ev_yiyen, dep_yiyen, ust_15, ust_25, ust_35, kg_var, xg, guven):
        """KuralÄ± kontrol et - GECTI/VETO/BELIRSIZ dÃ¶ndÃ¼r"""
        kural_upper = kural_adi.upper()
        kural_id_upper = kural_id.upper()
        
        # ÃœST/ALT kurallarÄ±
        if "ÃœST" in kural_upper or "UST" in kural_upper:
            if "2.5" in kural_adi:
                if ust_25 > 60:
                    return "GECTI"
                elif ust_25 > 0 and ust_25 < 40:
                    return "VETO"
            elif "1.5" in kural_adi:
                if ust_15 > 70:
                    return "GECTI"
                elif ust_15 > 0 and ust_15 < 50:
                    return "VETO"
            elif "3.5" in kural_adi:
                if ust_35 > 50:
                    return "GECTI"
                elif ust_35 > 0 and ust_35 < 30:
                    return "VETO"
        
        # KG kurallarÄ±
        if "KG" in kural_upper:
            if "YOK" in kural_upper:
                if kg_var > 0 and kg_var < 40:
                    return "GECTI"
                elif kg_var > 60:
                    return "VETO"
            else:  # KG VAR
                if kg_var > 60:
                    return "GECTI"
                elif kg_var > 0 and kg_var < 40:
                    return "VETO"
        
        # GOL GÃœC kurallarÄ±
        if "GOL" in kural_upper and "GÃœÃ‡" in kural_upper:
            if ev_atan > 80 or dep_atan > 80:
                return "GECTI"
            elif ev_atan < 50 and dep_atan < 50 and ev_atan > 0:
                return "VETO"
        
        # YEME kurallarÄ±
        if "YEME" in kural_upper or "YÄ°YEN" in kural_upper:
            if ev_yiyen > 60 or dep_yiyen > 60:
                return "GECTI"
            elif ev_yiyen < 30 and dep_yiyen < 30 and ev_yiyen > 0:
                return "VETO"
        
        # xG kurallarÄ±
        if "XG" in kural_upper:
            if xg > 2.5:
                return "GECTI"
            elif xg > 0 and xg < 1.5:
                return "VETO"
        
        # MS (MaÃ§ Sonucu) kurallarÄ±
        if "MS 1" in kural_upper or "MS1" in kural_upper:
            if ev_atan > 80 and dep_yiyen > 60:
                return "GECTI"
        if "MS 2" in kural_upper or "MS2" in kural_upper:
            if dep_atan > 80 and ev_yiyen > 60:
                return "GECTI"
        
        # VETO Ã¶zel kurallarÄ±
        if "VETO" in kural_upper or "YASAK" in kural_upper:
            # Bu tÃ¼r kurallar ters mantÄ±kla Ã§alÄ±ÅŸÄ±r
            if guven < 6:
                return "GECTI"  # DÃ¼ÅŸÃ¼k gÃ¼ven = bu veto kuralÄ± geÃ§erli
        
        # FAVORÄ°/GÃœÃ‡LÃœ kurallarÄ±
        if "FAVORÄ°" in kural_upper or "GÃœÃ‡LÃœ" in kural_upper:
            if ev_atan > 75 or dep_atan > 75:
                return "GECTI"
        
        # RÄ°SK kurallarÄ±
        if "RÄ°SK" in kural_upper:
            if guven < 7:
                return "VETO"
            else:
                return "GECTI"
        
        return "BELIRSIZ"
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ANALÄ°Z FONKSÄ°YONLARI
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def analizi_baslat(self):
        if not self.gorsel_listesi:
            messagebox.showwarning("UyarÄ±", "LÃ¼tfen gÃ¶rsel ekleyin!")
            return
        
        self.btn_analyze.config(state="disabled", text="â³ ANALÄ°Z YAPILIYOR...")
        self.progress_frame.pack(fill="x", padx=20, pady=5)
        self.progress["value"] = 0
        
        threading.Thread(target=self._analiz_thread, daemon=True).start()
    
    def _analiz_thread(self):
        """
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        ğŸš€ V5.8 YENÄ° 3 AÅAMALI MÄ°MARÄ°
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        AÅAMA 1: GEMÄ°NÄ° OCR - Sadece gÃ¶rsellerden veri Ã§Ä±kar (JSON)
        AÅAMA 2: PYTHON HESAPLAMA - TÃ¼m matematik ve kural kontrolÃ¼
        AÅAMA 3: GEMÄ°NÄ° SUNUM - Åablon doldurma ve yorum yazma
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        """
        try:
            api_key = self.entry_api.get().strip() or DEFAULT_API_KEY
            genai.configure(api_key=api_key)
            
            model_name = GEMINI_MODELS.get(self.var_model.get(), "gemini-2.5-pro")
            model = genai.GenerativeModel(model_name)
            
            images = []
            for i, path in enumerate(self.gorsel_listesi):
                img = Image.open(path)
                images.append(img)
                self.root.after(0, lambda v=((i+1)/len(self.gorsel_listesi))*20: self.progress.config(value=v))
            
            tarih = self.entry_date.get().strip()
            notlar = self.txt_notes.get(1.0, tk.END).strip()
            
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            # ğŸ” AÅAMA 1: GEMÄ°NÄ° OCR - SADECE VERÄ° Ã‡IKARMA
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            self.root.after(0, lambda: self.lbl_progress.config(text="ğŸ” AÅAMA 1: GÃ¶rsellerden veri okunuyor..."))
            
            ocr_prompt = """
# ğŸ” XG-XRAY V5.8 - AÅAMA 1: VERÄ° Ã‡IKARMA (OCR MODU)

## âš ï¸ KRÄ°TÄ°K TALÄ°MAT:
- SADECE gÃ¶rsellerdeki rakamlarÄ± oku
- YORUM YAPMA, ANALÄ°Z YAPMA, TAHMÄ°N YAPMA
- GÃ¶rselde olmayan veriyi UYDURMA
- BulamadÄ±ÄŸÄ±n veri iÃ§in "?" yaz

## ğŸ“Š Ã‡IKARILACAK VERÄ°LER:

### 1. TAKIM BÄ°LGÄ°LERÄ°:
- ev_takimi = [Ev sahibi takÄ±m adÄ±]
- dep_takimi = [Deplasman takÄ±m adÄ±]
- lig = [Lig adÄ±]
- mac_saati = [MaÃ§ saati]

### 2. ATILAN GOLLER TABLOSU (0.5 ÃœST SATIRINDAN):
- ev_atan_05 = [Ev Sahibi 0.5 Ãœst %] (AtÄ±lan Goller tablosu)
- dep_atan_05 = [Deplasman 0.5 Ãœst %] (AtÄ±lan Goller tablosu)
- ev_atan_15 = [Ev Sahibi 1.5 Ãœst %] (AtÄ±lan Goller tablosu)
- dep_atan_15 = [Deplasman 1.5 Ãœst %] (AtÄ±lan Goller tablosu)

### 3. YENEN GOLLER TABLOSU:
ğŸš¨ Ã–NEMLÄ°: "Yenen Goller" tablosu ayrÄ± bir tablodur. "AtÄ±lan Goller" ile KARIÅTIRILMAMALI!
- ev_yenen_05 = [Ev Sahibi 0.5 Ãœst %] (YENEN Goller tablosu - Bu rakip takÄ±mÄ±n eve karÅŸÄ± attÄ±ÄŸÄ± gol yÃ¼zdesidir)
- dep_yenen_05 = [Deplasman 0.5 Ãœst %] (YENEN Goller tablosu - Bu rakip takÄ±mÄ±n depde karÅŸÄ± attÄ±ÄŸÄ± gol yÃ¼zdesidir)
- ev_yenen_15 = [Ev Sahibi 1.5 Ãœst %] (YENEN Goller tablosu)
- dep_yenen_15 = [Deplasman 1.5 Ãœst %] (YENEN Goller tablosu)

âš ï¸ YENEN GOLLER TABLOSU BULUNAMAZSA:
EÄŸer gÃ¶rselde ayrÄ± bir "Yenen Goller" tablosu yoksa, ÅŸu formÃ¼lÃ¼ kullan:
- ev_yenen_05 â‰ˆ dep_atan_05 (Deplasman atÄ±yorsa, ev sahibi yiyordur)
- dep_yenen_05 â‰ˆ ev_atan_05 (Ev sahibi atÄ±yorsa, deplasman yiyordur)
ASLA 0 veya null verme! Tahmin yap.

### 4. YEMEME (CLEAN SHEET) ORANLARI:
- ev_yememe = [Ev Gol Yememe %]
- dep_yememe = [Dep Gol Yememe %]

### 5. Ä°LK YARI VERÄ°LERÄ° (Ä°Y/2Y SEKMESÄ°NDEN):
- iy_ev_gol = [Ev Ä°Y Gol Atma %]
- iy_dep_gol = [Dep Ä°Y Gol Atma %]
- iy_ev_yememe = [Ev Ä°Y Gol Yememe %]
- iy_dep_yememe = [Dep Ä°Y Gol Yememe %]

### 6. ORTALAMA SÃœTUNU (2.5 Ãœst ve KG Tahminleri tablosu):
- ust_05_ort = [0.5 Ãœst Ortalama %]
- ust_15_ort = [1.5 Ãœst Ortalama %]
- ust_25_ort = [2.5 Ãœst Ortalama %]
- ust_35_ort = [3.5 Ãœst Ortalama %]
- ust_45_ort = [4.5 Ãœst Ortalama %]
- kg_var_ort = [KG VAR Ortalama %]

### 7. xG VERÄ°LERÄ° (KIRMIZI KUTUCUK Ä°Ã‡Ä°NDEKÄ°LER!):
ğŸš¨ğŸš¨ğŸš¨ KRÄ°TÄ°K UYARI - xG ve ATILAN GOL FARKLI VERÄ°LERDÄ°R! ğŸš¨ğŸš¨ğŸš¨

â›” HATALI OKUMA Ã–RNEÄÄ°:
- "AtÄ±lan Gol" satÄ±rÄ±ndan 2.22 okudunuz â†’ BU xG DEÄÄ°L!
- xG satÄ±rÄ± AYRI bir satÄ±rdÄ±r!

âœ… DOÄRU OKUMA:
- Tabloda "xG" yazan satÄ±rÄ± bul (genellikle en alt satÄ±rlarda)
- FK Vojvodina tablosunda â†’ "xG" satÄ±rÄ± â†’ "Ev Sahibi" sÃ¼tunu = 1.83
- OFK Belgrade tablosunda â†’ "xG" satÄ±rÄ± â†’ "Deplasman" sÃ¼tunu = 1.43

ğŸ”´ "Form / Kim KazanÄ±r" veya "Form - Kim KazanÄ±r" tablosundan oku!
ğŸ”´ SADECE "xG" yazan satÄ±rÄ± kullan - "AtÄ±lan Gol" satÄ±rÄ±nÄ± KULLANMA!
ğŸ”´ SADECE "Ev Sahibi" sÃ¼tunundaki xG deÄŸerini xg_ev olarak al!
ğŸ”´ SADECE "Deplasman" sÃ¼tunundaki xG deÄŸerini xg_dep olarak al!
ğŸ”´ "Toplam" sÃ¼tununu ASLA KULLANMA!

- xg_ev = [Ev Sahibi sÃ¼tunundaki xG - KIRMIZI KUTUCUK Ä°Ã‡Ä°NDE] (Ã¶rn: 1.83)
- xg_dep = [Deplasman sÃ¼tunundaki xG - KIRMIZI KUTUCUK Ä°Ã‡Ä°NDE] (Ã¶rn: 1.43)
- xga_ev = [Ev xGA deÄŸeri] (varsa)
- xga_dep = [Dep xGA deÄŸeri] (varsa)

âš ï¸ xG OKUMA KURALLARI:
1. Tabloda "xG" yazan SATIRI bul (AtÄ±lan Gol satÄ±rÄ± DEÄÄ°L!)
2. xG satÄ±rÄ±ndaki "Ev Sahibi" sÃ¼tunundaki deÄŸeri xg_ev olarak kaydet
3. xG satÄ±rÄ±ndaki "Deplasman" sÃ¼tunundaki deÄŸeri xg_dep olarak kaydet
4. "Toplam" sÃ¼tununu KESINLIKLE KULLANMA!
5. xG deÄŸerleri genellikle 1.00 ile 2.50 arasÄ±ndadÄ±r (3.00+ nadir)
6. EÄŸer 2.50'den bÃ¼yÃ¼k xG okuduysan, muhtemelen "AtÄ±lan Gol" satÄ±rÄ±nÄ± okudun - TEKRAR KONTROL ET!

### 8. ÅUT VERÄ°LERÄ°:
- sut_ev = [Ev Toplam Åut]
- sut_dep = [Dep Toplam Åut]
- isabetli_ev = [Ev Ä°sabetli Åut]
- isabetli_dep = [Dep Ä°sabetli Åut]
- csi_ev = [Ev Ceza SahasÄ± Ä°Ã§i Åut] (varsa)
- csi_dep = [Dep Ceza SahasÄ± Ä°Ã§i Åut] (varsa)

### 9. FORM VERÄ°LERÄ°:
- gol_ort_ev = [Ev MaÃ§ BaÅŸÄ± Gol OrtalamasÄ±]
- gol_ort_dep = [Dep MaÃ§ BaÅŸÄ± Gol OrtalamasÄ±]
- gol_yeme_ort_ev = [Ev MaÃ§ BaÅŸÄ± Gol Yeme OrtalamasÄ±]
- gol_yeme_ort_dep = [Dep MaÃ§ BaÅŸÄ± Gol Yeme OrtalamasÄ±]
- kazanma_ev = [Ev Kazanma %]
- kazanma_dep = [Dep Kazanma %]
- lig_gol_ort = [Lig MaÃ§ BaÅŸÄ± Gol OrtalamasÄ±] (varsa)

### 10. ORANLAR (Bahis OranlarÄ± tablosu varsa):
ğŸš¨ Ã–NEMLÄ°: "Oranlar" tablosundaki TÃœM oranlarÄ± oku!
Tablo ÅŸu ÅŸekilde gÃ¶rÃ¼nÃ¼r:
- Market | Oranlar | Ä°statistik
- 0.5 Ãœst | 1.02 | 100%
- 1.5 Ãœst | 1.18 | 89%
- 2.5 Ãœst | 1.57 | 56%
- vb.

- oran_ms1 = [MS1 / Ev Galibiyet OranÄ±] (Ã¶rn: 1.53)
- oran_x = [Beraberlik OranÄ±] (Ã¶rn: 4.30)
- oran_ms2 = [MS2 / Deplasman Galibiyet OranÄ±] (Ã¶rn: 4.75)
- oran_05u = [0.5 Ãœst OranÄ±] (Ã¶rn: 1.02)
- oran_15u = [1.5 Ãœst OranÄ±] (Ã¶rn: 1.18)
- oran_25u = [2.5 Ãœst OranÄ±] (Ã¶rn: 1.57)
- oran_35u = [3.5 Ãœst OranÄ±] (Ã¶rn: 2.45)
- oran_45u = [4.5 Ãœst OranÄ±] (Ã¶rn: 4.00)
- oran_kg = [KG VAR OranÄ±] (Ã¶rn: 1.65)

### 11. EK BÄ°LGÄ°LER (YazÄ±lÄ± metin varsa):
- seri_ev = [Ev takÄ±mÄ± son maÃ§ serisi]
- seri_dep = [Dep takÄ±mÄ± son maÃ§ serisi]
- eksik_ev = [Ev eksik oyuncular]
- eksik_dep = [Dep eksik oyuncular]
- h2h_bilgi = [Son karÅŸÄ±laÅŸma bilgileri]
- ozel_not = [Ã–nemli notlar - kupa, derbi, motivasyon vs]

## ğŸ“¤ Ã‡IKTI FORMATI:
AÅŸaÄŸÄ±daki JSON formatÄ±nda dÃ¶ndÃ¼r. BulamadÄ±ÄŸÄ±n deÄŸerler iÃ§in null yaz:

```json
{
  "ev_takimi": "...",
  "dep_takimi": "...",
  "lig": "...",
  "mac_saati": "...",
  "ev_atan_05": 0,
  "dep_atan_05": 0,
  "ev_atan_15": 0,
  "dep_atan_15": 0,
  "ev_yenen_05": 0,
  "dep_yenen_05": 0,
  "ev_yenen_15": 0,
  "dep_yenen_15": 0,
  "ev_yememe": 0,
  "dep_yememe": 0,
  "iy_ev_gol": 0,
  "iy_dep_gol": 0,
  "iy_ev_yememe": 0,
  "iy_dep_yememe": 0,
  "ust_05_ort": 0,
  "ust_15_ort": 0,
  "ust_25_ort": 0,
  "ust_35_ort": 0,
  "ust_45_ort": 0,
  "kg_var_ort": 0,
  "xg_ev": 0.0,
  "xg_dep": 0.0,
  "xga_ev": null,
  "xga_dep": null,
  "sut_ev": 0,
  "sut_dep": 0,
  "isabetli_ev": 0,
  "isabetli_dep": 0,
  "csi_ev": null,
  "csi_dep": null,
  "gol_ort_ev": 0.0,
  "gol_ort_dep": 0.0,
  "gol_yeme_ort_ev": 0.0,
  "gol_yeme_ort_dep": 0.0,
  "kazanma_ev": 0,
  "kazanma_dep": 0,
  "lig_gol_ort": null,
  "oran_ms1": null,
  "oran_x": null,
  "oran_ms2": null,
  "oran_05u": null,
  "oran_15u": null,
  "oran_25u": null,
  "oran_35u": null,
  "oran_45u": null,
  "oran_kg": null,
  "seri_ev": null,
  "seri_dep": null,
  "eksik_ev": null,
  "eksik_dep": null,
  "h2h_bilgi": null,
  "ozel_not": null
}
```

âš ï¸ SADECE JSON DÃ–NDÃœR - BAÅKA HÄ°Ã‡BÄ°R ÅEY YAZMA!
"""
            
            # Gemini OCR Ã§aÄŸrÄ±sÄ±
            ocr_response = model.generate_content([ocr_prompt] + images)
            ocr_result = ocr_response.text
            
            self.root.after(0, lambda: self.progress.config(value=35))
            
            # JSON'u parse et
            try:
                # JSON bloÄŸunu bul
                json_match = re.search(r'\{[\s\S]*\}', ocr_result)
                if json_match:
                    ocr_data = json.loads(json_match.group())
                else:
                    raise ValueError("JSON bulunamadÄ±")
            except Exception as e:
                print(f"âš ï¸ JSON parse hatasÄ±: {e}")
                print(f"OCR sonucu: {ocr_result[:500]}")
                # Fallback: eski yÃ¶ntemle devam et
                ocr_data = self._fallback_ocr_parse(ocr_result)
            
            print(f"ğŸ“Š OCR Verisi: {json.dumps(ocr_data, indent=2, ensure_ascii=False)[:500]}")
            
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            # ğŸ§® AÅAMA 2: PYTHON HESAPLAMA - TÃœM MATEMATÄ°K VE KURALLAR
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            self.root.after(0, lambda: self.lbl_progress.config(text="ğŸ§® AÅAMA 2: Python hesaplamalarÄ± yapÄ±lÄ±yor..."))
            self.root.after(0, lambda: self.progress.config(value=50))
            
            # OCR verisini hesaplama motoruna uygun formata dÃ¶nÃ¼ÅŸtÃ¼r
            hesaplama_verisi = self._ocr_to_hesaplama_format(ocr_data)
            
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            # ğŸ”¥ YENÄ°: KURAL MOTORU V60 - ÅEFFAF VE KANITLI
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            print("ğŸ”¥ KURAL MOTORU V60 Ã‡ALIÅIYOR...")
            kural_motoru = KuralMotoru(hesaplama_verisi)
            kural_sonucu = kural_motoru.tum_kurallari_calistir()
            
            # KanÄ±t loglarÄ±nÄ± yazdÄ±r
            print(f"ğŸ“‹ KANIT LOGLARI ({len(kural_sonucu.get('kanit_loglari', []))} kayÄ±t):")
            for log in kural_sonucu.get('kanit_loglari', [])[-10:]:
                print(f"   {log}")
            
            # Eski format ile uyumluluk iÃ§in dÃ¶nÃ¼ÅŸtÃ¼r
            analiz_sonucu = {
                "nihai_banko": kural_sonucu["banko"].get("tip", "MS 1.5 ÃœST"),
                "guven": kural_sonucu["guven"],
                "kasa": kural_sonucu["kasa"],
                "vetolar": kural_sonucu["vetolar"],
                "uyarilar": kural_sonucu["uyarilar"],
                "gecenler": kural_sonucu["gecenler"],
                "gol_ongorusu": kural_sonucu.get("gol_ongorusu", {}),
                "tetikler": kural_sonucu.get("tetikler", []),
                "simulasyon": {"gecenler": kural_sonucu["gecenler"]},
                "toplam_kural": kural_sonucu["toplam_kural"],
                "kanit_loglari": kural_sonucu.get("kanit_loglari", [])  # ğŸ” KANIT LOGLARI EKLENDÄ°!
            }
            
            print(f"ğŸ¯ Analiz Sonucu: Banko={analiz_sonucu['nihai_banko']}, GÃ¼ven={analiz_sonucu['guven']}/10")
            print(f"ğŸš« Vetolar: {len(analiz_sonucu['vetolar'])}")
            print(f"âœ… GeÃ§en Bankolar: {len(analiz_sonucu['gecenler'])}")
            
            self.root.after(0, lambda: self.progress.config(value=70))
            
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            # ğŸ“ AÅAMA 3: GEMÄ°NÄ° SUNUM - ÅABLON DOLDURMA VE YORUM
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            self.root.after(0, lambda: self.lbl_progress.config(text="ğŸ“ AÅAMA 3: Rapor hazÄ±rlanÄ±yor..."))
            
            sunum_prompt = self._sunum_promptu_olustur(ocr_data, analiz_sonucu, tarih, notlar)
            
            # Gemini Sunum Ã§aÄŸrÄ±sÄ±
            sunum_response = model.generate_content([sunum_prompt] + images)
            result = sunum_response.text
            
            self.root.after(0, lambda: self.progress.config(value=90))
            self.root.after(0, lambda: self.lbl_progress.config(text="ğŸ’¾ Kaydediliyor..."))
            
            # Sonucu kaydet
            self.last_result = result
            self._parse_and_save_v58(result, tarih, ocr_data, analiz_sonucu)
            
            self.root.after(0, lambda: self.progress.config(value=100))
            self.root.after(0, lambda: self._analiz_bitti(result))
            
        except Exception as ex:
            import traceback
            print(f"âŒ Analiz hatasÄ±: {ex}")
            traceback.print_exc()
            hata_mesaji = str(ex)  # Lambda iÃ§in yerel deÄŸiÅŸken
            self.root.after(0, lambda h=hata_mesaji: self._analiz_hata(h))
    
    def _fallback_ocr_parse(self, ocr_result):
        """OCR JSON parse baÅŸarÄ±sÄ±z olursa fallback parser"""
        data = {}
        
        # SatÄ±r satÄ±r ayrÄ±ÅŸtÄ±r
        for line in ocr_result.split('\n'):
            if '=' in line or ':' in line:
                try:
                    if '=' in line:
                        key, val = line.split('=', 1)
                    else:
                        key, val = line.split(':', 1)
                    
                    key = key.strip().lower().replace(' ', '_').replace('"', '').replace("'", "")
                    val = val.strip().replace('"', '').replace("'", "").replace(',', '')
                    
                    # SayÄ±sal deÄŸer mi kontrol et
                    try:
                        if '.' in val:
                            data[key] = float(val)
                        else:
                            data[key] = int(val.replace('%', ''))
                    except:
                        data[key] = val
                except:
                    pass
        
        return data
    
    def _ocr_to_hesaplama_format(self, ocr_data):
        """OCR verisini HesaplamaMotoru formatÄ±na dÃ¶nÃ¼ÅŸtÃ¼r - V5.8 GELÄ°ÅTÄ°RÄ°LMÄ°Å"""
        
        def safe_float(val, default=0):
            if val is None:
                return default
            try:
                return float(str(val).replace('%', '').replace(',', '.'))
            except:
                return default
        
        def safe_int(val, default=0):
            if val is None:
                return default
            try:
                return int(float(str(val).replace('%', '').replace(',', '.')))
            except:
                return default
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ğŸ“Š ATILAN GOLLER (KAYNAK: AtÄ±lan Goller Tablosu)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        ev_atan_05 = safe_float(ocr_data.get('ev_atan_05', 70))
        dep_atan_05 = safe_float(ocr_data.get('dep_atan_05', 70))
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ğŸ“Š YENEN GOLLER (KAYNAK: Yenen Goller Tablosu)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        ev_yenen_05 = safe_float(ocr_data.get('ev_yenen_05', 0))
        dep_yenen_05 = safe_float(ocr_data.get('dep_yenen_05', 0))
        
        # âš ï¸ YENEN GOLLER 0 Ä°SE HESAPLA
        # FormÃ¼l: Rakibin atÄ±lan goller yÃ¼zdesi â‰ˆ TakÄ±mÄ±n yenen goller yÃ¼zdesi
        # Ev takÄ±mÄ±nÄ±n yenen gol % â‰ˆ Deplasman takÄ±mÄ±nÄ±n atÄ±lan gol %
        if ev_yenen_05 <= 0:
            ev_yenen_05 = dep_atan_05  # Rakip atÄ±yorsa, sen yiyorsun
            print(f"âš ï¸ Ev Yenen tahmini: Dep Atan %{dep_atan_05} kullanÄ±ldÄ±")
        
        if dep_yenen_05 <= 0:
            dep_yenen_05 = ev_atan_05  # Rakip atÄ±yorsa, sen yiyorsun
            print(f"âš ï¸ Dep Yenen tahmini: Ev Atan %{ev_atan_05} kullanÄ±ldÄ±")
        
        # Hala 0 ise varsayÄ±lan
        if ev_yenen_05 <= 0:
            ev_yenen_05 = 65  # Lig ortalamasÄ±
        if dep_yenen_05 <= 0:
            dep_yenen_05 = 65
        
        print(f"ğŸ“Š GOL YEME: Ev %{ev_yenen_05:.0f} | Dep %{dep_yenen_05:.0f}")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ğŸ“Š Ä°LK YARI GOL (KAYNAK: AtÄ±lan Goller - Ä°Y/2Y Sekmesi)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        iy_ev_gol = safe_float(ocr_data.get('iy_ev_gol', 0))
        iy_dep_gol = safe_float(ocr_data.get('iy_dep_gol', 0))
        
        # âš ï¸ Ä°Y GOL 0 Ä°SE HESAPLA
        # FormÃ¼l: Ä°Y Gol â‰ˆ Toplam gol yÃ¼zdesinin %40-50'si
        if iy_ev_gol <= 0 and ev_atan_05 > 0:
            iy_ev_gol = ev_atan_05 * 0.45  # YaklaÅŸÄ±k %45'i Ä°Y'de
            print(f"âš ï¸ Ä°Y Ev tahmini: %{ev_atan_05} x 0.45 = %{iy_ev_gol:.0f}")
        
        if iy_dep_gol <= 0 and dep_atan_05 > 0:
            iy_dep_gol = dep_atan_05 * 0.45
            print(f"âš ï¸ Ä°Y Dep tahmini: %{dep_atan_05} x 0.45 = %{iy_dep_gol:.0f}")
        
        # VarsayÄ±lan minimum
        if iy_ev_gol <= 0:
            iy_ev_gol = 50
        if iy_dep_gol <= 0:
            iy_dep_gol = 50
        
        iy_gol_ort = (iy_ev_gol + iy_dep_gol) / 2
        print(f"ğŸ“Š Ä°Y GOL: Ev %{iy_ev_gol:.0f} | Dep %{iy_dep_gol:.0f} | Ort %{iy_gol_ort:.1f}")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ğŸ“ CONVERSION HESAPLAMA - V5.8 GELÄ°ÅTÄ°RÄ°LMÄ°Å
        # FormÃ¼l: (MaÃ§ BaÅŸÄ± Gol / MaÃ§ BaÅŸÄ± Åut) * 100
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        sut_ev = safe_float(ocr_data.get('sut_ev', 0))
        sut_dep = safe_float(ocr_data.get('sut_dep', 0))
        gol_ev = safe_float(ocr_data.get('gol_ort_ev', 0))
        gol_dep = safe_float(ocr_data.get('gol_ort_dep', 0))
        
        # EÄŸer ÅŸut verisi yoksa, gol ortalamasÄ±ndan tahmin et
        LIG_ORT_SUT = 13  # VarsayÄ±lan lig ortalamasÄ± ÅŸut
        
        # EÄŸer gol ortalamasÄ± var ama ÅŸut yoksa â†’ tahmin et
        if sut_ev <= 0 and gol_ev > 0:
            sut_ev = (gol_ev / 0.11)  # Tahmini ÅŸut
            print(f"âš ï¸ Åut EV tahmini: {gol_ev} gol â†’ {sut_ev:.1f} ÅŸut")
        
        if sut_dep <= 0 and gol_dep > 0:
            sut_dep = (gol_dep / 0.11)  # Tahmini ÅŸut
            print(f"âš ï¸ Åut DEP tahmini: {gol_dep} gol â†’ {sut_dep:.1f} ÅŸut")
        
        # Åut hala 0 ise lig ortalamasÄ± kullan
        if sut_ev <= 0:
            sut_ev = LIG_ORT_SUT
        if sut_dep <= 0:
            sut_dep = LIG_ORT_SUT
        
        # Gol ortalamasÄ± 0 ise atÄ±lan goller yÃ¼zdesinden tahmin et
        if gol_ev <= 0 and ev_atan_05 > 0:
            gol_ev = (ev_atan_05 / 100) * 1.8  # Tahmini gol ortalamasÄ±
            print(f"âš ï¸ Gol EV tahmini: %{ev_atan_05} 0.5Ãœ â†’ {gol_ev:.2f} gol ort")
        
        if gol_dep <= 0 and dep_atan_05 > 0:
            gol_dep = (dep_atan_05 / 100) * 1.8
            print(f"âš ï¸ Gol DEP tahmini: %{dep_atan_05} 0.5Ãœ â†’ {gol_dep:.2f} gol ort")
        
        # VarsayÄ±lan minimum deÄŸerler
        if gol_ev <= 0:
            gol_ev = 1.2  # Lig ortalamasÄ±
        if gol_dep <= 0:
            gol_dep = 1.2
        
        # ğŸ“ CONVERSION HESAPLA
        conv_ev = (gol_ev / sut_ev * 100) if sut_ev > 0 else 11
        conv_dep = (gol_dep / sut_dep * 100) if sut_dep > 0 else 11
        
        # Conversion limitleri (mantÄ±ksÄ±z deÄŸerleri dÃ¼zelt)
        conv_ev = max(5, min(25, conv_ev))  # %5-%25 arasÄ± makul
        conv_dep = max(5, min(25, conv_dep))
        
        print(f"ğŸ“ CONVERSION: EV={gol_ev:.2f}/{sut_ev:.1f}=%{conv_ev:.1f} | DEP={gol_dep:.2f}/{sut_dep:.1f}=%{conv_dep:.1f}")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # YEMEME (CLEAN SHEET) HESAPLAMA
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        ev_yememe = safe_float(ocr_data.get('ev_yememe', 0))
        dep_yememe = safe_float(ocr_data.get('dep_yememe', 0))
        
        # Yememe 0 ise hesapla: 100 - Yenen%
        if ev_yememe <= 0:
            ev_yememe = max(10, 100 - ev_yenen_05)
            print(f"âš ï¸ Ev Yememe tahmini: 100 - {ev_yenen_05:.0f} = %{ev_yememe:.0f}")
        if dep_yememe <= 0:
            dep_yememe = max(10, 100 - dep_yenen_05)
            print(f"âš ï¸ Dep Yememe tahmini: 100 - {dep_yenen_05:.0f} = %{dep_yememe:.0f}")
        
        # Favori belirleme (oranlardan veya kazanma yÃ¼zdesinden)
        oran_ms1 = safe_float(ocr_data.get('oran_ms1'), 2.0)
        oran_ms2 = safe_float(ocr_data.get('oran_ms2'), 2.0)
        kazanma_ev = safe_float(ocr_data.get('kazanma_ev', 50))
        kazanma_dep = safe_float(ocr_data.get('kazanma_dep', 50))
        
        if oran_ms1 < oran_ms2:
            favori = "ev"
            favori_oran = oran_ms1
            favori_yeme = safe_float(ocr_data.get('gol_yeme_ort_ev', 1.0))
            favori_conv = conv_ev
            kazanma_yuzde = kazanma_ev
        else:
            favori = "dep"
            favori_oran = oran_ms2
            favori_yeme = safe_float(ocr_data.get('gol_yeme_ort_dep', 1.0))
            favori_conv = conv_dep
            kazanma_yuzde = kazanma_dep
        
        return {
            # TakÄ±m bilgileri
            "ev_takimi": ocr_data.get('ev_takimi', 'Ev'),
            "dep_takimi": ocr_data.get('dep_takimi', 'Deplasman'),
            "lig": ocr_data.get('lig', ''),
            
            # AtÄ±lan goller
            "ev_atan": ev_atan_05,
            "dep_atan": dep_atan_05,
            "ev_gol_15": safe_float(ocr_data.get('ev_atan_15', 50)),
            "dep_gol_15": safe_float(ocr_data.get('dep_atan_15', 50)),
            
            # Yenen goller - HESAPLANMIÅ
            "ev_yenen": ev_yenen_05,
            "dep_yenen": dep_yenen_05,
            "ev_yeme_15": safe_float(ocr_data.get('ev_yenen_15', 40)),
            "dep_yeme_15": safe_float(ocr_data.get('dep_yenen_15', 40)),
            
            # Yememe (Clean Sheet) - HESAPLANMIÅ
            "ev_yememe": ev_yememe,
            "dep_yememe": dep_yememe,
            
            # Ortalama deÄŸerler
            "ust_05": safe_float(ocr_data.get('ust_05_ort', 90)),
            "ust_15": safe_float(ocr_data.get('ust_15_ort', 75)),
            "ust_25": safe_float(ocr_data.get('ust_25_ort', 55)),
            "ust_35": safe_float(ocr_data.get('ust_35_ort', 35)),
            "ust_45": safe_float(ocr_data.get('ust_45_ort', 20)),
            "kg_var": safe_float(ocr_data.get('kg_var_ort', 55)),
            
            # xG deÄŸerleri
            "xg_ev": safe_float(ocr_data.get('xg_ev', 1.3)),
            "xg_dep": safe_float(ocr_data.get('xg_dep', 1.2)),
            "xga_ev": safe_float(ocr_data.get('xga_ev', 1.2)),
            "xga_dep": safe_float(ocr_data.get('xga_dep', 1.3)),
            
            # Åut verileri
            "sut_ev": sut_ev,
            "sut_dep": sut_dep,
            "sut_toplam": sut_ev + sut_dep,
            "isabetli_ev": safe_float(ocr_data.get('isabetli_ev', 4)),
            "isabetli_dep": safe_float(ocr_data.get('isabetli_dep', 3)),
            
            # Conversion - HESAPLANMIÅ
            "conv_ev": conv_ev,
            "conv_dep": conv_dep,
            "favori_conv": favori_conv,
            
            # Ä°lk yarÄ± - HESAPLANMIÅ
            "iy_ev": iy_ev_gol,
            "iy_dep": iy_dep_gol,
            "iy_gol_ort": iy_gol_ort,
            
            # Form ve lig
            "gol_ort": safe_float(ocr_data.get('gol_ort_ev', 1.5)) + safe_float(ocr_data.get('gol_ort_dep', 1.3)),
            "lig_gol_ort": safe_float(ocr_data.get('lig_gol_ort', 2.5)),
            
            # Oran ve favori
            "oran": favori_oran,
            "oran_ms1": oran_ms1,
            "oran_ms2": oran_ms2,
            "favori": favori,
            "favori_yeme": favori_yeme,
            "kazanma_yuzde": kazanma_yuzde,
            
            # Ek bilgiler
            "seri_ev": ocr_data.get('seri_ev'),
            "seri_dep": ocr_data.get('seri_dep'),
            "eksik_ev": ocr_data.get('eksik_ev'),
            "eksik_dep": ocr_data.get('eksik_dep'),
            "h2h_bilgi": ocr_data.get('h2h_bilgi'),
            "ozel_not": ocr_data.get('ozel_not'),
        }
    
    def _sunum_promptu_olustur(self, ocr_data, analiz_sonucu, tarih, notlar):
        """
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        AÅAMA 3: Gemini Sunum promptu oluÅŸtur - V60 ÅEFFAF FORMAT
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        YENÄ° Ã–ZELLÄ°KLER:
        - BÃ¶lÃ¼m 12: Ã‡apraz Analiz (Atan/Yenen eÅŸleÅŸmesi)
        - BÃ¶lÃ¼m 13: KanÄ±t LoglarÄ± (Åeffaf karar mekanizmasÄ±)
        """
        
        # Analiz sonuÃ§larÄ±nÄ± prompt'a ekle
        vetolar = analiz_sonucu.get('vetolar', [])
        
        # V63: NULL/boÅŸ deÄŸer kontrolÃ¼ - detaysÄ±z VETO'larÄ± dÃ¼zgÃ¼n gÃ¶ster
        veto_items = []
        for v in vetolar:
            kural_id = v.get('kural_id', v.get('id', 'N/A'))
            detay = v.get('detay', v.get('mesaj', ''))
            # BoÅŸ detay kontrolÃ¼
            if not detay or detay.strip() == '':
                detay = "[VETO AKTÄ°F]"
            veto_items.append(f"{kural_id}: {detay}")
        
        veto_listesi = ", ".join(veto_items) if veto_items else "TEMÄ°Z âœ…"
        
        gecenler = analiz_sonucu.get('simulasyon', {}).get('gecenler', [])
        if gecenler and isinstance(gecenler[0], dict):
            if 'tip' in gecenler[0]:
                gecen_listesi = ", ".join([f"{g['tip']} (%{g.get('puan', 0):.0f})" for g in gecenler])
            elif 'kural_id' in gecenler[0]:
                gecen_listesi = ", ".join([f"{g['kural_id']}" for g in gecenler])
            else:
                gecen_listesi = ", ".join([str(g) for g in gecenler])
        elif gecenler:
            gecen_listesi = ", ".join([str(g) for g in gecenler])
        else:
            gecen_listesi = "HÄ°Ã‡BÄ°RÄ°"
        
        gol_ongorusu = analiz_sonucu.get('gol_ongorusu', {})
        canli_tetik = analiz_sonucu.get('canli_tetik', [])
        iy_radar = analiz_sonucu.get('iy_radar', {})
        hesaplamalar = analiz_sonucu.get('hesaplamalar', {})
        
        # ğŸ” KANIT LOGLARI - DÄ°NAMÄ°K VE DETAYLI
        kanit_loglari = analiz_sonucu.get('kanit_loglari', [])
        
        # KanÄ±t loglarÄ±nÄ± kategorize et
        root_logs = [l for l in kanit_loglari if "[ROOT]" in l]
        giyotin_logs = [l for l in kanit_loglari if "[GÄ°YOTÄ°N]" in l]
        kural_logs = [l for l in kanit_loglari if "[KURAL]" in l]
        banko_logs = [l for l in kanit_loglari if "[BANKO]" in l]
        sonuc_logs = [l for l in kanit_loglari if "[SONUÃ‡]" in l]
        
        # FormatlanmÄ±ÅŸ kanÄ±t metni oluÅŸtur
        kanit_text = f"""
ğŸ“‹ TOPLAM LOG: {len(kanit_loglari)} kayÄ±t

ğŸ”µ ROOT PROTOKOLÃœ ({len(root_logs)} log):
{chr(10).join(root_logs) if root_logs else "   KayÄ±t yok"}

ğŸ”´ GÄ°YOTÄ°N KONTROL ({len(giyotin_logs)} log):
{chr(10).join(giyotin_logs) if giyotin_logs else "   TÃ¼m vetolar geÃ§ti"}

ğŸŸ¢ KURAL TARAMA ({len(kural_logs)} log):
{chr(10).join(kural_logs[-20:]) if kural_logs else "   KayÄ±t yok"}
{"   ... ve " + str(len(kural_logs)-20) + " log daha" if len(kural_logs) > 20 else ""}

ğŸŸ¡ BANKO SEÃ‡Ä°M ({len(banko_logs)} log):
{chr(10).join(banko_logs) if banko_logs else "   KayÄ±t yok"}

âš« SONUÃ‡ ({len(sonuc_logs)} log):
{chr(10).join(sonuc_logs) if sonuc_logs else "   KayÄ±t yok"}
""".strip()
        
        # GÃ¼ven emoji ve aÃ§Ä±klama
        guven = analiz_sonucu.get('guven', 7)
        guven_emoji = {10: "ğŸ’ ELÄ°T", 9: "ğŸ”¥ Ã‡OK GÃœÃ‡LÃœ", 8: "ğŸ’ª GÃœÃ‡LÃœ", 7: "âš–ï¸ STANDART", 6: "âš ï¸ DÄ°KKATLÄ°", 5: "â“ RÄ°SKLÄ°"}.get(guven, "â“ RÄ°SKLÄ°")
        kasa_orani = analiz_sonucu.get('kasa', 10)
        
        ev_takimi = ocr_data.get('ev_takimi', 'Ev TakÄ±mÄ±')
        dep_takimi = ocr_data.get('dep_takimi', 'Deplasman')
        lig = ocr_data.get('lig', 'Bilinmeyen Lig')
        
        # OCR verilerini al
        xg_ev = ocr_data.get('xg_ev', 0) or 0
        xg_dep = ocr_data.get('xg_dep', 0) or 0
        xg_toplam = xg_ev + xg_dep
        
        ev_atan = ocr_data.get('ev_atan_05', 0) or 0
        dep_atan = ocr_data.get('dep_atan_05', 0) or 0
        
        # ğŸ”§ YENEN GOLLER - Birden fazla key dene (OCR farklÄ± isimler kullanabiliyor)
        ev_yiyen = ocr_data.get('ev_yenen_05', ocr_data.get('ev_yiyen_05', 0)) or 0
        dep_yiyen = ocr_data.get('dep_yenen_05', ocr_data.get('dep_yiyen_05', 0)) or 0
        
        # âš ï¸ YENEN GOLLER 0 Ä°SE Ã‡APRAZ HESAPLA
        # FormÃ¼l: Rakibin atan gol % â‰ˆ TakÄ±mÄ±n yenen gol %
        if ev_yiyen <= 0 and dep_atan > 0:
            ev_yiyen = dep_atan  # Deplasman atÄ±yorsa, ev sahibi yiyor
        if dep_yiyen <= 0 and ev_atan > 0:
            dep_yiyen = ev_atan  # Ev sahibi atÄ±yorsa, deplasman yiyor
        
        # Hala 0 ise varsayÄ±lan
        if ev_yiyen <= 0:
            ev_yiyen = 65  # Lig ortalamasÄ±
        if dep_yiyen <= 0:
            dep_yiyen = 65
        
        # ğŸ”¥ BÃ–LÃœM 12: Ã‡APRAZ ANALÄ°Z HESAPLAMALARI
        # Ev Gol GÃ¼cÃ¼ = (Ev Atan + Dep Yenen) / 2
        ev_gol_gucu = (ev_atan + dep_yiyen) / 2 if ev_atan > 0 else 70
        # Dep Gol GÃ¼cÃ¼ = (Dep Atan + Ev Yenen) / 2
        dep_gol_gucu = (dep_atan + ev_yiyen) / 2 if dep_atan > 0 else 70
        
        # 1.5 Ãœst iÃ§in yenen verileri
        ev_atan_15 = ocr_data.get('ev_atan_15', 50) or 50
        dep_atan_15 = ocr_data.get('dep_atan_15', 50) or 50
        ev_yiyen_15 = ocr_data.get('ev_yenen_15', 40) or 40
        dep_yiyen_15 = ocr_data.get('dep_yenen_15', 40) or 40
        
        # Savunma alarmlarÄ±
        ev_savunma_alarm = "ğŸš¨ SAVUNMA ALARMI! GOL GELEBÄ°LÄ°R" if dep_yiyen_15 > 70 else "Normal"
        dep_savunma_alarm = "ğŸš¨ SAVUNMA ALARMI! GOL GELEBÄ°LÄ°R" if ev_yiyen_15 > 70 else "Normal"
        
        # CanlÄ± Tetikleyici kontrolÃ¼
        tetik_aktif = ev_atan >= 80 or dep_atan >= 80 or ev_yiyen >= 80 or dep_yiyen >= 80
        
        # Kasa SigortasÄ± seÃ§imi (BÃ¶lÃ¼m 12 baÄŸÄ±msÄ±z)
        if ev_gol_gucu > 85 and dep_gol_gucu > 85:
            sigorta_secimi = "KG VAR"
            sigorta_sebep = f"Ev Gol GÃ¼cÃ¼ %{ev_gol_gucu:.0f} + Dep Gol GÃ¼cÃ¼ %{dep_gol_gucu:.0f} > 85"
        elif ev_gol_gucu > 90:
            sigorta_secimi = "EV SAHÄ°BÄ° 0.5 ÃœST"
            sigorta_sebep = f"Ev Gol GÃ¼cÃ¼ %{ev_gol_gucu:.0f} > 90"
        elif dep_gol_gucu > 90:
            sigorta_secimi = "DEPLASMAN 0.5 ÃœST"
            sigorta_sebep = f"Dep Gol GÃ¼cÃ¼ %{dep_gol_gucu:.0f} > 90"
        elif ocr_data.get('ust_15_ort', 70) > 80:
            sigorta_secimi = "MS 1.5 ÃœST"
            sigorta_sebep = f"1.5 Ãœst Ort %{ocr_data.get('ust_15_ort', 70)} > 80"
        else:
            sigorta_secimi = "MS 0.5 ÃœST"
            sigorta_sebep = "En dÃ¼ÅŸÃ¼k riskli seÃ§enek - yÃ¼ksek gÃ¼venli liman"
        
        # V70 FIX: Sigorta gÃ¼ven puanÄ± - tutarlÄ± mantÄ±k
        if "MS 0.5 ÃœST" in sigorta_secimi:
            sigorta_guven = 9  # En gÃ¼venli
        elif "MS 1.5 ÃœST" in sigorta_secimi:
            sigorta_guven = 8  # Ã‡ok gÃ¼venli
        elif "KG VAR" in sigorta_secimi:
            sigorta_guven = 8  # GÃ¼venli
        elif "0.5 ÃœST" in sigorta_secimi:  # TakÄ±m bazlÄ±
            sigorta_guven = 8
        else:
            sigorta_guven = 7
        
        # ğŸ”§ Ä°Y GOL - Birden fazla key dene
        ev_iy_atan = ocr_data.get('iy_ev_gol', ocr_data.get('ev_iy_atan', ocr_data.get('iy_ev_atan', 0))) or 0
        dep_iy_atan = ocr_data.get('iy_dep_gol', ocr_data.get('dep_iy_atan', ocr_data.get('iy_dep_atan', 0))) or 0
        
        # âš ï¸ Ä°Y GOL 0 Ä°SE TAHMÄ°N ET
        # FormÃ¼l: Ä°Y Gol â‰ˆ Toplam gol yÃ¼zdesinin %45'i
        if ev_iy_atan <= 0 and ev_atan > 0:
            ev_iy_atan = ev_atan * 0.45
        if dep_iy_atan <= 0 and dep_atan > 0:
            dep_iy_atan = dep_atan * 0.45
        
        # Hala 0 ise varsayÄ±lan
        if ev_iy_atan <= 0:
            ev_iy_atan = 50
        if dep_iy_atan <= 0:
            dep_iy_atan = 50
        
        # ğŸ”§ YEMEME - Birden fazla key dene
        ev_yememe = ocr_data.get('ev_yememe', ocr_data.get('ev_cs', 0)) or 0
        dep_yememe = ocr_data.get('dep_yememe', ocr_data.get('dep_cs', 0)) or 0
        
        # âš ï¸ YEMEME 0 Ä°SE HESAPLA: 100 - Yenen%
        if ev_yememe <= 0:
            ev_yememe = max(10, 100 - ev_yiyen) if ev_yiyen > 0 else 35
        if dep_yememe <= 0:
            dep_yememe = max(10, 100 - dep_yiyen) if dep_yiyen > 0 else 35
        
        sut_ev = ocr_data.get('sut_ev', 0) or 0
        sut_dep = ocr_data.get('sut_dep', 0) or 0
        
        # âš ï¸ ÅUT 0 Ä°SE TAHMÄ°N ET
        if sut_ev <= 0:
            sut_ev = 13  # Lig ortalamasÄ±
        if sut_dep <= 0:
            sut_dep = 12
        
        sut_toplam = sut_ev + sut_dep
        
        conv_ev = ocr_data.get('conv_ev', 0) or 0
        conv_dep = ocr_data.get('conv_dep', 0) or 0
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ğŸ”§ KRÄ°TÄ°K DÃœZELTME: HESAPLAMALARI KENDÄ°MÄ°Z YAPALIM!
        # hesaplamalar dict'i boÅŸ geliyor, %0 hatasÄ± bundan kaynaklanÄ±yor
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        # GOL ORT: (Ev Atan 0.5Ãœ + Dep Atan 0.5Ãœ) / 2
        gol_ort = (ev_atan + dep_atan) / 2 if (ev_atan > 0 or dep_atan > 0) else 70
        
        # Ä°Y GOL DEÄERÄ°: (Ev Ä°Y Atan + Dep Ä°Y Atan) / 2
        iy_gol = (ev_iy_atan + dep_iy_atan) / 2 if (ev_iy_atan > 0 or dep_iy_atan > 0) else 50
        
        # Lig ortalamalarÄ± - OCR'dan veya varsayÄ±lan
        ust_05 = ocr_data.get('ust_05_ort', ocr_data.get('lig_05_ust', 95)) or 95
        ust_15 = ocr_data.get('ust_15_ort', ocr_data.get('lig_15_ust', 75)) or 75
        ust_25 = ocr_data.get('ust_25_ort', ocr_data.get('lig_25_ust', 55)) or 55
        ust_35 = ocr_data.get('ust_35_ort', ocr_data.get('lig_35_ust', 35)) or 35
        kg_ort = ocr_data.get('kg_var_ort', ocr_data.get('lig_kg', 55)) or 55
        
        # HÄ°BRÄ°T KG VAR: (((Ev Atan + Dep Atan) / 2) + KG Ort) / 2
        hibrit_kg = ((gol_ort) + kg_ort) / 2 if kg_ort > 0 else gol_ort
        
        # Conversion hesapla (eÄŸer 0 ise)
        if conv_ev == 0 and sut_ev > 0:
            gol_ort_ev = ocr_data.get('gol_ort_ev', 1.5) or 1.5
            conv_ev = (gol_ort_ev / sut_ev * 100) if sut_ev > 0 else 12
            conv_ev = max(5, min(25, conv_ev))  # %5-%25 arasÄ± makul
        
        if conv_dep == 0 and sut_dep > 0:
            gol_ort_dep = ocr_data.get('gol_ort_dep', 1.2) or 1.2
            conv_dep = (gol_ort_dep / sut_dep * 100) if sut_dep > 0 else 11
            conv_dep = max(5, min(25, conv_dep))
        
        # EÄŸer hala 0 ise varsayÄ±lan deÄŸerler
        if conv_ev == 0:
            conv_ev = 12  # Lig ortalamasÄ±
        if conv_dep == 0:
            conv_dep = 11
        
        nihai_banko = analiz_sonucu.get('nihai_banko', 'BELÄ°RLENEMEDÄ°')
        
        return f"""
# ğŸ“ XG-XRAY V5.8 - AÅAMA 3: PROFESYONEL SUNUM MODU

## ğŸ¯ SEN KÄ°MSÄ°N:
Sen XG-XRAY ANALÄ°STÄ°SÄ°N (DATA HUNTER). Duygusuz bir matematik motorusun.
TakÄ±m ismi Ã¶nemsiz, sadece rakamlar konuÅŸur. Her cÃ¼mlen VERÄ°YE DAYANMALI.

## âš ï¸ KRÄ°TÄ°K TALÄ°MATLAR:
1. PYTHON TÃœM HESAPLAMALARI YAPTI - SEN SADECE ÅABLONU DOLDUR
2. AÅŸaÄŸÄ±daki HAZIR VERÄ°LERÄ° kullan, KENDÄ° HESAPLAMA YAPMA
3. "Belki", "ÅansÄ± var" gibi yuvarlak laflar YASAK
4. NET konuÅŸ: "OynanÄ±r" veya "Oynanmaz"
5. TEKNÄ°K konuÅŸ: "KÃ¶tÃ¼" deÄŸil "Conversion %7, lig ortalamasÄ± altÄ±nda"
6. HER SATIRIN SONUNA HESABI YAZ (Ã¶rn: "(78+78)/2 = %78")

## ğŸš¨ HÄ°YERARÅÄ° KURALI (Ã‡OK Ã–NEMLÄ°!):
â›” YASAK: Ä°DEAL veya SÃœRPRÄ°Z gÃ¼ven puanÄ± ASLA BANKO'dan yÃ¼ksek olamaz!
âœ… ZORUNLU: En yÃ¼ksek gÃ¼ven puanÄ± alan seÃ§enek OTOMATÄ°K OLARAK BANKO'ya yazÄ±lÄ±r.

Ã–RNEK YANLIÅ:
âŒ BANKO: MS 1.5 ÃœST â†’ 6/10
âŒ Ä°DEAL: KG VAR â†’ 7/10  â† BU SAÃ‡MALIK!

Ã–RNEK DOÄRU:
âœ… BANKO: KG VAR â†’ 7/10 (En yÃ¼ksek puanlÄ±)
âœ… Ä°DEAL: MS 1.5 ÃœST â†’ 6/10 (Ä°kinci sÄ±rada)

## ğŸ”´ PYTHON MODU (ACIMISIZ KALÄ°BRASYON):
- YUVARLAMA YOK: %79.9 â†’ BAÅARISIZ (%80 deÄŸil!)
- ENFLASYON YOK: Python 6/10 verdiyse sen de 6/10 ver
- LÄ°G CEZASI: Elit lig deÄŸilse nihai puandan -1 dÃ¼ÅŸÃ¼ldÃ¼
- VETO Ã–NCELÄ°ÄÄ°: Giyotin/Conv uyarÄ±sÄ± varsa MAX 6/10

NÄ°HAÄ° GÃœVEN PUANI (PYTHON HESAPLADI): {guven}/10
NÄ°HAÄ° KASA ORANI: %{kasa_orani}

## ğŸ“Š PYTHON'DAN GELEN HAZIR VERÄ°LER:

### TEMEL VERÄ°LER:
- Ev TakÄ±mÄ±: {ev_takimi}
- Deplasman: {dep_takimi}
- Lig: {lig}
- Tarih: {tarih}

### OCR'DAN OKUNAN VERÄ°LER:
- Ev Atan 0.5Ãœ: %{ev_atan}
- Dep Atan 0.5Ãœ: %{dep_atan}
- Ev Yiyen 0.5Ãœ: %{ev_yiyen}
- Dep Yiyen 0.5Ãœ: %{dep_yiyen}
- Ev Ä°Y Atan: %{ev_iy_atan}
- Dep Ä°Y Atan: %{dep_iy_atan}
- Ev Yememe: %{ev_yememe}
- Dep Yememe: %{dep_yememe}
- xG Ev: {xg_ev:.2f}
- xG Dep: {xg_dep:.2f}
- Åut Ev: {sut_ev}
- Åut Dep: {sut_dep}
- Conv Ev: %{conv_ev}
- Conv Dep: %{conv_dep}

### LÄ°G ORTALAMALARI:
- 0.5 ÃœST: %{ust_05}
- 1.5 ÃœST: %{ust_15}
- 2.5 ÃœST: %{ust_25}
- 3.5 ÃœST: %{ust_35}
- KG VAR: %{kg_ort}

### HESAPLANAN DEÄERLER:
- GOL ORT: %{gol_ort:.1f}
- Ä°Y GOL DEÄERÄ°: %{iy_gol:.1f}
- HÄ°BRÄ°T KG VAR: %{hibrit_kg:.1f}
- xG TOPLAM: {xg_toplam:.2f}
- ÅUT TOPLAM: {sut_toplam}

### VETO KONTROLÃœ:
{veto_listesi}

### BANKO TARAMA (GEÃ‡ENLER):
{gecen_listesi}

### NÄ°HAÄ° BANKO (PYTHON SEÃ‡TÄ°):
{nihai_banko}

### GÃœVEN VE KASA:
- GÃ¼ven: {guven}/10 ({guven_emoji})
- Kasa: %{kasa_orani}

### Ä°Y RADAR:
- Karar: {iy_radar.get('karar', 'BELÄ°RSÄ°Z')}
- Puan: %{iy_gol:.1f}
- Baraj: %68

---

## ğŸ“‹ DOLDURULACAK ÅABLON (90 DAKÄ°KA ANALÄ°Z):

AÅŸaÄŸÄ±daki ÅŸablonu AYNEN doldur. Veriler Python tarafÄ±ndan hesaplandÄ±, sen sadece ÅŸablona yerleÅŸtir.

```
âš½ï¸ {ev_takimi.upper()} VS {dep_takimi.upper()}
ğŸ“… {tarih} | ğŸ† {lig}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š TEMEL Ä°STATÄ°STÄ°KLER
â€¢ MS 0.5 ÃœST : %{ust_05} {f"âœ…" if ust_05 >= 80 else "âš ï¸" if ust_05 >= 60 else "âŒ"}
â€¢ MS 1.5 ÃœST : %{ust_15} {f"âœ…" if ust_15 >= 80 else "âš ï¸" if ust_15 >= 60 else "âŒ"}
â€¢ MS 2.5 ÃœST : %{ust_25} {f"âœ…" if ust_25 >= 60 else "âš ï¸" if ust_25 >= 45 else "âŒ"}
â€¢ MS 3.5 ÃœST : %{ust_35} {f"âœ…" if ust_35 >= 45 else "âš ï¸" if ust_35 >= 30 else "âŒ"}
â€¢ KG VAR     : %{kg_ort} {f"âœ…" if kg_ort >= 65 else "âš ï¸" if kg_ort >= 50 else "âŒ"}
â€¢ Ä°Y 0.5 ÃœST : %{iy_gol:.0f} {f"âœ…" if iy_gol >= 60 else "âš ï¸" if iy_gol >= 45 else "âŒ"}
â€¢ Ev Gol GÃ¼cÃ¼ : %{ev_atan} {f"âœ…" if ev_atan >= 80 else "âš ï¸" if ev_atan >= 60 else "âŒ"}
â€¢ Dep Gol GÃ¼cÃ¼: %{dep_atan} {f"âœ…" if dep_atan >= 80 else "âš ï¸" if dep_atan >= 60 else "âŒ"}

ğŸ“ˆ Ä°LERÄ° SEVÄ°YE VERÄ°LER
â€¢ xG: {xg_ev:.2f} + {xg_dep:.2f} = {xg_toplam:.2f}
â€¢ Ev Atan: [OCR'dan gol ortalamasÄ±] gol/maÃ§
â€¢ Dep Atan: [OCR'dan gol ortalamasÄ±] gol/maÃ§
â€¢ Ev Seri: [Son 5 maÃ§ serisi - W/L/D]
â€¢ Dep Seri: [Son 5 maÃ§ serisi - W/L/D]

â­ï¸ EN KRÄ°TÄ°K 3 VERÄ°
1ï¸âƒ£ Toplam xG: {xg_toplam:.2f}
   â””â”€ [xG yÃ¼ksekse "Matematiksel gol beklentisi yÃ¼ksek", dÃ¼ÅŸÃ¼kse "Normal seviyede"]

2ï¸âƒ£ Gol GÃ¼Ã§leri: Ev %{ev_atan} / Dep %{dep_atan}
   â””â”€ [%80+ varsa "Her iki takÄ±m da yÃ¼ksek gol bulma oranÄ±na sahip"]

3ï¸âƒ£ KG VAR OranÄ±: %{kg_ort}
   â””â”€ [%65+ ise "KarÅŸÄ±lÄ±klÄ± gol ihtimali gÃ¼Ã§lÃ¼", deÄŸilse "Orta seviyede"]

ğŸ§  GOL Ã–NGÃ–RÃœSÃœ
[Bu bÃ¶lÃ¼mÃ¼ 4-5 cÃ¼mle olarak yaz. Spiker gibi anlat:]

{ev_takimi}, kendi sahasÄ±nda maÃ§ baÅŸÄ±na [gol_ort_ev] gol ortalamasÄ±yla rakiplerini tehdit ediyor. SavunmasÄ±nda ise maÃ§ baÅŸÄ±na [gol_yeme_ort_ev] gol gÃ¶rÃ¼yor ki bu da rakibin her an gol bulabileceÄŸini gÃ¶steriyor.

{dep_takimi} ise deplasmanda [gol_ort_dep] gol Ã¼retiyor ve [gol_yeme_ort_dep] gol yiyor. Her iki takÄ±mÄ±n da savunma zaaflarÄ± gÃ¶z Ã¶nÃ¼ne alÄ±ndÄ±ÄŸÄ±nda, bu maÃ§ta filelerin havalanmasÄ± kaÃ§Ä±nÄ±lmaz gÃ¶rÃ¼nÃ¼yor.

Toplam xG deÄŸeri {xg_toplam:.2f} ile matematiksel olarak [1.5/2.5] barajÄ±nÄ±n aÅŸÄ±lma ihtimali oldukÃ§a gÃ¼Ã§lÃ¼.

ğŸ“ Analiz Yorumu:
[Tek cÃ¼mlelik sonuÃ§ - Ã¶rn: "Her iki takÄ±mÄ±n gol Ã¼retimi %{gol_ort:.0f} istatistiÄŸiyle 2+ gol neredeyse kesin. 1.5 ÃœST gÃ¼venli."]

ğŸ’° NÄ°HAÄ° MATEMATÄ°KSEL TAHMÄ°N
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¯ BANKO: {nihai_banko}
ğŸ“Š GÃ¼ven: {guven}/10 {guven_emoji}
ğŸ’° Kasa : %{kasa_orani}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“± 90 DAKÄ°KA ANALÄ°Z
```

âš ï¸ Ã–NEMLÄ° KURALLAR:
1. TEMEL Ä°STATÄ°STÄ°KLER'de TÃœM verileri listele (âœ…, âš ï¸, âŒ dahil)
2. Ä°LERÄ° SEVÄ°YE VERÄ°LER'i kÄ±sa tut
3. KRÄ°TÄ°K 3 VERÄ°'de kÄ±sa aÃ§Ä±klamalar yaz
4. GOL Ã–NGÃ–RÃœSÃœ'nÃ¼ 4-5 cÃ¼mle olarak detaylÄ± yaz - bu kÄ±sÄ±m Ã¶nemli!
5. BANKO dÄ±ÅŸÄ±nda Ä°DEAL/SÃœRPRÄ°Z Ã¶nerme

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ§  BÃ–LÃœM 12: YAPAY ZEKA GOL Ã–NGÃ–RÃœSÃœ (BANKO'DAN BAÄIMSIZ ANALÄ°Z)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
(Kaynak: ATILAN GOLLER ve YENEN GOLLER TablolarÄ± - Ã‡APRAZ KARÅILAÅTIRMA)
(Bu bÃ¶lÃ¼m BANKO ne olursa olsun, maÃ§Ä±n gol potansiyelini AYRI analiz eder)

ğŸš¨ YENEN GOLLER VERÄ°SÄ° KULLANIMI:
- ev_yiyen = DEP ATAN deÄŸerine yakÄ±n olmalÄ± (Deplasman atÄ±yorsa, ev yiyordur)
- dep_yiyen = EV ATAN deÄŸerine yakÄ±n olmalÄ± (Ev atÄ±yorsa, deplasman yiyordur)
- ASLA %0 yazma! EÄŸer yenen goller tablosu yoksa, ATAN deÄŸerini kullan.
- Ã–rnek: Ev Atan %100, Dep Atan %89 ise â†’ ev_yiyen â‰ˆ %89, dep_yiyen â‰ˆ %100

âš½ 0.5 ÃœST ANALÄ°ZÄ° (KÄ°M ATAR?):
   â€¢ Ev Atan: %{ev_atan} vs Dep Yiyen: %{dep_yiyen}
   â€¢ Dep Atan: %{dep_atan} vs Ev Yiyen: %{ev_yiyen}
   
   â†’ Ã‡APRAZ EÅLEÅTÄ°RME:
     - {ev_takimi} Gol Ä°htimali: (Ev Atan + Dep Yiyen) / 2 = %{{ev_gol_ihtimali}}
     - {dep_takimi} Gol Ä°htimali: (Dep Atan + Ev Yiyen) / 2 = %{{dep_gol_ihtimali}}
   
   â†’ SONUÃ‡: {{gol_sonuc_aciklama}}
   â†’ Ã‡apraz EÅŸleÅŸme: {{capraz_eslesme_durumu}}

âš½ 1.5 ÃœST ANALÄ°ZÄ° (2+ GOL Ã‡IKAR MI?):
   â€¢ Ev Atan 1.5Ãœ: %{{ev_atan_15}} vs Dep Yiyen 1.5Ãœ: %{{dep_yiyen_15}}
   â€¢ Dep Atan 1.5Ãœ: %{{dep_atan_15}} vs Ev Yiyen 1.5Ãœ: %{{ev_yiyen_15}}
   
   â†’ KRÄ°TÄ°K KONTROL:
     - EÄŸer bir tarafÄ±n YEME oranÄ± %70+ ise â†’ "SÃœRPRÄ°Z GOL POTANSÄ°YELÄ°" âš ï¸
     - EÄŸer iki taraf da dÃ¼ÅŸÃ¼kse (<50%) â†’ "UZAK DUR" â›”
   
   â†’ SONUÃ‡: {{sonuc_15_aciklama}}

âš¡ CANLI TETÄ°KLEYÄ°CÄ° (MAÃ‡ Ä°Ã‡Ä° SAVAÅ PLANI):
   (Bu bÃ¶lÃ¼m SADECE gol atma/yeme istatistiÄŸi %80+ olan takÄ±mlar iÃ§in geÃ§erli)
   
   â€¢ {ev_takimi} Gol Atma: %{ev_atan} {"(â‰¥%80 âœ… AKTÄ°F)" if ev_atan >= 80 else "(<%80 - PASÄ°F)"}
   â€¢ {dep_takimi} Gol Atma: %{dep_atan} {"(â‰¥%80 âœ… AKTÄ°F)" if dep_atan >= 80 else "(<%80 - PASÄ°F)"}
   
   â†’ SENARYO 1: EÄŸer {ev_takimi} 0-1 geriye dÃ¼ÅŸerse â†’ CanlÄ±da {ev_takimi} 0.5 ÃœST (gol atma istatistiÄŸine gÃ¶re)
   â†’ SENARYO 2: EÄŸer {dep_takimi} 0-1 geriye dÃ¼ÅŸerse â†’ CanlÄ±da KG VAR veya {dep_takimi} 0.5 ÃœST takip
   â†’ SENARYO 3: HT 0-0 ise â†’ 2.YarÄ± 0.5 ÃœST deÄŸerlendir
   
   âš ï¸ KIRMIZI KART Ä°STÄ°SNASI: KÄ±rmÄ±zÄ± kart Ã§Ä±karsa TÃœM TETÄ°KLER Ä°PTAL!

âœ… NÄ°HAÄ° GOL KARARI (BÃ–LÃœM 12 SONUCU):
{ev_takimi} atar ({ev_atan}%), {dep_takimi} karÅŸÄ±lÄ±k verir ({dep_atan}%). MaÃ§ta GOL BEKLENTÄ°SÄ°: {{gol_beklentisi}}

ğŸš¨ KASA SÄ°GORTASI (EN GÃœVENLÄ° LÄ°MAN) ğŸš¨
ğŸ”’ SÄ°GORTA TERCÄ°HÄ°: "{sigorta_secimi}"
ğŸ“Š GÃœVEN: {sigorta_guven}/10
ğŸ“ SEBEP: {sigorta_sebep}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” BÃ–LÃœM 13: KURAL TARAMA KANITLARI (SYSTEM LOGS)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
{kanit_text}
```

## âš ï¸ SON UYARI:
- YukarÄ±daki ÅŸablonu AYNEN kullan, bÃ¶lÃ¼m sÄ±rasÄ±nÄ± BOZMA
- Her hesabÄ±n yanÄ±na formÃ¼lÃ¼ YAZ
- "Belki", "olabilir" gibi belirsiz kelimeler YASAK
- Veride gÃ¶rmediÄŸin ÅŸeyi UYDURMA

---
||VERI_BASLANGIC||
mac_adi={ev_takimi} vs {dep_takimi}
lig={lig}
banko={nihai_banko}
guven={guven}
kasa={kasa_orani}
xg_ev={xg_ev}
xg_dep={xg_dep}
ev_atan={ev_atan}
dep_atan={dep_atan}
ev_yiyen={ev_yiyen}
dep_yiyen={dep_yiyen}
ev_yememe={ev_yememe}
dep_yememe={dep_yememe}
ust_15={ust_15}
ust_25={ust_25}
ust_35={ust_35}
kg_var={kg_ort}
iy_ev_gol={ev_iy_atan}
iy_dep_gol={dep_iy_atan}
vetolar={len(vetolar)}
gecenler={len(gecenler)}
ev_gol_gucu={ev_gol_gucu:.0f}
dep_gol_gucu={dep_gol_gucu:.0f}
sigorta={sigorta_secimi}
||VERI_BITIS||
"""
    
    def _parse_and_save_v58(self, result, tarih, ocr_data, analiz_sonucu):
        """V70: Analiz sonucunu kaydet - GARANTÄ°LÄ° KAYIT SÄ°STEMÄ°"""
        print("â•" * 60)
        print("ğŸ”µ V70 _parse_and_save_v58 BAÅLADI")
        print("â•" * 60)
        
        # ASLA try-except iÃ§inde kayÄ±p olmayacak - her durumda kaydet!
        data = {
            "tarih": tarih,
            "id": hashlib.md5(f"{tarih}{time.time()}".encode()).hexdigest()[:8],
            "kayit_zamani": datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        }
        
        # 1. ||VERI_BASLANGIC|| bloÄŸundan oku
        try:
            match = re.search(r'\|\|VERI_BASLANGIC\|\|(.*?)\|\|VERI_BITIS\|\|', result, re.DOTALL)
            if match:
                veri_text = match.group(1)
                for line in veri_text.strip().split('\n'):
                    if '=' in line:
                        key, val = line.split('=', 1)
                        data[key.strip()] = val.strip()
                print(f"âœ… VERI bloÄŸundan {len(data)} anahtar okundu")
        except Exception as e:
            print(f"âš ï¸ VERI bloÄŸu parse hatasÄ±: {e}")
        
        # 2. Python'dan gelen deÄŸerleri ekle
        try:
            data["banko"] = analiz_sonucu.get('nihai_banko', data.get('banko', 'MS 1.5 ÃœST'))
            data["guven"] = analiz_sonucu.get('guven', 7)
            data["kasa"] = analiz_sonucu.get('kasa', 10)
            data["vetolar"] = [v.get('id', 'N/A') for v in analiz_sonucu.get('vetolar', [])]
            print(f"âœ… Analiz sonucu eklendi: Banko={data['banko']}, GÃ¼ven={data['guven']}")
        except Exception as e:
            print(f"âš ï¸ Analiz sonucu ekleme hatasÄ±: {e}")
        
        # 3. OCR verilerini ekle
        try:
            if ocr_data:
                data["xg_ev"] = ocr_data.get('xg_ev', '') or ''
                data["xg_dep"] = ocr_data.get('xg_dep', '') or ''
                data["ev_atan"] = ocr_data.get('ev_atan_05', '') or ''
                data["dep_atan"] = ocr_data.get('dep_atan_05', '') or ''
                data["ev_yiyen"] = ocr_data.get('ev_yenen_05', '') or ''
                data["dep_yiyen"] = ocr_data.get('dep_yenen_05', '') or ''
                data["lig"] = ocr_data.get('lig', data.get('lig', '')) or ''
                data["ev_takimi"] = ocr_data.get('ev_takimi', '') or ''
                data["dep_takimi"] = ocr_data.get('dep_takimi', '') or ''
                
                # V70 FIX: TÃœM ORANLARI KAYDET
                data["oran_ms1"] = ocr_data.get('oran_ms1', '') or ''
                data["oran_x"] = ocr_data.get('oran_x', '') or ''
                data["oran_ms2"] = ocr_data.get('oran_ms2', '') or ''
                data["oran_05u"] = ocr_data.get('oran_05u', '') or ''  # 0.5 Ãœst
                data["oran_15u"] = ocr_data.get('oran_15u', '') or ''  # 1.5 Ãœst
                data["oran_25u"] = ocr_data.get('oran_25u', '') or ''  # 2.5 Ãœst
                data["oran_35u"] = ocr_data.get('oran_35u', '') or ''  # 3.5 Ãœst
                data["oran_45u"] = ocr_data.get('oran_45u', '') or ''  # 4.5 Ãœst
                data["oran_kg"] = ocr_data.get('oran_kg', '') or ''    # KG VAR
                
                # Lig ortalamalarÄ±
                data["ust_15"] = ocr_data.get('ust_15_ort', '') or ''
                data["ust_25"] = ocr_data.get('ust_25_ort', '') or ''
                data["ust_35"] = ocr_data.get('ust_35_ort', '') or ''
                data["kg_var"] = ocr_data.get('kg_var_ort', '') or ''
                
                data["ocr_data"] = ocr_data
                data["analiz_sonucu"] = analiz_sonucu
                print(f"âœ… OCR verileri eklendi (oranlar dahil)")
        except Exception as e:
            print(f"âš ï¸ OCR veri ekleme hatasÄ±: {e}")
        
        # 4. mac_adi dÃ¼zelt
        try:
            if "mac_adi" in data:
                data["mac"] = data["mac_adi"].replace(" ", "_").replace("vs", "-")
            elif data.get("ev_takimi") and data.get("dep_takimi"):
                data["mac"] = f"{data['ev_takimi']} vs {data['dep_takimi']}"
            else:
                data["mac"] = f"Analiz_{tarih}_{data['id']}"
            print(f"âœ… MaÃ§ adÄ±: {data['mac']}")
        except Exception as e:
            print(f"âš ï¸ MaÃ§ adÄ± hatasÄ±: {e}")
            data["mac"] = f"Analiz_{tarih}"
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # 5. GARANTÄ°LÄ° KAYIT - HER DURUMDA Ã‡ALIÅACAK!
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        print("ğŸ”µ GARANTÄ°LÄ° KAYIT BAÅLIYOR...")
        
        # A) mac_db'ye ekle
        try:
            self.mac_db.append(data)
            print(f"âœ… mac_db'ye eklendi, toplam: {len(self.mac_db)}")
        except Exception as e:
            print(f"âŒ mac_db.append hatasÄ±: {e}")
        
        # B) JSON dosyasÄ±na kaydet
        try:
            self.db_kaydet()
            print(f"âœ… JSON dosyasÄ±na kaydedildi")
        except Exception as e:
            print(f"âŒ db_kaydet hatasÄ±: {e}")
        
        # C) FÄ°L HAFIZASINA ekle
        try:
            if hasattr(self, 'mac_arsivi'):
                mac_key = data.get("mac", "").replace(" ", "_").replace("-", "_").lower()
                if mac_key:
                    self.mac_arsivi[mac_key] = data
                    print(f"âœ… FÄ°L HAFIZASINA eklendi, toplam: {len(self.mac_arsivi)}")
        except Exception as e:
            print(f"âŒ FÄ°L HAFIZASI hatasÄ±: {e}")
        
        # D) current_analysis'i MUTLAKA gÃ¼ncelle!
        self.current_analysis = data
        print(f"âœ…âœ…âœ… current_analysis SET EDÄ°LDÄ°!")
        print(f"    mac: {self.current_analysis.get('mac', 'N/A')}")
        print(f"    banko: {self.current_analysis.get('banko', 'N/A')}")
        print(f"    guven: {self.current_analysis.get('guven', 'N/A')}")
        
        # E) Performans tracker
        try:
            if hasattr(self, 'performance') and self.performance:
                self.performance.add_match(data)
        except:
            pass
        
        # F) Listelere ekle
        try:
            mac_adi = data.get("mac", "Bilinmeyen")
            banko_upper = str(data.get("banko", "")).upper()
            
            if "2.5" in banko_upper and "ÃœST" in banko_upper:
                if not hasattr(self, 'listeler'):
                    self.listeler = {}
                self.listeler.setdefault("2.5_ust", []).append(mac_adi)
            
            if "1.5" in banko_upper and "ÃœST" in banko_upper:
                if not hasattr(self, 'listeler'):
                    self.listeler = {}
                self.listeler.setdefault("1.5_ust", []).append(mac_adi)
            
            if "KG" in banko_upper and "VAR" in banko_upper:
                if not hasattr(self, 'listeler'):
                    self.listeler = {}
                self.listeler.setdefault("kg_var", []).append(mac_adi)
        except:
            pass
        
        # G) V70: EXCEL OTOMATÄ°K EKLEME
        try:
            if hasattr(self, 'excel_otomatik_ekle'):
                self.excel_otomatik_ekle(data)
                print(f"ğŸ“Š Excel'e eklendi: {data.get('mac', 'N/A')}")
        except Exception as e:
            print(f"âš ï¸ Excel ekleme hatasÄ±: {e}")
        
        # H) V70: SEKME SENKRONÄ°ZASYONU
        try:
            self.root.after(500, self._v70_tum_sekmeleri_guncelle)
        except:
            pass
        
        print("â•" * 60)
        print(f"ğŸŸ¢ V70 KAYIT TAMAMLANDI: {data.get('mac', 'N/A')}")
        print(f"   ğŸ“Š mac_db: {len(self.mac_db)} maÃ§")
        print(f"   ğŸ“Š mac_arsivi: {len(self.mac_arsivi) if hasattr(self, 'mac_arsivi') else 0} maÃ§")
        print(f"   ğŸ“Š current_analysis: {'SET âœ…' if self.current_analysis else 'NONE âŒ'}")
        print("â•" * 60)
    
    def _v70_tum_sekmeleri_guncelle(self):
        """V70: Analiz sonrasÄ± TÃœM sekmelerin combobox'larÄ±nÄ± gÃ¼ncelle"""
        try:
            print("ğŸ”„ V70: TÃ¼m sekmeler gÃ¼ncelleniyor...")
            
            # Telegram
            if hasattr(self, 'tg_maclari_yukle'):
                self.tg_maclari_yukle()
            
            # Sosyal
            if hasattr(self, 'sosyal_maclari_yukle'):
                self.sosyal_maclari_yukle()
            
            # PuanlayÄ±cÄ±
            if hasattr(self, 'puan_maclari_yukle'):
                self.puan_maclari_yukle()
            
            # SimÃ¼latÃ¶r
            if hasattr(self, 'sim_maclari_yukle'):
                self.sim_maclari_yukle()
            
            # ArÅŸiv
            if hasattr(self, 'arsiv_yenile'):
                self.arsiv_yenile()
            
            print("âœ… V70: TÃ¼m sekmeler gÃ¼ncellendi!")
        except Exception as e:
            print(f"âš ï¸ Sekme gÃ¼ncelleme hatasÄ±: {e}")
    
    def _parse_and_save(self, result, tarih):
        """Analiz sonucunu parse et ve BÃ–LÃœM 5 ile BANKO seÃ§"""
        try:
            # ||VERI_BASLANGIC|| bloÄŸunu bul
            match = re.search(r'\|\|VERI_BASLANGIC\|\|(.*?)\|\|VERI_BITIS\|\|', result, re.DOTALL)
            if match:
                veri_text = match.group(1)
                data = {"tarih": tarih, "id": hashlib.md5(f"{tarih}{time.time()}".encode()).hexdigest()[:8]}
                
                for line in veri_text.strip().split('\n'):
                    if '=' in line:
                        key, val = line.split('=', 1)
                        data[key.strip()] = val.strip()
                
                # mac_adi dÃ¼zelt
                if "mac_adi" in data:
                    data["mac"] = data["mac_adi"].replace(" ", "_")
                
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                # ğŸ¯ BÃ–LÃœM 5 HÄ°YERARÅÄ°K BANKO SEÃ‡Ä°MÄ°
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                # Gemini'nin topladÄ±ÄŸÄ± verileri BÃ–LÃœM 5'e gÃ¶nder
                mac_verisi = {
                    "ev_atan": data.get("ev_atan", 70),
                    "dep_atan": data.get("dep_atan", 70),
                    "ev_yiyen": data.get("ev_yiyen", 50),
                    "dep_yiyen": data.get("dep_yiyen", 50),
                    "xg": data.get("xg", 2.5),
                    "xg_ev": data.get("xg_ev", 1.3),
                    "xg_dep": data.get("xg_dep", 1.2),
                    "ust_15": data.get("ust_15", 75),
                    "ust_25": data.get("ust_25", 60),
                    "ust_35": data.get("ust_35", 40),
                    "kg_var": data.get("kg_var", 55),
                    "oran": data.get("oran", 1.80),
                    "conv_ev": data.get("conv_ev", 12),
                    "conv_dep": data.get("conv_dep", 12),
                    "sut_ev": data.get("sut_ev", 12),
                    "sut_dep": data.get("sut_dep", 10),
                    "iy_ev_gol": data.get("iy_ev_gol", 60),
                    "iy_dep_gol": data.get("iy_dep_gol", 55),
                    "lig_gol_ort": data.get("lig_gol_ort", 2.5),
                    "ev_yememe": data.get("ev_yememe", 30),
                    "dep_yememe": data.get("dep_yememe", 30),
                    "mac_adi": data.get("mac_adi", ""),
                    "lig": data.get("lig", ""),
                }
                
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                # ğŸ¯ HÄ°BRÄ°T SÄ°STEM: BÃ–LÃœM 5 + GEMÄ°NÄ° ONAY
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                # ADIM 1: BÃ–LÃœM 5 tÃ¼m kurallarÄ± tarar, geÃ§enleri listeler
                # ADIM 2: Gemini bu listeden en iyisini seÃ§er (lig analizi ile)
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                
                try:
                    bolum5_sonuc = bolum5_banko_sec(mac_verisi)
                    
                    # BÃ–LÃœM 5'in bulduÄŸu TÃœM geÃ§en bahisler
                    tum_gecenler = bolum5_sonuc.get("tum_gecenler", [])
                    
                    # Gemini'nin seÃ§tiÄŸi banko (analiz metninden)
                    gemini_banko = data.get("banko", "MS 1.5 ÃœST")
                    
                    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    # HÄ°BRÄ°T KARAR MEKANÄ°ZMASI
                    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    # Ã–ncelik sÄ±rasÄ± (en cesurdan en gÃ¼venliye):
                    # 1. MS 3.5 ÃœST
                    # 2. MS 2.5 ÃœST  
                    # 3. KG VAR
                    # 4. MS TARAF (MS1/MS2)
                    # 5. TAKIM 1.5 ÃœST
                    # 6. TAKIM 0.5 ÃœST
                    # 7. MS 1.5 ÃœST (son Ã§are - en gÃ¼venli)
                    
                    oncelik_sirasi = [
                        "MS 3.5 ÃœST",
                        "MS 2.5 ÃœST", 
                        "KG VAR",
                        "MS 1", "MS 2", "MS1", "MS2", "EV KAZANIR", "DEP KAZANIR",
                        "EV TAKIM 1.5 ÃœST", "DEP TAKIM 1.5 ÃœST",
                        "EV TAKIM 0.5 ÃœST", "DEP TAKIM 0.5 ÃœST",
                        "MS 1.5 ÃœST"
                    ]
                    
                    # Gemini'nin seÃ§tiÄŸi banko, BÃ–LÃœM 5'in geÃ§enlerinde var mÄ±?
                    gemini_banko_upper = gemini_banko.upper().strip()
                    gecenler_upper = [g.upper().strip() for g in tum_gecenler]
                    
                    # Gemini bankosunu normalize et
                    gemini_normalized = gemini_banko_upper.replace("MS ", "").replace("ÃœST", "").strip()
                    
                    banko_bulundu = False
                    final_banko = gemini_banko  # VarsayÄ±lan: Gemini'nin seÃ§tiÄŸi
                    
                    # Gemini'nin seÃ§tiÄŸi, BÃ–LÃœM 5'te var mÄ± kontrol et
                    for gecen in tum_gecenler:
                        gecen_upper = gecen.upper().strip()
                        if (gemini_banko_upper in gecen_upper or 
                            gecen_upper in gemini_banko_upper or
                            gemini_normalized in gecen_upper):
                            banko_bulundu = True
                            final_banko = gemini_banko
                            break
                    
                    # EÄŸer Gemini'nin seÃ§tiÄŸi BÃ–LÃœM 5'te yoksa,
                    # BÃ–LÃœM 5'in Ã¶ncelik sÄ±rasÄ±na gÃ¶re en yÃ¼ksek olanÄ± seÃ§
                    if not banko_bulundu and tum_gecenler:
                        for oncelikli in oncelik_sirasi:
                            for gecen in tum_gecenler:
                                if oncelikli.upper() in gecen.upper():
                                    final_banko = gecen
                                    banko_bulundu = True
                                    break
                            if banko_bulundu:
                                break
                        
                        # Hala bulunamadÄ±ysa ilk geÃ§eni al
                        if not banko_bulundu:
                            final_banko = tum_gecenler[0]
                    
                    # FÄ°NAL BANKO ATAMASI
                    data["banko"] = final_banko
                    data["gemini_onerisi"] = gemini_banko
                    data["bolum5_banko"] = bolum5_sonuc.get("banko", "MS 1.5 ÃœST")
                    data["bolum5_gecenler"] = tum_gecenler
                    
                    # BÃ–LÃœM 5 detaylarÄ±nÄ± kaydet
                    data["banko_detay"] = {
                        "asama": bolum5_sonuc.get("asama", 0),
                        "kural_no": bolum5_sonuc.get("kural_no", 0),
                        "kural_adi": bolum5_sonuc.get("kural_adi", ""),
                        "sartlar": bolum5_sonuc.get("sartlar", []),
                        "alternatif": bolum5_sonuc.get("alternatif", ""),
                        "guclu": bolum5_sonuc.get("guclu", False),
                        "vetolar": bolum5_sonuc.get("vetolar", []),
                        "tum_gecenler": tum_gecenler,
                        "hibrit_karar": f"Gemini: {gemini_banko} | BÃ–LÃœM 5 geÃ§enler: {', '.join(tum_gecenler) if tum_gecenler else 'YOK'}"
                    }
                    
                    # GÃ¼ven puanÄ±nÄ± ayarla
                    if bolum5_sonuc.get("guclu"):
                        try:
                            mevcut_guven = int(data.get("guven", 7))
                            data["guven"] = min(10, mevcut_guven + 1)
                        except:
                            pass
                    
                    # Alternatif = sigorta
                    if bolum5_sonuc.get("alternatif"):
                        data["sigorta"] = bolum5_sonuc.get("alternatif")
                    
                    print(f"âœ… HÄ°BRÄ°T BANKO: {final_banko}")
                    print(f"   ğŸ“Š Gemini Ã¶nerisi: {gemini_banko}")
                    print(f"   ğŸ“‹ BÃ–LÃœM 5 geÃ§enler: {tum_gecenler}")
                    
                except Exception as e:
                    print(f"âš ï¸ BÃ–LÃœM 5 hatasÄ±: {e} - Gemini bankosunu kullanÄ±yorum")
                
                # VeritabanÄ±na ekle
                self.mac_db.append(data)
                self.db_kaydet()
                
                # V5.7 FIX: current_analysis'i gÃ¼ncelle - tÃ¼m butonlar Ã§alÄ±ÅŸsÄ±n
                self.current_analysis = data
                
                # Performans tracker'a ekle
                self.performance.add_match(data)
                
                # ğŸ“Š OTOMATÄ°K EXCEL'E EKLE
                if hasattr(self, 'excel_otomatik_ekle'):
                    try:
                        self.excel_otomatik_ekle(data)
                    except Exception as excel_err:
                        print(f"âš ï¸ Excel otomatik ekleme hatasÄ±: {excel_err}")
        except Exception as e:
            print(f"Parse hatasÄ±: {e}")
    
    def _analiz_bitti(self, result):
        self.txt_result.delete(1.0, tk.END)
        self.txt_result.insert(tk.END, result)
        self.btn_analyze.config(state="normal", text=f"ğŸš€ ANALÄ°ZÄ° BAÅLAT ({TOPLAM_KURAL} KURAL)")
        self.progress_frame.pack_forget()
        self.lbl_status.config(text="âœ… Analiz tamamlandÄ±!", fg=self.theme["success"])
        self.arsiv_yenile()
        self.listeleri_guncelle()
    
    def _analiz_hata(self, hata):
        self.txt_result.delete(1.0, tk.END)
        self.txt_result.insert(tk.END, f"âŒ HATA: {hata}")
        self.btn_analyze.config(state="normal", text=f"ğŸš€ ANALÄ°ZÄ° BAÅLAT ({TOPLAM_KURAL} KURAL)")
        self.progress_frame.pack_forget()
        self.lbl_status.config(text=f"âŒ Hata!", fg=self.theme["error"])
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ARÅÄ°V FONKSÄ°YONLARI
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def arsiv_yenile(self):
        for item in self.tree_arsiv.get_children():
            self.tree_arsiv.delete(item)
        
        filtre = self.combo_filtre.get()
        
        # V70 DEBUG: KaÃ§ maÃ§ var?
        print(f"ğŸ“‹ ArÅŸiv yenileniyor... mac_db'de {len(self.mac_db)} maÃ§ var")
        
        for mac in reversed(self.mac_db[-100:]):
            sonuc = mac.get("sonuc", "BEKLÄ°YOR")
            
            if filtre != "TÃ¼mÃ¼" and sonuc != filtre:
                continue
            
            # V5.7: Tag belirle - renklendirme iÃ§in
            if sonuc in ["KAZANDI", "âœ…", "KAZANAN"]:
                tag = "kazandi"
                sonuc_text = "âœ… KAZANDI"
            elif sonuc in ["KAYBETTÄ°", "âŒ", "KAYBEDEN"]:
                tag = "kaybetti"
                sonuc_text = "âŒ KAYBETTÄ°"
            else:
                tag = "bekliyor"
                sonuc_text = "â³ BEKLÄ°YOR"
            
            self.tree_arsiv.insert("", "end", values=(
                mac.get("tarih", "?"),
                mac.get("mac", mac.get("mac_adi", "?")).replace("_", " "),
                mac.get("banko", "?"),
                mac.get("sigorta", "?"),
                mac.get("guven", "?"),
                mac.get("kasa", "10"),
                sonuc_text
            ), tags=(tag,))
            self.mac_id_map[mac.get("mac", "")] = mac.get("id", "")
    
    def arsiv_ara(self):
        arama = self.entry_search.get().strip().lower()
        for item in self.tree_arsiv.get_children():
            self.tree_arsiv.delete(item)
        
        for mac in reversed(self.mac_db):
            mac_adi = mac.get("mac", mac.get("mac_adi", "")).lower()
            if arama in mac_adi:
                self.tree_arsiv.insert("", "end", values=(
                    mac.get("tarih", "?"),
                    mac.get("mac", mac.get("mac_adi", "?")).replace("_", " "),
                    mac.get("banko", "?"),
                    mac.get("sigorta", "?"),
                    mac.get("guven", "?"),
                    mac.get("sonuc", "BEKLÄ°YOR")
                ))
    
    def arsiv_detay(self, event):
        sel = self.tree_arsiv.selection()
        if not sel:
            return
        
        values = self.tree_arsiv.item(sel[0], "values")
        mac_adi = values[1].replace(" ", "_")
        
        for mac in self.mac_db:
            if mac.get("mac", mac.get("mac_adi", "")).replace(" ", "_") == mac_adi:
                popup = tk.Toplevel(self.root)
                popup.title(f"ğŸ“Š {values[1]}")
                popup.geometry("700x600")
                popup.configure(bg=self.theme["bg"])
                
                # Buton Ã§erÃ§evesi
                btn_frame = tk.Frame(popup, bg=self.theme["bg"])
                btn_frame.pack(fill="x", padx=10, pady=5)
                
                tk.Button(btn_frame, text="ğŸ“¤ TELEGRAM'A GÃ–NDER", command=lambda m=mac: self.arsiv_telegram_gonder(m, popup),
                         bg="#0088cc", fg="white", font=("Arial", 10, "bold")).pack(side="left", padx=5)
                tk.Button(btn_frame, text="ğŸ“‹ KOPYALA", command=lambda m=mac: self.arsiv_kopyala(m),
                         bg="#28a745", fg="white").pack(side="left", padx=5)
                tk.Button(btn_frame, text="âŒ KAPAT", command=popup.destroy,
                         bg="#dc3545", fg="white").pack(side="right", padx=5)
                
                # Metin alanÄ±
                txt = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
                txt.pack(expand=True, fill="both", padx=10, pady=10)
                
                for k, v in mac.items():
                    txt.insert(tk.END, f"{k}: {v}\n")
                
                txt.config(state="disabled")
                break
    
    def arsiv_telegram_gonder(self, mac_data, popup_window=None):
        """ArÅŸivdeki maÃ§Ä± Telegram'a gÃ¶nder - V5.8 DÃœZGÃœN FORMAT"""
        try:
            # Verileri al
            mac_adi = mac_data.get("mac", mac_data.get("mac_adi", "Bilinmeyen MaÃ§")).replace("_", " ")
            lig = mac_data.get("lig", "?")
            tarih = mac_data.get("tarih", "?")
            banko = mac_data.get("banko", "?")
            
            # Sigorta - bankonun 1 tÄ±k altÄ±
            sigorta = self.telegram._sigorta_belirle(banko) if hasattr(self, 'telegram') else "MS 0.5 ÃœST"
            
            # GÃ¼ven ve kasa
            guven = mac_data.get("guven", 7)
            try:
                guven_sayi = int(str(guven).split("/")[0])
            except:
                guven_sayi = 7
            kasa = KASA_ORANLARI.get(guven_sayi, {"oran": 10})["oran"]
            
            mesaj = f"""ğŸ“Š *DETAYLI ANALÄ°Z*
âš½ï¸ {mac_adi}
ğŸ“… {tarih} | ğŸ† {lig}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ *TAHMÄ°N*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… *BANKO:* {banko}
ğŸ›¡ï¸ *SÄ°GORTA:* {sigorta}
ğŸ“Š *GÃœVEN:* {guven_sayi}/10
ğŸ’° *KASA:* %{kasa}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“± _90 DAKÄ°KA ANALÄ°Z_"""
            
            # Kanal seÃ§ici ile gÃ¶nder
            self.kanal_sec_ve_gonder(mesaj, "ArÅŸiv Analizi")
            
            if popup_window:
                popup_window.destroy()
                
        except Exception as e:
            messagebox.showerror("Hata", f"Telegram'a gÃ¶nderilemedi:\n{e}")
    
    def arsiv_kopyala(self, mac_data):
        """ArÅŸiv verisini panoya kopyala"""
        try:
            # TÃ¼m veriyi metin olarak oluÅŸtur
            metin = ""
            for k, v in mac_data.items():
                metin += f"{k}: {v}\n"
            
            # Panoya kopyala
            self.root.clipboard_clear()
            self.root.clipboard_append(metin)
            messagebox.showinfo("BaÅŸarÄ±lÄ±", "âœ… Veriler panoya kopyalandÄ±!")
            
        except Exception as e:
            messagebox.showerror("Hata", f"Kopyalama hatasÄ±:\n{e}")
    
    def arsiv_sag_tik(self, event):
        """SaÄŸ tÄ±k menÃ¼sÃ¼ gÃ¶ster"""
        # TÄ±klanan item'i seÃ§
        item = self.tree_arsiv.identify_row(event.y)
        if item:
            self.tree_arsiv.selection_set(item)
            
            # SaÄŸ tÄ±k menÃ¼sÃ¼ oluÅŸtur
            menu = tk.Menu(self.root, tearoff=0)
            menu.add_command(label="ğŸ” Ä°NCELE (Otopsi)", command=self.arsiv_otopsi)
            menu.add_command(label="ğŸ“¤ TELEGRAM'A GÃ–NDER", command=lambda: self.arsiv_telegram_gonder_secili())
            menu.add_separator()
            menu.add_command(label="ğŸ—‘ï¸ SÄ°L", command=self.arsiv_secili_sil)
            
            menu.post(event.x_root, event.y_root)
    
    def arsiv_telegram_gonder_secili(self):
        """SeÃ§ili maÃ§Ä± Telegram'a gÃ¶nder"""
        sel = self.tree_arsiv.selection()
        if not sel:
            return
        
        values = self.tree_arsiv.item(sel[0], "values")
        mac_adi = values[1].replace(" ", "_")
        
        for mac in self.mac_db:
            if mac.get("mac", mac.get("mac_adi", "")).replace(" ", "_") == mac_adi:
                self.arsiv_telegram_gonder(mac)
                break
    
    def arsiv_otopsi(self):
        """MAÃ‡ OTOPSÄ°SÄ° - Neden yattÄ± analizi"""
        sel = self.tree_arsiv.selection()
        if not sel:
            return
        
        values = self.tree_arsiv.item(sel[0], "values")
        mac_adi = values[1].replace(" ", "_")
        
        for mac in self.mac_db:
            if mac.get("mac", mac.get("mac_adi", "")).replace(" ", "_") == mac_adi:
                # Otopsi penceresi aÃ§
                popup = tk.Toplevel(self.root)
                popup.title(f"ğŸ” MAÃ‡ OTOPSÄ°SÄ° - {values[1]}")
                popup.geometry("800x700")
                popup.configure(bg=self.theme["bg"])
                
                # BaÅŸlÄ±k
                tk.Label(popup, text="ğŸ” MAÃ‡ OTOPSÄ°SÄ°", font=("Arial", 16, "bold"),
                        bg=self.theme["bg"], fg=self.theme["accent"]).pack(pady=10)
                
                # Metin alanÄ±
                txt = scrolledtext.ScrolledText(popup, font=("Consolas", 10), 
                                               bg="#0a0a0a", fg="#00ff00", wrap=tk.WORD)
                txt.pack(expand=True, fill="both", padx=10, pady=10)
                
                # Otopsi raporu oluÅŸtur
                rapor = self._otopsi_raporu_olustur(mac)
                txt.insert(tk.END, rapor)
                txt.config(state="disabled")
                
                # Kapat butonu
                tk.Button(popup, text="âŒ KAPAT", command=popup.destroy,
                         bg="#dc3545", fg="white", font=("Arial", 11)).pack(pady=10)
                break
    
    def _otopsi_raporu_olustur(self, mac):
        """
        GELÄ°ÅMÄ°Å OTOPSÄ° RAPORU - OtopsiSistemi kullanÄ±r
        
        Yeni Ã¶zellikler:
        - BÃ–LÃœM 5 kural analizi (hangi kuralla seÃ§ildi)
        - DetaylÄ± neden yattÄ± analizi
        - Kural ihlalleri tespiti
        - Ã–ÄŸrenme iÃ§in ders Ã§Ä±karma
        """
        # GerÃ§ek skor ve oynanan banko
        skor = mac.get("skor", "")
        banko = mac.get("banko", "?")
        
        # OtopsiSistemi ile detaylÄ± rapor oluÅŸtur
        try:
            otopsi = OtopsiSistemi(mac, skor, banko)
            return otopsi.metin_rapor()
        except Exception as e:
            # Hata durumunda eski basit rapor
            return self._basit_otopsi_raporu(mac, str(e))
    
    def _basit_otopsi_raporu(self, mac, hata_mesaji=""):
        """Yedek basit otopsi raporu (hata durumunda)"""
        rapor = "=" * 70 + "\n"
        rapor += "ğŸ“Š MAÃ‡ OTOPSÄ°SÄ° (BASÄ°T)\n"
        rapor += "=" * 70 + "\n\n"
        
        if hata_mesaji:
            rapor += f"âš ï¸ GeliÅŸmiÅŸ otopsi hatasÄ±: {hata_mesaji}\n\n"
        
        # Temel bilgiler
        mac_adi = mac.get("mac_adi", mac.get("mac", "?"))
        banko = mac.get("banko", "?")
        sigorta = mac.get("sigorta", "?")
        guven = mac.get("guven", "?")
        skor = mac.get("skor", "?")
        sonuc = mac.get("sonuc", "?")
        
        rapor += f"âš½ MAÃ‡: {mac_adi}\n"
        rapor += f"ğŸ“… TARÄ°H: {mac.get('tarih', '?')}\n"
        rapor += f"ğŸ† LÄ°G: {mac.get('lig', '?')}\n\n"
        
        rapor += f"âœ… SKOR: {skor}\n"
        rapor += f"ğŸ¯ TAHMÄ°N: {banko}\n"
        rapor += f"ğŸ›¡ï¸ SÄ°GORTA: {sigorta}\n"
        rapor += f"ğŸ“Š GÃœVEN: {guven}/10\n"
        rapor += f"{'âŒ SONUÃ‡: YATTI' if sonuc == 'YATTI' else 'âœ… SONUÃ‡: TUTTU'}\n\n"
        
        # Ä°statistikler
        rapor += "=" * 70 + "\n"
        rapor += "ğŸ“ˆ Ä°STATÄ°STÄ°KLER\n"
        rapor += "=" * 70 + "\n\n"
        
        ev_atan = mac.get("ev_atan", "?")
        dep_atan = mac.get("dep_atan", "?")
        ev_yiyen = mac.get("ev_yiyen", "?")
        dep_yiyen = mac.get("dep_yiyen", "?")
        xg = mac.get("xg", "?")
        ust_15 = mac.get("ust_15", "?")
        ust_25 = mac.get("ust_25", "?")
        
        rapor += f"ğŸ  Ev Gol Atma: %{ev_atan}\n"
        rapor += f"ğŸ  Ev Gol Yeme: %{ev_yiyen}\n"
        rapor += f"âœˆï¸  Dep Gol Atma: %{dep_atan}\n"
        rapor += f"âœˆï¸  Dep Gol Yeme: %{dep_yiyen}\n"
        rapor += f"âš¡ Toplam xG: {xg}\n"
        rapor += f"ğŸ“Š MS 1.5Ãœ: %{ust_15}\n"
        rapor += f"ğŸ“Š MS 2.5Ãœ: %{ust_25}\n\n"
        
        # Otopsi analizi - Neden yattÄ±?
        if sonuc == "YATTI":
            rapor += "=" * 70 + "\n"
            rapor += "ğŸ” NEDEN YATTI?\n"
            rapor += "=" * 70 + "\n\n"
            
            uyari_sayisi = 0
            
            # KURAL 1: Ev Ã§ok gol yiyen + MS1 oynama
            try:
                if "MS 1" in banko or "MS1" in banko or "EV KAZANIR" in banko:
                    if float(str(ev_yiyen).replace("%", "")) >= 80:
                        uyari_sayisi += 1
                        rapor += f"{uyari_sayisi}. âš ï¸ KURAL Ä°HLALÄ°: EV Ã‡OK GOL YÄ°YOR\n"
                        rapor += f"   - Ev Yiyen: %{ev_yiyen} (â‰¥80% RÄ°SKLÄ°!)\n"
                        rapor += f"   - Tahmin: {banko}\n"
                        rapor += f"   - KURAL: Ev %80+ gol yiyorsa MS1 oynama!\n\n"
            except:
                pass
            
            # KURAL 2: Dep Ã§ok gol atÄ±yor + MS1 oynama
            try:
                if "MS 1" in banko or "MS1" in banko or "EV KAZANIR" in banko:
                    if float(str(dep_atan).replace("%", "")) >= 80:
                        uyari_sayisi += 1
                        rapor += f"{uyari_sayisi}. âš ï¸ KURAL Ä°HLALÄ°: DEPLASMAN Ã‡OK GOLCÃœ\n"
                        rapor += f"   - Dep Atan: %{dep_atan} (â‰¥80% Ã§ok yÃ¼ksek!)\n"
                        rapor += f"   - Tahmin: {banko}\n"
                        rapor += f"   - KURAL: Dep %80+ gol atÄ±yorsa MS1 riskli!\n\n"
            except:
                pass
            
            # KURAL 3: Her iki takÄ±m golcÃ¼ + MS1/MS2 oynama
            try:
                if "MS 1" in banko or "MS 2" in banko:
                    ev_atan_f = float(str(ev_atan).replace("%", ""))
                    dep_atan_f = float(str(dep_atan).replace("%", ""))
                    if ev_atan_f >= 75 and dep_atan_f >= 75:
                        uyari_sayisi += 1
                        rapor += f"{uyari_sayisi}. âš ï¸ Ã‡ELÄ°ÅKÄ°: HER Ä°KÄ° TAKIM DA GOLCÃœ\n"
                        rapor += f"   - Ev Atan: %{ev_atan}\n"
                        rapor += f"   - Dep Atan: %{dep_atan}\n"
                        rapor += f"   - Tahmin: {banko}\n"
                        rapor += f"   - SONUÃ‡: Her iki takÄ±m da gol atabilir!\n"
                        rapor += f"   - Ã–NERÄ°: GOL oynamalÄ±ydÄ±n (1.5Ãœ, KG VAR)\n\n"
            except:
                pass
            
            # KURAL 4: xG dÃ¼ÅŸÃ¼k ama ÃœST oynama
            try:
                if "ÃœST" in banko or "UST" in banko:
                    xg_f = float(str(xg))
                    if xg_f < 2.5:
                        uyari_sayisi += 1
                        rapor += f"{uyari_sayisi}. âš ï¸ DÃœÅÃœK xG UYARISI\n"
                        rapor += f"   - Toplam xG: {xg} (< 2.5 dÃ¼ÅŸÃ¼k!)\n"
                        rapor += f"   - Tahmin: {banko}\n"
                        rapor += f"   - KURAL: xG < 2.5 ise ÃœST riskli!\n\n"
            except:
                pass
            
            if uyari_sayisi == 0:
                rapor += "â€¢ KURAL Ä°HLALÄ° YOK - Sadece ÅŸans faktÃ¶rÃ¼\n"
                rapor += "â€¢ MaÃ§ beklenmedik geliÅŸti\n\n"
            
            # DoÄŸru tahmin Ã¶nerisi
            rapor += "=" * 70 + "\n"
            rapor += "ğŸ’¡ DOÄRU TAHMÄ°N NEYDÄ°?\n"
            rapor += "=" * 70 + "\n\n"
            
            try:
                ev_atan_f = float(str(ev_atan).replace("%", ""))
                dep_atan_f = float(str(dep_atan).replace("%", ""))
                
                if ev_atan_f >= 75 and dep_atan_f >= 75:
                    rapor += "âœ“ MS 1.5 ÃœST veya KG VAR\n"
                    rapor += "  (Her iki takÄ±m da golcÃ¼)\n\n"
                elif ev_atan_f >= 80:
                    rapor += "âœ“ EV TAKIM GOL ATAR (0.5Ãœ, 1.5Ãœ)\n\n"
                elif dep_atan_f >= 80:
                    rapor += "âœ“ DEPLASMAN GOL ATAR (0.5Ãœ, KG VAR)\n\n"
            except:
                rapor += "â€¢ Ä°statistikler yetersiz\n\n"
        
        else:  # TUTTU
            rapor += "=" * 70 + "\n"
            rapor += "âœ… NEDEN TUTTU?\n"
            rapor += "=" * 70 + "\n\n"
            rapor += "â€¢ DoÄŸru analiz yapÄ±ldÄ±\n"
            rapor += "â€¢ Ä°statistikler destekledi\n"
            rapor += "â€¢ Tahmin ile sonuÃ§ uyumlu\n\n"
        
        # Ders Ã§Ä±karÄ±lacaklar
        rapor += "=" * 70 + "\n"
        rapor += "ğŸ“š DERS Ã‡IKARILACAKLAR\n"
        rapor += "=" * 70 + "\n\n"
        
        try:
            ev_yiyen_f = float(str(ev_yiyen).replace("%", ""))
            dep_atan_f = float(str(dep_atan).replace("%", ""))
            
            if ev_yiyen_f >= 80:
                rapor += "âœ“ Ev %80+ gol yiyorsa MS1 oynama\n"
            if dep_atan_f >= 80:
                rapor += "âœ“ Dep %80+ gol atÄ±yorsa MS1 riskli\n"
            if ev_yiyen_f >= 70 and dep_atan_f >= 70:
                rapor += "âœ“ Her iki takÄ±m golcÃ¼yse GOL oyna (taraf deÄŸil)\n"
        except:
            pass
        
        rapor += "âœ“ SimÃ¼lasyona da bak (Ã§eliÅŸki varsa dikkatli ol)\n"
        rapor += "âœ“ GÃ¼ven 7'nin altÄ±ndaysa kasa oranÄ±nÄ± dÃ¼ÅŸÃ¼r\n"
        
        rapor += "\n" + "=" * 70 + "\n"
        rapor += "ğŸ“Š 90 DAKÄ°KA ANALÄ°Z - Otopsi Raporu\n"
        rapor += "=" * 70 + "\n"
        
        return rapor
    
    def arsiv_secili_sil(self):
        """FIX #17-18: SeÃ§ili maÃ§larÄ± arÅŸivden sil - geri al iÃ§in kaydet"""
        secili = self.tree_arsiv.selection()
        if not secili:
            messagebox.showwarning("UyarÄ±", "Silmek iÃ§in maÃ§ seÃ§in!")
            return
        
        if not messagebox.askyesno("Onay", f"{len(secili)} maÃ§ silinecek. Emin misiniz?"):
            return
        
        # FIX #18: Silmeden Ã¶nce yedekle - geri al iÃ§in
        self.son_silinen = self.mac_db.copy()
        
        silinen = 0
        for item in secili:
            values = self.tree_arsiv.item(item, "values")
            mac_adi = values[1].replace(" ", "_")
            
            # mac_db'den sil
            for i, mac in enumerate(self.mac_db):
                if mac.get("mac", mac.get("mac_adi", "")).replace(" ", "_") == mac_adi:
                    del self.mac_db[i]
                    silinen += 1
                    break
        
        # Kaydet ve yenile
        self.db_kaydet()
        self.arsiv_yenile()
        messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… {silinen} maÃ§ silindi!\n\nğŸ’¡ Geri almak iÃ§in 'â†©ï¸ GERÄ° AL' butonunu kullanÄ±n.")
    
    def arsiv_tumunu_sil(self):
        """TÃ¼m arÅŸivi temizle"""
        if not self.mac_db:
            messagebox.showwarning("UyarÄ±", "Silinecek maÃ§ yok!")
            return
        
        if not messagebox.askyesno("âš ï¸ DÄ°KKAT", f"TÃœM {len(self.mac_db)} maÃ§ silinecek!\n\nEmin misiniz?"):
            return
        
        # FIX #18: Silmeden Ã¶nce yedekle
        self.son_silinen = self.mac_db.copy()
        
        self.mac_db = []
        self.db_kaydet()
        self.arsiv_yenile()
        messagebox.showinfo("BaÅŸarÄ±lÄ±", "âœ… TÃ¼m arÅŸiv temizlendi!\n\nğŸ’¡ Geri almak iÃ§in 'â†©ï¸ GERÄ° AL' butonunu kullanÄ±n.")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SKOR FONKSÄ°YONLARI (HATA 13 - GÃ–RSEL SKOR)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def skor_yukle(self):
        tarih = self.entry_skor_tarih.get().strip()
        maclar = [m.get("mac", m.get("mac_adi", "?")).replace("_", " ") 
                  for m in self.mac_db if m.get("tarih") == tarih]
        self.combo_skor_mac["values"] = maclar
        if maclar:
            self.combo_skor_mac.set(maclar[0])
        self.txt_skor.delete(1.0, tk.END)
        self.txt_skor.insert(tk.END, f"ğŸ“… {tarih} tarihli {len(maclar)} maÃ§ yÃ¼klendi.\n\n")
        for m in maclar:
            self.txt_skor.insert(tk.END, f"âš½ {m}\n")
    
    def skor_gorsel_yukle(self):
        """HATA 13 - GÃ¶rsel skor yÃ¼kle ve Gemini ile oku"""
        file = filedialog.askopenfilename(filetypes=[("GÃ¶rseller", "*.png *.jpg *.jpeg")])
        if not file:
            return
        
        self.skor_gorseli = [file]
        self.txt_skor.delete(1.0, tk.END)
        self.txt_skor.insert(tk.END, "â³ GÃ¶rsel okunuyor...\n")
        
        threading.Thread(target=self._skor_gorsel_oku, args=(file,), daemon=True).start()
    
    def skor_panodan(self):
        """Panodan skor gÃ¶rseli al"""
        try:
            img = ImageGrab.grabclipboard()
            if img:
                path = os.path.join(BASE_DIR, f"skor_{datetime.now().strftime('%H%M%S')}.png")
                img.save(path)
                self.skor_gorseli = [path]
                self.txt_skor.delete(1.0, tk.END)
                self.txt_skor.insert(tk.END, "â³ GÃ¶rsel okunuyor...\n")
                threading.Thread(target=self._skor_gorsel_oku, args=(path,), daemon=True).start()
        except Exception as e:
            self.txt_skor.insert(tk.END, f"âŒ Hata: {e}\n")
    
    def _skor_gorsel_oku(self, path):
        """Gemini ile skor gÃ¶rselini oku"""
        try:
            api_key = self.entry_api.get().strip() or DEFAULT_API_KEY
            genai.configure(api_key=api_key)
            model = genai.GenerativeModel("gemini-2.0-flash")
            
            img = Image.open(path)
            
            prompt = """Bu gÃ¶rseldeki maÃ§ skorlarÄ±nÄ± oku ve listele.
Her maÃ§ iÃ§in ÅŸu formatta yaz:
[Ev TakÄ±mÄ±] [Ev Skoru]-[Dep Skoru] [Deplasman TakÄ±mÄ±]

Ã–rnek:
FenerbahÃ§e 4-0 Konyaspor
Sakaryaspor 3-0 Hatayspor

Sadece skorlarÄ± listele, baÅŸka bir ÅŸey yazma."""
            
            response = model.generate_content([prompt, img])
            result = response.text
            
            self.root.after(0, lambda: self._skor_gorsel_sonuc(result))
        except Exception as e:
            self.root.after(0, lambda: self.txt_skor.insert(tk.END, f"âŒ Hata: {e}\n"))
    
    def _skor_gorsel_sonuc(self, result):
        """Okunan skorlarÄ± gÃ¶ster ve eÅŸleÅŸtir"""
        self.txt_skor.delete(1.0, tk.END)
        self.txt_skor.insert(tk.END, "ğŸ“Š OKUNAN SKORLAR:\n")
        self.txt_skor.insert(tk.END, "="*50 + "\n\n")
        
        # SkorlarÄ± parse et
        self.okunan_skorlar = []
        for line in result.strip().split('\n'):
            line = line.strip()
            if not line:
                continue
            
            # Skor formatÄ±: TakÄ±m1 X-Y TakÄ±m2
            match = re.search(r'(.+?)\s+(\d+)-(\d+)\s+(.+)', line)
            if match:
                ev_takim = match.group(1).strip()
                ev_skor = int(match.group(2))
                dep_skor = int(match.group(3))
                dep_takim = match.group(4).strip()
                
                self.okunan_skorlar.append({
                    "ev": ev_takim, "dep": dep_takim,
                    "ev_skor": ev_skor, "dep_skor": dep_skor,
                    "toplam": ev_skor + dep_skor
                })
                
                self.txt_skor.insert(tk.END, f"âš½ {ev_takim} {ev_skor}-{dep_skor} {dep_takim}\n")
        
        self.txt_skor.insert(tk.END, "\n" + "="*50 + "\n")
        self.txt_skor.insert(tk.END, "ğŸ“‹ ANALÄ°ZLERLE EÅLEÅTÄ°RME:\n\n")
        
        # GÃ¼nÃ¼n analizleriyle eÅŸleÅŸtir
        tarih = self.entry_skor_tarih.get().strip()
        eslesen = 0
        
        for skor in self.okunan_skorlar:
            for mac in self.mac_db:
                if mac.get("tarih") != tarih:
                    continue
                
                mac_adi = mac.get("mac", mac.get("mac_adi", "")).lower()
                ev_lower = skor["ev"].lower()
                dep_lower = skor["dep"].lower()
                
                # EÅŸleÅŸme kontrolÃ¼
                if ev_lower[:5] in mac_adi or dep_lower[:5] in mac_adi:
                    banko = mac.get("banko", "").upper()
                    toplam_gol = skor["toplam"]
                    
                    # SonuÃ§ hesapla
                    sonuc = "?"
                    if "2.5 ÃœST" in banko:
                        sonuc = "âœ… KAZANDI" if toplam_gol > 2.5 else "âŒ KAYBETTÄ°"
                    elif "1.5 ÃœST" in banko:
                        sonuc = "âœ… KAZANDI" if toplam_gol > 1.5 else "âŒ KAYBETTÄ°"
                    elif "KG VAR" in banko:
                        sonuc = "âœ… KAZANDI" if skor["ev_skor"] > 0 and skor["dep_skor"] > 0 else "âŒ KAYBETTÄ°"
                    elif "0.5 ÃœST" in banko:
                        sonuc = "âœ… KAZANDI" if toplam_gol > 0.5 else "âŒ KAYBETTÄ°"
                    
                    self.txt_skor.insert(tk.END, f"{sonuc} {skor['ev']} {skor['ev_skor']}-{skor['dep_skor']} {skor['dep']}\n")
                    self.txt_skor.insert(tk.END, f"   â†’ BANKO: {banko}\n\n")
                    
                    # Sonucu kaydet
                    mac["_temp_sonuc"] = "KAZANDI" if "âœ…" in sonuc else "KAYBETTÄ°"
                    mac["_temp_skor"] = f"{skor['ev_skor']}-{skor['dep_skor']}"
                    eslesen += 1
                    break
        
        self.txt_skor.insert(tk.END, f"\nğŸ“Š Toplam {eslesen} maÃ§ eÅŸleÅŸti.\n")
        self.txt_skor.insert(tk.END, "ğŸ’¾ 'OTOMATÄ°K EÅLEÅTÄ°R & KAYDET' ile kaydedin.\n")
    
    def skor_otomatik_kaydet(self):
        """EÅŸleÅŸen skorlarÄ± otomatik kaydet - V5.6 DÃœZELTÄ°LDÄ°"""
        tarih = self.entry_skor_tarih.get().strip()
        kaydedilen = 0
        
        for mac in self.mac_db:
            if mac.get("tarih") == tarih and mac.get("_temp_sonuc"):
                mac["sonuc"] = mac.pop("_temp_sonuc")
                skor_degeri = mac.pop("_temp_skor", "")
                mac["gercek_skor"] = skor_degeri
                mac["skor"] = skor_degeri  # ARÅÄ°V/ORANLAR iÃ§in de kaydet!
                
                # Bahis sonuÃ§larÄ±nÄ± kontrol et
                if skor_degeri:
                    self._kontrol_bahisler(mac, skor_degeri)
                
                # Performance tracker gÃ¼ncelle
                self.performance.update_result(mac.get("id"), mac["sonuc"], mac.get("gercek_skor"))
                kaydedilen += 1
        
        self.db_kaydet()
        self.arsiv_yenile()
        # ORANLAR sekmesini de gÃ¼ncelle
        if hasattr(self, 'detayli_arsiv_guncelle'):
            self.detayli_arsiv_guncelle()
        messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… {kaydedilen} maÃ§ sonucu kaydedildi!")
    
    def skor_kaydet(self):
        """Tek maÃ§ skor kaydet - V5.6 DÃœZELTÄ°LDÄ°"""
        mac_adi = self.combo_skor_mac.get().replace(" ", "_")
        sonuc = self.combo_sonuc.get()
        skor = self.entry_gercek_skor.get().strip()
        
        if not mac_adi or not sonuc:
            return
        
        for mac in self.mac_db:
            if mac.get("mac", mac.get("mac_adi", "")).replace(" ", "_") == mac_adi:
                mac["sonuc"] = sonuc
                mac["gercek_skor"] = skor
                mac["skor"] = skor  # ARÅÄ°V/ORANLAR iÃ§in de kaydet!
                
                # Bahis sonuÃ§larÄ±nÄ± kontrol et
                if skor:
                    self._kontrol_bahisler(mac, skor)
                
                self.performance.update_result(mac.get("id"), sonuc, skor)
                break
        
        self.db_kaydet()
        self.arsiv_yenile()
        # ORANLAR sekmesini de gÃ¼ncelle
        if hasattr(self, 'detayli_arsiv_guncelle'):
            self.detayli_arsiv_guncelle()
        self.lbl_status.config(text=f"âœ… {sonuc} kaydedildi | Skor: {skor}", fg=self.theme["success"])
    
    def toplu_sonuc(self, sonuc):
        """Toplu sonuÃ§ kaydet - V5.6 DÃœZELTÄ°LDÄ°"""
        tarih = self.entry_skor_tarih.get().strip()
        for mac in self.mac_db:
            if mac.get("tarih") == tarih and not mac.get("sonuc"):
                mac["sonuc"] = sonuc
                self.performance.update_result(mac.get("id"), sonuc, "")
        self.db_kaydet()
        self.arsiv_yenile()
        # ORANLAR sekmesini de gÃ¼ncelle
        if hasattr(self, 'detayli_arsiv_guncelle'):
            self.detayli_arsiv_guncelle()
        messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… TÃ¼m maÃ§lar {sonuc} olarak iÅŸaretlendi!")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # KUPON FONKSÄ°YONLARI (HATA 3 - GÃ–RSEL DÃœZELTME)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def kupon_olustur(self, tip):
        """FIX: KUPON Ã‡IKTILARI - BOÅLUKSUZ FORMAT"""
        tarih = self.entry_kupon_tarih.get().strip()
        maclar = [m for m in self.mac_db if m.get("tarih") == tarih]
        
        if not maclar:
            maclar = self.mac_db
        
        if not maclar:
            messagebox.showwarning("UyarÄ±", "HenÃ¼z analiz yapÄ±lmamÄ±ÅŸ!")
            return
        
        self.txt_kupon.delete(1.0, tk.END)
        
        if tip == "KASA":
            # ğŸ’° KASA KUPONU (BANKO) - V70 YENÄ° FORMAT
            secilen = [m for m in maclar if int(str(m.get("guven", "0")).replace("/10", "") or 0) >= 7][:3]
            if not secilen:
                secilen = maclar[:3]
            
            lines = [
                "ğŸ’° KASA KUPONU (BANKO) ğŸ’°",
                "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            ]
            
            for i, mac in enumerate(secilen, 1):
                mac_adi = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")
                tarih_mac = mac.get("tarih", "?")
                
                # Saat - birden fazla kaynaktan dene
                saat = mac.get("saat") or mac.get("mac_saati") or "?"
                ocr_data = mac.get("ocr_data", {}) or {}
                if saat == "?" and ocr_data:
                    saat = ocr_data.get("mac_saati", "?")
                
                banko = mac.get("banko", "?")
                guven = mac.get("guven", "?")
                
                # Verileri Ã§ek
                ev_atan = mac.get("ev_atan_05", mac.get("ev_atan", 0)) or 0
                dep_yiyen = mac.get("dep_yenen_05", mac.get("dep_yiyen", 0)) or 0
                
                # xG - doÄŸru key'lerden al
                xg_ev = float(mac.get("xg_ev", 0) or ocr_data.get("xg_ev", 0) or 0)
                xg_dep = float(mac.get("xg_dep", 0) or ocr_data.get("xg_dep", 0) or 0)
                xg = xg_ev + xg_dep
                if xg == 0:
                    xg = float(mac.get("xg", mac.get("xg_toplam", 0)) or 0)
                
                kg_ort = mac.get("kg_var_ort", mac.get("kg_var", 0)) or 0
                lig_ort = mac.get("lig_gol_ort", 2.50) or 2.50
                
                # Kritik veriyi belirle
                if kg_ort and float(kg_ort) >= 65:
                    kritik = f"Ä°ki takÄ±mÄ±n maÃ§larÄ±nda %{float(kg_ort):.0f} KG VAR oldu!"
                elif ev_atan >= 85:
                    kritik = f"Ev sahibi iÃ§ sahada her maÃ§ gol attÄ±!"
                elif xg >= 2.5:
                    kritik = f"xG {xg:.2f} ile yÃ¼ksek gol beklentisi!"
                else:
                    kritik = "Ä°statistikler gÃ¼Ã§lÃ¼ gol beklentisi gÃ¶steriyor!"
                
                lines.append(f"")
                lines.append(f"#âƒ£{i} âš½ï¸ {mac_adi}")
                lines.append(f"ğŸ“… {tarih_mac} | â° {saat}")
                lines.append(f"ğŸ¯ TAHMÄ°N: {banko}")
                lines.append(f"ğŸ“Š GÃœVEN : {guven}")
                lines.append(f"ğŸ’¡ NEDEN?:")
                lines.append(f"1ï¸âƒ£ Ev Gol Atma: %{float(ev_atan):.0f} - Dep. Yeme: %{float(dep_yiyen):.0f}")
                lines.append(f"2ï¸âƒ£ Lig Ort: {lig_ort} Gol | MaÃ§taki xG: {xg:.2f}")
                lines.append(f"3ï¸âƒ£ âš ï¸ KRÄ°TÄ°K: {kritik}")
            
            lines.append("")
            lines.append("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            lines.append("ğŸ’° KasanÄ±n %20'si basÄ±lÄ±r")
            lines.append("ğŸ“± 90 DAKÄ°KA ANALÄ°Z")
            self.txt_kupon.insert(tk.END, "\n".join(lines))
            
        elif tip == "KARMA":
            # ğŸ”¥ KARMA KUPON (Ä°DEAL) - V70 YENÄ° FORMAT
            secilen = [m for m in maclar if int(str(m.get("guven", "0")).replace("/10", "") or 0) >= 6][:3]
            if not secilen:
                secilen = maclar[:3]
            
            lines = [
                "ğŸ”¥ KARMA KUPON (Ä°DEAL) ğŸ”¥",
                "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            ]
            
            for i, mac in enumerate(secilen, 1):
                mac_adi = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")
                tarih_mac = mac.get("tarih", "?")
                
                # Saat - birden fazla kaynaktan dene
                saat = mac.get("saat") or mac.get("mac_saati") or "?"
                ocr_data = mac.get("ocr_data", {}) or {}
                if saat == "?" and ocr_data:
                    saat = ocr_data.get("mac_saati", "?")
                
                banko = mac.get("banko", "?")
                sigorta = mac.get("sigorta", mac.get("garanti", "KG VAR"))
                guven = mac.get("guven", "?")
                
                # Verileri Ã§ek
                ev_atan = mac.get("ev_atan_05", mac.get("ev_atan", 0)) or 0
                dep_yiyen = mac.get("dep_yenen_05", mac.get("dep_yiyen", 0)) or 0
                
                # xG - doÄŸru key'lerden al
                xg_ev = float(mac.get("xg_ev", 0) or ocr_data.get("xg_ev", 0) or 0)
                xg_dep = float(mac.get("xg_dep", 0) or ocr_data.get("xg_dep", 0) or 0)
                xg = xg_ev + xg_dep
                if xg == 0:
                    xg = float(mac.get("xg", mac.get("xg_toplam", 0)) or 0)
                
                lig_ort = mac.get("lig_gol_ort", 2.50) or 2.50
                
                # Dikkat Ã§ekici veri
                if ev_atan >= 85:
                    dikkat = "Ev sahibi iÃ§ sahada her maÃ§ gol attÄ±!"
                elif xg >= 2.5:
                    dikkat = f"xG {xg:.2f} ile yÃ¼ksek beklenti!"
                else:
                    dikkat = "GÃ¼Ã§lÃ¼ istatistikler!"
                
                lines.append(f"")
                lines.append(f"#âƒ£{i} âš½ï¸ {mac_adi}")
                lines.append(f"ğŸ“… {tarih_mac} | â° {saat}")
                lines.append(f"ğŸ¯ Ä°DEAL    : {banko}")
                lines.append(f"ğŸ›¡ï¸ ALTERNATÄ°F: {sigorta}")
                lines.append(f"ğŸ“Š GÃœVEN    : {guven}")
                lines.append(f"ğŸ’¡ NEDEN?:")
                lines.append(f"1ï¸âƒ£ Ev Gol Atma: %{float(ev_atan):.0f} - Dep. Yeme: %{float(dep_yiyen):.0f}")
                lines.append(f"2ï¸âƒ£ Lig Ort: {lig_ort} Gol | MaÃ§taki xG: {xg:.2f}")
                lines.append(f"3ï¸âƒ£ âš ï¸ DÄ°KKAT: {dikkat}")
            
            lines.append("")
            lines.append("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            lines.append("âš–ï¸ Strateji: Dengeli risk/kazanÃ§")
            lines.append("ğŸ’° KasanÄ±n %10'u basÄ±lÄ±r")
            lines.append("ğŸ“± 90 DAKÄ°KA ANALÄ°Z")
            self.txt_kupon.insert(tk.END, "\n".join(lines))
            
        elif tip == "RISK":
            # âš ï¸ RÄ°SKLÄ° KUPON - SÃœRPRÄ°Z - V70 YENÄ° FORMAT
            secilen = maclar[:3]
            
            lines = [
                "âš ï¸ RÄ°SKLÄ° KUPON (SÃœRPRÄ°Z)",
                "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            ]
            
            for i, mac in enumerate(secilen, 1):
                mac_adi = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")
                tarih_mac = mac.get("tarih", "?")
                
                # Saat - birden fazla kaynaktan dene
                saat = mac.get("saat") or mac.get("mac_saati") or "?"
                ocr_data = mac.get("ocr_data", {}) or {}
                if saat == "?" and ocr_data:
                    saat = ocr_data.get("mac_saati", "?")
                
                banko = mac.get("banko", "?")
                guven = mac.get("guven", "?")
                
                # Verileri Ã§ek
                ev_atan = mac.get("ev_atan_05", mac.get("ev_atan", 0)) or 0
                dep_atan = mac.get("dep_atan_05", mac.get("dep_atan", 0)) or 0
                dep_yiyen = mac.get("dep_yiyen", mac.get("dep_yenen_05", 0)) or 0
                lig_gol = mac.get("lig_gol_ort", 2.50) or 2.50
                
                # xG - doÄŸru key'lerden al
                xg_ev = float(mac.get("xg_ev", 0) or ocr_data.get("xg_ev", 0) or 0)
                xg_dep = float(mac.get("xg_dep", 0) or ocr_data.get("xg_dep", 0) or 0)
                xg = xg_ev + xg_dep
                if xg == 0:
                    xg = float(mac.get("xg", mac.get("xg_toplam", 0)) or 0)
                
                # NEDEN? aÃ§Ä±klamasÄ±
                lines.append(f"")
                lines.append(f"#âƒ£{i} âš½ï¸ {mac_adi}")
                lines.append(f"ğŸ“… {tarih_mac} | â° {saat}")
                lines.append(f"ğŸ¯ TAHMÄ°N: {banko}")
                lines.append(f"ğŸ“Š GÃœVEN : {guven}")
                lines.append(f"ğŸ’¡ NEDEN?:")
                lines.append(f"1ï¸âƒ£ Ev Gol Atma: %{float(ev_atan):.0f} - Dep. Yeme: %{float(dep_yiyen):.0f}")
                lines.append(f"2ï¸âƒ£ Lig Ort: {lig_gol} Gol | MaÃ§taki xG: {xg:.2f}")
                
                # En dikkat Ã§ekici veri
                if ev_atan >= 85 or dep_atan >= 85:
                    lines.append(f"3ï¸âƒ£ âš ï¸ FIRSAT: %{max(float(ev_atan), float(dep_atan)):.0f} gol atma istatistiÄŸi!")
                elif xg >= 2.5:
                    lines.append(f"3ï¸âƒ£ âš ï¸ FIRSAT: xG {xg:.2f} ile yÃ¼ksek beklenti!")
                else:
                    lines.append(f"3ï¸âƒ£ âš ï¸ FIRSAT: Ä°statistikler sÃ¼rpriz bekliyor!")
            
            lines.append("")
            lines.append("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            lines.append("âš¡ï¸ Strateji: YÃ¼ksek risk/kazanÃ§")
            lines.append("ğŸ’° KasanÄ±n %5'i basÄ±lÄ±r")
            lines.append("ğŸ“± 90 DAKÄ°KA ANALÄ°Z")
            self.txt_kupon.insert(tk.END, "\n".join(lines))
    
    def gunun_en_iyi_3(self):
        """ğŸ† GÃœNÃœN EN Ä°YÄ° 3 MAÃ‡I - V70 YENÄ° FORMAT"""
        tarih = self.entry_kupon_tarih.get().strip()
        maclar = [m for m in self.mac_db if m.get("tarih") == tarih]
        
        # EÄŸer tarih eÅŸleÅŸmezse, tÃ¼m maÃ§larÄ± al
        if not maclar:
            maclar = self.mac_db
        
        # VERI bloÄŸundan gÃ¼ncelle
        if self.last_result:
            veri_data = {}
            veri_match = re.search(r'\|\|VERI_BASLANGIC\|\|(.*?)\|\|VERI_BITIS\|\|', self.last_result, re.DOTALL)
            if veri_match:
                for line in veri_match.group(1).strip().split('\n'):
                    if '=' in line:
                        key, val = line.split('=', 1)
                        veri_data[key.strip()] = val.strip().replace("%", "")
            
            # Son maÃ§a verileri ekle
            if maclar and veri_data:
                maclar[-1].update(veri_data)
        
        # GÃ¼vene gÃ¶re sÄ±rala
        def get_guven(m):
            try:
                return int(str(m.get("guven", "0")).replace("/10", "").replace("%", "") or 0)
            except:
                return 0
        
        maclar.sort(key=get_guven, reverse=True)
        
        self.txt_kupon.delete(1.0, tk.END)
        
        lines = [
            "ğŸ† GÃœNÃœN EN Ä°YÄ° 3 MAÃ‡I",
            "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        ]
        
        medals = ["ğŸ¥‡", "ğŸ¥ˆ", "ğŸ¥‰"]
        
        for i, mac in enumerate(maclar[:3], 0):
            mac_adi = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")
            
            # Saat - birden fazla kaynaktan dene
            saat = mac.get("saat") or mac.get("mac_saati") or "?"
            ocr_data = mac.get("ocr_data", {}) or {}
            if saat == "?" and ocr_data:
                saat = ocr_data.get("mac_saati", "?")
            
            banko = mac.get("banko", "?")
            sigorta = mac.get("sigorta", mac.get("garanti", "KG VAR"))
            guven = mac.get("guven", "?")
            ust_15 = mac.get("ust_15", mac.get("ust_15_ort", "?"))
            
            # xG - doÄŸru key'lerden al
            xg_ev = float(mac.get("xg_ev", 0) or ocr_data.get("xg_ev", 0) or 0)
            xg_dep = float(mac.get("xg_dep", 0) or ocr_data.get("xg_dep", 0) or 0)
            xg = xg_ev + xg_dep
            if xg == 0:
                xg = float(mac.get("xg", mac.get("xg_toplam", 0)) or 0)
            
            # Verileri al
            ev_atan = mac.get("ev_atan_05", mac.get("ev_atan", 0)) or 0
            dep_yiyen = mac.get("dep_yiyen", mac.get("dep_yenen_05", 0)) or 0
            lig_gol = mac.get("lig_gol_ort", 2.50)
            kg_ort = mac.get("kg_var_ort", mac.get("kg_var", 0)) or 0
            
            medal = medals[i] if i < 3 else "âš½"
            
            lines.append(f"")
            lines.append(f"{medal} #{i+1} {mac_adi}")
            lines.append(f"   â° {saat}")
            lines.append(f"   ğŸ¯ BANKO   : {banko}")
            lines.append(f"   ğŸ›¡ï¸ SÄ°GORTA : {sigorta}")
            lines.append(f"   ğŸ“Š GÃ¼ven: {guven}/10 | xG: {xg:.2f} | 1.5Ãœ: %{ust_15}")
            lines.append(f"")
            lines.append(f"   ğŸ’¡ ANALÄ°Z DETAYI:")
            lines.append(f"   1ï¸âƒ£ Ev Gol: %{float(ev_atan):.0f} - Dep. Yeme: %{float(dep_yiyen):.0f}")
            lines.append(f"   2ï¸âƒ£ Lig Ort: {lig_gol} - MaÃ§ xG: {xg:.2f}")
            
            # Ã–ne Ã§Ä±kan veri
            if float(ev_atan) >= 85 or float(dep_yiyen) >= 75:
                lines.append(f"   3ï¸âƒ£ ğŸš€ Her maÃ§ gol oluyor!")
            elif float(kg_ort) >= 70:
                lines.append(f"   3ï¸âƒ£ ğŸš€ KG VAR oranÄ± %{float(kg_ort):.0f}!")
            else:
                lines.append(f"   3ï¸âƒ£ ğŸš€ GÃ¼Ã§lÃ¼ istatistikler!")
            
            lines.append("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
        
        lines.append("ğŸ“± 90 DAKÄ°KA ANALÄ°Z")
        self.txt_kupon.insert(tk.END, "\n".join(lines))
    
    def kupon_gorsel_kaydet(self):
        """HATA 3 DÃœZELTMESÄ° - PIL ile gÃ¶rsel oluÅŸtur"""
        text = self.txt_kupon.get(1.0, tk.END).strip()
        if not text:
            messagebox.showwarning("UyarÄ±", "Ã–nce kupon oluÅŸturun!")
            return
        
        # PIL ile gÃ¶rsel oluÅŸtur
        width, height = 600, 400
        img = Image.new('RGB', (width, height), '#0a0a0a')
        draw = ImageDraw.Draw(img)
        
        # Font yÃ¼kle
        try:
            font = ImageFont.truetype("arial.ttf", 16)
            font_small = ImageFont.truetype("arial.ttf", 14)
        except:
            font = ImageFont.load_default()
            font_small = font
        
        # Ã‡erÃ§eve
        draw.rectangle([5, 5, width-5, height-5], outline='#00ff00', width=2)
        
        # BaÅŸlÄ±k
        draw.rectangle([0, 0, width, 40], fill='#1a1a1a')
        draw.text((20, 10), "ğŸ’° XG-XRAY KUPON", fill='#00ff00', font=font)
        
        # Metin
        y = 60
        for line in text.split('\n')[:15]:
            # Emoji'leri temizle
            clean_line = re.sub(r'[^\w\s\-\|\:\.\,\/\(\)]', '', line)
            draw.text((20, y), clean_line[:50], fill='#ffffff', font=font_small)
            y += 22
        
        # Footer
        draw.rectangle([0, height-30, width, height], fill='#1a1a1a')
        draw.text((20, height-25), "90 Dakika Analiz | XG-XRAY V5.6", fill='#666666', font=font_small)
        
        # Kaydet
        dosya = filedialog.asksaveasfilename(defaultextension=".png",
                                              filetypes=[("PNG", "*.png")],
                                              initialfile=f"kupon_{datetime.now().strftime('%Y%m%d_%H%M')}.png")
        if dosya:
            img.save(dosya)
            messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… GÃ¶rsel kaydedildi:\n{dosya}")
    
    def kupon_telegram(self):
        text = self.txt_kupon.get(1.0, tk.END).strip()
        if not text:
            messagebox.showwarning("UyarÄ±", "Ã–nce kupon oluÅŸturun!")
            return
        
        self.kanal_sec_ve_gonder(text, "Kupon GÃ¶nder")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # LÄ°STELER FONKSÄ°YONU
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def listeleri_guncelle(self):
        """Ã–ZEL LÄ°STELERÄ° DOLDUR - PYTHON BAZLI, BANKO'YA GÃ–RE"""
        tarih = self.entry_liste_tarih.get().strip()
        maclar = [m for m in self.mac_db if m.get("tarih") == tarih]
        
        # EÄŸer tarihe gÃ¶re maÃ§ yoksa, tÃ¼m maÃ§larÄ± al
        if not maclar:
            maclar = self.mac_db
        
        # Listeleri temizle
        for lst in [self.lst_35, self.lst_25, self.lst_kg, self.lst_fav, self.lst_iy, self.lst_deger]:
            lst.delete(0, tk.END)
        
        for mac in maclar:
            # MaÃ§ adÄ±nÄ± ve takÄ±mlarÄ± al
            mac_adi_full = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")
            
            # TakÄ±m isimlerini ayÄ±r
            ev_takim = ""
            dep_takim = ""
            if " VS " in mac_adi_full.upper():
                parcalar = mac_adi_full.split(" VS " if " VS " in mac_adi_full else " vs ")
                ev_takim = parcalar[0].strip() if len(parcalar) > 0 else ""
                dep_takim = parcalar[1].strip() if len(parcalar) > 1 else ""
            elif " - " in mac_adi_full:
                parcalar = mac_adi_full.split(" - ")
                ev_takim = parcalar[0].strip() if len(parcalar) > 0 else ""
                dep_takim = parcalar[1].strip() if len(parcalar) > 1 else ""
            else:
                ev_takim = mac_adi_full
                dep_takim = ""
            
            # BANKO deÄŸerini al (bÃ¼yÃ¼k harfe Ã§evir)
            banko = str(mac.get("banko", "")).upper()
            
            # GÃ¼ven deÄŸerini al
            guven = str(mac.get("guven", "0")).replace("/10", "").strip()
            try:
                guven_int = int(guven)
            except:
                guven_int = 0
            
            # xG deÄŸerlerini al
            def safe_float(val, default=0):
                if val is None or val == "" or val == "?":
                    return default
                try:
                    return float(str(val).replace("%", "").replace(",", ".").strip())
                except:
                    return default
            
            xg_ev = safe_float(mac.get("xg_ev", 0))
            xg_dep = safe_float(mac.get("xg_dep", 0))
            xg_toplam = xg_ev + xg_dep
            
            # Oran deÄŸerini al
            oran = safe_float(mac.get("oran", 1.80), 1.80)
            
            # Ev ve Dep 0.5Ãœ gol atma yÃ¼zdeleri
            ev_atan = safe_float(mac.get("ev_atan", mac.get("ev_atan_05", 0)))
            dep_atan = safe_float(mac.get("dep_atan", mac.get("dep_atan_05", 0)))
            
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            # ğŸ”¥ 3.5 ÃœST LÄ°STESÄ° - BANKO'da "3.5" geÃ§iyorsa
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            if "3.5" in banko and "ÃœST" in banko:
                self.lst_35.insert(tk.END, f"{ev_takim} vs {dep_takim}")
            
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            # âš½ 2.5 ÃœST LÄ°STESÄ° - BANKO'da "2.5" geÃ§iyorsa
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            if "2.5" in banko and "ÃœST" in banko:
                self.lst_25.insert(tk.END, f"{ev_takim} vs {dep_takim}")
            
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            # ğŸ¤ KG VAR LÄ°STESÄ° - BANKO'da "KG VAR" geÃ§iyorsa
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            if "KG VAR" in banko or "KG" in banko and "YOK" not in banko:
                self.lst_kg.insert(tk.END, f"{ev_takim} vs {dep_takim}")
            
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            # ğŸ‘‘ FAVORÄ° LÄ°STESÄ° - MS1, MS2, KAZANIR veya aÄŸÄ±r favori
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            favori_eklendi = False
            agir_favori = ""
            
            # MS1 veya EV kazanÄ±r
            if ("MS1" in banko or "MS 1" in banko or "EV KAZANIR" in banko) and guven_int >= 7:
                agir_favori = ev_takim
                favori_eklendi = True
            # MS2 veya DEP kazanÄ±r
            elif ("MS2" in banko or "MS 2" in banko or "DEP KAZANIR" in banko or "DEPLASMAN KAZANIR" in banko) and guven_int >= 7:
                agir_favori = dep_takim
                favori_eklendi = True
            # Genel "KAZANIR" ifadesi
            elif "KAZANIR" in banko and guven_int >= 7:
                # Banko'dan takÄ±m adÄ±nÄ± Ã§Ä±karmaya Ã§alÄ±ÅŸ
                if ev_takim.upper() in banko:
                    agir_favori = ev_takim
                elif dep_takim.upper() in banko:
                    agir_favori = dep_takim
                elif ev_atan > dep_atan + 15:
                    agir_favori = ev_takim
                elif dep_atan > ev_atan + 15:
                    agir_favori = dep_takim
                else:
                    agir_favori = "?"
                favori_eklendi = True
            # Oran bazlÄ± aÄŸÄ±r favori (1.40 ve altÄ±)
            elif oran <= 1.40 and guven_int >= 7:
                if ev_atan > dep_atan:
                    agir_favori = ev_takim
                else:
                    agir_favori = dep_takim
                favori_eklendi = True
            
            if favori_eklendi and agir_favori:
                self.lst_fav.insert(tk.END, f"{ev_takim} vs {dep_takim} (AÄIR FAVORÄ°: {agir_favori})")
            
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            # â±ï¸ Ä°Y GOL LÄ°STESÄ° - BANKO'da "Ä°Y" geÃ§iyorsa
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            if "Ä°Y" in banko or "IY" in banko or "Ä°LK YARI" in banko:
                self.lst_iy.insert(tk.END, f"{ev_takim} vs {dep_takim}")
            
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            # ğŸ’ XG 5+ LÄ°STESÄ° - xG toplamÄ± 5.0 ve Ã¼zeri
            # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            if xg_toplam >= 5.0:
                self.lst_deger.insert(tk.END, f"{ev_takim} vs {dep_takim} (xG: {xg_toplam:.2f})")
    
    def listeleri_telegrama_gonder(self):
        """SeÃ§ilen listeleri Telegram'a gÃ¶nder - POPUP ile seÃ§im"""
        
        # Popup penceresi oluÅŸtur
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“¤ Telegram'a GÃ¶nder")
        popup.geometry("500x600")
        popup.configure(bg=self.theme["bg"])
        popup.transient(self.root)
        popup.grab_set()
        
        # BaÅŸlÄ±k
        tk.Label(popup, text="ğŸ“¤ TELEGRAM'A GÃ–NDER", font=("Segoe UI", 14, "bold"),
                 bg=self.theme["bg"], fg=self.theme["accent"]).pack(pady=10)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # KANAL SEÃ‡Ä°MÄ° - KAYITLI KANALLARDAN
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_kanal = tk.LabelFrame(popup, text="ğŸ“º KANAL SEÃ‡Ä°MÄ°", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_kanal.pack(fill="x", padx=20, pady=10)
        
        # KayÄ±tlÄ± kanallarÄ± al (telegram.channels listesinden)
        kayitli_kanallar = []
        if hasattr(self, 'telegram') and hasattr(self.telegram, 'channels'):
            kayitli_kanallar = self.telegram.channels
        
        # Kanal seÃ§im deÄŸiÅŸkenleri
        self.kanal_secim_vars = {}
        
        if kayitli_kanallar:
            for ch in kayitli_kanallar:
                kanal_adi = ch.get("name", "Kanal")
                chat_id = ch.get("chat_id", "")
                aktif = ch.get("active", True)
                
                var = tk.BooleanVar(value=aktif)
                self.kanal_secim_vars[kanal_adi] = {"var": var, "chat_id": chat_id}
                
                frm_k = tk.Frame(frm_kanal, bg=self.theme["card_bg"])
                frm_k.pack(fill="x", padx=10, pady=2)
                
                tk.Checkbutton(frm_k, text=kanal_adi, variable=var,
                              bg=self.theme["card_bg"], fg=self.theme["fg"],
                              selectcolor=self.theme["entry_bg"]).pack(side="left")
                
                # Chat ID gÃ¶ster
                display_id = f"({chat_id[:20]}...)" if len(str(chat_id)) > 20 else f"({chat_id})"
                tk.Label(frm_k, text=display_id,
                        bg=self.theme["card_bg"], fg="gray", font=("Arial", 8)).pack(side="left", padx=5)
        else:
            tk.Label(frm_kanal, text="âš ï¸ KayÄ±tlÄ± kanal yok! AYARLAR'dan ekleyin.",
                    bg=self.theme["card_bg"], fg="orange").pack(pady=5)
        
        # TÃ¼mÃ¼nÃ¼ SeÃ§ / HiÃ§birini SeÃ§me (kanallar iÃ§in)
        if kayitli_kanallar:
            frm_kanal_btn = tk.Frame(frm_kanal, bg=self.theme["card_bg"])
            frm_kanal_btn.pack(fill="x", padx=10, pady=5)
            
            def tum_kanallari_sec():
                for k, v in self.kanal_secim_vars.items():
                    v["var"].set(True)
            
            def hic_kanal_secme():
                for k, v in self.kanal_secim_vars.items():
                    v["var"].set(False)
            
            tk.Button(frm_kanal_btn, text="âœ… TÃ¼mÃ¼", command=tum_kanallari_sec,
                      bg="#28a745", fg="white", font=("Arial", 8)).pack(side="left", padx=2)
            tk.Button(frm_kanal_btn, text="âŒ HiÃ§biri", command=hic_kanal_secme,
                      bg="#dc3545", fg="white", font=("Arial", 8)).pack(side="left", padx=2)
        
        # Yeni kanal ekleme
        frm_yeni = tk.Frame(frm_kanal, bg=self.theme["card_bg"])
        frm_yeni.pack(fill="x", padx=10, pady=5)
        
        tk.Label(frm_yeni, text="Yeni Chat ID:", bg=self.theme["card_bg"], fg="gray").pack(side="left")
        self.entry_yeni_chat = tk.Entry(frm_yeni, width=25, bg=self.theme["entry_bg"], fg=self.theme["fg"])
        self.entry_yeni_chat.pack(side="left", padx=5)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # LÄ°STE SEÃ‡Ä°MÄ°
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_liste = tk.LabelFrame(popup, text="ğŸ“‹ GÃ–NDERÄ°LECEK LÄ°STELER", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_liste.pack(fill="x", padx=20, pady=10)
        
        # Liste seÃ§im deÄŸiÅŸkenleri
        self.liste_secim_vars = {}
        
        listeler = [
            ("ğŸ”¥ 3.5 ÃœST", self.lst_35, self.chk_35_var),
            ("âš½ 2.5 ÃœST", self.lst_25, self.chk_25_var),
            ("ğŸ¤ KG VAR", self.lst_kg, self.chk_kg_var),
            ("ğŸ‘‘ FAVORÄ°", self.lst_fav, self.chk_fav_var),
            ("â±ï¸ Ä°Y GOL", self.lst_iy, self.chk_iy_var),
            ("ğŸ’ XG 5+", self.lst_deger, self.chk_deger_var)
        ]
        
        for liste_adi, lst_widget, chk_var in listeler:
            adet = lst_widget.size()
            var = tk.BooleanVar(value=(adet > 0))  # Dolu olanlarÄ± otomatik seÃ§
            self.liste_secim_vars[liste_adi] = {"var": var, "widget": lst_widget}
            
            frm_l = tk.Frame(frm_liste, bg=self.theme["card_bg"])
            frm_l.pack(fill="x", padx=10, pady=2)
            
            tk.Checkbutton(frm_l, text=f"{liste_adi} ({adet} maÃ§)", variable=var,
                          bg=self.theme["card_bg"], fg=self.theme["fg"],
                          selectcolor=self.theme["entry_bg"]).pack(side="left")
            
            # BoÅŸsa uyarÄ±
            if adet == 0:
                tk.Label(frm_l, text="(BOÅ)", bg=self.theme["card_bg"], fg="red",
                        font=("Arial", 8)).pack(side="left", padx=5)
        
        # TÃ¼mÃ¼nÃ¼ SeÃ§ / HiÃ§birini SeÃ§me (listeler iÃ§in)
        frm_secim = tk.Frame(frm_liste, bg=self.theme["card_bg"])
        frm_secim.pack(fill="x", padx=10, pady=5)
        
        def tumunu_sec():
            for k, v in self.liste_secim_vars.items():
                v["var"].set(True)
        
        def hicbirini_secme():
            for k, v in self.liste_secim_vars.items():
                v["var"].set(False)
        
        tk.Button(frm_secim, text="âœ… TÃ¼mÃ¼nÃ¼ SeÃ§", command=tumunu_sec,
                  bg="#28a745", fg="white").pack(side="left", padx=5)
        tk.Button(frm_secim, text="âŒ HiÃ§birini SeÃ§me", command=hicbirini_secme,
                  bg="#dc3545", fg="white").pack(side="left", padx=5)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # Ã–NÄ°ZLEME
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_onizleme = tk.LabelFrame(popup, text="ğŸ‘ï¸ Ã–NÄ°ZLEME", bg=self.theme["card_bg"], fg=self.theme["accent"])
        frm_onizleme.pack(fill="both", expand=True, padx=20, pady=10)
        
        self.txt_telegram_onizleme = scrolledtext.ScrolledText(frm_onizleme, height=8,
                                                                bg=self.theme["entry_bg"], fg=self.theme["fg"],
                                                                font=("Consolas", 9))
        self.txt_telegram_onizleme.pack(fill="both", expand=True, padx=5, pady=5)
        
        def onizleme_guncelle():
            tarih = self.entry_liste_tarih.get().strip()
            mesaj = f"ğŸ“‹ *Ã–ZEL LÄ°STELER*\nğŸ“… Tarih: {tarih}\n{'â•'*30}\n\n"
            
            for liste_adi, data in self.liste_secim_vars.items():
                if data["var"].get() and data["widget"].size() > 0:
                    mesaj += f"{liste_adi}\n"
                    widget = data["widget"]
                    for i in range(widget.size()):
                        item = widget.get(i)
                        mesaj += f"  â€¢ {item}\n"
                    mesaj += "\n"
            
            mesaj += "â•" * 30 + "\nğŸ“Š 90 DAKÄ°KA ANALÄ°Z"
            
            self.txt_telegram_onizleme.delete(1.0, tk.END)
            self.txt_telegram_onizleme.insert(tk.END, mesaj)
        
        tk.Button(frm_onizleme, text="ğŸ”„ Ã–nizlemeyi GÃ¼ncelle", command=onizleme_guncelle,
                  bg=self.theme["button"], fg=self.theme["fg"]).pack(pady=5)
        
        # Ä°lk Ã¶nizleme
        onizleme_guncelle()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # GÃ–NDER BUTONU
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_btn = tk.Frame(popup, bg=self.theme["bg"])
        frm_btn.pack(fill="x", padx=20, pady=10)
        
        def gonder():
            # Kanal kontrolÃ¼
            secili_kanallar = []
            
            # KayÄ±tlÄ± kanallardan seÃ§ilenler
            for kanal_adi, data in self.kanal_secim_vars.items():
                if data["var"].get() and data["chat_id"]:
                    secili_kanallar.append({"ad": kanal_adi, "chat_id": data["chat_id"]})
            
            # Yeni girilen chat id
            yeni_chat = self.entry_yeni_chat.get().strip()
            if yeni_chat:
                secili_kanallar.append({"ad": "Yeni Kanal", "chat_id": yeni_chat})
            
            if not secili_kanallar:
                messagebox.showwarning("UyarÄ±", "LÃ¼tfen en az bir kanal seÃ§in veya Chat ID girin!")
                return
            
            # Liste kontrolÃ¼
            secili_liste_var = any(data["var"].get() and data["widget"].size() > 0 
                                   for data in self.liste_secim_vars.values())
            
            if not secili_liste_var:
                messagebox.showwarning("UyarÄ±", "GÃ¶nderilecek liste yok!\nEn az bir liste seÃ§in.")
                return
            
            # MesajÄ± hazÄ±rla
            mesaj = self.txt_telegram_onizleme.get(1.0, tk.END).strip()
            
            # Token al
            token = ""
            if hasattr(self, 'telegram') and hasattr(self.telegram, 'token'):
                token = self.telegram.token
            elif hasattr(self, 'entry_tg_token'):
                token = self.entry_tg_token.get().strip()
            
            if not token:
                messagebox.showwarning("UyarÄ±", "Telegram Bot Token bulunamadÄ±!\nAYARLAR sekmesinden girin.")
                return
            
            # Her kanala gÃ¶nder
            basarili = 0
            hatali = 0
            
            for kanal in secili_kanallar:
                try:
                    url = f"https://api.telegram.org/bot{token}/sendMessage"
                    data = {
                        "chat_id": kanal["chat_id"],
                        "text": mesaj,
                        "parse_mode": "Markdown"
                    }
                    
                    response = requests.post(url, data=data, timeout=10)
                    
                    if response.status_code == 200:
                        basarili += 1
                    else:
                        hatali += 1
                        print(f"Hata ({kanal['ad']}): {response.text}")
                except Exception as e:
                    hatali += 1
                    print(f"Hata ({kanal['ad']}): {e}")
            
            # SonuÃ§
            if basarili > 0 and hatali == 0:
                messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… {basarili} kanala baÅŸarÄ±yla gÃ¶nderildi!")
                popup.destroy()
            elif basarili > 0 and hatali > 0:
                messagebox.showwarning("KÄ±smi BaÅŸarÄ±", f"âœ… {basarili} kanal baÅŸarÄ±lÄ±\nâŒ {hatali} kanal baÅŸarÄ±sÄ±z")
            else:
                messagebox.showerror("Hata", "âŒ HiÃ§bir kanala gÃ¶nderilemedi!")
        
        tk.Button(frm_btn, text="ğŸ“¤ GÃ–NDER", command=gonder,
                  bg="#0088cc", fg="white", font=("Arial", 12, "bold"),
                  width=20, height=2).pack(side="left", padx=10)
        
        tk.Button(frm_btn, text="âŒ Ä°PTAL", command=popup.destroy,
                  bg="#dc3545", fg="white", font=("Arial", 12, "bold"),
                  width=15, height=2).pack(side="right", padx=10)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # DEÄERLÄ° BAHÄ°S (HATA 4 - AÃ‡IKLAMALI)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def deger_bahis_bul(self):
        """ğŸ’ DEÄER BAHÄ°S BULUCU - xG + Gol Ort + Oran KontrolÃ¼"""
        
        # txt_deger veya txt_degerli hangisi varsa onu kullan
        txt_widget = self.txt_deger if hasattr(self, 'txt_deger') else (self.txt_degerli if hasattr(self, 'txt_degerli') else None)
        if not txt_widget:
            messagebox.showwarning("UyarÄ±", "Metin alanÄ± bulunamadÄ±!")
            return
        
        txt_widget.delete(1.0, tk.END)
        txt_widget.insert(tk.END, "ğŸ’ DEÄER BAHÄ°S ANALÄ°ZÄ°\n")
        txt_widget.insert(tk.END, "â•"*50 + "\n\n")
        
        # Filtreleri al
        try:
            min_xg = float(self.spin_min_xg.get()) if hasattr(self, 'spin_min_xg') else 3.0
            min_oran = float(self.spin_min_oran.get()) if hasattr(self, 'spin_min_oran') else 1.60
        except:
            min_xg = 3.0
            min_oran = 1.60
        
        bulunan = 0
        deger_maclar = []
        
        for mac in self.mac_db:
            try:
                mac_adi = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")
                
                # DeÄŸerleri gÃ¼venli ÅŸekilde al
                def safe_float(val, default=0):
                    if val is None or val == "" or val == "?":
                        return default
                    try:
                        return float(str(val).replace("%", "").replace(",", ".").strip())
                    except:
                        return default
                
                xg_ev = safe_float(mac.get("xg_ev", 0))
                xg_dep = safe_float(mac.get("xg_dep", 0))
                xg_toplam = xg_ev + xg_dep
                
                lig_gol_ort = safe_float(mac.get("lig_gol_ort", 0))
                ust_25 = safe_float(mac.get("ust_25", mac.get("ms_25", 0)))
                ev_atan = safe_float(mac.get("ev_atan", mac.get("ev_atan_05", 0)))
                dep_atan = safe_float(mac.get("dep_atan", mac.get("dep_atan_05", 0)))
                
                # Oran deÄŸeri (varsa)
                oran = safe_float(mac.get("oran", 0), 0)
                
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                # DEÄER BAHÄ°S KRÄ°TERLERÄ°:
                # 1. xG â‰¥ 4.0
                # 2. Lig gol ortalamasÄ± â‰¥ 2.90 VEYA iki takÄ±m gol atma ort â‰¥ 80%
                # 3. 2.5 ÃœST oranÄ± â‰¥ 1.60 (eÄŸer oran bilgisi varsa)
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                
                deger_skor = 0
                deger_nedenler = []
                
                # Kriter 1: xG yÃ¼ksek (4+)
                if xg_toplam >= 4.0:
                    deger_skor += 3
                    deger_nedenler.append(f"xG: {xg_toplam:.2f} (YÃœKSEK)")
                elif xg_toplam >= 3.5:
                    deger_skor += 2
                    deger_nedenler.append(f"xG: {xg_toplam:.2f}")
                elif xg_toplam >= min_xg:
                    deger_skor += 1
                    deger_nedenler.append(f"xG: {xg_toplam:.2f}")
                
                # Kriter 2: Lig gol ortalamasÄ± yÃ¼ksek
                if lig_gol_ort >= 2.90:
                    deger_skor += 2
                    deger_nedenler.append(f"Lig Ort: {lig_gol_ort:.2f}")
                elif lig_gol_ort >= 2.60:
                    deger_skor += 1
                    deger_nedenler.append(f"Lig Ort: {lig_gol_ort:.2f}")
                
                # Kriter 3: Ä°ki takÄ±m da gol atÄ±yor
                if ev_atan >= 85 and dep_atan >= 85:
                    deger_skor += 2
                    deger_nedenler.append(f"Ev: %{ev_atan:.0f} | Dep: %{dep_atan:.0f}")
                elif ev_atan >= 75 and dep_atan >= 75:
                    deger_skor += 1
                    deger_nedenler.append(f"Ev: %{ev_atan:.0f} | Dep: %{dep_atan:.0f}")
                
                # Kriter 4: 2.5 ÃœST istatistiÄŸi yÃ¼ksek
                if ust_25 >= 70:
                    deger_skor += 2
                    deger_nedenler.append(f"2.5Ãœ: %{ust_25:.0f}")
                elif ust_25 >= 60:
                    deger_skor += 1
                    deger_nedenler.append(f"2.5Ãœ: %{ust_25:.0f}")
                
                # Minimum 4 puan = DEÄER BAHÄ°S
                if deger_skor >= 4:
                    deger_maclar.append({
                        "mac": mac_adi,
                        "skor": deger_skor,
                        "nedenler": deger_nedenler,
                        "xg": xg_toplam,
                        "ust_25": ust_25,
                        "oneri": "2.5 ÃœST" if ust_25 >= 65 else ("3.5 ÃœST" if xg_toplam >= 4.5 else "KG VAR")
                    })
                    bulunan += 1
                    
            except Exception as e:
                continue
        
        # SonuÃ§larÄ± sÄ±rala (en yÃ¼ksek skor Ã¶nce)
        deger_maclar.sort(key=lambda x: x["skor"], reverse=True)
        
        if deger_maclar:
            for i, dm in enumerate(deger_maclar[:10], 1):
                emoji = "ğŸ’" if dm["skor"] >= 6 else ("âœ¨" if dm["skor"] >= 5 else "ğŸ”¸")
                txt_widget.insert(tk.END, f"{emoji} #{i} {dm['mac']}\n")
                txt_widget.insert(tk.END, f"   ğŸ“Š DeÄŸer Skoru: {dm['skor']}/8\n")
                txt_widget.insert(tk.END, f"   ğŸ¯ Ã–nerilen: {dm['oneri']}\n")
                txt_widget.insert(tk.END, f"   ğŸ“ˆ Veriler: {' | '.join(dm['nedenler'])}\n")
                txt_widget.insert(tk.END, "\n")
            
            txt_widget.insert(tk.END, "â•"*50 + "\n")
            txt_widget.insert(tk.END, f"ğŸ“Š Toplam {bulunan} DEÄER BAHÄ°S bulundu!\n")
        else:
            txt_widget.insert(tk.END, "âŒ Kriterlere uyan deÄŸer bahis bulunamadÄ±.\n")
            txt_widget.insert(tk.END, "ğŸ’¡ Filtreleri gevÅŸetmeyi deneyin.\n")
    
    def deger_otomatik_tara(self):
        """ğŸ” OTOMATÄ°K TARAMA - TÃ¼m bahis tiplerini kontrol et"""
        
        txt_widget = self.txt_deger if hasattr(self, 'txt_deger') else (self.txt_degerli if hasattr(self, 'txt_degerli') else None)
        if not txt_widget:
            return
        
        txt_widget.delete(1.0, tk.END)
        txt_widget.insert(tk.END, "ğŸ” OTOMATÄ°K DEÄER TARAMASI\n")
        txt_widget.insert(tk.END, "â•"*50 + "\n")
        txt_widget.insert(tk.END, "TÃ¼m bahis tipleri taranÄ±yor...\n\n")
        
        # Filtreleri al
        try:
            min_istat = float(self.spin_min_istat.get()) if hasattr(self, 'spin_min_istat') else 75
        except:
            min_istat = 75
        
        sonuclar = {
            "2.5 ÃœST": [],
            "3.5 ÃœST": [],
            "KG VAR": [],
            "KG YOK": [],
            "Ä°Y GOL": [],
            "EV 0.5 ÃœST": [],
            "DEP 0.5 ÃœST": [],
            "MS1": [],
            "MS2": []
        }
        
        for mac in self.mac_db:
            try:
                mac_adi = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")
                banko = str(mac.get("banko", "")).upper()
                
                def safe_float(val, default=0):
                    if val is None or val == "" or val == "?":
                        return default
                    try:
                        return float(str(val).replace("%", "").replace(",", ".").strip())
                    except:
                        return default
                
                # Ä°statistikleri al
                ust_25 = safe_float(mac.get("ust_25", mac.get("ms_25", 0)))
                kg_var = safe_float(mac.get("kg_var", 0))
                ev_atan = safe_float(mac.get("ev_atan", mac.get("ev_atan_05", 0)))
                dep_atan = safe_float(mac.get("dep_atan", mac.get("dep_atan_05", 0)))
                ev_yememe = safe_float(mac.get("ev_yememe", 0))
                dep_yememe = safe_float(mac.get("dep_yememe", 0))
                iy_ev = safe_float(mac.get("iy_ev_gol", 0))
                iy_dep = safe_float(mac.get("iy_dep_gol", 0))
                xg_ev = safe_float(mac.get("xg_ev", 0))
                xg_dep = safe_float(mac.get("xg_dep", 0))
                xg_toplam = xg_ev + xg_dep
                
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                # HER BAHÄ°S TÄ°PÄ° Ä°Ã‡Ä°N KONTROL
                # Ä°statistik yÃ¼ksek (%80+) ama BANKO olmamÄ±ÅŸ = DEÄER!
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                
                # 2.5 ÃœST: Ä°statistik %75+ ve banko deÄŸilse
                if ust_25 >= min_istat and "2.5" not in banko:
                    sonuclar["2.5 ÃœST"].append(f"{mac_adi} (%{ust_25:.0f})")
                
                # 3.5 ÃœST: xG 4+ veya 2.5Ãœ %80+ ve banko deÄŸilse
                if (xg_toplam >= 4.0 or ust_25 >= 80) and "3.5" not in banko:
                    sonuclar["3.5 ÃœST"].append(f"{mac_adi} (xG:{xg_toplam:.1f})")
                
                # KG VAR: Ä°ki takÄ±m da %75+ gol atÄ±yor ve banko deÄŸilse
                if ev_atan >= min_istat and dep_atan >= min_istat and "KG VAR" not in banko:
                    sonuclar["KG VAR"].append(f"{mac_adi} (Ev:%{ev_atan:.0f} Dep:%{dep_atan:.0f})")
                
                # KG YOK: Ä°ki takÄ±mdan biri %50+ yememe ve banko deÄŸilse
                if (ev_yememe >= 50 or dep_yememe >= 50) and "KG YOK" not in banko:
                    yememe = max(ev_yememe, dep_yememe)
                    sonuclar["KG YOK"].append(f"{mac_adi} (Yememe:%{yememe:.0f})")
                
                # Ä°Y GOL: Ä°Y istatistikleri %70+ ve banko deÄŸilse
                if iy_ev >= 70 and iy_dep >= 70 and "Ä°Y" not in banko:
                    sonuclar["Ä°Y GOL"].append(f"{mac_adi} (Ä°Y Ev:%{iy_ev:.0f} Dep:%{iy_dep:.0f})")
                
                # EV 0.5 ÃœST: Ev takÄ±mÄ± %85+ gol atÄ±yor ve banko deÄŸilse
                if ev_atan >= 85 and "EV" not in banko and "0.5" not in banko:
                    sonuclar["EV 0.5 ÃœST"].append(f"{mac_adi} (%{ev_atan:.0f})")
                
                # DEP 0.5 ÃœST: Dep takÄ±mÄ± %85+ gol atÄ±yor ve banko deÄŸilse
                if dep_atan >= 85 and "DEP" not in banko and "0.5" not in banko:
                    sonuclar["DEP 0.5 ÃœST"].append(f"{mac_adi} (%{dep_atan:.0f})")
                
            except:
                continue
        
        # SonuÃ§larÄ± yazdÄ±r
        toplam = 0
        for bahis_tipi, maclar in sonuclar.items():
            if maclar:
                txt_widget.insert(tk.END, f"\nğŸ¯ {bahis_tipi} ({len(maclar)} maÃ§)\n")
                txt_widget.insert(tk.END, "â”€"*40 + "\n")
                for m in maclar[:5]:  # Her kategoriden max 5
                    txt_widget.insert(tk.END, f"   â€¢ {m}\n")
                if len(maclar) > 5:
                    txt_widget.insert(tk.END, f"   ... ve {len(maclar)-5} maÃ§ daha\n")
                toplam += len(maclar)
        
        txt_widget.insert(tk.END, "\n" + "â•"*50 + "\n")
        txt_widget.insert(tk.END, f"ğŸ“Š Toplam {toplam} potansiyel DEÄER BAHÄ°S bulundu!\n")
        txt_widget.insert(tk.END, "ğŸ’¡ Bu maÃ§lar BANKO olmamÄ±ÅŸ ama istatistikleri yÃ¼ksek!\n")
    
    def deger_yuksek_potansiyel(self):
        """ğŸš€ YÃœKSEK POTANSÄ°YEL - 4.5+ gol potansiyelli maÃ§lar"""
        
        txt_widget = self.txt_deger if hasattr(self, 'txt_deger') else (self.txt_degerli if hasattr(self, 'txt_degerli') else None)
        if not txt_widget:
            return
        
        txt_widget.delete(1.0, tk.END)
        txt_widget.insert(tk.END, "ğŸš€ YÃœKSEK POTANSÄ°YEL MAÃ‡LAR\n")
        txt_widget.insert(tk.END, "â•"*50 + "\n")
        txt_widget.insert(tk.END, "4.5+ gol potansiyeli olan maÃ§lar aranÄ±yor...\n\n")
        
        yuksek_maclar = []
        
        for mac in self.mac_db:
            try:
                mac_adi = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")
                
                def safe_float(val, default=0):
                    if val is None or val == "" or val == "?":
                        return default
                    try:
                        return float(str(val).replace("%", "").replace(",", ".").strip())
                    except:
                        return default
                
                xg_ev = safe_float(mac.get("xg_ev", 0))
                xg_dep = safe_float(mac.get("xg_dep", 0))
                xg_toplam = xg_ev + xg_dep
                
                ev_atan = safe_float(mac.get("ev_atan", mac.get("ev_atan_05", 0)))
                dep_atan = safe_float(mac.get("dep_atan", mac.get("dep_atan_05", 0)))
                ust_25 = safe_float(mac.get("ust_25", mac.get("ms_25", 0)))
                lig_gol_ort = safe_float(mac.get("lig_gol_ort", 0))
                
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                # YÃœKSEK POTANSÄ°YEL KRÄ°TERLERÄ°:
                # - xG â‰¥ 4.5 VEYA
                # - xG â‰¥ 4.0 + Ä°ki takÄ±m %100 gol atÄ±yor VEYA
                # - xG â‰¥ 3.5 + Lig ort â‰¥ 3.0 + 2.5Ãœ %75+
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                
                potansiyel_skor = 0
                tahmin = ""
                
                if xg_toplam >= 4.5:
                    potansiyel_skor = 5
                    tahmin = "4.5 ÃœST"
                elif xg_toplam >= 4.0 and ev_atan >= 100 and dep_atan >= 100:
                    potansiyel_skor = 5
                    tahmin = "3.5 ÃœST (Garanti GollÃ¼)"
                elif xg_toplam >= 4.0 and ev_atan >= 90 and dep_atan >= 90:
                    potansiyel_skor = 4
                    tahmin = "3.5 ÃœST"
                elif xg_toplam >= 3.5 and lig_gol_ort >= 3.0 and ust_25 >= 75:
                    potansiyel_skor = 4
                    tahmin = "2.5+ (YÃ¼ksek Oran)"
                elif xg_toplam >= 3.5 and ust_25 >= 80:
                    potansiyel_skor = 3
                    tahmin = "2.5 ÃœST (GÃ¼Ã§lÃ¼)"
                
                if potansiyel_skor >= 3:
                    yuksek_maclar.append({
                        "mac": mac_adi,
                        "xg": xg_toplam,
                        "ev_atan": ev_atan,
                        "dep_atan": dep_atan,
                        "ust_25": ust_25,
                        "skor": potansiyel_skor,
                        "tahmin": tahmin
                    })
                    
            except:
                continue
        
        # SÄ±rala
        yuksek_maclar.sort(key=lambda x: x["skor"], reverse=True)
        
        if yuksek_maclar:
            for i, ym in enumerate(yuksek_maclar[:10], 1):
                emoji = "ğŸ”¥" if ym["skor"] >= 5 else ("âš¡" if ym["skor"] >= 4 else "âœ¨")
                txt_widget.insert(tk.END, f"{emoji} #{i} {ym['mac']}\n")
                txt_widget.insert(tk.END, f"   ğŸ¯ TAHMÄ°N: {ym['tahmin']}\n")
                txt_widget.insert(tk.END, f"   ğŸ“Š xG: {ym['xg']:.2f} | 2.5Ãœ: %{ym['ust_25']:.0f}\n")
                txt_widget.insert(tk.END, f"   âš½ Ev: %{ym['ev_atan']:.0f} | Dep: %{ym['dep_atan']:.0f}\n")
                txt_widget.insert(tk.END, "\n")
            
            txt_widget.insert(tk.END, "â•"*50 + "\n")
            txt_widget.insert(tk.END, f"ğŸš€ {len(yuksek_maclar)} YÃœKSEK POTANSÄ°YEL MAÃ‡ bulundu!\n")
        else:
            txt_widget.insert(tk.END, "âŒ YÃ¼ksek potansiyel maÃ§ bulunamadÄ±.\n")
    
    def deger_gizli_hazine(self):
        """ğŸŒ GÄ°ZLÄ° HAZÄ°NE - DÃ¼ÅŸÃ¼k profilli lig ama gÃ¼Ã§lÃ¼ istatistik"""
        
        txt_widget = self.txt_deger if hasattr(self, 'txt_deger') else (self.txt_degerli if hasattr(self, 'txt_degerli') else None)
        if not txt_widget:
            return
        
        txt_widget.delete(1.0, tk.END)
        txt_widget.insert(tk.END, "ğŸŒ GÄ°ZLÄ° HAZÄ°NE LÄ°GLERÄ°\n")
        txt_widget.insert(tk.END, "â•"*50 + "\n")
        txt_widget.insert(tk.END, "DÃ¼ÅŸÃ¼k profilli ama gÃ¼Ã§lÃ¼ istatistikli maÃ§lar...\n\n")
        
        # Gizli hazine ligleri
        gizli_ligler = [
            "NorveÃ§", "Ä°sveÃ§", "Danimarka", "Finlandiya", "Ä°zlanda",
            "Polonya", "Ã‡ekya", "Slovakya", "Macaristan", "Romanya",
            "Bulgaristan", "HÄ±rvatistan", "SÄ±rbistan", "Slovenya",
            "Ä°srail", "KÄ±brÄ±s", "Yunanistan", "Ukrayna", "Rusya",
            "Kazakistan", "GÃ¼rcistan", "Azerbaycan", "Arnavutluk",
            "Kuzey Makedonya", "Kosova", "Bosna", "KaradaÄŸ",
            "MLS", "Brezilya", "Arjantin", "Meksika", "Åili",
            "Kolombiya", "Peru", "Ekvador", "Japonya", "GÃ¼ney Kore",
            "Ã‡in", "Avustralya", "Suudi", "BAE", "Katar"
        ]
        
        # Elit ligler (bunlarÄ± hariÃ§ tut)
        elit_ligler = ["Premier League", "La Liga", "Serie A", "Bundesliga", 
                       "Ligue 1", "SÃ¼per Lig", "Eredivisie", "Primeira Liga"]
        
        gizli_maclar = []
        
        for mac in self.mac_db:
            try:
                mac_adi = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")
                lig = mac.get("lig", "")
                
                # Elit lig mi kontrol et
                is_elit = any(e.lower() in lig.lower() for e in elit_ligler)
                if is_elit:
                    continue
                
                # Gizli hazine ligi mi kontrol et
                is_gizli = any(g.lower() in lig.lower() for g in gizli_ligler)
                
                def safe_float(val, default=0):
                    if val is None or val == "" or val == "?":
                        return default
                    try:
                        return float(str(val).replace("%", "").replace(",", ".").strip())
                    except:
                        return default
                
                ev_atan = safe_float(mac.get("ev_atan", mac.get("ev_atan_05", 0)))
                dep_atan = safe_float(mac.get("dep_atan", mac.get("dep_atan_05", 0)))
                ust_25 = safe_float(mac.get("ust_25", mac.get("ms_25", 0)))
                xg_ev = safe_float(mac.get("xg_ev", 0))
                xg_dep = safe_float(mac.get("xg_dep", 0))
                xg_toplam = xg_ev + xg_dep
                guven = str(mac.get("guven", "0")).replace("/10", "")
                try:
                    guven_int = int(guven)
                except:
                    guven_int = 0
                
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                # GÄ°ZLÄ° HAZÄ°NE KRÄ°TERLERÄ°:
                # - Elit lig DEÄÄ°L
                # - Ä°statistik gÃ¼Ã§lÃ¼ (iki takÄ±m %80+ VEYA 2.5Ãœ %70+)
                # - xG 3.0+
                # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                
                hazine_skor = 0
                
                if ev_atan >= 80 and dep_atan >= 80:
                    hazine_skor += 2
                if ust_25 >= 70:
                    hazine_skor += 2
                if xg_toplam >= 3.5:
                    hazine_skor += 2
                elif xg_toplam >= 3.0:
                    hazine_skor += 1
                if is_gizli:
                    hazine_skor += 1  # Bilinen gizli hazine ligi bonus
                
                if hazine_skor >= 3:
                    gizli_maclar.append({
                        "mac": mac_adi,
                        "lig": lig,
                        "xg": xg_toplam,
                        "ev_atan": ev_atan,
                        "dep_atan": dep_atan,
                        "ust_25": ust_25,
                        "skor": hazine_skor,
                        "guven": guven_int
                    })
                    
            except:
                continue
        
        # SÄ±rala
        gizli_maclar.sort(key=lambda x: x["skor"], reverse=True)
        
        if gizli_maclar:
            for i, gm in enumerate(gizli_maclar[:10], 1):
                emoji = "ğŸ’" if gm["skor"] >= 5 else ("ğŸŒŸ" if gm["skor"] >= 4 else "âœ¨")
                txt_widget.insert(tk.END, f"{emoji} #{i} {gm['mac']}\n")
                txt_widget.insert(tk.END, f"   ğŸ† Lig: {gm['lig']}\n")
                txt_widget.insert(tk.END, f"   ğŸ“Š xG: {gm['xg']:.2f} | 2.5Ãœ: %{gm['ust_25']:.0f}\n")
                txt_widget.insert(tk.END, f"   âš½ Ev: %{gm['ev_atan']:.0f} | Dep: %{gm['dep_atan']:.0f}\n")
                txt_widget.insert(tk.END, "\n")
            
            txt_widget.insert(tk.END, "â•"*50 + "\n")
            txt_widget.insert(tk.END, f"ğŸŒ {len(gizli_maclar)} GÄ°ZLÄ° HAZÄ°NE bulundu!\n")
            txt_widget.insert(tk.END, "ğŸ’¡ Bu ligler daha az takip ediliyor ama fÄ±rsatlar var!\n")
        else:
            txt_widget.insert(tk.END, "âŒ Kriterlere uyan gizli hazine bulunamadÄ±.\n")
    
    def deger_telegram_gonder(self):
        """DeÄŸerli bahis sonuÃ§larÄ±nÄ± Telegram'a gÃ¶nder"""
        txt_widget = self.txt_deger if hasattr(self, 'txt_deger') else (self.txt_degerli if hasattr(self, 'txt_degerli') else None)
        if not txt_widget:
            return
        
        icerik = txt_widget.get(1.0, tk.END).strip()
        if not icerik:
            messagebox.showwarning("UyarÄ±", "Ã–nce bir tarama yapÄ±n!")
            return
        
        # Ã–nizleme popup
        self._telegram_onizleme_popup(icerik, "DeÄŸerli Bahis")


# ============================================================
# PART 4 SONU - PART 5'E DEVAM
# ============================================================
# ============================================================
# PART 5/6 - FONKSÄ°YONLAR BÃ–LÃœM 2
# ============================================================
# Bu dosyayÄ± PART 4'Ã¼n SONUNA ekle
# ============================================================

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # TELEGRAM FONKSÄ°YONLARI (HATA 1, 2, 5, 15)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def telegram_kaydet(self):
        global TELEGRAM_BOT_TOKEN, TELEGRAM_CHAT_ID
        TELEGRAM_BOT_TOKEN = self.entry_tg_token.get().strip()
        TELEGRAM_CHAT_ID = self.entry_tg_chat.get().strip()
        self.telegram = TelegramBot(TELEGRAM_BOT_TOKEN, TELEGRAM_CHAT_ID)
        self.telegram.load_channels(CHANNELS_FILE)
        self.ayarlar_kaydet()
        messagebox.showinfo("BaÅŸarÄ±lÄ±", "âœ… Telegram ayarlarÄ± kaydedildi!")
    
    def telegram_test(self):
        ok, result = self.telegram.send("ğŸ§ª XG-XRAY V5.6 Test MesajÄ± - BaÄŸlantÄ± BaÅŸarÄ±lÄ±!")
        if ok:
            messagebox.showinfo("BaÅŸarÄ±lÄ±", "âœ… Test mesajÄ± gÃ¶nderildi!")
        else:
            messagebox.showerror("Hata", f"âŒ Hata: {result}")
    
    def kanal_ekle(self):
        """HATA 15 - Ã‡oklu kanal ekleme"""
        ad = self.entry_kanal_ad.get().strip()
        chat_id = self.entry_kanal_id.get().strip()
        
        if not ad or not chat_id:
            messagebox.showwarning("UyarÄ±", "Kanal adÄ± ve Chat ID gerekli!")
            return
        
        self.telegram.add_channel(ad, chat_id)
        self.telegram.save_channels(CHANNELS_FILE)
        self.kanal_listele()
        
        self.entry_kanal_ad.delete(0, tk.END)
        self.entry_kanal_id.delete(0, tk.END)
        messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… {ad} eklendi!")
    
    def kanal_sil(self):
        """SeÃ§ili kanallarÄ± sil"""
        secili = self.listbox_kanallar.curselection()
        if not secili:
            messagebox.showwarning("UyarÄ±", "Silmek iÃ§in kanal seÃ§in!")
            return
        
        # Onay al
        if not messagebox.askyesno("Onay", f"{len(secili)} kanal silinecek. Emin misiniz?"):
            return
        
        # Sondan baÅŸa sil (index kaymasÄ± olmasÄ±n)
        for idx in reversed(secili):
            if idx < len(self.telegram.channels):
                del self.telegram.channels[idx]
        
        self.telegram.save_channels(CHANNELS_FILE)
        self.kanal_listele()
        messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… {len(secili)} kanal silindi!")
    
    def kanal_tumunu_sil(self):
        """TÃ¼m kanallarÄ± sil"""
        if not self.telegram.channels:
            messagebox.showwarning("UyarÄ±", "Silinecek kanal yok!")
            return
        
        if not messagebox.askyesno("Onay", "TÃœM kanallar silinecek! Emin misiniz?"):
            return
        
        self.telegram.channels = []
        self.telegram.save_channels(CHANNELS_FILE)
        self.kanal_listele()
        messagebox.showinfo("BaÅŸarÄ±lÄ±", "âœ… TÃ¼m kanallar silindi!")
    
    def kanal_listele(self):
        """KayÄ±tlÄ± kanallarÄ± listele"""
        self.listbox_kanallar.delete(0, tk.END)
        for ch in self.telegram.channels:
            status = "âœ…" if ch.get("active", True) else "âŒ"
            self.listbox_kanallar.insert(tk.END, f"{status} {ch['name']} ({ch['chat_id']})")
        
        # FIX #16: telegram_kanallari'nÄ± senkronize et
        self.telegram_kanallari = []
        for ch in self.telegram.channels:
            self.telegram_kanallari.append({
                "ad": ch.get("name", "Kanal"),
                "id": ch.get("chat_id", "")
            })
    
    def tg_maclari_yukle(self):
        """V70: FÄ°L HAFIZASINDAN maÃ§larÄ± yÃ¼kle"""
        # V70: mac_arsivi'den TÃœM maÃ§larÄ± al
        maclar = []
        
        # Ã–nce mac_arsivi'den
        if hasattr(self, 'mac_arsivi') and self.mac_arsivi:
            for mac_key, mac_data in self.mac_arsivi.items():
                mac_adi = mac_data.get("mac", mac_data.get("mac_adi", ""))
                if mac_adi:
                    maclar.append(mac_adi.replace("_", " "))
        
        # mac_arsivi boÅŸsa mac_db'den
        if not maclar and self.mac_db:
            maclar = [m.get("mac", m.get("mac_adi", "?")).replace("_", " ") 
                      for m in self.mac_db[-50:]]  # Son 50 maÃ§
        
        # Combobox'Ä± doldur
        self.combo_tg_mac["values"] = maclar
        if maclar:
            self.combo_tg_mac.set(maclar[0])
        else:
            self.combo_tg_mac.set("Analiz bulunamadÄ±")
        
        print(f"ğŸ“‹ Telegram maÃ§ listesi: {len(maclar)} maÃ§ yÃ¼klendi")
    
    def canli_bildirim_gonder(self):
        """FIX #27: CanlÄ± bildirim popup - Ã¶zel mesaj yaz ve gÃ¶nder"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“¢ CanlÄ± Bildirim GÃ¶nder")
        popup.geometry("500x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“¢ CANLI BÄ°LDÄ°RÄ°M GÃ–NDER", font=("Segoe UI", 14, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(pady=10)
        
        tk.Label(popup, text="Bildirim mesajÄ±nÄ±zÄ± yazÄ±n:", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack(anchor="w", padx=20)
        
        txt_bildirim = scrolledtext.ScrolledText(popup, height=8, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 10))
        txt_bildirim.pack(fill="x", padx=20, pady=10)
        txt_bildirim.insert("1.0", "ğŸ”´ CANLI BÄ°LDÄ°RÄ°M\n\n")
        
        # Kanal seÃ§imi
        tk.Label(popup, text="ğŸ“¢ Kanal SeÃ§:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(anchor="w", padx=20)
        
        frm_kanal = tk.Frame(popup, bg=ModernTheme.BG_CARD)
        frm_kanal.pack(fill="x", padx=20, pady=5)
        
        kanal_vars = {}
        for kanal in self.telegram_kanallari:
            var = tk.BooleanVar(value=True)
            kanal_vars[kanal.get("id", "")] = var
            tk.Checkbutton(frm_kanal, text=f"{kanal.get('ad', 'Kanal')} ({kanal.get('id', '')})",
                          variable=var, bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY,
                          selectcolor=ModernTheme.BG_PRIMARY).pack(anchor="w", padx=10)
        
        def gonder():
            mesaj = txt_bildirim.get("1.0", tk.END).strip()
            if not mesaj:
                messagebox.showwarning("UyarÄ±", "Mesaj yazÄ±n!")
                return
            
            basarili = 0
            for kanal_id, var in kanal_vars.items():
                if var.get():
                    ok, _ = self.telegram.send(mesaj, kanal_id)
                    if ok:
                        basarili += 1
            
            popup.destroy()
            messagebox.showinfo("âœ…", f"Bildirim {basarili} kanala gÃ¶nderildi!")
        
        tk.Button(popup, text="ğŸ“¤ GÃ–NDER", command=gonder,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", font=("Arial", 11, "bold"), relief="flat").pack(pady=10)
    
    def tg_format_gonder(self, format_tipi):
        """V70: SeÃ§ili maÃ§ iÃ§in format oluÅŸtur - FÄ°L HAFIZASINDAN"""
        mac_adi = self.combo_tg_mac.get()
        if not mac_adi or mac_adi == "Analiz bulunamadÄ±":
            messagebox.showwarning("UyarÄ±", "LÃ¼tfen bir maÃ§ seÃ§in!")
            return
        
        # V70: Ã–nce FÄ°L HAFIZASINDAN ara
        mac_data = None
        mac_key = mac_adi.replace(" ", "_").replace("-", "_").lower()
        
        if hasattr(self, 'mac_arsivi') and mac_key in self.mac_arsivi:
            mac_data = self.mac_arsivi[mac_key]
            print(f"ğŸ˜ FÄ°L HAFIZASINDAN bulundu: {mac_adi}")
        
        # BulunamadÄ±ysa mac_db'den ara
        if not mac_data:
            mac_normalized = mac_adi.replace(" ", "_")
            for m in self.mac_db:
                m_name = m.get("mac", m.get("mac_adi", "")).replace(" ", "_")
                if m_name == mac_normalized or m_name.lower() == mac_normalized.lower():
                    mac_data = m
                    break
        
        # Hala bulunamadÄ±ysa son analizi kullan
        if not mac_data and self.current_analysis:
            mac_data = self.current_analysis
            print(f"ğŸ“‹ Son analiz kullanÄ±ldÄ±: {self.current_analysis.get('mac', 'N/A')}")
        
        if not mac_data:
            messagebox.showwarning("UyarÄ±", f"MaÃ§ veritabanÄ±nda bulunamadÄ±: {mac_adi}\n\nÃ–nce bir analiz yapÄ±n!")
            return
        
        # V70: current_analysis gÃ¼ncelle
        self.current_analysis = mac_data
        
        # Format oluÅŸtur
        if format_tipi == "kisa":
            msg = self._format_kisa(mac_data)
        elif format_tipi == "detayli":
            msg = self._format_detayli(mac_data)
        elif format_tipi == "canli":
            msg = self._format_canli(mac_data)
        else:  # sonuc
            msg = self._format_sonuc(mac_data)
        
        # Ã–nizleme gÃ¶ster
        self.txt_tg_preview.delete(1.0, tk.END)
        self.txt_tg_preview.insert(tk.END, msg)
        
        # Ã–nizleme popup'Ä± gÃ¶ster
        self._telegram_onizleme_popup(msg, f"Telegram - {format_tipi.upper()}")
    
    def _format_detayli(self, mac_data):
        """DetaylÄ± format - V5.8 DÃœZGÃœN FORMAT"""
        mac = mac_data.get("mac", mac_data.get("mac_adi", "?")).replace("_", " ")
        lig = mac_data.get("lig", "?")
        tarih = mac_data.get("tarih", "?")
        banko = mac_data.get("banko", "?")
        
        # Sigorta hesapla - bankonun 1 altÄ±
        sigorta = self.telegram._sigorta_belirle(banko) if hasattr(self, 'telegram') else "MS 0.5 ÃœST"
        
        # GÃ¼ven ve kasa
        guven = mac_data.get("guven", 7)
        try:
            guven_sayi = int(str(guven).split("/")[0])
        except:
            guven_sayi = 7
        kasa = KASA_ORANLARI.get(guven_sayi, {"oran": 10})["oran"]
        
        # OCR verilerinden istatistikler
        ocr_data = mac_data.get("ocr_data", {}) or {}
        
        # Ã–nce mac_data, sonra ocr_data
        def get_val(key, ocr_key=None, default="?"):
            val = mac_data.get(key, "")
            if not val or val == "?" or val == "":
                if ocr_key:
                    val = ocr_data.get(ocr_key, default)
                else:
                    val = default
            return str(val).replace("%", "") if val else default
        
        ev_atan = get_val("ev_atan", "ev_atan_05", "85")
        dep_atan = get_val("dep_atan", "dep_atan_05", "75")
        ust_25 = get_val("ust_25", "ust_25_ort", "55")
        kg_var = get_val("kg_var", "kg_var_ort", "55")
        
        # xG hesapla
        xg_ev = get_val("xg_ev", "xg_ev", "1.3")
        xg_dep = get_val("xg_dep", "xg_dep", "1.2")
        try:
            xg_toplam = f"{float(xg_ev) + float(xg_dep):.2f}"
        except:
            xg_toplam = "2.50"
        
        # Kritik 3 veri - analiz_sonucu'ndan veya mac_data'dan al
        analiz_sonucu = mac_data.get("analiz_sonucu", {}) or {}
        simulasyon = analiz_sonucu.get("simulasyon", {}) or {}
        gecenler = simulasyon.get("gecenler", [])
        
        kritik_text = ""
        if gecenler:
            for i, g in enumerate(gecenler[:3], 1):
                kritik_text += f"{i}. {g.get('tip', '?')} - Puan: %{g.get('puan', 0):.0f}\n"
        else:
            # Alternatif: mac_data'dan kritik veriler oluÅŸtur
            kritik_list = []
            
            # xG toplam yÃ¼ksekse
            try:
                xg_f = float(xg_toplam)
                if xg_f >= 2.5:
                    kritik_list.append(f"1. Toplam xG: {xg_toplam} (YÃ¼ksek)")
            except:
                pass
            
            # Ev gol gÃ¼cÃ¼ yÃ¼ksekse
            try:
                ev_f = float(ev_atan)
                if ev_f >= 80:
                    kritik_list.append(f"2. Ev Gol GÃ¼cÃ¼: %{ev_atan} (GÃ¼Ã§lÃ¼)")
            except:
                pass
            
            # KG VAR yÃ¼ksekse
            try:
                kg_f = float(kg_var)
                if kg_f >= 60:
                    kritik_list.append(f"3. KG VAR: %{kg_var} (YÃ¼ksek)")
            except:
                pass
            
            if kritik_list:
                kritik_text = "\n".join(kritik_list)
            else:
                kritik_text = f"1. xG: {xg_toplam}\n2. Gol GÃ¼Ã§leri: %{ev_atan} / %{dep_atan}\n3. 2.5Ãœ: %{ust_25}"
        
        return f"""âš½ï¸ *{mac}*
ğŸ† {lig}
ğŸ“… {tarih}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ *TAHMÄ°N:* {banko}
ğŸ“Š GÃ¼ven: *{guven_sayi}/10*

ğŸ“ˆ *Ä°STATÄ°STÄ°KLER:*
â€¢ Ev 0.5Ãœ: %{ev_atan}
â€¢ Dep 0.5Ãœ: %{dep_atan}
â€¢ 2.5Ãœ Ort: %{ust_25}
â€¢ KG VAR: %{kg_var}
â€¢ xG: {xg_toplam}

ğŸ“Œ *KRÄ°TÄ°K VERÄ°LER:*
{kritik_text}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ *BANKO:* {banko}
ğŸ›¡ï¸ *SÄ°GORTA:* {sigorta}
ğŸ“Š *GÃœVEN:* {guven_sayi}/10
ğŸ’° *KASA:* %{kasa}

ğŸ“± _90 DAKÄ°KA ANALÄ°Z_"""
    
    def _format_kisa(self, mac_data):
        """KÄ±sa format"""
        mac = mac_data.get("mac", mac_data.get("mac_adi", "?")).replace("_", " ")
        banko = mac_data.get("banko", "?")
        guven = mac_data.get("guven", "?")
        
        return f"""âš½ *{mac}*

ğŸ¯ *TAHMÄ°N:* {banko}
ğŸ“Š GÃ¼ven: *{guven}/10*

ğŸ“± _90 Dakika Analiz_"""
    
    def _format_canli(self, mac_data):
        """CanlÄ± hatÄ±rlatma formatÄ±"""
        mac = mac_data.get("mac", mac_data.get("mac_adi", "?")).replace("_", " ")
        banko = mac_data.get("banko", "?")
        
        return f"""â° *CANLI BAHÄ°S ZAMANI!*

âš½ {mac}
ğŸ¯ Tahmin: *{banko}*

âš ï¸ MaÃ§ baÅŸladÄ±, canlÄ± oranlarÄ± kontrol et!

ğŸ“± _90 Dakika Analiz_"""
    
    def _format_sonuc(self, mac_data):
        """SonuÃ§ formatÄ±"""
        mac = mac_data.get("mac", mac_data.get("mac_adi", "?")).replace("_", " ")
        banko = mac_data.get("banko", "?")
        sonuc = mac_data.get("sonuc", "?")
        skor = mac_data.get("gercek_skor", "?")
        
        emoji = "âœ…" if sonuc == "KAZANDI" else "âŒ"
        
        return f"""{emoji} *SONUÃ‡*

âš½ {mac}
ğŸ¯ Tahmin: {banko}
ğŸ“Š Skor: *{skor}*
{emoji} *{sonuc}*

ğŸ“± _90 Dakika Analiz_"""
    
    def kanal_sec_ve_gonder(self, mesaj, baslik="Kanal SeÃ§"):
        """GLOBAL KANAL SEÃ‡Ä°CÄ° - TÃ¼m telegram gÃ¶nderimlerinde kullanÄ±lÄ±r"""
        # Ã–nce telegram_kanallari'nÄ± kontrol et
        kanallar = getattr(self, 'telegram_kanallari', [])
        
        if not kanallar:
            # Kanal yoksa varsayÄ±lan chat'e gÃ¶nder
            ok, result = self.telegram.send(mesaj)
            if ok:
                messagebox.showinfo("BaÅŸarÄ±lÄ±", "âœ… VarsayÄ±lan kanala gÃ¶nderildi!")
            else:
                messagebox.showerror("Hata", f"âŒ {result}")
            return
        
        # Kanal seÃ§ici dialog oluÅŸtur
        dialog = tk.Toplevel(self.root)
        dialog.title(f"ğŸ“¤ {baslik}")
        dialog.geometry("450x400")
        dialog.configure(bg=ModernTheme.BG_PRIMARY)
        dialog.transient(self.root)
        dialog.grab_set()
        
        # BaÅŸlÄ±k
        tk.Label(dialog, text="ğŸ“¢ GÃ¶ndermek istediÄŸiniz kanallarÄ± seÃ§in:", 
                 bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY, 
                 font=("Segoe UI", 12, "bold")).pack(pady=15)
        
        # Kanal listesi (checkbutton'larla)
        frm_list = tk.Frame(dialog, bg=ModernTheme.BG_CARD)
        frm_list.pack(fill="both", expand=True, padx=20, pady=10)
        
        kanal_vars = []
        for kanal in kanallar:
            var = tk.BooleanVar(value=True)  # VarsayÄ±lan seÃ§ili
            kanal_id = kanal.get("id", kanal.get("chat_id", ""))
            kanal_ad = kanal.get("ad", kanal.get("name", "Kanal"))
            
            cb = tk.Checkbutton(frm_list, 
                               text=f"ğŸ“¢ {kanal_ad} ({kanal_id})",
                               variable=var,
                               bg=ModernTheme.BG_CARD, 
                               fg=ModernTheme.TEXT_PRIMARY,
                               selectcolor=ModernTheme.BG_PRIMARY,
                               activebackground=ModernTheme.BG_CARD,
                               font=("Segoe UI", 10))
            cb.pack(anchor="w", pady=3, padx=10)
            kanal_vars.append((kanal_id, var))
        
        # TÃ¼mÃ¼nÃ¼ seÃ§/kaldÄ±r
        frm_secim = tk.Frame(dialog, bg=ModernTheme.BG_PRIMARY)
        frm_secim.pack(fill="x", padx=20, pady=10)
        
        def tumunu_sec():
            for _, var in kanal_vars:
                var.set(True)
        
        def tumunu_kaldir():
            for _, var in kanal_vars:
                var.set(False)
        
        tk.Button(frm_secim, text="âœ… TÃ¼mÃ¼nÃ¼ SeÃ§", command=tumunu_sec,
                  bg="#28a745", fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(frm_secim, text="âŒ TÃ¼mÃ¼nÃ¼ KaldÄ±r", command=tumunu_kaldir,
                  bg="#6c757d", fg="white", relief="flat").pack(side="left", padx=5)
        
        # GÃ¶nder butonu
        def gonder():
            secili_kanallar = [cid for cid, var in kanal_vars if var.get()]
            if not secili_kanallar:
                messagebox.showwarning("UyarÄ±", "En az bir kanal seÃ§in!")
                return
            
            dialog.destroy()
            
            # SeÃ§ili kanallara gÃ¶nder
            basarili = 0
            hatali = 0
            for cid in secili_kanallar:
                ok, result = self.telegram.send(mesaj, chat_id=cid)
                if ok:
                    basarili += 1
                else:
                    hatali += 1
            
            if hatali == 0:
                messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… {basarili} kanala gÃ¶nderildi!")
            else:
                messagebox.showwarning("SonuÃ§", f"âœ… {basarili} baÅŸarÄ±lÄ±\nâŒ {hatali} baÅŸarÄ±sÄ±z")
        
        frm_btn = tk.Frame(dialog, bg=ModernTheme.BG_PRIMARY)
        frm_btn.pack(fill="x", padx=20, pady=15)
        
        tk.Button(frm_btn, text="ğŸ“¤ GÃ–NDER", command=gonder,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", font=("Segoe UI", 11, "bold"),
                  width=15, height=2, relief="flat").pack(side="left", padx=10)
        tk.Button(frm_btn, text="âŒ Ä°PTAL", command=dialog.destroy,
                  bg=ModernTheme.ACCENT_DANGER, fg="white", font=("Segoe UI", 11),
                  width=15, height=2, relief="flat").pack(side="right", padx=10)
    
    def telegram_gonder(self):
        """V70: Ana sayfadan telegram gÃ¶nder - FÄ°L HAFIZASI DESTEKLÄ°"""
        # V70: FÄ°L HAFIZASI kontrolÃ¼ - mac_arsivi, mac_db veya current_analysis
        mac_data = None
        
        # Ã–nce current_analysis
        if hasattr(self, 'current_analysis') and self.current_analysis:
            mac_data = self.current_analysis
        # Sonra mac_db
        elif self.mac_db:
            mac_data = self.mac_db[-1]
            self.current_analysis = mac_data
        # Son olarak mac_arsivi
        elif hasattr(self, 'mac_arsivi') and self.mac_arsivi:
            mac_data = list(self.mac_arsivi.values())[-1]
            self.current_analysis = mac_data
        
        if not mac_data:
            messagebox.showwarning("UyarÄ±", "HenÃ¼z analiz yapÄ±lmamÄ±ÅŸ!\n\nLÃ¼tfen Ã¶nce bir gÃ¶rsel yÃ¼kleyip analiz yapÄ±n.")
            return
        
        # Telegram gÃ¶nder
        if self.telegram:
            msg = self.telegram.format_analysis_detailed(mac_data, self.last_result or "")
            self.kanal_sec_ve_gonder(msg, "DetaylÄ± Analiz GÃ¶nder")
        else:
            messagebox.showerror("Hata", "Telegram botu baÅŸlatÄ±lamadÄ±!\nAPI Key'i kontrol edin.")
    
    def telegram_ozet_gonder(self):
        """V70: Ã–ZET - FÄ°L HAFIZASI DESTEKLÄ°"""
        # V70: FÄ°L HAFIZASI kontrolÃ¼
        mac_data = None
        
        if hasattr(self, 'current_analysis') and self.current_analysis:
            mac_data = self.current_analysis
        elif self.mac_db:
            mac_data = self.mac_db[-1]
            self.current_analysis = mac_data
        elif hasattr(self, 'mac_arsivi') and self.mac_arsivi:
            mac_data = list(self.mac_arsivi.values())[-1]
            self.current_analysis = mac_data
        
        if not mac_data:
            messagebox.showwarning("UyarÄ±", "HenÃ¼z analiz yapÄ±lmamÄ±ÅŸ!\n\nLÃ¼tfen Ã¶nce bir gÃ¶rsel yÃ¼kleyip analiz yapÄ±n.")
            return
        
        text = self.last_result or ""
        
        # OCR verisi varsa al
        ocr_data = mac_data.get("ocr_data", {}) or {}
        analiz_sonucu = mac_data.get("analiz_sonucu", {}) or {}
        
        # 1. ||VERI_BASLANGIC|| bloÄŸundan oku
        veri_data = {}
        veri_match = re.search(r'\|\|VERI_BASLANGIC\|\|(.*?)\|\|VERI_BITIS\|\|', text, re.DOTALL)
        if veri_match:
            veri_text = veri_match.group(1)
            for line in veri_text.strip().split('\n'):
                if '=' in line:
                    key, val = line.split('=', 1)
                    veri_data[key.strip()] = val.strip()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # HELPER FONKSÄ°YONLAR
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        def safe_val(key, alt_keys=None, default="?"):
            """SÄ±rayla: veri_data â†’ mac_data â†’ ocr_data â†’ default"""
            # veri_data'dan
            if key in veri_data and veri_data[key] not in ["?", "", "null", "None", None]:
                return str(veri_data[key]).replace("[", "").replace("]", "").replace("%", "").strip()
            # mac_data'dan
            if key in mac_data and mac_data[key] not in ["?", "", None, "null"]:
                return str(mac_data[key]).replace("[", "").replace("]", "").replace("%", "").strip()
            # ocr_data'dan
            if key in ocr_data and ocr_data[key] not in ["?", "", None, "null"]:
                return str(ocr_data[key]).replace("[", "").replace("]", "").replace("%", "").strip()
            # Alternatif keyler
            if alt_keys:
                for ak in alt_keys:
                    for src in [veri_data, mac_data, ocr_data]:
                        if ak in src and src[ak] not in ["?", "", None, "null"]:
                            return str(src[ak]).replace("[", "").replace("]", "").replace("%", "").strip()
            return default
        
        def safe_float(val, default=0):
            try:
                return float(str(val).replace("%", "").replace(",", ".").strip())
            except:
                return default
        
        def get_ikon(yuzde, baraj_yuksek=80, baraj_orta=60):
            """YÃ¼zdeye gÃ¶re ikon"""
            try:
                y = safe_float(yuzde)
                if y >= baraj_yuksek:
                    return "âœ…"
                elif y >= baraj_orta:
                    return "âš ï¸"
                else:
                    return "âŒ"
            except:
                return ""
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # VERÄ°LERÄ° TOPLA
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        # TakÄ±m bilgileri
        ev_takimi = safe_val("ev_takimi", ["ev"], "Ev Sahibi")
        dep_takimi = safe_val("dep_takimi", ["dep"], "Deplasman")
        lig = safe_val("lig", None, "Bilinmeyen Lig")
        tarih = self.entry_date.get().strip() or datetime.now().strftime("%d.%m.%Y")
        
        # mac_adi'den takÄ±m isimlerini Ã§Ä±kar
        mac_adi = safe_val("mac_adi", ["mac"], "")
        if mac_adi and "vs" in mac_adi.lower():
            parts = re.split(r'\s+vs\s+', mac_adi, flags=re.IGNORECASE)
            if len(parts) == 2:
                ev_takimi = parts[0].strip().replace("_", " ")
                dep_takimi = parts[1].strip().replace("_", " ")
        
        # Temel istatistikler - OCR'dan gelen GERÃ‡EK veriler
        # V64: Ã–ncelik sÄ±rasÄ±: ocr_data â†’ analiz_sonucu â†’ veri_data â†’ mac_data
        
        def get_real_stat(key, alt_keys=None, default="?"):
            """OCR verisinden GERÃ‡EK istatistiÄŸi al"""
            # Ã–nce ocr_data'dan
            if ocr_data and key in ocr_data:
                val = ocr_data[key]
                if val not in [None, "", "?", 0, 0.0]:
                    return str(val).replace("%", "")
            # Sonra analiz_sonucu
            if analiz_sonucu:
                hesap = analiz_sonucu.get("hesaplamalar", {})
                if key in hesap:
                    val = hesap[key]
                    if val not in [None, "", "?", 0, 0.0]:
                        return str(val).replace("%", "")
            # Alt keyler
            if alt_keys:
                for ak in alt_keys:
                    for src in [ocr_data, analiz_sonucu.get("hesaplamalar", {}), veri_data, mac_data]:
                        if src and ak in src:
                            val = src[ak]
                            if val not in [None, "", "?", 0, 0.0]:
                                return str(val).replace("%", "")
            # veri_data ve mac_data
            for src in [veri_data, mac_data]:
                if src and key in src:
                    val = src[key]
                    if val not in [None, "", "?", 0, 0.0]:
                        return str(val).replace("%", "")
            return default
        
        ms_05 = get_real_stat("ust_05", ["ust_05_ort", "ms_05_ust"], "95")
        ms_15 = get_real_stat("ust_15", ["ust_15_ort", "ms_15_ust"], "75")
        ms_25 = get_real_stat("ust_25", ["ust_25_ort", "ms_25_ust"], "55")
        ms_35 = get_real_stat("ust_35", ["ust_35_ort", "ms_35_ust"], "35")
        kg_var = get_real_stat("kg_var_ort", ["kg_var", "hibrit_kg"], "55")
        
        # Ä°Y verileri - OCR'dan
        iy_ev = get_real_stat("iy_ev_gol", ["iy_ev_atan"], "50")
        iy_dep = get_real_stat("iy_dep_gol", ["iy_dep_atan"], "50")
        iy_ort = (safe_float(iy_ev) + safe_float(iy_dep)) / 2
        
        # TakÄ±m gol gÃ¼Ã§leri (0.5 ÃœST yÃ¼zdeleri) - OCR'dan
        ev_gol = get_real_stat("ev_atan_05", ["ev_atan"], "70")
        dep_gol = get_real_stat("dep_atan_05", ["dep_atan"], "70")
        
        # xG verileri - OCR'dan
        xg_ev = get_real_stat("xg_ev", None, "?")
        xg_dep = get_real_stat("xg_dep", None, "?")
        xg_toplam = "?"
        if xg_ev != "?" and xg_dep != "?":
            try:
                xg_toplam = f"{safe_float(xg_ev) + safe_float(xg_dep):.2f}"
            except:
                pass
        
        # Gol ortalamalarÄ± (maÃ§ baÅŸÄ± atÄ±lan/yenen)
        gol_ort_ev = safe_val("gol_ort_ev", None, "1.2")
        gol_ort_dep = safe_val("gol_ort_dep", None, "1.2")
        gol_yeme_ev = safe_val("gol_yeme_ort_ev", None, "1.0")
        gol_yeme_dep = safe_val("gol_yeme_ort_dep", None, "1.0")
        
        # Seri bilgileri
        seri_ev = safe_val("seri_ev", None, "")
        seri_dep = safe_val("seri_dep", None, "")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # KRÄ°TÄ°K 3 VERÄ° - Metinden Ã§Ä±kar
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        kritik_veriler = []
        
        # 1. xG bazlÄ±
        if xg_toplam != "?" and safe_float(xg_toplam) >= 2.5:
            kritik_veriler.append({
                "baslik": f"Toplam xG: {xg_toplam}",
                "aciklama": f"Matematiksel gol beklentisi {'yÃ¼ksek' if safe_float(xg_toplam) >= 3 else 'normal'}"
            })
        
        # 2. Gol gÃ¼cÃ¼ bazlÄ±
        if safe_float(ev_gol) >= 80 or safe_float(dep_gol) >= 80:
            kritik_veriler.append({
                "baslik": f"Gol GÃ¼Ã§leri: Ev %{ev_gol} / Dep %{dep_gol}",
                "aciklama": "Her iki takÄ±m da yÃ¼ksek gol bulma oranÄ±na sahip"
            })
        
        # 3. KG VAR bazlÄ±
        if safe_float(kg_var) >= 65:
            kritik_veriler.append({
                "baslik": f"KG VAR OranÄ±: %{kg_var}",
                "aciklama": "KarÅŸÄ±lÄ±klÄ± gol ihtimali gÃ¼Ã§lÃ¼"
            })
        
        # 4. 2.5 ÃœST bazlÄ±
        if safe_float(ms_25) >= 55:
            kritik_veriler.append({
                "baslik": f"2.5 ÃœST OranÄ±: %{ms_25}",
                "aciklama": "MaÃ§ baÅŸÄ±na 3+ gol potansiyeli var"
            })
        
        # Eksik kalan kritik verileri doldur
        while len(kritik_veriler) < 3:
            kritik_veriler.append({
                "baslik": "Form Analizi",
                "aciklama": "TakÄ±mlarÄ±n gÃ¼ncel performansÄ± deÄŸerlendirildi"
            })
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BANKO VE GÃœVEN
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        banko = safe_val("banko", ["nihai_banko"], "MS 1.5 ÃœST")
        banko = banko.replace("**", "").replace("*", "").strip()
        if not banko or banko == "?":
            banko = "MS 1.5 ÃœST"
        
        guven = safe_val("guven", None, "7")
        try:
            guven_sayi = int(str(guven).split("/")[0].strip())
        except:
            guven_sayi = 7
        
        kasa = KASA_ORANLARI.get(guven_sayi, {"oran": 10})["oran"]
        guven_emoji = {10: "ğŸ’", 9: "ğŸ”¥", 8: "ğŸ’ª", 7: "âš–ï¸", 6: "âš ï¸", 5: "â“"}.get(guven_sayi, "âš–ï¸")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ANALÄ°Z YORUMU - BANKOYA UYGUN
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        gol_yorum = ""
        toplam_gol_beklenti = safe_float(gol_ort_ev) + safe_float(gol_ort_dep)
        xg_toplam_f = safe_float(xg_toplam)
        
        # Bankoya gÃ¶re yorum oluÅŸtur
        banko_upper = banko.upper() if banko else ""
        
        if "3.5" in banko_upper and "ÃœST" in banko_upper:
            gol_yorum = f"xG {xg_toplam} ve gol ortalamasÄ± {toplam_gol_beklenti:.1f} ile 4+ gol potansiyeli gÃ¼Ã§lÃ¼. 3.5 ÃœST destekleniyor."
        elif "2.5" in banko_upper and "ÃœST" in banko_upper:
            gol_yorum = f"xG {xg_toplam} ve gol gÃ¼Ã§leri %{ev_gol}/%{dep_gol} ile 3+ gol beklentisi yÃ¼ksek. 2.5 ÃœST Ã¶nerilir."
        elif "1.5" in banko_upper and "ÃœST" in banko_upper:
            gol_yorum = f"Her iki takÄ±mÄ±n gol Ã¼retimi %{ms_15} istatistiÄŸiyle 2+ gol neredeyse kesin. 1.5 ÃœST gÃ¼venli."
        elif "0.5" in banko_upper and "ÃœST" in banko_upper:
            gol_yorum = f"Gol Ã§Ä±kmasÄ± %{ms_05} oranÄ±yla bekleniyor. En gÃ¼venli bahis seÃ§eneÄŸi."
        elif "KG" in banko_upper and "VAR" in banko_upper:
            gol_yorum = f"Her iki takÄ±m da gol buluyor. KG VAR %{kg_var} ile destekleniyor."
        elif "KG" in banko_upper and "YOK" in banko_upper:
            gol_yorum = f"Taraflardan en az biri gol atamayacak. Defansif maÃ§ bekleniyor."
        elif "ALT" in banko_upper:
            gol_yorum = f"DÃ¼ÅŸÃ¼k gol beklentisi. ALT bahisleri deÄŸerli gÃ¶rÃ¼nÃ¼yor."
        else:
            gol_yorum = f"Veriler {banko} bahsini destekliyor. GÃ¼ven puanÄ± {guven_sayi}/10."
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # MESAJ OLUÅTUR - YENÄ° FORMAT
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        msg = f"""âš½ï¸ {ev_takimi.upper()} VS {dep_takimi.upper()}
ğŸ“… {tarih} | ğŸ† {lig}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š *TEMEL Ä°STATÄ°STÄ°KLER*
â€¢ MS 0.5 ÃœST : %{ms_05} {get_ikon(ms_05, 90, 80)}
â€¢ MS 1.5 ÃœST : %{ms_15} {get_ikon(ms_15, 80, 65)}
â€¢ MS 2.5 ÃœST : %{ms_25} {get_ikon(ms_25, 60, 50)}
â€¢ MS 3.5 ÃœST : %{ms_35} {get_ikon(ms_35, 45, 35)}
â€¢ KG VAR     : %{kg_var} {get_ikon(kg_var, 70, 55)}
â€¢ Ä°Y 0.5 ÃœST : %{iy_ort:.0f} {get_ikon(iy_ort, 70, 55)}

â€¢ Ev Gol GÃ¼cÃ¼ : %{ev_gol} {get_ikon(ev_gol, 80, 65)}
â€¢ Dep Gol GÃ¼cÃ¼: %{dep_gol} {get_ikon(dep_gol, 80, 65)}

ğŸ“ˆ *Ä°LERÄ° SEVÄ°YE VERÄ°LER*
â€¢ xG: {xg_ev} + {xg_dep} = *{xg_toplam}*
â€¢ Ev Atan: {gol_ort_ev} gol/maÃ§
â€¢ Dep Atan: {gol_ort_dep} gol/maÃ§"""

        if seri_ev or seri_dep:
            msg += f"""
â€¢ Ev Seri: {seri_ev if seri_ev else '-'}
â€¢ Dep Seri: {seri_dep if seri_dep else '-'}"""

        msg += f"""

â­ï¸ *EN KRÄ°TÄ°K 3 VERÄ°*
1ï¸âƒ£ {kritik_veriler[0]['baslik']}
   â””â”€ {kritik_veriler[0]['aciklama']}

2ï¸âƒ£ {kritik_veriler[1]['baslik']}
   â””â”€ {kritik_veriler[1]['aciklama']}

3ï¸âƒ£ {kritik_veriler[2]['baslik']}
   â””â”€ {kritik_veriler[2]['aciklama']}

ğŸ§  *GOL Ã–NGÃ–RÃœSÃœ*
Ev sahibi maÃ§ baÅŸÄ±na *{gol_ort_ev}* atÄ±p *{gol_yeme_ev}* yiyor.
Deplasman ekibi *{gol_ort_dep}* atÄ±p *{gol_yeme_dep}* yiyor.

ğŸ“ _Analiz Yorumu:_
{gol_yorum}

ğŸ’° *NÄ°HAÄ° MATEMATÄ°KSEL TAHMÄ°N*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¯ *BANKO:* {banko}
ğŸ“Š GÃ¼ven: *{guven_sayi}/10* {guven_emoji}
ğŸ’° Kasa : *%{kasa}*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“± _90 DAKÄ°KA ANALÄ°Z_"""
        
        # KANAL SEÃ‡Ä°CÄ° Ä°LE GÃ–NDER
        self.kanal_sec_ve_gonder(msg, "Ã–zet GÃ¶nder")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # DASHBOARD FONKSÄ°YONLARI
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def dashboard_guncelle(self):
        stats = self.performance.get_stats()
        
        self.lbl_toplam.config(text=f"ğŸ“Š Toplam: {stats['toplam']}")
        self.lbl_kazanan.config(text=f"âœ… Kazanan: {stats['kazanan']}")
        self.lbl_kaybeden.config(text=f"âŒ Kaybeden: {stats['kaybeden']}")
        self.lbl_basari.config(text=f"ğŸ“ˆ BaÅŸarÄ±: %{stats['basari']}")
        
        self.txt_dashboard.delete(1.0, tk.END)
        
        # GÃ¼nlÃ¼k stats
        self.txt_dashboard.insert(tk.END, "ğŸ“… GÃœNLÃœK PERFORMANS\n")
        self.txt_dashboard.insert(tk.END, "="*50 + "\n\n")
        
        gunluk = self.performance.get_daily_stats()
        for tarih, data in sorted(gunluk.items(), reverse=True)[:10]:
            toplam = data["kazanan"] + data["kaybeden"]
            basari = round(data["kazanan"] / toplam * 100, 1) if toplam > 0 else 0
            self.txt_dashboard.insert(tk.END, f"ğŸ“† {tarih}: {data['kazanan']}/{toplam} (%{basari})\n")
        
        # Lig stats
        self.txt_dashboard.insert(tk.END, "\n\nğŸ† LÄ°G PERFORMANSI\n")
        self.txt_dashboard.insert(tk.END, "="*50 + "\n\n")
        
        lig_stats = self.performance.get_league_stats()
        for lig, data in list(lig_stats.items())[:10]:
            emoji = "âœ…" if data["basari"] >= 60 else "âš ï¸" if data["basari"] >= 50 else "âŒ"
            self.txt_dashboard.insert(tk.END, f"{emoji} {lig}: {data['kazanan']}/{data['toplam']} (%{data['basari']})\n")
        
        # Bahis tÃ¼rÃ¼ stats
        self.txt_dashboard.insert(tk.END, "\n\nğŸ¯ BAHÄ°S TÃœRÃœ PERFORMANSI\n")
        self.txt_dashboard.insert(tk.END, "="*50 + "\n\n")
        
        tur_stats = self.performance.get_by_type()
        for tur, data in list(tur_stats.items())[:10]:
            emoji = "âœ…" if data["basari"] >= 60 else "âš ï¸" if data["basari"] >= 50 else "âŒ"
            self.txt_dashboard.insert(tk.END, f"{emoji} {tur}: {data['kazanan']}/{data['toplam']} (%{data['basari']})\n")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # KARÅILAÅTIR FONKSÄ°YONU
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def maclari_karsilastir(self):
        """Ä°ki maÃ§Ä± karÅŸÄ±laÅŸtÄ±r - PRO versiyon"""
        # PRO arayÃ¼zde combo_kars1 ve combo_kars2 var
        if not hasattr(self, 'combo_kars1') or not hasattr(self, 'combo_kars2'):
            # Eski versiyon - tree_kars kullan
            if hasattr(self, 'entry_kars_tarih') and hasattr(self, 'tree_kars'):
                tarih = self.entry_kars_tarih.get().strip()
                maclar = [m for m in self.mac_db if m.get("tarih") == tarih]
                
                for item in self.tree_kars.get_children():
                    self.tree_kars.delete(item)
                
                puanli_maclar = []
                for mac in maclar:
                    veriler = {
                        "xg": mac.get("xg", 0),
                        "ev_atan": mac.get("ev_atan", 0),
                        "dep_atan": mac.get("dep_atan", 0),
                        "ev_yiyen": mac.get("ev_yiyen", 0),
                        "dep_yiyen": mac.get("dep_yiyen", 0),
                        "guven": mac.get("guven", 5),
                        "ust_25": mac.get("ust_25", 0),
                        "lig": mac.get("lig", "")
                    }
                    scorer = MatchScorer(veriler)
                    sonuc = scorer.calculate_score()
                    mac["_puan"] = sonuc["toplam"]
                    puanli_maclar.append(mac)
                
                puanli_maclar.sort(key=lambda x: x.get("_puan", 0), reverse=True)
                
                for mac in puanli_maclar:
                    self.tree_kars.insert("", "end", values=(
                        mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")[:30],
                        mac.get("banko", "?"),
                        mac.get("sigorta", "?"),
                        mac.get("guven", "?"),
                        mac.get("_puan", 0),
                        mac.get("lig", "?")[:20]
                    ))
            return
        
        # PRO versiyon - iki maÃ§Ä± karÅŸÄ±laÅŸtÄ±r
        mac1_str = self.combo_kars1.get()
        mac2_str = self.combo_kars2.get()
        
        if not mac1_str or not mac2_str:
            messagebox.showwarning("UyarÄ±", "Ä°ki maÃ§ seÃ§in!")
            return
        
        mac1_data = None
        mac2_data = None
        
        for m in self.mac_db:
            mac_str = f"{m.get('tarih', '')} - {m.get('mac', m.get('mac_adi', ''))}"
            if mac1_str in mac_str or mac_str in mac1_str:
                mac1_data = m
            if mac2_str in mac_str or mac_str in mac2_str:
                mac2_data = m
        
        if not mac1_data or not mac2_data:
            messagebox.showwarning("UyarÄ±", "MaÃ§lar bulunamadÄ±!")
            return
        
        # KarÅŸÄ±laÅŸtÄ±rma metni - FIX #23: DETAYLI
        txt = "â•" * 70 + "\n"
        txt += "                    ğŸ“Š DETAYLI MAÃ‡ KARÅILAÅTIRMA\n"
        txt += "â•" * 70 + "\n\n"
        
        for i, (label, mac) in enumerate([(mac1_str, mac1_data), (mac2_str, mac2_data)], 1):
            txt += f"{'â”€' * 70}\n"
            txt += f"ğŸ“Œ MAÃ‡ {i}: {mac.get('mac', mac.get('mac_adi', '?'))}\n"
            txt += f"{'â”€' * 70}\n"
            txt += f"   ğŸ“… Tarih: {mac.get('tarih', '?')}\n"
            txt += f"   ğŸ† Lig: {mac.get('lig', '?')}\n"
            txt += f"\n   ğŸ¯ TAHMÄ°N BÄ°LGÄ°LERÄ°:\n"
            txt += f"      â€¢ Banko: {mac.get('banko', '?')}\n"
            txt += f"      â€¢ Sigorta: {mac.get('sigorta', '?')}\n"
            txt += f"      â€¢ GÃ¼ven: {mac.get('guven', '?')}/10\n"
            txt += f"      â€¢ Kasa: %{mac.get('kasa', '?')}\n"
            txt += f"\n   ğŸ“Š Ä°STATÄ°STÄ°KLER:\n"
            txt += f"      â€¢ xG Toplam: {mac.get('xg', mac.get('xg_toplam', '?'))}\n"
            txt += f"      â€¢ MS 2.5Ãœ: %{mac.get('ms_25', mac.get('ust_25', '?'))}\n"
            txt += f"      â€¢ KG VAR: %{mac.get('kg_var', '?')}\n"
            txt += f"      â€¢ Ev Gol Atma: %{mac.get('ev_atan', '?')}\n"
            txt += f"      â€¢ Dep Gol Atma: %{mac.get('dep_atan', '?')}\n"
            txt += f"      â€¢ Ev Gol Yeme: %{mac.get('ev_yiyen', '?')}\n"
            txt += f"      â€¢ Dep Gol Yeme: %{mac.get('dep_yiyen', '?')}\n"
            txt += f"\n   ğŸ“ˆ SONUÃ‡:\n"
            txt += f"      â€¢ Skor: {mac.get('skor', mac.get('gercek_skor', 'Bekleniyor'))}\n"
            txt += f"      â€¢ SonuÃ§: {mac.get('sonuc', 'BEKLÄ°YOR')}\n"
            txt += "\n"
        
        # KarÅŸÄ±laÅŸtÄ±rma Ã¶zeti
        txt += "â•" * 70 + "\n"
        txt += "                    âš–ï¸ KARÅILAÅTIRMA Ã–ZETÄ°\n"
        txt += "â•" * 70 + "\n\n"
        
        def get_num(mac, key):
            val = mac.get(key, 0)
            if isinstance(val, str):
                val = val.replace("%", "").strip()
                try: return float(val)
                except: return 0
            return float(val) if val else 0
        
        xg1 = get_num(mac1_data, "xg") or get_num(mac1_data, "xg_toplam")
        xg2 = get_num(mac2_data, "xg") or get_num(mac2_data, "xg_toplam")
        guven1 = get_num(mac1_data, "guven")
        guven2 = get_num(mac2_data, "guven")
        
        txt += f"   ğŸ“Š xG KarÅŸÄ±laÅŸtÄ±rma:\n"
        txt += f"      MaÃ§ 1: {xg1} vs MaÃ§ 2: {xg2}\n"
        txt += f"      {'âœ… MaÃ§ 1 daha yÃ¼ksek xG' if xg1 > xg2 else ('âœ… MaÃ§ 2 daha yÃ¼ksek xG' if xg2 > xg1 else 'âš–ï¸ EÅŸit')}\n\n"
        
        txt += f"   ğŸ¯ GÃ¼ven KarÅŸÄ±laÅŸtÄ±rma:\n"
        txt += f"      MaÃ§ 1: {guven1}/10 vs MaÃ§ 2: {guven2}/10\n"
        txt += f"      {'âœ… MaÃ§ 1 daha gÃ¼venli' if guven1 > guven2 else ('âœ… MaÃ§ 2 daha gÃ¼venli' if guven2 > guven1 else 'âš–ï¸ EÅŸit')}\n\n"
        
        txt += "â•" * 70 + "\n"
        
        if hasattr(self, 'txt_karsilastir'):
            self.txt_karsilastir.delete(1.0, tk.END)
            self.txt_karsilastir.insert(tk.END, txt)
        
        if puanli_maclar:
            en_iyi = puanli_maclar[0]
            self.lbl_kars.config(text=f"ğŸ† EN Ä°YÄ°: {en_iyi.get('mac', '?').replace('_', ' ')} ({en_iyi.get('_puan', 0)} puan)")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # Ã–ÄRENME FONKSÄ°YONU
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def ogrenme_analiz(self):
        self.txt_ogrenme.delete(1.0, tk.END)
        self.txt_ogrenme.insert(tk.END, "ğŸ§  Ã–ÄRENEN SÄ°STEM ANALÄ°ZÄ°\n")
        self.txt_ogrenme.insert(tk.END, "="*50 + "\n\n")
        
        oneriler = self.learning.analyze(self.performance)
        
        if not oneriler:
            self.txt_ogrenme.insert(tk.END, "âœ… Åu an iÃ§in Ã¶neri yok. Sistem iyi Ã§alÄ±ÅŸÄ±yor!\n")
            self.txt_ogrenme.insert(tk.END, "\nğŸ’¡ Daha fazla maÃ§ analiz ettikÃ§e sistem Ã¶ÄŸrenecek.\n")
        else:
            for oneri in oneriler:
                tip = oneri["tip"]
                konu = oneri["konu"]
                basari = oneri["basari"]
                aciklama = oneri["oneri"]
                
                emoji = "ğŸ”´" if basari < 45 else "ğŸŸ¡" if basari < 55 else "ğŸŸ¢"
                
                self.txt_ogrenme.insert(tk.END, f"{emoji} [{tip}] {konu}\n")
                self.txt_ogrenme.insert(tk.END, f"   ğŸ“Š BaÅŸarÄ±: %{basari}\n")
                self.txt_ogrenme.insert(tk.END, f"   ğŸ’¡ {aciklama}\n\n")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SOSYAL MEDYA (HATA 6 - 3 GEREKÃ‡E)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def sosyal_maclari_yukle(self):
        """TÃ¼m maÃ§larÄ± tarihe gÃ¶re sÄ±ralayarak yÃ¼kle"""
        # V70 FIX: TÃ¼m maÃ§larÄ± tarihe gÃ¶re listele
        maclar = []
        
        # 1. Ã–nce mac_db'den tÃ¼m maÃ§larÄ± al
        if self.mac_db:
            for mac in self.mac_db:
                mac_adi = mac.get("mac", mac.get("mac_adi", ""))
                tarih = mac.get("tarih", "")
                if mac_adi:
                    # Tarih + MaÃ§ adÄ± formatÄ±nda kaydet (sÄ±ralama iÃ§in)
                    display_name = mac_adi.replace("_", " ")
                    if tarih:
                        maclar.append((tarih, display_name, f"[{tarih}] {display_name}"))
                    else:
                        maclar.append(("9999", display_name, display_name))
        
        # 2. mac_arsivi'den de ekle (duplicate kontrolÃ¼ ile)
        if hasattr(self, 'mac_arsivi') and self.mac_arsivi:
            existing_names = [m[1] for m in maclar]
            for mac_key, mac_data in self.mac_arsivi.items():
                mac_adi = mac_data.get("mac", mac_data.get("mac_adi", ""))
                tarih = mac_data.get("tarih", "")
                if mac_adi:
                    display_name = mac_adi.replace("_", " ")
                    if display_name not in existing_names:
                        if tarih:
                            maclar.append((tarih, display_name, f"[{tarih}] {display_name}"))
                        else:
                            maclar.append(("9999", display_name, display_name))
        
        # 3. Tarihe gÃ¶re sÄ±rala (yeniden eskiye)
        maclar.sort(key=lambda x: x[0], reverse=True)
        
        # 4. ComboBox'a ekle
        mac_listesi = [m[2] for m in maclar]
        self.combo_sosyal_mac["values"] = mac_listesi
        if mac_listesi:
            self.combo_sosyal_mac.set(mac_listesi[0])
        print(f"ğŸ“‹ Sosyal maÃ§ listesi: {len(mac_listesi)} maÃ§ yÃ¼klendi (tarihe gÃ¶re sÄ±ralÄ±)")
    
    def sosyal_analiz_cek(self):
        """V70: ANALÄ°ZDEN TÃœM VERÄ°LERÄ° Ã‡EK - FÄ°L HAFIZASINDAN"""
        mac_adi_raw = self.combo_sosyal_mac.get()
        
        # V70 FIX: [tarih] prefix'ini Ã§Ä±kar
        if mac_adi_raw.startswith("["):
            # [19.12.2025] FK Vojvodina vs OFK Belgrade formatÄ±
            import re
            match = re.match(r'\[.*?\]\s*(.*)', mac_adi_raw)
            if match:
                mac_adi = match.group(1).strip()
            else:
                mac_adi = mac_adi_raw
        else:
            mac_adi = mac_adi_raw
        
        mac_key = mac_adi.replace(" ", "_").replace("-", "_").lower()
        
        veri_data = {}
        
        # V70: Ã–nce FÄ°L HAFIZASINDAN ara
        if hasattr(self, 'mac_arsivi') and mac_key in self.mac_arsivi:
            mac_data = self.mac_arsivi[mac_key]
            for key, val in mac_data.items():
                veri_data[key] = str(val).replace("%", "") if val else ""
            print(f"ğŸ˜ Sosyal veri FÄ°L HAFIZASINDAN Ã§ekildi: {mac_adi}")
        
        # AÅAMA 1: last_result'tan VERI bloÄŸunu Ã§ek (tamamlayÄ±cÄ±)
        if self.last_result:
            veri_match = re.search(r'\|\|VERI_BASLANGIC\|\|(.*?)\|\|VERI_BITIS\|\|', self.last_result, re.DOTALL)
            if veri_match:
                for line in veri_match.group(1).strip().split('\n'):
                    if '=' in line:
                        key, val = line.split('=', 1)
                        if key.strip() not in veri_data or not veri_data.get(key.strip()):
                            veri_data[key.strip()] = val.strip().replace("%", "")
        
        # AÅAMA 2: mac_db'den tamamla (eksik varsa)
        mac_normalized = mac_adi.replace(" ", "_")
        for mac in self.mac_db:
            mac_name = mac.get("mac", mac.get("mac_adi", "")).replace(" ", "_")
            if mac_name == mac_normalized or mac_name.lower() == mac_normalized.lower():
                # mac_db'deki tÃ¼m verileri al, ama VERI bloÄŸundakileri Ã¼zerine yazma
                for key, val in mac.items():
                    if key not in veri_data or not veri_data.get(key):
                        veri_data[key] = str(val).replace("%", "")
                break
        
        # AÅAMA 3: Kontrol - Kritik veriler var mÄ±?
        if not veri_data:
            if hasattr(self, 'lbl_status'):
                self.lbl_status.config(text="âŒ MaÃ§ bulunamadÄ±", fg=ModernTheme.ACCENT_DANGER)
            messagebox.showwarning("UyarÄ±", f"MaÃ§ veritabanÄ±nda bulunamadÄ±: {mac_adi}")
            return
        
        # TakÄ±m adÄ±
        if hasattr(self, 'sosyal_takim'):
            self.sosyal_takim.delete(0, tk.END)
            self.sosyal_takim.insert(0, veri_data.get("mac_adi", veri_data.get("mac", mac_adi.replace("_", " "))))
        
        # Tahmin - Combobox ise set, Entry ise delete/insert
        if hasattr(self, 'sosyal_tahmin'):
            tahmin_val = veri_data.get("banko", "MS 1.5 ÃœST")
            if isinstance(self.sosyal_tahmin, ttk.Combobox):
                self.sosyal_tahmin.set(tahmin_val)
            else:
                self.sosyal_tahmin.delete(0, tk.END)
                self.sosyal_tahmin.insert(0, tahmin_val)
        
        # TÃ¼m verileri kaydet
        self.sosyal_veri = veri_data
        
        # Debug: Hangi veriler Ã§ekildi?
        cekilen = len([k for k, v in veri_data.items() if v and v != "?" and v != "0"])
        if hasattr(self, 'lbl_status'):
            self.lbl_status.config(text=f"âœ… {cekilen} veri Ã§ekildi!", fg=ModernTheme.ACCENT_SUCCESS)
    
    def sosyal_prompt_olustur(self):
        """ğŸ“£ SOSYAL MEDYA PROMPT - V70 CANLI SENARYO MODLU"""
        # TakÄ±m ve tahmin al
        takim = ""
        tahmin = ""
        
        if hasattr(self, 'sosyal_takim'):
            takim = self.sosyal_takim.get().strip()
        if hasattr(self, 'sosyal_tahmin'):
            tahmin = self.sosyal_tahmin.get().strip()
        
        # EÄŸer boÅŸsa mac_db'den son analizi al
        if not takim and self.mac_db:
            son_mac = self.mac_db[-1]
            takim = son_mac.get("mac", son_mac.get("mac_adi", "TAKIM A VS TAKIM B"))
            tahmin = son_mac.get("banko", "2.5 ÃœST")
            self.sosyal_veri = son_mac
        
        if not takim:
            messagebox.showwarning("UyarÄ±", "Ã–nce ANALÄ°Z Ã‡EK butonuna tÄ±klayÄ±n!")
            return
        
        if not tahmin:
            tahmin = "2.5 ÃœST"
        
        # Verileri al
        v = getattr(self, 'sosyal_veri', {})
        if not v and self.mac_db:
            v = self.mac_db[-1]
        
        # Ä°statistikleri Ã§ek
        def safe_get(key, default="0"):
            val = v.get(key, default)
            return str(val).replace("%", "") if val else default
        
        ev_atan = safe_get("ev_atan", "75")
        dep_atan = safe_get("dep_atan", "70")
        ev_yiyen = safe_get("ev_yiyen", "60")
        dep_yiyen = safe_get("dep_yiyen", "55")
        xg_toplam = safe_get("xg", safe_get("xg_toplam", "2.8"))
        xg_ev = safe_get("xg_ev", "1.5")
        xg_dep = safe_get("xg_dep", "1.3")
        lig_gol_ort = safe_get("lig_gol_ort", "2.5")
        guven = safe_get("guven", "8")
        lig = v.get("lig", "Bilinmiyor")
        ev_gol_ort = safe_get("ev_gol_ort", "1.8")
        dep_gol_ort = safe_get("dep_gol_ort", "1.2")
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # V70 YENÄ°: CANLI SENARYO KONTROLÃœ - HATA 7
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        canli_mod = False
        canli_dakika = ""
        canli_uyari = ""
        
        if hasattr(self, 'combo_canli_senaryo'):
            senaryo = self.combo_canli_senaryo.get()
            if "CanlÄ±" in senaryo:
                canli_mod = True
                
                # Tahmini 0.5 ÃœST'e Ã§ek
                orijinal_tahmin = tahmin
                tahmin = "0.5 ÃœST"
                
                # GÃ¼veni yÃ¼kselt
                try:
                    guven_int_orig = int(str(guven).replace("/10", "").strip())
                except:
                    guven_int_orig = 8
                
                # Boost mantÄ±ÄŸÄ±
                if guven_int_orig >= 8:
                    guven = "10"  # MAX
                elif guven_int_orig >= 7:
                    guven = "9"
                else:
                    guven = str(guven_int_orig + 2)
                
                # Dakika bilgisi
                if "45-60" in senaryo:
                    canli_dakika = "45-60 ArasÄ±"
                    canli_uyari = f"""
ğŸš¨ CANLI UYARI: MaÃ§ta Gol Beklentisi Artarak Devam Ediyor!

ğŸ“Œ Orijinal Tahmin: {orijinal_tahmin}
ğŸ“Œ CanlÄ± DÃ¼ÅŸÃ¼ÅŸ: 0.5 ÃœST (1 Gol Ã‡Ä±kar)
ğŸ“Œ Dakika ilerledi, risk azaldÄ±. Kasa korumak iÃ§in 0.5 ÃœST ideal.
ğŸ“Œ GÃ¼ven BOOST: {guven_int_orig}/10 â†’ {guven}/10 (CanlÄ± bonusu)
"""
                elif "70-80" in senaryo:
                    canli_dakika = "70-80 ArasÄ± (Son FÄ±rsat)"
                    canli_uyari = f"""
ğŸš¨ CANLI SON FIRSAT: MaÃ§ Bitiyor, Gol Beklentisi Kritik!

ğŸ“Œ Orijinal Tahmin: {orijinal_tahmin}
ğŸ“Œ CanlÄ± DÃ¼ÅŸÃ¼ÅŸ: 0.5 ÃœST (Son 20dk iÃ§in ideal)
ğŸ“Œ Dakika 70+, takÄ±mlar aÃ§Ä±lÄ±yor. Åut sayÄ±larÄ± artÄ±yor.
ğŸ“Œ GÃ¼ven MAX: {guven}/10 (Son dakika avantajÄ±)
"""
        
        # TakÄ±m adlarÄ±nÄ± ayÄ±r
        takim_upper = takim.upper()
        if " VS " in takim_upper:
            takim_parts = takim.split(" VS " if " VS " in takim else " vs ")
        elif " - " in takim:
            takim_parts = takim.split(" - ")
        else:
            takim_parts = [takim, "Rakip"]
        
        ev_takim = takim_parts[0].strip() if len(takim_parts) > 0 else "Ev"
        dep_takim = takim_parts[1].strip() if len(takim_parts) > 1 else "Deplasman"
        
        # GÃ¼ven hesapla
        try:
            guven_int = int(str(guven).replace("/10", "").strip())
        except:
            guven_int = 8
        guven_bar = "ğŸŸ¢" * guven_int + "âš«" * (10 - guven_int)
        
        # Kasa yÃ¶netimi
        if guven_int >= 10:
            kasa_oran, kasa_seviye = "%25", "ğŸ’ KUSURSUZ - ELÄ°T"
        elif guven_int >= 9:
            kasa_oran, kasa_seviye = "%20", "ğŸ”¥ Ã‡OK GÃœÃ‡LÃœ"
        elif guven_int >= 8:
            kasa_oran, kasa_seviye = "%15", "ğŸ’ª GÃœÃ‡LÃœ"
        elif guven_int >= 7:
            kasa_oran, kasa_seviye = "%10", "âš–ï¸ STANDART"
        elif guven_int >= 6:
            kasa_oran, kasa_seviye = "%8", "âš ï¸ DÄ°KKATLÄ°"
        else:
            kasa_oran, kasa_seviye = "%5", "ğŸ² RÄ°SKLÄ°"
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BAHÄ°S TÄ°PÄ°NE GÃ–RE 3 GEREKÃ‡E OLUÅTUR
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        tahmin_upper = tahmin.upper()
        
        # ğŸ“‚ BÃ–LÃœM 1: GOL BAHÄ°SLERÄ° (ÃœST)
        if "ÃœST" in tahmin_upper and "ALT" not in tahmin_upper and "Ä°Y" not in tahmin_upper:
            # 0.5, 1.5, 2.5, 3.5, 4.5, 5.5 ÃœST
            if "3.5" in tahmin or "4.5" in tahmin or "5.5" in tahmin:
                # YÃ¼ksek gol beklentisi - heyecanlÄ± ton
                gerekce_1 = f"1ï¸âƒ£ *HÃœCUM GÃœCÃœ VE GOL DÃœELLOSU:*\nÄ°ki takÄ±mÄ±n da ofansif verileri bu bahsi gÃ¼Ã§lÃ¼ bir ÅŸekilde destekliyor. {ev_takim}'Ä±n maÃ§ baÅŸÄ±na {ev_gol_ort} gol ortalamasÄ± ve {dep_takim}'Ä±n skora katkÄ± oranÄ± gÃ¶z Ã¶nÃ¼ne alÄ±ndÄ±ÄŸÄ±nda, filelerin defalarca havalanmasÄ± kaÃ§Ä±nÄ±lmaz. Ã–zellikle son maÃ§lardaki form grafiÄŸi gol dÃ¼ellosunun habercisi!"
                
                gerekce_2 = f"2ï¸âƒ£ *xG ANALÄ°ZÄ° VE TEMPO:*\nVeri tabanÄ±mÄ±zdaki xG analizi maÃ§Ä±n temposunun Ã§ok yÃ¼ksek olacaÄŸÄ±nÄ± gÃ¶steriyor. Toplam xG deÄŸerinin *{xg_toplam}* seviyesinde olmasÄ±, iki takÄ±mÄ±n da ceza sahasÄ±na girmekte zorlanmadÄ±ÄŸÄ±nÄ± kanÄ±tlÄ±yor. Ligin {lig_gol_ort} olan gol ortalamasÄ±nÄ±n Ã§ok Ã¼zerindeler!"
                
                gerekce_3 = f"3ï¸âƒ£ *KIRILGAN SAVUNMALAR:*\nSadece atÄ±lan goller deÄŸil, yenen goller de bu tercihi parlatÄ±yor. Ev sahibi *%{ev_yiyen}* oranÄ±nda gol yerken, deplasman *%{dep_yiyen}* oranÄ±nda kalesini gole aÃ§Ä±yor. Savunma arkasÄ±na atÄ±lan toplardaki zafiyetler, maÃ§Ä±n bol gollÃ¼ geÃ§eceÄŸinin habercisi!"
            else:
                # Normal gol beklentisi (0.5, 1.5, 2.5 ÃœST)
                gerekce_1 = f"1ï¸âƒ£ *Ä°STATÄ°STÄ°KSEL HÃœCUM GÃœCÃœ:*\nÄ°ki takÄ±mÄ±n ofansif verileri incelendiÄŸinde, kÄ±sÄ±r bir maÃ§ ihtimali masada yok. {ev_takim}'Ä±n *%{ev_atan}* gol atma oranÄ± ve {dep_takim}'Ä±n *%{dep_atan}* skora katkÄ±sÄ±, bu barajÄ±n aÅŸÄ±lmasÄ± iÃ§in gereken matematiksel zemini oluÅŸturuyor."
                
                gerekce_2 = f"2ï¸âƒ£ *xG (GOL BEKLENTÄ°SÄ°) ANALÄ°ZÄ°:*\nVeri tabanÄ±ndaki xG analizleri, maÃ§Ä±n rÃ¶lantide geÃ§meyeceÄŸini kanÄ±tlÄ±yor. Toplam Gol Beklentisinin *{xg_toplam}* seviyelerinde olmasÄ±, ceza sahasÄ± aksiyonlarÄ±nÄ±n bolluÄŸuna iÅŸaret ediyor. Lig ortalamasÄ±: {lig_gol_ort}"
                
                gerekce_3 = f"3ï¸âƒ£ *SAVUNMA ZAAFÄ°YETLERÄ°:*\nGol bahsini asÄ±l gÃ¼Ã§lendiren faktÃ¶r, takÄ±mlarÄ±n savunma disiplininden uzak olmasÄ±. Ev sahibi *%{ev_yiyen}*, deplasman *%{dep_yiyen}* oranÄ±nda gol yiyor. Bireysel hatalara aÃ§Ä±k savunma kurgularÄ±, forvetlerin iÅŸini kolaylaÅŸtÄ±racaktÄ±r."
        
        # ğŸ“‚ BÃ–LÃœM 2: GOL BAHÄ°SLERÄ° (ALT)
        elif "ALT" in tahmin_upper:
            gerekce_1 = f"1ï¸âƒ£ *SAVUNMA DÄ°SÄ°PLÄ°NÄ° VE KATI OYUN:*\nBu karÅŸÄ±laÅŸmada Ã¶ncelik gol atmak deÄŸil, gol yememek olacak. Ä°ki teknik adamÄ±n da kontrollÃ¼ oyun anlayÄ±ÅŸÄ± ve takÄ±m savunmasÄ±na verdikleri Ã¶nem, maÃ§Ä±n kilidinin aÃ§Ä±lmasÄ±nÄ± zorlaÅŸtÄ±rÄ±yor. Erken bir gol sesi beklemiyoruz."
            
            gerekce_2 = f"2ï¸âƒ£ *DÃœÅÃœK GOL BEKLENTÄ°SÄ° (xG):*\nÄ°statistikler bu maÃ§Ä±n bir satranÃ§ mÃ¼cadelesi ÅŸeklinde geÃ§eceÄŸini gÃ¶steriyor. Ligin ortalamasÄ± *{lig_gol_ort}* gol seviyesinde. Ã–zellikle orta saha mÃ¼cadelesi ÅŸeklinde geÃ§ecek bu maÃ§ta, Ã¼retkenlik sorunu skora doÄŸrudan yansÄ±yacaktÄ±r."
            
            gerekce_3 = f"3ï¸âƒ£ *HÃœCUM KISIRLIÄI:*\nHÃ¼cum hattÄ±ndaki verimsizlik istatistiklere net yansÄ±mÄ±ÅŸ durumda. Her iki takÄ±mÄ±n da son maÃ§lardaki gol Ã¼retimi dÃ¼ÅŸÃ¼k. YaratÄ±cÄ± oyuncu eksikliÄŸi ve rakibin katÄ± savunma bloÄŸu, maÃ§Ä±n 'Under' (Alt) senaryosunda bitmesi iÃ§in en bÃ¼yÃ¼k gerekÃ§e."
        
        # ğŸ“‚ BÃ–LÃœM 3: TARAF BAHÄ°SLERÄ° (MS 1)
        elif "MS 1" in tahmin_upper or "MS1" in tahmin_upper:
            gerekce_1 = f"1ï¸âƒ£ *EV SAHÄ°BÄ° PERFORMANSI:*\n{ev_takim}, bu ligin en istikrarlÄ± ev sahibi takÄ±mlarÄ±ndan biri. Evinde oynadÄ±ÄŸÄ± maÃ§larda *%{ev_atan}* oranÄ±nda gol atmasÄ±, rakibine karÅŸÄ± kuracaÄŸÄ± baskÄ±yÄ± kÄ±rma ihtimalinin Ã§ok dÃ¼ÅŸÃ¼k olduÄŸunu gÃ¶steriyor."
            
            gerekce_2 = f"2ï¸âƒ£ *KADRO KALÄ°TESÄ° VE MOTÄ°VASYON:*\nKadro derinliÄŸi ve kalitesi, maÃ§Ä±n kaderini belirleyecek ana unsur. Kritik anlarda sahneye Ã§Ä±kacak yÄ±ldÄ±z oyunculara sahipler. {dep_takim}'Ä±n son haftalardaki dÃ¼ÅŸÃ¼ÅŸÃ¼ ve motivasyon kaybÄ±, favorinin iÅŸini oldukÃ§a kolaylaÅŸtÄ±racaktÄ±r."
            
            gerekce_3 = f"3ï¸âƒ£ *TARÄ°HSEL VE GÃœNCEL FORM:*\nSadece kÃ¢ÄŸÄ±t Ã¼zerinde deÄŸil, sahada da formda olan taraf {ev_takim}. xG verileri de bunu destekliyor: Ev xG *{xg_ev}* vs Dep xG *{xg_dep}*. Rakip savunma zaafiyetleri ile boÄŸuÅŸuyor."
        
        # ğŸ“‚ BÃ–LÃœM 3: TARAF BAHÄ°SLERÄ° (MS 2)
        elif "MS 2" in tahmin_upper or "MS2" in tahmin_upper:
            gerekce_1 = f"1ï¸âƒ£ *DEPLASMAN PERFORMANSI:*\n{dep_takim}, bu ligin en tehlikeli deplasman takÄ±mlarÄ±ndan biri. DÄ±ÅŸarÄ±da oynadÄ±ÄŸÄ± maÃ§larda *%{dep_atan}* oranÄ±nda gol atmasÄ±, ev sahibinin savunmasÄ±nÄ± zorlayacaÄŸÄ±nÄ±n kanÄ±tÄ±."
            
            gerekce_2 = f"2ï¸âƒ£ *KADRO KALÄ°TESÄ° VE MOTÄ°VASYON:*\nKadro derinliÄŸi ve kalitesi farkÄ± net. {dep_takim}'Ä±n kritik anlarda sahneye Ã§Ä±kacak yÄ±ldÄ±z oyunculara sahip olmasÄ±, avantajÄ± daha da artÄ±rÄ±yor. {ev_takim}'Ä±n iÃ§ saha performansÄ±ndaki dÃ¼ÅŸÃ¼ÅŸ dikkat Ã§ekici."
            
            gerekce_3 = f"3ï¸âƒ£ *TARÄ°HSEL VE GÃœNCEL FORM:*\nSahada da formda olan taraf {dep_takim}. xG verileri: Dep xG *{xg_dep}* vs Ev xG *{xg_ev}*. Ev sahibinin savunma zaafiyetleri (*%{ev_yiyen}* gol yeme) galibiyeti getirecek anahtar detay."
        
        # ğŸ“‚ BÃ–LÃœM 4: BERABERLÄ°K (MS X)
        elif "MS X" in tahmin_upper or "MSX" in tahmin_upper or tahmin_upper == "X":
            gerekce_1 = f"1ï¸âƒ£ *GÃœÃ‡ DENGESÄ° VE ORTA SAHA SAVAÅI:*\nÄ°ki takÄ±mÄ±n da gÃ¼Ã§ dengeleri birbirine Ã§ok yakÄ±n. Sahadaki oyunun bÃ¼yÃ¼k bÃ¶lÃ¼mÃ¼nÃ¼n orta sahada kilitlenmesi ve taraflarÄ±n birbirine Ã¼stÃ¼nlÃ¼k kurmakta zorlanmasÄ± kuvvetle muhtemel. Ä°statistikler de beraberlik kokuyor."
            
            gerekce_2 = f"2ï¸âƒ£ *RÄ°SKTEN KAÃ‡INMA PSÄ°KOLOJÄ°SÄ°:*\nKaybetmenin iki takÄ±ma da bÃ¼yÃ¼k hasar vereceÄŸi bir maÃ§. Teknik direktÃ¶rlerin Ã¶nceliÄŸi 'Ã¶nce durdur, sonra vur' taktiÄŸi olacaÄŸÄ± iÃ§in, kontrollÃ¼ oyun skoru dengeye taÅŸÄ±yacaktÄ±r."
            
            gerekce_3 = f"3ï¸âƒ£ *Ä°STATÄ°STÄ°KSEL EÅÄ°TLÄ°K:*\nBu ligde beraberlik oranÄ± yÃ¼ksek iki takÄ±m karÅŸÄ±laÅŸÄ±yor. xG verileri de dengeyi gÃ¶steriyor: Ev xG *{xg_ev}* vs Dep xG *{xg_dep}*. MaÃ§Ä±n son dÃ¼dÃ¼ÄŸÃ¼nde puanlarÄ±n paylaÅŸÄ±lmasÄ± en mantÄ±klÄ± senaryo."
        
        # ğŸ“‚ BÃ–LÃœM 5: KG VAR
        elif "KG VAR" in tahmin_upper or "KGVAR" in tahmin_upper:
            gerekce_1 = f"1ï¸âƒ£ *HER Ä°KÄ° TAKIMIN GOL POTANSÄ°YELÄ°:*\n{ev_takim} *%{ev_atan}* oranÄ±nda gol atarken, {dep_takim} *%{dep_atan}* oranÄ±nda fileleri havalandÄ±rÄ±yor. Her iki takÄ±mÄ±n da '0' Ã§ekmesi bÃ¼yÃ¼k sÃ¼rpriz olur!"
            
            gerekce_2 = f"2ï¸âƒ£ *SAVUNMA HATALARI:*\nÄ°ki takÄ±m da gol atÄ±yor ancak savunmayÄ± unutuyorlar! Ev sahibi *%{ev_yiyen}*, deplasman *%{dep_yiyen}* oranÄ±nda gol yiyor. KarÅŸÄ±lÄ±klÄ± savunma zaafiyetleri KG VAR bahsini parlatÄ±yor."
            
            gerekce_3 = f"3ï¸âƒ£ *AÃ‡IK FUTBOL VE TEMPO:*\nAÃ§Ä±k futbol ve hÄ±zlÄ± geÃ§iÅŸ oyunlarÄ±, iki kalede de gol gÃ¶rmemizi saÄŸlayacaktÄ±r. Toplam xG: *{xg_toplam}* - Bu da iki takÄ±mÄ±n da pozisyon Ã¼reteceÄŸinin kanÄ±tÄ±."
        
        # ğŸ“‚ BÃ–LÃœM 5: KG YOK
        elif "KG YOK" in tahmin_upper or "KGYOK" in tahmin_upper:
            gerekce_1 = f"1ï¸âƒ£ *TEK TARAFLI OYUN:*\nMaÃ§Ä±n kontrolÃ¼nÃ¼n tamamen bir takÄ±mda olmasÄ± bekleniyor. GÃ¼Ã§lÃ¼ tarafÄ±n oyunu domine etmesi, zayÄ±f tarafÄ±n gol bulmasÄ±nÄ± zorlaÅŸtÄ±racak."
            
            gerekce_2 = f"2ï¸âƒ£ *KISIR HÃœCUM HATTI:*\nZayÄ±f olan tarafÄ±n gol yollarÄ±ndaki etkisizliÄŸi ve dÃ¼ÅŸÃ¼k ÅŸut ortalamasÄ±, karÅŸÄ±lÄ±klÄ± gol ihtimalini bitiriyor. xG verileri de bunu destekliyor."
            
            gerekce_3 = f"3ï¸âƒ£ *CLEAN SHEET (GOL YEMEME):*\nFavori takÄ±mÄ±n savunma konsantrasyonu Ã§ok yÃ¼ksek. Son maÃ§lardaki performanslarÄ±, kalesini gole kapatmaya Ã§ok yakÄ±n olduklarÄ±nÄ± gÃ¶steriyor."
        
        # ğŸ“‚ BÃ–LÃœM 6: Ä°LK YARI BAHÄ°SLERÄ°
        elif "Ä°Y" in tahmin_upper or "IY" in tahmin_upper:
            gerekce_1 = f"1ï¸âƒ£ *HIZLI BAÅLANGIÃ‡:*\nÄ°ki takÄ±mÄ±n da istatistikleri, maÃ§lara Ã§ok hÄ±zlÄ± baÅŸladÄ±klarÄ±nÄ± gÃ¶steriyor. Ä°lk 45 dakikada gol sesi Ã§Ä±kmasÄ± yÃ¼ksek bir ihtimal. TakÄ±mlar temkinli baÅŸlamayacak!"
            
            gerekce_2 = f"2ï¸âƒ£ *ERKEN GOL Ä°STATÄ°STÄ°ÄÄ°:*\nVeriler, bu takÄ±mlarÄ±n maÃ§larÄ±nÄ±n genellikle ilk yarÄ±m saatinde kilidin aÃ§Ä±ldÄ±ÄŸÄ±nÄ± doÄŸruluyor. Bekleyerek deÄŸil, saldÄ±rarak baÅŸlayacaklardÄ±r. xG: *{xg_toplam}*"
            
            gerekce_3 = f"3ï¸âƒ£ *SAVUNMA KONSANTRASYONU:*\nMaÃ§ baÅŸlarÄ±ndaki yerleÅŸim hatalarÄ± ve konsantrasyon eksikliÄŸi, ilk yarÄ± bitmeden filelerin havalanmasÄ±na neden olacaktÄ±r. Ev *%{ev_atan}*, Dep *%{dep_atan}* gol atÄ±yor."
        
        # ğŸ“‚ BÃ–LÃœM 7: HANDÄ°KAP
        elif "HANDÄ°KAP" in tahmin_upper or "H1" in tahmin_upper or "H2" in tahmin_upper:
            gerekce_1 = f"1ï¸âƒ£ *SIKLET FARKI:*\nÄ°ki takÄ±m arasÄ±nda ciddi bir kalite uÃ§urumu var. Favori takÄ±m sadece kazanmakla kalmayÄ±p, averajÄ± da artÄ±rmak isteyecektir. xG farkÄ± bunu destekliyor."
            
            gerekce_2 = f"2ï¸âƒ£ *SKOR ÃœRETKENLÄ°ÄÄ°:*\nRakibin direnci kÄ±rÄ±ldÄ±ktan sonra maÃ§ farka gidebilir. Favori ekibin gol silahlarÄ±, handikap engelini rahat aÅŸacaktÄ±r. Ev *%{ev_atan}*, Dep *%{dep_atan}* gol atÄ±yor."
            
            gerekce_3 = f"3ï¸âƒ£ *Ã‡Ã–KÃœÅ POTANSÄ°YELÄ°:*\nZayÄ±f tarafÄ±n oyun disiplininden kopma huyu var. Geriye dÃ¼ÅŸtÃ¼kleri an daÄŸÄ±lmalarÄ±, farklÄ± skoru getirecek ana faktÃ¶r."
        
        # VarsayÄ±lan (bilinmeyen bahis tipi)
        else:
            gerekce_1 = f"1ï¸âƒ£ *HÃœCUM GÃœCÃœ:*\nÄ°ki takÄ±mÄ±n ofansif verileri gÃ¼Ã§lÃ¼. Ev *%{ev_atan}*, Dep *%{dep_atan}* gol atma oranÄ±yla Ã¶ne Ã§Ä±kÄ±yor."
            gerekce_2 = f"2ï¸âƒ£ *xG ANALÄ°ZÄ°:*\nToplam xG: *{xg_toplam}* - MaÃ§ta pozisyon bolluÄŸu bekleniyor. Lig ortalamasÄ±: {lig_gol_ort}"
            gerekce_3 = f"3ï¸âƒ£ *SAVUNMA DURUMU:*\nEv *%{ev_yiyen}*, Dep *%{dep_yiyen}* gol yeme oranÄ±yla dikkat Ã§ekiyor."
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # HASHTAG OLUÅTUR
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        hashtag_ev = "#" + ev_takim.replace(" ", "").replace("-", "").replace("FK", "").replace("FC", "").replace(".", "")[:12]
        hashtag_dep = "#" + dep_takim.replace(" ", "").replace("-", "").replace("FK", "").replace("FC", "").replace(".", "")[:12]
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # FÄ°NAL PROMPT
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        # V70: CanlÄ± mod uyarÄ±sÄ±nÄ± ekle
        canli_baslik = ""
        if canli_mod:
            canli_baslik = canli_uyari + "\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n"
        
        prompt = f"""{canli_baslik}âš½ *{ev_takim} vs {dep_takim}*
ğŸ† {lig}

ğŸ¯ *TAHMÄ°N:* {tahmin}
ğŸ“Š *GÃœVEN:* {guven}/10 {guven_bar}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”¥ *3 DETAYLI GEREKÃ‡E:*

{gerekce_1}

{gerekce_2}

{gerekce_3}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ’° *KASA YÃ–NETÄ°MÄ°:* {kasa_seviye} - {kasa_oran}

ğŸ“¢ *Telegram:* https://t.me/DoksanDakikaAnaliz

{hashtag_ev}vs{hashtag_dep} #Bahis #Ä°ddaa #CanlÄ±Bahis #90DakikaAnaliz #FutbolAnaliz"""
        
        # Widget'a yaz
        if hasattr(self, 'txt_sosyal'):
            self.txt_sosyal.delete(1.0, tk.END)
            self.txt_sosyal.insert(tk.END, prompt)
        elif hasattr(self, 'sosyal_sonuc'):
            self.sosyal_sonuc.delete(1.0, tk.END)
            self.sosyal_sonuc.insert(tk.END, prompt)
        
        messagebox.showinfo("âœ…", f"{tahmin} iÃ§in prompt oluÅŸturuldu!")
    
    def sosyal_kopyala(self):
        """FIX: Sosyal prompt kopyala - doÄŸru widget"""
        text = ""
        if hasattr(self, 'txt_sosyal'):
            text = self.txt_sosyal.get(1.0, tk.END).strip()
        elif hasattr(self, 'sosyal_sonuc'):
            text = self.sosyal_sonuc.get(1.0, tk.END).strip()
        
        if text:
            self.root.clipboard_clear()
            self.root.clipboard_append(text)
            messagebox.showinfo("âœ…", "KopyalandÄ±!")
    
    def sosyal_telegram_gonder(self):
        """FIX: Sosyal prompt Telegram'a gÃ¶nder - doÄŸru widget"""
        text = ""
        if hasattr(self, 'txt_sosyal'):
            text = self.txt_sosyal.get(1.0, tk.END).strip()
        elif hasattr(self, 'sosyal_sonuc'):
            text = self.sosyal_sonuc.get(1.0, tk.END).strip()
        
        if text:
            self.kanal_sec_ve_gonder(text, "Sosyal Medya GÃ¶nder")
        else:
            messagebox.showwarning("UyarÄ±", "Ã–nce prompt oluÅŸturun!")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # PUANLAYICI (HATA 7 - TÃœM VERÄ°LER)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def puan_maclari_yukle(self):
        """V70: MaÃ§larÄ± yÃ¼kle - FÄ°L HAFIZASINDAN"""
        maclar = []
        
        # V70: mac_arsivi'den TÃœM maÃ§larÄ± al
        if hasattr(self, 'mac_arsivi') and self.mac_arsivi:
            for mac_key, mac_data in self.mac_arsivi.items():
                mac_adi = mac_data.get("mac", mac_data.get("mac_adi", ""))
                if mac_adi:
                    maclar.append(mac_adi.replace("_", " "))
        
        # mac_arsivi boÅŸsa mac_db'den
        if not maclar and self.mac_db:
            maclar = [m.get("mac", m.get("mac_adi", "?")).replace("_", " ") 
                      for m in self.mac_db[-50:]]
        
        self.combo_puan_mac["values"] = maclar
        if maclar:
            self.combo_puan_mac.set(maclar[0])
        print(f"ğŸ“‹ PuanlayÄ±cÄ± maÃ§ listesi: {len(maclar)} maÃ§ yÃ¼klendi")
    
    def puan_analiz_cek(self):
        """V70 FIX: SeÃ§ili maÃ§Ä±n verilerini Ã§ek ve puanla"""
        # SeÃ§ili maÃ§Ä± al
        if not hasattr(self, 'combo_puan_mac'):
            messagebox.showwarning("UyarÄ±", "MaÃ§ listesi bulunamadÄ±!")
            return
            
        secim = self.combo_puan_mac.get()
        if not secim:
            messagebox.showwarning("UyarÄ±", "Ã–nce bir maÃ§ seÃ§in!")
            return
        
        mac_data = None
        for m in self.mac_db:
            mac_str = f"{m.get('tarih', '')} - {m.get('mac', m.get('mac_adi', ''))}"
            if secim in mac_str or mac_str in secim:
                mac_data = m
                break
        
        if not mac_data:
            messagebox.showwarning("UyarÄ±", "MaÃ§ bulunamadÄ±!")
            return
        
        # Direkt puanlama yap - entry widget'larÄ±na gerek yok
        try:
            veriler = {
                "xg": mac_data.get("xg", mac_data.get("xg_toplam", 2.5)),
                "ev_atan": mac_data.get("ev_atan", mac_data.get("ev_atan_05", 70)),
                "dep_atan": mac_data.get("dep_atan", mac_data.get("dep_atan_05", 65)),
                "ev_yiyen": mac_data.get("ev_yiyen", mac_data.get("ev_yenen_05", 60)),
                "dep_yiyen": mac_data.get("dep_yiyen", mac_data.get("dep_yenen_05", 55)),
                "ust_25": mac_data.get("ust_25", mac_data.get("ms_25", 55)),
                "guven": mac_data.get("guven", 7),
                "lig": mac_data.get("lig", "")
            }
            
            scorer = MatchScorer(veriler)
            sonuc = scorer.calculate_score()
            
            # txt_puan kullan
            txt_widget = self.txt_puan if hasattr(self, 'txt_puan') else None
            if not txt_widget:
                messagebox.showinfo("Puan", f"Toplam Puan: {sonuc['toplam']}/100\nSeviye: {sonuc['seviye']}")
                return
            
            txt_widget.delete(1.0, tk.END)
            txt_widget.insert(tk.END, "ğŸ¯ MAÃ‡ PUANLAMA SONUCU\n")
            txt_widget.insert(tk.END, "="*50 + "\n\n")
            txt_widget.insert(tk.END, f"âš½ MAÃ‡: {mac_data.get('mac', '?')}\n")
            txt_widget.insert(tk.END, f"ğŸ† LÄ°G: {mac_data.get('lig', '?')}\n\n")
            
            txt_widget.insert(tk.END, "ğŸ“Š VERÄ°LER:\n")
            txt_widget.insert(tk.END, f"  â€¢ xG: {veriler['xg']}\n")
            txt_widget.insert(tk.END, f"  â€¢ Ev Atan: %{veriler['ev_atan']}\n")
            txt_widget.insert(tk.END, f"  â€¢ Dep Atan: %{veriler['dep_atan']}\n")
            txt_widget.insert(tk.END, f"  â€¢ 2.5 Ãœst: %{veriler['ust_25']}\n\n")
            
            txt_widget.insert(tk.END, f"ğŸ“Š TOPLAM PUAN: {sonuc['toplam']}/100\n")
            txt_widget.insert(tk.END, f"ğŸ† SEVÄ°YE: {sonuc['seviye']}\n\n")
            
            txt_widget.insert(tk.END, "ğŸ“ˆ DETAY:\n")
            for k, v in sonuc["detay"].items():
                txt_widget.insert(tk.END, f"  â€¢ {k}: {v}/20\n")
            
            txt_widget.insert(tk.END, f"\nğŸ’¡ Ã–NERÄ°: {sonuc['oneri']}\n")
            
        except Exception as e:
            messagebox.showerror("Hata", f"Puanlama hatasÄ±: {e}")
    
    def mac_puanla(self):
        """FIX #22: SeÃ§ili maÃ§Ä± puanla"""
        # Ã–nce seÃ§ili maÃ§Ä± al
        mac_data = None
        if hasattr(self, 'combo_puan_mac'):
            secim = self.combo_puan_mac.get()
            if secim:
                for m in self.mac_db:
                    mac_str = f"{m.get('tarih', '')} - {m.get('mac', m.get('mac_adi', ''))}"
                    if secim in mac_str or mac_str in secim:
                        mac_data = m
                        break
        
        if not mac_data and self.mac_db:
            mac_data = self.mac_db[-1]
        
        if not mac_data:
            messagebox.showwarning("UyarÄ±", "Puanlanacak maÃ§ bulunamadÄ±!")
            return
        
        try:
            veriler = {
                "xg": mac_data.get("xg", mac_data.get("xg_toplam", 2.5)),
                "ev_atan": mac_data.get("ev_atan", 70),
                "dep_atan": mac_data.get("dep_atan", 65),
                "ev_yiyen": mac_data.get("ev_yiyen", 60),
                "dep_yiyen": mac_data.get("dep_yiyen", 55),
                "ust_25": mac_data.get("ust_25", mac_data.get("ms_25", 55)),
                "guven": mac_data.get("guven", 7),
                "lig": mac_data.get("lig", "")
            }
            
            scorer = MatchScorer(veriler)
            sonuc = scorer.calculate_score()
            
            # txt_puan kullan (txt_puan_sonuc deÄŸil)
            txt_widget = self.txt_puan if hasattr(self, 'txt_puan') else (self.txt_puan_sonuc if hasattr(self, 'txt_puan_sonuc') else None)
            if not txt_widget:
                messagebox.showinfo("Puan", f"Toplam Puan: {sonuc['toplam']}/100\nSeviye: {sonuc['seviye']}")
                return
            
            txt_widget.delete(1.0, tk.END)
            txt_widget.insert(tk.END, "ğŸ¯ MAÃ‡ PUANLAMA SONUCU\n")
            txt_widget.insert(tk.END, "="*50 + "\n\n")
            txt_widget.insert(tk.END, f"âš½ MAÃ‡: {mac_data.get('mac', '?')}\n")
            txt_widget.insert(tk.END, f"ğŸ† LÄ°G: {mac_data.get('lig', '?')}\n\n")
            
            txt_widget.insert(tk.END, f"ğŸ“Š TOPLAM PUAN: {sonuc['toplam']}/100\n")
            txt_widget.insert(tk.END, f"ğŸ† SEVÄ°YE: {sonuc['seviye']}\n\n")
            
            txt_widget.insert(tk.END, "ğŸ“ˆ DETAY:\n")
            for k, v in sonuc["detay"].items():
                txt_widget.insert(tk.END, f"  â€¢ {k}: {v}/20\n")
            
            txt_widget.insert(tk.END, f"\nğŸ’¡ Ã–NERÄ°: {sonuc['oneri']}\n")
            
        except Exception as e:
            messagebox.showerror("Hata", f"Puanlama hatasÄ±: {e}")
    
    def gunun_maclarini_puanla(self):
        """FIX #22: GÃ¼nÃ¼n tÃ¼m maÃ§larÄ±nÄ± puanla"""
        tarih = datetime.now().strftime("%d.%m.%Y")
        maclar = [m for m in self.mac_db if m.get("tarih") == tarih]
        
        # txt_puan kullan
        txt_widget = self.txt_puan if hasattr(self, 'txt_puan') else (self.txt_puan_sonuc if hasattr(self, 'txt_puan_sonuc') else None)
        if not txt_widget:
            messagebox.showwarning("UyarÄ±", "Metin alanÄ± bulunamadÄ±!")
            return
        
        txt_widget.delete(1.0, tk.END)
        txt_widget.insert(tk.END, f"ğŸ¯ GÃœNÃœN TÃœM MAÃ‡LARI ({tarih})\n")
        txt_widget.insert(tk.END, "="*50 + "\n\n")
        
        if not maclar:
            txt_widget.insert(tk.END, "âš ï¸ BugÃ¼ne ait analiz bulunamadÄ±!\n")
            return
        
        sonuclar = []
        for mac in maclar:
            veriler = {
                "xg": mac.get("xg", mac.get("xg_toplam", 0)),
                "ev_atan": mac.get("ev_atan", 0),
                "dep_atan": mac.get("dep_atan", 0),
                "ev_yiyen": mac.get("ev_yiyen", 0),
                "dep_yiyen": mac.get("dep_yiyen", 0),
                "ust_25": mac.get("ust_25", mac.get("ms_25", 0)),
                "guven": mac.get("guven", 5),
                "lig": mac.get("lig", "")
            }
            scorer = MatchScorer(veriler)
            sonuc = scorer.calculate_score()
            sonuclar.append((mac, sonuc))
        
        sonuclar.sort(key=lambda x: x[1]["toplam"], reverse=True)
        
        for mac, sonuc in sonuclar:
            mac_adi = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")[:30]
            txt_widget.insert(tk.END, f"{sonuc['seviye']} {mac_adi}\n")
            txt_widget.insert(tk.END, f"   Puan: {sonuc['toplam']}/100 | {mac.get('banko', '?')}\n\n")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # SÄ°MÃœLATÃ–R (HATA 8 - GENÄ°ÅLETÄ°LMÄ°Å)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def sim_maclari_yukle(self):
        """V70: MaÃ§larÄ± yÃ¼kle - FÄ°L HAFIZASINDAN"""
        maclar = []
        
        # V70: mac_arsivi'den TÃœM maÃ§larÄ± al
        if hasattr(self, 'mac_arsivi') and self.mac_arsivi:
            for mac_key, mac_data in self.mac_arsivi.items():
                mac_adi = mac_data.get("mac", mac_data.get("mac_adi", ""))
                if mac_adi:
                    maclar.append(mac_adi.replace("_", " "))
        
        # mac_arsivi boÅŸsa mac_db'den
        if not maclar and self.mac_db:
            maclar = [m.get("mac", m.get("mac_adi", "?")).replace("_", " ") 
                      for m in self.mac_db]
        
        # TekrarlarÄ± kaldÄ±r
        maclar = list(dict.fromkeys(maclar))
        self.combo_sim_mac["values"] = maclar
        if maclar:
            self.combo_sim_mac.set(maclar[0])
        print(f"ğŸ“‹ SimÃ¼latÃ¶r maÃ§ listesi: {len(maclar)} maÃ§ yÃ¼klendi")
    
    def sim_analiz_cek(self):
        """SimÃ¼lasyon verilerini Ã§ek - DÃœZELTME"""
        if not hasattr(self, 'combo_sim_mac'):
            messagebox.showwarning("UyarÄ±", "SimÃ¼lasyon sayfasÄ± bulunamadÄ±!")
            return
        
        secim = self.combo_sim_mac.get()
        if not secim:
            messagebox.showwarning("UyarÄ±", "Ã–nce bir maÃ§ seÃ§in!")
            return
        
        # MaÃ§ eÅŸleÅŸtirme - daha esnek
        mac_data = None
        secim_clean = secim.replace("_", " ").lower()
        
        for m in self.mac_db:
            mac_adi = m.get('mac', m.get('mac_adi', '')).replace("_", " ").lower()
            if secim_clean in mac_adi or mac_adi in secim_clean:
                mac_data = m
                break
        
        # Hala bulunamadÄ±ysa son analizi al
        if not mac_data and self.mac_db:
            mac_data = self.mac_db[-1]
        
        if not mac_data:
            messagebox.showwarning("UyarÄ±", "HiÃ§ analiz yapÄ±lmamÄ±ÅŸ! Ã–nce bir maÃ§ analiz edin.")
            return
        
        # sim_entries varsa bunlarÄ± kullan
        if hasattr(self, 'sim_entries'):
            xg = mac_data.get("xg", mac_data.get("xg_toplam", mac_data.get("xg_ev", "1.5")))
            xg_dep = mac_data.get("xg_dep", "1.2")
            
            # xG deÄŸerlerini Ã§Ä±kar
            if isinstance(xg, str) and "+" in xg:
                parts = xg.split("+")
                ev_xg = parts[0].strip()
                dep_xg = parts[1].strip() if len(parts) > 1 else str(xg_dep)
            else:
                try:
                    ev_xg = str(mac_data.get("xg_ev", 1.5))
                    dep_xg = str(mac_data.get("xg_dep", 1.2))
                except:
                    ev_xg = "1.50"
                    dep_xg = "1.20"
            
            # Entry'leri doldur
            if "ev_xg" in self.sim_entries:
                self.sim_entries["ev_xg"].delete(0, tk.END)
                self.sim_entries["ev_xg"].insert(0, ev_xg.replace("%", ""))
            if "dep_xg" in self.sim_entries:
                self.sim_entries["dep_xg"].delete(0, tk.END)
                self.sim_entries["dep_xg"].insert(0, dep_xg.replace("%", ""))
            if "ev_atan" in self.sim_entries:
                self.sim_entries["ev_atan"].delete(0, tk.END)
                val = str(mac_data.get("ev_atan", mac_data.get("ev_atan_05", 70))).replace("%", "")
                self.sim_entries["ev_atan"].insert(0, val)
            if "dep_atan" in self.sim_entries:
                self.sim_entries["dep_atan"].delete(0, tk.END)
                val = str(mac_data.get("dep_atan", mac_data.get("dep_atan_05", 65))).replace("%", "")
                self.sim_entries["dep_atan"].insert(0, val)
        
        messagebox.showinfo("âœ…", f"Veriler Ã§ekildi: {mac_data.get('mac', '?')}")
    
    def simulasyon_baslat(self):
        """FIX #23: Monte Carlo simÃ¼lasyonu Ã§alÄ±ÅŸtÄ±r"""
        try:
            # sim_entries'den verileri al
            if hasattr(self, 'sim_entries'):
                ev_xg = float(self.sim_entries.get("ev_xg", tk.Entry()).get() or 1.5)
                dep_xg = float(self.sim_entries.get("dep_xg", tk.Entry()).get() or 1.2)
                ev_atan = float(self.sim_entries.get("ev_atan", tk.Entry()).get() or 70)
                dep_atan = float(self.sim_entries.get("dep_atan", tk.Entry()).get() or 65)
                iterasyon = int(self.sim_entries.get("iterasyon", tk.Entry()).get() or 10000)
            else:
                ev_xg, dep_xg, ev_atan, dep_atan, iterasyon = 1.5, 1.2, 70, 65, 10000
            
            # txt_sim kullan
            txt_widget = self.txt_sim if hasattr(self, 'txt_sim') else None
            if not txt_widget:
                messagebox.showwarning("UyarÄ±", "SonuÃ§ alanÄ± bulunamadÄ±!")
                return
            
            txt_widget.delete(1.0, tk.END)
            txt_widget.insert(tk.END, f"ğŸ® MONTE CARLO SÄ°MÃœLASYON ({iterasyon}x)\n")
            txt_widget.insert(tk.END, "="*50 + "\n\n")
            
            txt_widget.insert(tk.END, f"ğŸ“Š PARAMETRELER:\n")
            txt_widget.insert(tk.END, f"  â€¢ xG: {ev_xg} vs {dep_xg}\n")
            txt_widget.insert(tk.END, f"  â€¢ Atan: %{ev_atan} vs %{dep_atan}\n\n")
            
            # Basit simÃ¼lasyon
            import random
            ev_gol_toplam = 0
            dep_gol_toplam = 0
            ust_15 = 0
            ust_25 = 0
            ust_35 = 0
            kg_var = 0
            ev_kazanir = 0
            berabere = 0
            dep_kazanir = 0
            skorlar = {}
            
            for _ in range(iterasyon):
                # Poisson daÄŸÄ±lÄ±mÄ± ile gol simÃ¼lasyonu
                ev_gol = random.randint(0, int(ev_xg * 2 + 1))
                dep_gol = random.randint(0, int(dep_xg * 2 + 1))
                
                # xG'ye gÃ¶re aÄŸÄ±rlÄ±klÄ± random
                if random.random() < ev_xg / 3:
                    ev_gol += 1
                if random.random() < dep_xg / 3:
                    dep_gol += 1
                
                ev_gol_toplam += ev_gol
                dep_gol_toplam += dep_gol
                
                toplam = ev_gol + dep_gol
                if toplam > 1: ust_15 += 1
                if toplam > 2: ust_25 += 1
                if toplam > 3: ust_35 += 1
                if ev_gol > 0 and dep_gol > 0: kg_var += 1
                
                if ev_gol > dep_gol: ev_kazanir += 1
                elif ev_gol < dep_gol: dep_kazanir += 1
                else: berabere += 1
                
                skor = f"{ev_gol}-{dep_gol}"
                skorlar[skor] = skorlar.get(skor, 0) + 1
            
            txt_widget.insert(tk.END, f"ğŸ† SONUÃ‡LAR:\n")
            txt_widget.insert(tk.END, f"  â€¢ Ev KazanÄ±r: %{ev_kazanir*100//iterasyon}\n")
            txt_widget.insert(tk.END, f"  â€¢ Berabere: %{berabere*100//iterasyon}\n")
            txt_widget.insert(tk.END, f"  â€¢ Dep KazanÄ±r: %{dep_kazanir*100//iterasyon}\n\n")
            
            txt_widget.insert(tk.END, f"âš½ GOL TAHMÄ°NLERÄ°:\n")
            txt_widget.insert(tk.END, f"  â€¢ 1.5 Ãœst: %{ust_15*100//iterasyon}\n")
            txt_widget.insert(tk.END, f"  â€¢ 2.5 Ãœst: %{ust_25*100//iterasyon}\n")
            txt_widget.insert(tk.END, f"  â€¢ 3.5 Ãœst: %{ust_35*100//iterasyon}\n")
            txt_widget.insert(tk.END, f"  â€¢ KG Var: %{kg_var*100//iterasyon}\n")
            txt_widget.insert(tk.END, f"  â€¢ Ort. Gol: {(ev_gol_toplam+dep_gol_toplam)/iterasyon:.2f}\n\n")
            
            txt_widget.insert(tk.END, f"ğŸ“ˆ EN SIK SKORLAR:\n")
            en_sik = sorted(skorlar.items(), key=lambda x: x[1], reverse=True)[:5]
            for skor, sayi in en_sik:
                oran = round(sayi / iterasyon * 100, 1)
                txt_widget.insert(tk.END, f"  â€¢ {skor}: {sayi}x (%{oran})\n")
            
        except Exception as e:
            messagebox.showerror("Hata", f"SimÃ¼lasyon hatasÄ±: {e}")


# ============================================================
# PART 5 SONU - PART 6'YA DEVAM
# ============================================================
# ============================================================
# PART 6/6 (SON) - KALAN FONKSÄ°YONLAR + MAIN
# ============================================================
# Bu dosyayÄ± PART 5'in SONUNA ekle
# ============================================================

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ALARM FONKSÄ°YONLARI
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def alarm_ekle(self):
        mac = self.entry_alarm_mac.get().strip()
        saat = self.entry_alarm_saat.get().strip()
        dk = int(self.spin_alarm_dk.get() or 30)
        
        if not mac or not saat:
            return
        
        alarm = {
            "id": hashlib.md5(f"{mac}{saat}{time.time()}".encode()).hexdigest()[:6],
            "mac": mac,
            "saat": saat,
            "dakika_once": dk,
            "aktif": True
        }
        self.alarmlar.append(alarm)
        self.ayarlar_kaydet()
        self.alarm_listele()
        
        self.entry_alarm_mac.delete(0, tk.END)
        self.entry_alarm_saat.delete(0, tk.END)
    
    def alarm_sil(self):
        sel = self.tree_alarm.selection()
        if not sel:
            return
        
        values = self.tree_alarm.item(sel[0], "values")
        mac = values[0]
        
        self.alarmlar = [a for a in self.alarmlar if a["mac"] != mac]
        self.ayarlar_kaydet()
        self.alarm_listele()
    
    def alarm_listele(self):
        for item in self.tree_alarm.get_children():
            self.tree_alarm.delete(item)
        
        for alarm in self.alarmlar:
            hatirlatma = f"{alarm['dakika_once']} dk Ã¶nce"
            durum = "âœ… Aktif" if alarm.get("aktif", True) else "âŒ KapalÄ±"
            self.tree_alarm.insert("", "end", values=(
                alarm["mac"], alarm["saat"], hatirlatma, durum
            ))
    
    def alarm_kontrol(self):
        """Her dakika alarm kontrolÃ¼"""
        simdi = datetime.now()
        
        for alarm in self.alarmlar:
            if not alarm.get("aktif", True):
                continue
            
            try:
                saat_parts = alarm["saat"].split(":")
                alarm_saat = simdi.replace(hour=int(saat_parts[0]), minute=int(saat_parts[1]), second=0)
                hatirlatma_saat = alarm_saat - timedelta(minutes=alarm["dakika_once"])
                
                if simdi.hour == hatirlatma_saat.hour and simdi.minute == hatirlatma_saat.minute:
                    self._alarm_bildir(alarm)
                    alarm["aktif"] = False
            except:
                pass
        
        # 60 saniye sonra tekrar kontrol
        self.root.after(60000, self.alarm_kontrol)
    
    def _alarm_bildir(self, alarm):
        """Alarm bildirimi gÃ¶ster ve Telegram'a gÃ¶nder"""
        msg = f"â° ALARM!\n\nâš½ {alarm['mac']}\nğŸ• Saat: {alarm['saat']}\n\nMaÃ§ {alarm['dakika_once']} dakika sonra baÅŸlÄ±yor!"
        
        # Popup gÃ¶ster
        messagebox.showinfo("â° ALARM", msg)
        
        # Telegram'a gÃ¶nder (opsiyonel)
        if TELEGRAM_BOT_TOKEN and TELEGRAM_CHAT_ID:
            self.telegram.send(msg)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # LABORATUVAR FONKSÄ°YONLARI (HATA 9)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def lab_kural_test(self):
        """FIX: SeÃ§ili kuralÄ± arÅŸivde test et"""
        # Yeni lab sayfasÄ± iÃ§in
        if hasattr(self, 'combo_lab_kural'):
            kural_sec = self.combo_lab_kural.get()
            if not kural_sec:
                messagebox.showwarning("UyarÄ±", "Ã–nce bir kural seÃ§in!")
                return
            
            self.txt_lab.delete("1.0", tk.END)
            self.txt_lab.insert(tk.END, "ğŸ”¬ KURAL TEST SONUCU\n")
            self.txt_lab.insert(tk.END, "â•" * 60 + "\n\n")
            self.txt_lab.insert(tk.END, f"ğŸ“œ Kural: {kural_sec}\n\n")
            
            # SonuÃ§lu maÃ§larÄ± bul
            sonuclu = [m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]]
            
            if not sonuclu:
                self.txt_lab.insert(tk.END, "âš ï¸ SonuÃ§lu maÃ§ bulunamadÄ±!\n")
                return
            
            kazanan = len([m for m in sonuclu if m.get("sonuc") in ["KAZANDI", "âœ…"]])
            kaybeden = len([m for m in sonuclu if m.get("sonuc") in ["KAYBETTÄ°", "âŒ"]])
            toplam = kazanan + kaybeden
            basari = (kazanan / toplam * 100) if toplam > 0 else 0
            
            self.txt_lab.insert(tk.END, f"ğŸ“Š ARÅÄ°V TEST SONUCU:\n")
            self.txt_lab.insert(tk.END, f"   â€¢ Toplam sonuÃ§lu: {toplam}\n")
            self.txt_lab.insert(tk.END, f"   â€¢ âœ… Kazanan: {kazanan}\n")
            self.txt_lab.insert(tk.END, f"   â€¢ âŒ Kaybeden: {kaybeden}\n")
            self.txt_lab.insert(tk.END, f"   â€¢ ğŸ“ˆ BaÅŸarÄ±: %{basari:.1f}\n\n")
            
            if basari >= 70:
                self.txt_lab.insert(tk.END, "ğŸ’ MÃœKEMMEL! Bu strateji Ã§alÄ±ÅŸÄ±yor.\n")
            elif basari >= 50:
                self.txt_lab.insert(tk.END, "âš ï¸ Orta seviye. Ek filtreler gerekebilir.\n")
            else:
                self.txt_lab.insert(tk.END, "âŒ DÃ¼ÅŸÃ¼k baÅŸarÄ±. Stratejiyi revize et.\n")
            return
        
        # Eski lab sayfasÄ± iÃ§in (entry_lab_xg varsa)
        if not hasattr(self, 'entry_lab_xg'):
            messagebox.showwarning("UyarÄ±", "Lab sayfasÄ± bulunamadÄ±!")
            return
            
        xg_min = float(self.entry_lab_xg.get() or 2.5)
        conv_min = float(self.entry_lab_conv.get() or 12)
        ust_min = float(self.entry_lab_ust.get() or 55)
        bahis_turu = self.combo_lab_bahis.get()
        
        kural = {
            "ad": f"xG>{xg_min} & Conv>{conv_min} & 2.5Ãœ>{ust_min} â†’ {bahis_turu}",
            "sartlar": {
                "xg": xg_min,
                "conv": conv_min,
                "ust_25": ust_min
            },
            "bahis": bahis_turu
        }
        
        # Sadece sonucu belli maÃ§larÄ± test et
        sonuclu_maclar = [m for m in self.mac_db if m.get("sonuc")]
        
        self.txt_lab_sonuc.delete(1.0, tk.END)
        self.txt_lab_sonuc.insert(tk.END, "ğŸ”¬ KURAL TEST SONUCU\n")
        self.txt_lab_sonuc.insert(tk.END, "="*50 + "\n\n")
        self.txt_lab_sonuc.insert(tk.END, f"ğŸ“œ KURAL: {kural['ad']}\n\n")
        
        if len(sonuclu_maclar) < 5:
            self.txt_lab_sonuc.insert(tk.END, "âš ï¸ Yeterli veri yok!\n")
            self.txt_lab_sonuc.insert(tk.END, f"ğŸ“Š SonuÃ§lu maÃ§ sayÄ±sÄ±: {len(sonuclu_maclar)}\n")
            self.txt_lab_sonuc.insert(tk.END, "ğŸ’¡ En az 5 sonuÃ§lu analiz gerekiyor.\n")
            return
        
        # Test et
        sonuc = self.lab.test_rule(kural, sonuclu_maclar)
        
        self.txt_lab_sonuc.insert(tk.END, f"ğŸ“Š TEST SONUCU:\n")
        self.txt_lab_sonuc.insert(tk.END, f"  â€¢ EÅŸleÅŸen maÃ§: {sonuc['toplam']}\n")
        self.txt_lab_sonuc.insert(tk.END, f"  â€¢ Kazanan: {sonuc['dogru']}\n")
        self.txt_lab_sonuc.insert(tk.END, f"  â€¢ Kaybeden: {sonuc['yanlis']}\n")
        self.txt_lab_sonuc.insert(tk.END, f"  â€¢ BaÅŸarÄ±: %{sonuc['basari']}\n\n")
        
        if sonuc['basari'] >= 70:
            self.txt_lab_sonuc.insert(tk.END, "âœ… BU KURAL Ã‡ALIÅIYOR! Sisteme ekleyebilirsin.\n")
        elif sonuc['basari'] >= 55:
            self.txt_lab_sonuc.insert(tk.END, "âš ï¸ Kural ortalama, daha fazla test gerekli.\n")
        else:
            self.txt_lab_sonuc.insert(tk.END, "âŒ Bu kural Ã§alÄ±ÅŸmÄ±yor, deÄŸiÅŸtirmeyi dene.\n")
        
        # EÅŸleÅŸen maÃ§larÄ± listele
        if sonuc['eslesen_maclar']:
            self.txt_lab_sonuc.insert(tk.END, "\nğŸ“‹ EÅLEÅEN MAÃ‡LAR:\n")
            for mac in sonuc['eslesen_maclar'][:10]:
                mac_adi = mac.get("mac", mac.get("mac_adi", "?")).replace("_", " ")[:25]
                mac_sonuc = "âœ…" if mac.get("sonuc") == "KAZANDI" else "âŒ"
                self.txt_lab_sonuc.insert(tk.END, f"  {mac_sonuc} {mac_adi}\n")
    
    def lab_kural_kaydet(self):
        """KuralÄ± kaydet"""
        xg_min = self.entry_lab_xg.get()
        conv_min = self.entry_lab_conv.get()
        ust_min = self.entry_lab_ust.get()
        bahis_turu = self.combo_lab_bahis.get()
        
        kural = {
            "ad": f"xG>{xg_min} & Conv>{conv_min} & 2.5Ãœ>{ust_min} â†’ {bahis_turu}",
            "sartlar": {"xg": xg_min, "conv": conv_min, "ust_25": ust_min},
            "bahis": bahis_turu,
            "tarih": datetime.now().isoformat()
        }
        
        self.lab.add_rule(kural)
        messagebox.showinfo("BaÅŸarÄ±lÄ±", "âœ… Kural kaydedildi!")
    
    def lab_kurallari_listele(self):
        """KayÄ±tlÄ± kurallarÄ± listele"""
        self.txt_lab_sonuc.delete(1.0, tk.END)
        self.txt_lab_sonuc.insert(tk.END, "ğŸ“‹ KAYITLI KURALLAR\n")
        self.txt_lab_sonuc.insert(tk.END, "="*50 + "\n\n")
        
        for i, kural in enumerate(self.lab.data.get("kurallar", []), 1):
            self.txt_lab_sonuc.insert(tk.END, f"{i}. {kural['ad']}\n")
            self.txt_lab_sonuc.insert(tk.END, f"   ğŸ“… {kural.get('tarih', '?')[:10]}\n\n")
        
        if not self.lab.data.get("kurallar"):
            self.txt_lab_sonuc.insert(tk.END, "âŒ HenÃ¼z kayÄ±tlÄ± kural yok.\n")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # GÄ°ZLÄ° HAZÄ°NE FONKSÄ°YONLARI (HATA 10)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def hazine_listele(self):
        """Hazine liglerini listele"""
        for item in self.tree_hazine.get_children():
            self.tree_hazine.delete(item)
        
        # KullanÄ±cÄ± baÅŸarÄ± oranlarÄ±nÄ± hesapla
        lig_basari = {}
        for mac in self.mac_db:
            if not mac.get("sonuc"):
                continue
            lig = mac.get("lig", "DiÄŸer")
            if lig not in lig_basari:
                lig_basari[lig] = {"kazanan": 0, "toplam": 0}
            lig_basari[lig]["toplam"] += 1
            if mac["sonuc"] == "KAZANDI":
                lig_basari[lig]["kazanan"] += 1
        
        for lig, data in GIZLI_HAZINE_LIGLERI.items():
            # KullanÄ±cÄ± baÅŸarÄ±sÄ±
            user_data = lig_basari.get(lig, {"kazanan": 0, "toplam": 0})
            user_basari = round(user_data["kazanan"] / user_data["toplam"] * 100, 1) if user_data["toplam"] > 0 else 0
            
            # FÄ±rsat hesapla (user baÅŸarÄ±sÄ± - bahisÃ§i baÅŸarÄ±sÄ±)
            firsat = user_basari - data["bahisci_basari"] if user_basari > 0 else 0
            firsat_text = f"+{firsat:.1f}" if firsat > 0 else f"{firsat:.1f}"
            
            self.tree_hazine.insert("", "end", values=(
                lig,
                data["gol_ort"],
                f"%{data['kg_oran']}",
                f"%{data['bahisci_basari']}",
                f"%{user_basari}" if user_basari > 0 else "-",
                firsat_text if user_basari > 0 else "-"
            ))
    
    def hazine_guncelle(self):
        """HATA 10 - Verileri analizlerden gÃ¼ncelle"""
        # Lig baÅŸarÄ± oranlarÄ±nÄ± hesapla
        lig_stats = {}
        for mac in self.mac_db:
            lig = mac.get("lig", "")
            if not lig:
                continue
            
            if lig not in lig_stats:
                lig_stats[lig] = {
                    "gol_toplam": 0,
                    "mac_sayisi": 0,
                    "kg_var": 0,
                    "kazanan": 0,
                    "toplam_sonuclu": 0
                }
            
            lig_stats[lig]["mac_sayisi"] += 1
            
            # xG'den gol ortalamasÄ± tahmin et
            try:
                xg = float(mac.get("xg", 0) or 0)
                lig_stats[lig]["gol_toplam"] += xg
            except:
                pass
            
            # KG oranÄ±
            try:
                kg = float(mac.get("kg_var", 0) or 0)
                lig_stats[lig]["kg_var"] += kg
            except:
                pass
            
            # BaÅŸarÄ±
            if mac.get("sonuc"):
                lig_stats[lig]["toplam_sonuclu"] += 1
                if mac["sonuc"] == "KAZANDI":
                    lig_stats[lig]["kazanan"] += 1
        
        # GIZLI_HAZINE_LIGLERI gÃ¼ncelle
        for lig, stats in lig_stats.items():
            if stats["mac_sayisi"] >= 3:  # En az 3 maÃ§ analiz edilmiÅŸ olmalÄ±
                gol_ort = round(stats["gol_toplam"] / stats["mac_sayisi"], 1)
                kg_oran = round(stats["kg_var"] / stats["mac_sayisi"], 0)
                
                if lig not in GIZLI_HAZINE_LIGLERI:
                    GIZLI_HAZINE_LIGLERI[lig] = {
                        "gol_ort": gol_ort,
                        "kg_oran": int(kg_oran),
                        "bahisci_basari": 45  # VarsayÄ±lan
                    }
                else:
                    GIZLI_HAZINE_LIGLERI[lig]["gol_ort"] = gol_ort
                    GIZLI_HAZINE_LIGLERI[lig]["kg_oran"] = int(kg_oran)
        
        self.hazine_listele()
        messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… {len(lig_stats)} lig gÃ¼ncellendi!")
    
    def hazine_analiz(self):
        """SeÃ§ili ligi analiz et"""
        lig = self.combo_hazine_lig.get()
        if not lig:
            return
        
        data = GIZLI_HAZINE_LIGLERI.get(lig, {})
        
        self.txt_hazine_sonuc.delete(1.0, tk.END)
        self.txt_hazine_sonuc.insert(tk.END, f"ğŸ {lig} ANALÄ°ZÄ°\n")
        self.txt_hazine_sonuc.insert(tk.END, "="*50 + "\n\n")
        
        self.txt_hazine_sonuc.insert(tk.END, f"ğŸ“Š Ä°STATÄ°STÄ°KLER:\n")
        self.txt_hazine_sonuc.insert(tk.END, f"  â€¢ Gol OrtalamasÄ±: {data.get('gol_ort', '?')}\n")
        self.txt_hazine_sonuc.insert(tk.END, f"  â€¢ KG VAR OranÄ±: %{data.get('kg_oran', '?')}\n")
        self.txt_hazine_sonuc.insert(tk.END, f"  â€¢ BahisÃ§i BaÅŸarÄ±sÄ±: %{data.get('bahisci_basari', '?')}\n\n")
        
        # Ã–neriler
        gol_ort = data.get('gol_ort', 2.5)
        kg_oran = data.get('kg_oran', 60)
        
        self.txt_hazine_sonuc.insert(tk.END, f"ğŸ’¡ Ã–NERÄ°LER:\n")
        
        if gol_ort >= 2.8:
            self.txt_hazine_sonuc.insert(tk.END, f"  âœ… 2.5 ÃœST bahisleri iÃ§in ideal lig!\n")
        if kg_oran >= 65:
            self.txt_hazine_sonuc.insert(tk.END, f"  âœ… KG VAR bahisleri iÃ§in ideal lig!\n")
        if gol_ort >= 3.0:
            self.txt_hazine_sonuc.insert(tk.END, f"  ğŸ”¥ 3.5 ÃœST potansiyeli yÃ¼ksek!\n")
        
        self.txt_hazine_sonuc.insert(tk.END, f"\nâš ï¸ BahisÃ§iler bu liglere az ilgi gÃ¶sterir,\n")
        self.txt_hazine_sonuc.insert(tk.END, f"   bu yÃ¼zden oranlar genelde yÃ¼ksektir!\n")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # GÃ–RSEL FONKSÄ°YONLARI - YENÄ° HÄ°BRÄ°T SÄ°STEM
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    # TAKIM RENKLERÄ° VERÄ°TABANI
    TAKIM_RENKLERI = {
        # TÃ¼rkiye
        "fenerbahÃ§e": {"birincil": "#FFED00", "ikincil": "#00205B", "ad": "FenerbahÃ§e"},
        "galatasaray": {"birincil": "#FDB913", "ikincil": "#C80815", "ad": "Galatasaray"},
        "beÅŸiktaÅŸ": {"birincil": "#000000", "ikincil": "#FFFFFF", "ad": "BeÅŸiktaÅŸ"},
        "trabzonspor": {"birincil": "#8B0000", "ikincil": "#00CED1", "ad": "Trabzonspor"},
        "baÅŸakÅŸehir": {"birincil": "#FF6600", "ikincil": "#003366", "ad": "BaÅŸakÅŸehir"},
        "adana demirspor": {"birincil": "#0066CC", "ikincil": "#FF6600", "ad": "Adana Demirspor"},
        "antalyaspor": {"birincil": "#CC0000", "ikincil": "#FFFFFF", "ad": "Antalyaspor"},
        "sivasspor": {"birincil": "#CC0000", "ikincil": "#FFFFFF", "ad": "Sivasspor"},
        "konyaspor": {"birincil": "#006633", "ikincil": "#FFFFFF", "ad": "Konyaspor"},
        "kasÄ±mpaÅŸa": {"birincil": "#0033CC", "ikincil": "#FFFFFF", "ad": "KasÄ±mpaÅŸa"},
        # Ä°ngiltere
        "manchester united": {"birincil": "#DA291C", "ikincil": "#FBE122", "ad": "Man United"},
        "manchester city": {"birincil": "#6CABDD", "ikincil": "#1C2C5B", "ad": "Man City"},
        "liverpool": {"birincil": "#C8102E", "ikincil": "#00B2A9", "ad": "Liverpool"},
        "arsenal": {"birincil": "#EF0107", "ikincil": "#063672", "ad": "Arsenal"},
        "chelsea": {"birincil": "#034694", "ikincil": "#DBA111", "ad": "Chelsea"},
        "tottenham": {"birincil": "#132257", "ikincil": "#FFFFFF", "ad": "Tottenham"},
        # Ä°spanya
        "barcelona": {"birincil": "#A50044", "ikincil": "#004D98", "ad": "Barcelona"},
        "real madrid": {"birincil": "#FFFFFF", "ikincil": "#00529F", "ad": "Real Madrid"},
        "atletico madrid": {"birincil": "#CB3524", "ikincil": "#FFFFFF", "ad": "Atletico"},
        # Almanya
        "bayern": {"birincil": "#DC052D", "ikincil": "#0066B2", "ad": "Bayern"},
        "dortmund": {"birincil": "#FDE100", "ikincil": "#000000", "ad": "Dortmund"},
        # Ä°talya
        "juventus": {"birincil": "#000000", "ikincil": "#FFFFFF", "ad": "Juventus"},
        "inter": {"birincil": "#0068A8", "ikincil": "#000000", "ad": "Inter"},
        "milan": {"birincil": "#AC1A2F", "ikincil": "#000000", "ad": "AC Milan"},
        # Fransa
        "psg": {"birincil": "#004170", "ikincil": "#DA291C", "ad": "PSG"},
        # VarsayÄ±lan
        "default_ev": {"birincil": "#00FF00", "ikincil": "#004400", "ad": "Ev"},
        "default_dep": {"birincil": "#FF6600", "ikincil": "#442200", "ad": "Dep"},
    }
    
    def _takim_rengi_bul(self, takim_adi):
        """TakÄ±m adÄ±ndan renk bilgisi bul"""
        takim_lower = takim_adi.lower().strip()
        
        for key, value in self.TAKIM_RENKLERI.items():
            if key in takim_lower or takim_lower in key:
                return value
        
        # Bulunamazsa varsayÄ±lan
        return self.TAKIM_RENKLERI["default_ev"]
    
    def gorsel_analiz_cek(self):
        """SeÃ§ili maÃ§tan verileri Ã§ek"""
        if not hasattr(self, 'combo_gorsel_mac'):
            return
        
        secim = self.combo_gorsel_mac.get()
        if not secim:
            messagebox.showwarning("UyarÄ±", "Ã–nce bir maÃ§ seÃ§in!")
            return
        
        # MaÃ§Ä± bul
        mac = None
        for m in self.mac_db:
            mac_str = f"{m.get('tarih', '')} - {m.get('mac', m.get('mac_adi', ''))}"
            if secim in mac_str or mac_str in secim:
                mac = m
                break
        
        if not mac:
            messagebox.showwarning("UyarÄ±", "MaÃ§ bulunamadÄ±!")
            return
        
        # GÃ¶rsel verisini kaydet
        self.gorsel_data = mac
        messagebox.showinfo("âœ…", f"MaÃ§ verisi Ã§ekildi: {mac.get('mac', '?')}")
    
    def gorsel_olustur_v2(self):
        """ğŸ¨ YENÄ° HÄ°BRÄ°T GÃ–RSEL SÄ°STEMÄ° - 3 MOD"""
        
        # Veri kontrolÃ¼
        if not hasattr(self, 'gorsel_data') or not self.gorsel_data:
            # Son analizi kullan
            if self.mac_db:
                self.gorsel_data = self.mac_db[-1]
            else:
                messagebox.showwarning("UyarÄ±", "Ã–nce ANALÄ°ZDEN Ã‡EK'e tÄ±klayÄ±n!")
                return
        
        data = self.gorsel_data
        mod = self.gorsel_mod.get() if hasattr(self, 'gorsel_mod') else "prediction"
        
        # Boyut ayarla
        boyut = self.combo_gorsel_boyut.get() if hasattr(self, 'combo_gorsel_boyut') else "Instagram Post"
        if "Story" in boyut:
            width, height = 1080, 1920
        elif "Twitter" in boyut:
            width, height = 1200, 675
        elif "Kare" in boyut:
            width, height = 1080, 1080
        else:  # Instagram Post
            width, height = 1080, 1350
        
        # Verileri Ã§Ä±kar
        mac_adi = data.get("mac", data.get("mac_adi", "TAKIM A vs TAKIM B")).replace("_", " ")
        
        # TakÄ±mlarÄ± ayÄ±r
        if " vs " in mac_adi.lower():
            parts = mac_adi.split(" vs " if " vs " in mac_adi else " VS ")
        elif " - " in mac_adi:
            parts = mac_adi.split(" - ")
        else:
            parts = [mac_adi, "Rakip"]
        
        ev_takim = parts[0].strip() if len(parts) > 0 else "Ev"
        dep_takim = parts[1].strip() if len(parts) > 1 else "Dep"
        
        tahmin = data.get("banko", "2.5 ÃœST")
        guven = str(data.get("guven", "8")).replace("/10", "")
        xg_ev = data.get("xg_ev", "1.5")
        xg_dep = data.get("xg_dep", "1.3")
        ev_atan = str(data.get("ev_atan", data.get("ev_atan_05", "75"))).replace("%", "")
        dep_atan = str(data.get("dep_atan", data.get("dep_atan_05", "70"))).replace("%", "")
        oran = data.get("oran", "1.85")
        lig = data.get("lig", "")
        
        # TakÄ±m renklerini bul
        ev_renk = self._takim_rengi_bul(ev_takim)
        dep_renk = self._takim_rengi_bul(dep_takim)
        
        # GÃ¶rsel oluÅŸtur
        img = Image.new('RGB', (width, height), '#0a0a0a')
        draw = ImageDraw.Draw(img)
        
        # Font yÃ¼kle
        try:
            font_huge = ImageFont.truetype("arialbd.ttf", 72)
            font_large = ImageFont.truetype("arialbd.ttf", 48)
            font_medium = ImageFont.truetype("arial.ttf", 32)
            font_small = ImageFont.truetype("arial.ttf", 24)
        except:
            font_huge = ImageFont.load_default()
            font_large = font_huge
            font_medium = font_huge
            font_small = font_huge
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ARKA PLAN - TakÄ±m renkleriyle gradient
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        if self.var_gorsel_gradient.get():
            ev_rgb = tuple(int(ev_renk["birincil"].lstrip('#')[i:i+2], 16) for i in (0, 2, 4))
            dep_rgb = tuple(int(dep_renk["birincil"].lstrip('#')[i:i+2], 16) for i in (0, 2, 4))
            
            for x in range(width):
                ratio = x / width
                r = int(ev_rgb[0] * (1 - ratio) * 0.3 + dep_rgb[0] * ratio * 0.3)
                g = int(ev_rgb[1] * (1 - ratio) * 0.3 + dep_rgb[1] * ratio * 0.3)
                b = int(ev_rgb[2] * (1 - ratio) * 0.3 + dep_rgb[2] * ratio * 0.3)
                draw.line([(x, 0), (x, height)], fill=(r, g, b))
        
        # KaranlÄ±k overlay
        overlay = Image.new('RGBA', (width, height), (0, 0, 0, 150))
        img = Image.alpha_composite(img.convert('RGBA'), overlay).convert('RGB')
        draw = ImageDraw.Draw(img)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # SCANLINES EFEKTÄ°
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        if self.var_gorsel_scanlines.get():
            for y in range(0, height, 4):
                draw.line([(0, y), (width, y)], fill=(0, 0, 0), width=1)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # MOD'A GÃ–RE Ä°Ã‡ERÄ°K
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        if mod == "vs":
            self._gorsel_vs_mode(draw, img, width, height, ev_takim, dep_takim, 
                                ev_renk, dep_renk, tahmin, guven, font_huge, font_large, font_medium, font_small)
        elif mod == "stats":
            self._gorsel_stats_mode(draw, width, height, ev_takim, dep_takim,
                                   xg_ev, xg_dep, ev_atan, dep_atan, tahmin, guven, lig,
                                   font_large, font_medium, font_small)
        else:  # prediction
            self._gorsel_prediction_mode(draw, img, width, height, mac_adi, tahmin, 
                                        guven, oran, ev_renk, font_huge, font_large, font_medium, font_small)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # VIGNETTE EFEKTÄ°
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        if self.var_gorsel_vignette.get():
            vignette = Image.new('RGBA', (width, height), (0, 0, 0, 0))
            vdraw = ImageDraw.Draw(vignette)
            
            # KÃ¶ÅŸeleri karart
            for i in range(min(width, height) // 3):
                alpha = int(255 * (1 - i / (min(width, height) // 3)) * 0.7)
                vdraw.rectangle([i, i, width-i, height-i], outline=(0, 0, 0, alpha))
            
            img = Image.alpha_composite(img.convert('RGBA'), vignette).convert('RGB')
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ALT BAR - Telegram
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        draw = ImageDraw.Draw(img)
        bar_height = 60
        draw.rectangle([0, height - bar_height, width, height], fill="#1a1a1a")
        draw.text((width // 2, height - bar_height // 2), "ğŸ“¢ t.me/DoksanDakikaAnaliz", 
                 fill="#00aaff", font=font_small, anchor="mm")
        
        # Ã–nizleme gÃ¶ster
        self._gorsel_onizleme_goster(img)
        
        # PIL image'Ä± sakla
        self.gorsel_pil_image = img
        
        self.lbl_status.config(text="âœ… GÃ¶rsel oluÅŸturuldu!", fg=self.theme["success"])
    
    def _gorsel_vs_mode(self, draw, img, width, height, ev_takim, dep_takim, 
                        ev_renk, dep_renk, tahmin, guven, font_huge, font_large, font_medium, font_small):
        """ğŸ† VS MODE - TakÄ±m vs TakÄ±m"""
        
        # Ortada VS yazÄ±sÄ±
        vs_y = height // 2 - 50
        
        # Neon glow efekti iÃ§in VS
        for offset in range(10, 0, -2):
            alpha = 255 - offset * 20
            draw.text((width // 2 + offset, vs_y), "VS", fill=(255, 100, 0), font=font_huge, anchor="mm")
            draw.text((width // 2 - offset, vs_y), "VS", fill=(255, 100, 0), font=font_huge, anchor="mm")
        draw.text((width // 2, vs_y), "VS", fill="#FFFFFF", font=font_huge, anchor="mm")
        
        # Sol taraf - Ev takÄ±mÄ±
        ev_color = ev_renk["birincil"]
        draw.rectangle([0, 150, width // 2 - 50, 250], fill=ev_color)
        draw.text((width // 4, 200), ev_takim.upper()[:15], fill="#000000", font=font_large, anchor="mm")
        
        # SaÄŸ taraf - Deplasman takÄ±mÄ±
        dep_color = dep_renk["birincil"]
        draw.rectangle([width // 2 + 50, 150, width, 250], fill=dep_color)
        draw.text((width * 3 // 4, 200), dep_takim.upper()[:15], fill="#000000", font=font_large, anchor="mm")
        
        # Alt kÄ±sÄ±m - Tahmin kutusu
        box_y = height - 250
        draw.rectangle([100, box_y, width - 100, box_y + 120], fill="#1a1a2e", outline="#00ff00", width=3)
        draw.text((width // 2, box_y + 35), f"ğŸ¯ TAHMÄ°N: {tahmin}", fill="#00ff00", font=font_large, anchor="mm")
        draw.text((width // 2, box_y + 85), f"ğŸ“Š GÃœVEN: {guven}/10", fill="#ffffff", font=font_medium, anchor="mm")
    
    def _gorsel_prediction_mode(self, draw, img, width, height, mac_adi, tahmin, 
                                guven, oran, ev_renk, font_huge, font_large, font_medium, font_small):
        """ğŸ”¥ PREDICTION MODE - BÃ¼yÃ¼k Tahmin + Neon"""
        
        # Ãœst - MaÃ§ adÄ±
        draw.rectangle([50, 100, width - 50, 180], fill="#1a1a2e", outline="#ff6600", width=2)
        draw.text((width // 2, 140), mac_adi.upper()[:35], fill="#ffffff", font=font_medium, anchor="mm")
        
        # Orta - DEV TAHMÄ°N
        tahmin_y = height // 2 - 30
        
        # Neon glow efekti
        glow_color = (255, 102, 0)  # Turuncu
        for offset in range(20, 0, -2):
            alpha_color = (glow_color[0], glow_color[1], glow_color[2])
            draw.text((width // 2, tahmin_y + offset // 2), tahmin, fill=alpha_color, font=font_huge, anchor="mm")
            draw.text((width // 2, tahmin_y - offset // 2), tahmin, fill=alpha_color, font=font_huge, anchor="mm")
        
        # Ana yazÄ±
        draw.text((width // 2, tahmin_y), tahmin, fill="#FFFFFF", font=font_huge, anchor="mm")
        
        # AteÅŸ emojileri
        fire_y = tahmin_y + 80
        try:
            guven_int = int(guven)
        except:
            guven_int = 8
        fire_count = min(guven_int, 10)
        fire_text = "ğŸ”¥" * fire_count
        draw.text((width // 2, fire_y), fire_text, fill="#ff6600", font=font_medium, anchor="mm")
        
        # Alt kutular - GÃ¼ven ve Oran
        box_width = 200
        box_height = 100
        box_y = height - 280
        
        # GÃ¼ven kutusu
        draw.rectangle([width // 4 - box_width // 2, box_y, width // 4 + box_width // 2, box_y + box_height], 
                      fill="#0a2a0a", outline="#00ff00", width=2)
        draw.text((width // 4, box_y + 30), "GÃœVEN", fill="#00ff00", font=font_small, anchor="mm")
        draw.text((width // 4, box_y + 70), f"{guven}/10", fill="#ffffff", font=font_large, anchor="mm")
        
        # Oran kutusu
        draw.rectangle([width * 3 // 4 - box_width // 2, box_y, width * 3 // 4 + box_width // 2, box_y + box_height], 
                      fill="#2a2a0a", outline="#ffd700", width=2)
        draw.text((width * 3 // 4, box_y + 30), "ORAN", fill="#ffd700", font=font_small, anchor="mm")
        draw.text((width * 3 // 4, box_y + 70), str(oran), fill="#ffffff", font=font_large, anchor="mm")
    
    def _gorsel_stats_mode(self, draw, width, height, ev_takim, dep_takim,
                          xg_ev, xg_dep, ev_atan, dep_atan, tahmin, guven, lig,
                          font_large, font_medium, font_small):
        """ğŸ“Š STATS MODE - Ä°statistik BarlarÄ±"""
        
        # BaÅŸlÄ±k
        draw.rectangle([50, 80, width - 50, 160], fill="#1a1a2e", outline="#00ffff", width=2)
        draw.text((width // 2, 100), "ğŸ“Š MAÃ‡ ANALÄ°ZÄ°", fill="#00ffff", font=font_large, anchor="mm")
        draw.text((width // 2, 140), f"{ev_takim} vs {dep_takim}", fill="#ffffff", font=font_medium, anchor="mm")
        
        # Ä°statistik barlarÄ±
        bar_x = 100
        bar_width = width - 200
        bar_height = 40
        bar_start_y = 220
        bar_gap = 100
        
        stats = [
            ("xG EV", xg_ev, 3.0, "#00ff00"),
            ("xG DEP", xg_dep, 3.0, "#ff6600"),
            ("EV GOL %", ev_atan, 100, "#00aaff"),
            ("DEP GOL %", dep_atan, 100, "#ff00ff"),
        ]
        
        for i, (label, value, max_val, color) in enumerate(stats):
            y = bar_start_y + i * bar_gap
            
            # Etiket
            draw.text((bar_x, y - 25), label, fill="#aaaaaa", font=font_small, anchor="lm")
            
            # Arka plan bar
            draw.rectangle([bar_x, y, bar_x + bar_width, y + bar_height], fill="#1a1a1a", outline="#333333")
            
            # DeÄŸer barÄ±
            try:
                val = float(str(value).replace("%", ""))
                fill_width = int((val / max_val) * bar_width)
                fill_width = min(fill_width, bar_width)
            except:
                fill_width = bar_width // 2
            
            draw.rectangle([bar_x, y, bar_x + fill_width, y + bar_height], fill=color)
            
            # DeÄŸer yazÄ±sÄ±
            draw.text((bar_x + bar_width + 20, y + bar_height // 2), str(value), 
                     fill="#ffffff", font=font_medium, anchor="lm")
        
        # Alt kÄ±sÄ±m - Tahmin
        box_y = height - 280
        draw.rectangle([100, box_y, width - 100, box_y + 130], fill="#0a1a2a", outline="#00ffff", width=3)
        draw.text((width // 2, box_y + 40), f"ğŸ¯ BANKO: {tahmin}", fill="#00ffff", font=font_large, anchor="mm")
        draw.text((width // 2, box_y + 95), f"ğŸ“Š GÃœVEN: {guven}/10", fill="#ffffff", font=font_medium, anchor="mm")
    
    def _gorsel_onizleme_goster(self, img):
        """Ã–nizleme panelinde gÃ¶ster"""
        if not hasattr(self, 'frm_gorsel_onizleme'):
            return
        
        # Ã–nizleme boyutuna kÃ¼Ã§Ã¼lt
        preview_width = 400
        ratio = preview_width / img.width
        preview_height = int(img.height * ratio)
        
        img_preview = img.resize((preview_width, preview_height), Image.Resampling.LANCZOS)
        
        # PhotoImage'a Ã§evir
        self.gorsel_image = ImageTk.PhotoImage(img_preview)
        
        # Label'Ä± gÃ¼ncelle
        self.lbl_gorsel_onizleme.config(image=self.gorsel_image, text="")
    
    def gorsel_ai_arkaplan(self):
        """ğŸ¤– AI ARKA PLAN - HuggingFace Entegrasyonu"""
        try:
            import requests
            
            self.lbl_status.config(text="ğŸ¤– AI arka plan oluÅŸturuluyor...", fg=self.theme["warning"])
            self.root.update()
            
            # HuggingFace API
            API_URL = "https://api-inference.huggingface.co/models/runwayml/stable-diffusion-v1-5"
            
            # Prompt oluÅŸtur
            prompt = "Dark football stadium at night, dramatic lighting, smoke effects, cinematic, 4k, professional sports photography"
            
            headers = {"Authorization": "Bearer hf_demo"}  # Ãœcretsiz demo token
            
            response = requests.post(API_URL, headers=headers, json={"inputs": prompt}, timeout=30)
            
            if response.status_code == 200:
                # GÃ¶rsel al
                from io import BytesIO
                ai_img = Image.open(BytesIO(response.content))
                
                # BoyutlandÄ±r
                boyut = self.combo_gorsel_boyut.get() if hasattr(self, 'combo_gorsel_boyut') else "Instagram Post"
                if "Story" in boyut:
                    width, height = 1080, 1920
                elif "Twitter" in boyut:
                    width, height = 1200, 675
                else:
                    width, height = 1080, 1350
                
                ai_img = ai_img.resize((width, height), Image.Resampling.LANCZOS)
                
                # Karartma overlay
                overlay = Image.new('RGBA', (width, height), (0, 0, 0, 180))
                ai_img = Image.alpha_composite(ai_img.convert('RGBA'), overlay).convert('RGB')
                
                # Ãœzerine yazÄ±larÄ± ekle
                self._gorsel_ai_uzerine_yaz(ai_img)
                
                self.lbl_status.config(text="âœ… AI gÃ¶rsel oluÅŸturuldu!", fg=self.theme["success"])
            else:
                # Fallback - normal gÃ¶rsel
                messagebox.showinfo("Bilgi", "AI servisi ÅŸu an meÅŸgul. Normal gÃ¶rsel oluÅŸturuluyor...")
                self.gorsel_olustur_v2()
                
        except Exception as e:
            messagebox.showwarning("AI UyarÄ±", f"AI servisi kullanÄ±lamÄ±yor: {e}\nNormal gÃ¶rsel oluÅŸturuluyor...")
            self.gorsel_olustur_v2()
    
    def _gorsel_ai_uzerine_yaz(self, img):
        """AI arka plan Ã¼zerine yazÄ±larÄ± ekle"""
        # Prediction mode ile aynÄ± yazÄ±larÄ± ekle
        data = getattr(self, 'gorsel_data', None)
        if not data and self.mac_db:
            data = self.mac_db[-1]
        
        if not data:
            return
        
        draw = ImageDraw.Draw(img)
        width, height = img.size
        
        try:
            font_huge = ImageFont.truetype("arialbd.ttf", 72)
            font_large = ImageFont.truetype("arialbd.ttf", 48)
            font_medium = ImageFont.truetype("arial.ttf", 32)
            font_small = ImageFont.truetype("arial.ttf", 24)
        except:
            font_huge = ImageFont.load_default()
            font_large = font_huge
            font_medium = font_huge
            font_small = font_huge
        
        mac_adi = data.get("mac", "TAKIM A vs TAKIM B").replace("_", " ")
        tahmin = data.get("banko", "2.5 ÃœST")
        guven = str(data.get("guven", "8")).replace("/10", "")
        oran = data.get("oran", "1.85")
        
        # Ãœst - MaÃ§ adÄ±
        draw.rectangle([50, 100, width - 50, 180], fill=(26, 26, 46, 200))
        draw.text((width // 2, 140), mac_adi.upper()[:35], fill="#ffffff", font=font_medium, anchor="mm")
        
        # Orta - Tahmin
        tahmin_y = height // 2 - 30
        
        # Glow
        for offset in range(15, 0, -3):
            draw.text((width // 2, tahmin_y), tahmin, fill=(255, 102, 0), font=font_huge, anchor="mm")
        draw.text((width // 2, tahmin_y), tahmin, fill="#FFFFFF", font=font_huge, anchor="mm")
        
        # Alt - Telegram
        bar_height = 60
        draw.rectangle([0, height - bar_height, width, height], fill="#1a1a1a")
        draw.text((width // 2, height - bar_height // 2), "ğŸ“¢ t.me/DoksanDakikaAnaliz", 
                 fill="#00aaff", font=font_small, anchor="mm")
        
        # Ã–nizleme
        self._gorsel_onizleme_goster(img)
        self.gorsel_pil_image = img
    
    def gorsel_kaydet(self):
        """GÃ¶rseli kaydet"""
        if not hasattr(self, 'gorsel_pil_image') or not self.gorsel_pil_image:
            messagebox.showwarning("UyarÄ±", "Ã–nce gÃ¶rsel oluÅŸturun!")
            return
        
        filename = filedialog.asksaveasfilename(
            defaultextension=".png",
            filetypes=[("PNG", "*.png"), ("JPEG", "*.jpg")],
            initialfilename=f"xg_xray_gorsel_{datetime.now().strftime('%Y%m%d_%H%M%S')}.png"
        )
        
        if filename:
            self.gorsel_pil_image.save(filename, quality=95)
            messagebox.showinfo("âœ…", f"GÃ¶rsel kaydedildi:\n{filename}")
    
    def gorsel_telegram_gonder(self):
        """GÃ¶rseli Telegram'a gÃ¶nder"""
        if not hasattr(self, 'gorsel_pil_image') or not self.gorsel_pil_image:
            messagebox.showwarning("UyarÄ±", "Ã–nce gÃ¶rsel oluÅŸturun!")
            return
        
        # GeÃ§ici dosyaya kaydet
        import tempfile
        temp_file = os.path.join(tempfile.gettempdir(), f"xg_xray_temp_{int(time.time())}.png")
        self.gorsel_pil_image.save(temp_file)
        
        # Telegram'a gÃ¶nder
        try:
            self._telegram_gorsel_gonder(temp_file)
            messagebox.showinfo("âœ…", "GÃ¶rsel Telegram'a gÃ¶nderildi!")
        except Exception as e:
            messagebox.showerror("Hata", f"Telegram hatasÄ±: {e}")
        finally:
            # Temp dosyayÄ± sil
            if os.path.exists(temp_file):
                os.remove(temp_file)
    
    def gorsel_olustur(self):
        """PROFESYONEL GÃ–RSEL OLUÅTURUCU - FUTURÄ°STÄ°K TASARIM"""
        baslik = self.entry_gorsel_baslik.get().strip()
        mac = self.entry_gorsel_mac.get().strip()
        tahmin = self.entry_gorsel_tahmin.get().strip()
        guven = self.entry_gorsel_guven.get().strip()
        g1 = self.entry_gorsel_g1.get().strip()
        g2 = self.entry_gorsel_g2.get().strip()
        g3 = self.entry_gorsel_g3.get().strip()
        
        sablon = self.combo_gorsel_sablon.get()
        boyut = self.combo_gorsel_boyut.get()
        
        # Boyut ayarla (4:5 oran iÃ§in 1080x1350 ideal)
        if "Story" in boyut:
            width, height = 1080, 1920
        elif "Banner" in boyut:
            width, height = 1200, 628
        else:  # Post 4:5
            width, height = 1080, 1350
        
        # Renk ÅŸemasÄ±
        if "AteÅŸli" in sablon:
            bg_primary = "#0d0d0d"
            bg_secondary = "#1a1a1a"
            accent_1 = "#ff6600"
            accent_2 = "#ff9933"
            glow_color = (255, 102, 0)
        elif "Premium" in sablon:
            bg_primary = "#0a0a0a"
            bg_secondary = "#151515"
            accent_1 = "#ffd700"
            accent_2 = "#ffec80"
            glow_color = (255, 215, 0)
        elif "Neon" in sablon:
            bg_primary = "#0a0a1a"
            bg_secondary = "#151530"
            accent_1 = "#00ffff"
            accent_2 = "#00ff88"
            glow_color = (0, 255, 255)
        else:  # Klasik veya Futbol
            bg_primary = "#050a05"
            bg_secondary = "#0a150a"
            accent_1 = "#00ff00"
            accent_2 = "#00cc66"
            glow_color = (0, 255, 0)
        
        # GÃ¶rsel oluÅŸtur
        img = Image.new('RGB', (width, height), bg_primary)
        draw = ImageDraw.Draw(img)
        
        # Font yÃ¼kle
        try:
            font_title = ImageFont.truetype("segoeuib.ttf", 52)
            font_match = ImageFont.truetype("segoeuib.ttf", 38)
            font_tahmin = ImageFont.truetype("segoeuib.ttf", 42)
            font_medium = ImageFont.truetype("segoeui.ttf", 28)
            font_small = ImageFont.truetype("segoeui.ttf", 22)
            font_tiny = ImageFont.truetype("segoeui.ttf", 18)
        except:
            try:
                font_title = ImageFont.truetype("arial.ttf", 52)
                font_match = ImageFont.truetype("arial.ttf", 38)
                font_tahmin = ImageFont.truetype("arial.ttf", 42)
                font_medium = ImageFont.truetype("arial.ttf", 28)
                font_small = ImageFont.truetype("arial.ttf", 22)
                font_tiny = ImageFont.truetype("arial.ttf", 18)
            except:
                font_title = ImageFont.load_default()
                font_match = font_title
                font_tahmin = font_title
                font_medium = font_title
                font_small = font_title
                font_tiny = font_title
        
        # === ARKA PLAN EFEKTLER ===
        # Gradient arka plan
        for y in range(height):
            ratio = y / height
            r = int(int(bg_primary[1:3], 16) * (1 - ratio * 0.5))
            g = int(int(bg_primary[3:5], 16) * (1 - ratio * 0.3))
            b = int(int(bg_primary[5:7], 16) * (1 - ratio * 0.5))
            draw.line([(0, y), (width, y)], fill=(max(0, r), max(0, g), max(0, b)))
        
        # Futbol sahasÄ± Ã§izgileri (soluk)
        line_color = (30, 60, 30)
        # Orta Ã§ember
        draw.ellipse([width//2-150, height//2-150, width//2+150, height//2+150], outline=line_color, width=2)
        draw.ellipse([width//2-5, height//2-5, width//2+5, height//2+5], fill=line_color)
        # Yatay Ã§izgiler
        for i in range(5):
            y_line = 200 + i * 200
            draw.line([(50, y_line), (width-50, y_line)], fill=line_color, width=1)
        # Dikey Ã§izgiler
        draw.line([(width//2, 100), (width//2, height-100)], fill=line_color, width=1)
        
        # Data akÄ±ÅŸ Ã§izgileri (neon efekt)
        for i in range(8):
            x_start = 30 + i * 130
            draw.line([(x_start, 0), (x_start + 50, height)], fill=(glow_color[0]//8, glow_color[1]//8, glow_color[2]//8), width=1)
        
        # === ÃœST HEADER ===
        # Header arka plan (gradient)
        header_height = 130
        for y in range(header_height):
            alpha = 1 - (y / header_height) * 0.7
            r = int(glow_color[0] * alpha * 0.3)
            g = int(glow_color[1] * alpha * 0.3)
            b = int(glow_color[2] * alpha * 0.3)
            draw.line([(0, y), (width, y)], fill=(r, g, b))
        
        # Header Ã§erÃ§eve
        draw.rectangle([0, 0, width, header_height], outline=accent_1, width=3)
        
        # BaÅŸlÄ±k
        baslik_temiz = baslik.upper().replace("GÃœNÃœN", "GUNUN").replace("Ã–", "O").replace("Ãœ", "U").replace("Ä°", "I").replace("Å", "S").replace("Ä", "G").replace("Ã‡", "C")
        draw.text((width//2, 65), baslik_temiz, fill=accent_1, font=font_title, anchor="mm")
        
        # === MAÃ‡ ALANI ===
        y_pos = 180
        
        # MaÃ§ adÄ± arka planÄ±
        mac_box_y = y_pos
        draw.rectangle([60, mac_box_y, width-60, mac_box_y + 80], fill=bg_secondary, outline=accent_1, width=2)
        
        # MaÃ§ adÄ±
        mac_temiz = mac.upper() if mac else "MAC ADI"
        draw.text((width//2, mac_box_y + 40), mac_temiz, fill="#ffffff", font=font_match, anchor="mm")
        
        # === TAHMÄ°N KUTUSU (ANA ODAK) ===
        y_pos = mac_box_y + 120
        
        # Glow efekti iÃ§in dÄ±ÅŸ Ã§erÃ§eveler
        for i in range(3):
            offset = 3 - i
            alpha = 0.3 - i * 0.1
            glow = (int(glow_color[0] * alpha), int(glow_color[1] * alpha), int(glow_color[2] * alpha))
            draw.rectangle([100-offset, y_pos-offset, width-100+offset, y_pos+90+offset], outline=glow, width=2)
        
        # Ana tahmin kutusu
        draw.rectangle([100, y_pos, width-100, y_pos+90], fill=accent_1, outline="#ffffff", width=2)
        
        # Tahmin yazÄ±sÄ±
        tahmin_text = f"TAHMIN: {tahmin.upper()}" if tahmin else "TAHMIN"
        draw.text((width//2, y_pos + 45), tahmin_text, fill=bg_primary, font=font_tahmin, anchor="mm")
        
        # === GÃœVEN BARI ===
        y_pos += 130
        
        # GÃ¼ven deÄŸerini parse et
        try:
            guven_val = int(guven.split("/")[0]) if "/" in guven else int(guven.replace("/10", ""))
        except:
            guven_val = 8
        
        draw.text((width//2, y_pos), f"GUVEN: {guven_val}/10", fill=accent_1, font=font_medium, anchor="mm")
        
        # GÃ¼ven barÄ±
        y_pos += 40
        bar_width = 600
        bar_x = (width - bar_width) // 2
        bar_height = 20
        
        # Bar arka planÄ±
        draw.rectangle([bar_x, y_pos, bar_x + bar_width, y_pos + bar_height], fill="#333333", outline=accent_1, width=1)
        
        # Bar doluluk
        fill_width = int(bar_width * guven_val / 10)
        if fill_width > 0:
            # Gradient fill
            for i in range(fill_width):
                ratio = i / bar_width
                r = int(glow_color[0] * (0.5 + ratio * 0.5))
                g = int(glow_color[1] * (0.5 + ratio * 0.5))
                b = int(glow_color[2] * (0.5 + ratio * 0.5))
                draw.line([(bar_x + i, y_pos + 1), (bar_x + i, y_pos + bar_height - 1)], fill=(r, g, b))
        
        # === GEREKÃ‡ELER BAÅLIÄI ===
        y_pos += 50
        draw.text((width//2, y_pos), "GEREKCELER", fill="#888888", font=font_medium, anchor="mm")
        
        # === 3 GENÄ°ÅLETÄ°LMÄ°Å MODÃœL (UZUN METÄ°N DESTEKLÄ°) ===
        y_pos += 45
        panel_height = 220  # DAHA YÃœKSEK MODÃœLLER
        panel_margin = 25
        panel_width = (width - 4 * panel_margin) // 3
        
        gerekceler = [g1, g2, g3]
        icon_labels = ["TREND", "xG", "CONV"]  # Ä°kon etiketleri
        
        # VarsayÄ±lan gerekÃ§eler
        defaults = [
            "Ortalama istatistigi %88 ile cok yuksek. Bu durum takimin genel performansinin istikrarli ve yuksek oldugunu gosterir.",
            "Toplam gol beklentisi xG 3.33 ile 3 gol barajini asiyor. Bu veri macta bol gol pozisyonu ve yuksek skor potansiyeli olduguna isaret eder.",
            "Iki takimin da conversion oranlari %10'un uzerinde, bu da yaratilan pozisyonlarin gole cevrilme potansiyelini artiriyor."
        ]
        
        for i in range(3):
            panel_x = panel_margin + i * (panel_width + panel_margin)
            gerekce = gerekceler[i] if gerekceler[i] else defaults[i]
            
            # ModÃ¼l arka planÄ± (gradient)
            for dy in range(panel_height):
                ratio = dy / panel_height
                r = int(10 + ratio * 8)
                g = int(20 + ratio * 12)
                b = int(35 + ratio * 15)
                draw.line([(panel_x, y_pos + dy), (panel_x + panel_width, y_pos + dy)], fill=(r, g, b))
            
            # ModÃ¼l Ã§erÃ§eve (glow efekt)
            for offset in range(3, 0, -1):
                glow = (glow_color[0]//(5-offset), glow_color[1]//(5-offset), glow_color[2]//(5-offset))
                draw.rectangle([panel_x-offset, y_pos-offset, panel_x + panel_width+offset, y_pos + panel_height+offset], outline=glow, width=1)
            
            draw.rectangle([panel_x, y_pos, panel_x + panel_width, y_pos + panel_height], outline=accent_2, width=2)
            
            # Ãœst header - numara ve ikon
            header_h = 45
            header_color = (glow_color[0]//5, glow_color[1]//5, glow_color[2]//5)
            draw.rectangle([panel_x+1, y_pos+1, panel_x + panel_width-1, y_pos + header_h], fill=header_color)
            
            # Numara dairesi
            num_x = panel_x + 28
            num_y = y_pos + header_h//2
            draw.ellipse([num_x-16, num_y-16, num_x+16, num_y+16], fill=accent_1)
            draw.text((num_x, num_y), str(i+1), fill="#000000", font=font_medium, anchor="mm")
            
            # Ä°kon etiketi
            draw.text((panel_x + panel_width//2 + 15, num_y), icon_labels[i], fill=accent_1, font=font_small, anchor="mm")
            
            # GerekÃ§e metni - UZUN METÄ°N DESTEÄÄ°
            text_start_y = y_pos + header_h + 12
            text_margin = 12
            
            # TÃ¼rkÃ§e karakterleri temizle
            gerekce_clean = gerekce
            for tr, en in [("Ä°","I"),("Ä±","i"),("Ã–","O"),("Ã¶","o"),("Ãœ","U"),("Ã¼","u"),("Å","S"),("ÅŸ","s"),("Ä","G"),("ÄŸ","g"),("Ã‡","C"),("Ã§","c")]:
                gerekce_clean = gerekce_clean.replace(tr, en)
            
            # Metni satÄ±rlara bÃ¶l (daha uzun satÄ±rlar)
            words = gerekce_clean.split()
            lines = []
            current_line = ""
            max_chars = 24  # SatÄ±r baÅŸÄ±na karakter
            
            for word in words:
                test_line = current_line + " " + word if current_line else word
                if len(test_line) <= max_chars:
                    current_line = test_line
                else:
                    if current_line:
                        lines.append(current_line)
                    current_line = word
            if current_line:
                lines.append(current_line)
            
            # SatÄ±rlarÄ± Ã§iz (max 9 satÄ±r)
            line_height = 18
            for j, line in enumerate(lines[:9]):
                text_y = text_start_y + j * line_height
                draw.text((panel_x + text_margin, text_y), line, fill="#dddddd", font=font_tiny, anchor="lm")
        
        # === ALT FOOTER ===
        footer_y = height - 80
        
        # Footer arka plan
        for y in range(footer_y, height):
            alpha = (y - footer_y) / 100
            r = int(glow_color[0] * alpha * 0.2)
            g = int(glow_color[1] * alpha * 0.2)
            b = int(glow_color[2] * alpha * 0.2)
            draw.line([(0, y), (width, y)], fill=(r, g, b))
        
        # Footer Ã§izgisi
        draw.line([(50, footer_y), (width-50, footer_y)], fill=accent_1, width=2)
        
        # Marka
        draw.text((width//2, height - 50), "90 Dakika Analiz", fill=accent_1, font=font_medium, anchor="mm")
        
        # KÃ¶ÅŸe sÃ¼sleri
        corner_size = 30
        # Sol Ã¼st
        draw.line([(0, corner_size), (0, 0), (corner_size, 0)], fill=accent_1, width=3)
        # SaÄŸ Ã¼st
        draw.line([(width-corner_size, 0), (width, 0), (width, corner_size)], fill=accent_1, width=3)
        # Sol alt
        draw.line([(0, height-corner_size), (0, height), (corner_size, height)], fill=accent_1, width=3)
        # SaÄŸ alt
        draw.line([(width-corner_size, height), (width, height), (width, height-corner_size)], fill=accent_1, width=3)
        
        # === Ã–NÄ°ZLEME ===
        self.gorsel_image = img
        
        # KÃ¼Ã§Ã¼lt ve gÃ¶ster
        preview_size = (350, 440) if "Post" in boyut else (350, 180) if "Banner" in boyut else (200, 350)
        img_preview = img.copy()
        img_preview.thumbnail(preview_size, Image.Resampling.LANCZOS)
        
        photo = ImageTk.PhotoImage(img_preview)
        self.lbl_gorsel_onizleme.config(image=photo, text="")
        self.lbl_gorsel_onizleme.image = photo
        
        self.lbl_status.config(text="âœ… Profesyonel gÃ¶rsel oluÅŸturuldu!", fg=self.theme["success"])
    
    def gorsel_ai_olustur(self):
        """2 AÅAMALI AI GÃ–RSEL: AI Arka Plan + PIL YazÄ±lar"""
        baslik = self.entry_gorsel_baslik.get().strip() or "GÃœNÃœN BANKOSI"
        mac = self.entry_gorsel_mac.get().strip() or "TAKIM A vs TAKIM B"
        tahmin = self.entry_gorsel_tahmin.get().strip() or "MS 1.5 ÃœST"
        guven = self.entry_gorsel_guven.get().strip() or "8/10"
        g1 = self.entry_gorsel_g1.get().strip()
        g2 = self.entry_gorsel_g2.get().strip()
        g3 = self.entry_gorsel_g3.get().strip()
        
        self.lbl_status.config(text="ğŸ¤– AI arka plan oluÅŸturuluyor...", fg=self.theme["warning"])
        self.root.update()
        
        # AÅAMA 1: AI'dan sadece arka plan iste (yazÄ±sÄ±z)
        prompt = "dark futuristic sports analytics background, tactical football pitch with glowing lines, circuit board patterns, neon blue and green accents, cyberpunk aesthetic, high tech UI elements, data visualization grid, purple undertones, no text, no words, no letters, clean background template, vertical orientation, professional quality"
        
        try:
            import urllib.request
            import urllib.parse
            from io import BytesIO
            
            # Pollinations.ai URL
            encoded_prompt = urllib.parse.quote(prompt, safe='')
            url = f"https://image.pollinations.ai/prompt/{encoded_prompt}?width=1080&height=1350&nologo=true"
            
            self.lbl_status.config(text="ğŸŒ AI arka plan indiriliyor (30-60 sn)...", fg=self.theme["warning"])
            self.root.update()
            
            # Arka planÄ± indir
            req = urllib.request.Request(url)
            req.add_header('User-Agent', 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36')
            
            with urllib.request.urlopen(req, timeout=90) as response:
                image_data = response.read()
            
            # PIL Image oluÅŸtur
            bg_img = Image.open(BytesIO(image_data))
            if bg_img.mode == 'RGBA':
                bg_img = bg_img.convert('RGB')
            
            # Boyutu ayarla
            bg_img = bg_img.resize((1080, 1350), Image.Resampling.LANCZOS)
            
            self.lbl_status.config(text="âœï¸ YazÄ±lar ekleniyor...", fg=self.theme["warning"])
            self.root.update()
            
            # AÅAMA 2: YazÄ±larÄ± ekle
            img = self._gorsel_yazi_ekle(bg_img, baslik, mac, tahmin, guven, g1, g2, g3)
            
            self.gorsel_image = img
            
            # Ã–nizleme gÃ¶ster
            img_preview = img.copy()
            img_preview.thumbnail((350, 440), Image.Resampling.LANCZOS)
            photo = ImageTk.PhotoImage(img_preview)
            self.lbl_gorsel_onizleme.config(image=photo, text="")
            self.lbl_gorsel_onizleme.image = photo
            
            self.lbl_status.config(text="âœ… AI gÃ¶rsel oluÅŸturuldu!", fg=self.theme["success"])
            
        except Exception as e:
            self.lbl_status.config(text=f"âŒ Hata: {str(e)[:40]}", fg=self.theme["error"])
            messagebox.showerror("AI Hata", f"GÃ¶rsel oluÅŸturulamadÄ±:\n{e}\n\nManuel gÃ¶rsel iÃ§in 'OLUÅTUR' butonunu kullanÄ±n.")
    
    def _gorsel_yazi_ekle(self, bg_img, baslik, mac, tahmin, guven, g1, g2, g3):
        """AI arka plan Ã¼zerine profesyonel yazÄ±lar ekle"""
        from PIL import ImageDraw, ImageFont, ImageFilter, ImageEnhance
        
        # Arka planÄ± biraz karart (yazÄ±lar gÃ¶rÃ¼nsÃ¼n)
        enhancer = ImageEnhance.Brightness(bg_img)
        img = enhancer.enhance(0.6)
        
        draw = ImageDraw.Draw(img)
        width, height = img.size
        
        # Renkler
        neon_green = "#00ff00"
        white = "#ffffff"
        dark_bg = "#000000"
        accent = "#00cc66"
        
        # FontlarÄ± yÃ¼kle
        try:
            font_brand = ImageFont.truetype("segoeuib.ttf", 48)
            font_title = ImageFont.truetype("segoeuib.ttf", 42)
            font_match = ImageFont.truetype("segoeuib.ttf", 32)
            font_tahmin = ImageFont.truetype("segoeuib.ttf", 38)
            font_medium = ImageFont.truetype("segoeui.ttf", 28)
            font_small = ImageFont.truetype("segoeui.ttf", 22)
            font_tiny = ImageFont.truetype("segoeui.ttf", 16)
        except:
            try:
                font_brand = ImageFont.truetype("arial.ttf", 48)
                font_title = ImageFont.truetype("arial.ttf", 42)
                font_match = ImageFont.truetype("arial.ttf", 32)
                font_tahmin = ImageFont.truetype("arial.ttf", 38)
                font_medium = ImageFont.truetype("arial.ttf", 28)
                font_small = ImageFont.truetype("arial.ttf", 22)
                font_tiny = ImageFont.truetype("arial.ttf", 16)
            except:
                font_brand = ImageFont.load_default()
                font_title = font_brand
                font_match = font_brand
                font_tahmin = font_brand
                font_medium = font_brand
                font_small = font_brand
                font_tiny = font_brand
        
        # TÃ¼rkÃ§e karakterleri temizle
        def temizle(text):
            return text.replace("Ä°", "I").replace("Ä±", "i").replace("Ã–", "O").replace("Ã¶", "o").replace("Ãœ", "U").replace("Ã¼", "u").replace("Å", "S").replace("ÅŸ", "s").replace("Ä", "G").replace("ÄŸ", "g").replace("Ã‡", "C").replace("Ã§", "c")
        
        # === HEADER: 90DK ANALÄ°Z ===
        y = 40
        # Arka plan ÅŸeridi
        draw.rectangle([0, y-10, width, y+60], fill=(0, 0, 0, 180))
        # Futbol ikonu (basit daire)
        icon_x = width//2 - 150
        draw.ellipse([icon_x-15, y+15, icon_x+15, y+45], outline=neon_green, width=3)
        # Marka yazÄ±sÄ±
        draw.text((width//2, y+30), "90DK ANALIZ", fill=neon_green, font=font_brand, anchor="mm")
        
        # === BAÅLIK BANNER ===
        y = 130
        # Banner arka planÄ±
        draw.rectangle([50, y, width-50, y+70], fill=(0, 50, 0), outline=neon_green, width=3)
        # BaÅŸlÄ±k
        baslik_clean = temizle(baslik.upper())
        draw.text((width//2, y+35), baslik_clean, fill=white, font=font_title, anchor="mm")
        
        # === MAÃ‡ KUTUSU ===
        y = 240
        # Kutu
        draw.rectangle([60, y, width-60, y+80], fill=(20, 20, 30), outline=(100, 100, 100), width=2)
        # MaÃ§ adÄ±
        mac_clean = temizle(mac.upper())
        draw.text((width//2, y+40), mac_clean, fill=white, font=font_match, anchor="mm")
        
        # === TAHMÄ°N KUTUSU ===
        y = 360
        # Glow efekti iÃ§in Ã§oklu Ã§erÃ§eve
        for i in range(5, 0, -1):
            alpha = 50 - i*8
            glow_color = (0, 255//i, 0)
            draw.rectangle([80-i*3, y-i*2, width-80+i*3, y+80+i*2], outline=glow_color, width=2)
        # Ana kutu
        draw.rectangle([80, y, width-80, y+80], fill=neon_green, outline=white, width=3)
        # Tahmin yazÄ±sÄ±
        tahmin_clean = f"TAHMIN: {temizle(tahmin.upper())}"
        draw.text((width//2, y+40), tahmin_clean, fill=dark_bg, font=font_tahmin, anchor="mm")
        
        # === GÃœVEN METRE ===
        y = 480
        # GÃ¼ven deÄŸeri
        try:
            guven_val = int(guven.split("/")[0]) if "/" in guven else int(guven.replace("/10", ""))
        except:
            guven_val = 8
        
        draw.text((width//2, y), f"GUVEN: {guven_val}/10", fill=neon_green, font=font_medium, anchor="mm")
        
        # Progress bar
        y += 40
        bar_width = 600
        bar_x = (width - bar_width) // 2
        bar_h = 25
        # Arka plan
        draw.rectangle([bar_x, y, bar_x + bar_width, y + bar_h], fill=(40, 40, 40), outline=(100, 100, 100), width=1)
        # Doluluk
        fill_w = int(bar_width * guven_val / 10)
        if fill_w > 0:
            draw.rectangle([bar_x+2, y+2, bar_x + fill_w - 2, y + bar_h - 2], fill=neon_green)
        # YÃ¼zde
        draw.text((bar_x + bar_width + 20, y + bar_h//2), f"%{guven_val*10}", fill=white, font=font_small, anchor="lm")
        
        # === GEREKÃ‡ELER ===
        y = 580
        draw.text((width//2, y), "GEREKCELER", fill=(150, 150, 150), font=font_medium, anchor="mm")
        
        # 3 ModÃ¼l
        y += 50
        module_h = 200
        module_margin = 25
        module_w = (width - 4 * module_margin) // 3
        
        gerekceler = [g1, g2, g3]
        defaults = [
            "Ortalama istatistigi cok yuksek. Takim performansi istikrarli.",
            "Toplam gol beklentisi (xG) yuksek. Macta gol potansiyeli var.",
            "Conversion oranlari iyi. Pozisyonlar gole donusuyor."
        ]
        
        for i in range(3):
            mod_x = module_margin + i * (module_w + module_margin)
            gerekce = gerekceler[i] if gerekceler[i] else defaults[i]
            
            # ModÃ¼l arka planÄ±
            draw.rectangle([mod_x, y, mod_x + module_w, y + module_h], fill=(15, 25, 35), outline=accent, width=2)
            
            # Header
            draw.rectangle([mod_x, y, mod_x + module_w, y + 45], fill=(0, 60, 30))
            
            # Numara
            num_x = mod_x + 28
            num_y = y + 22
            draw.ellipse([num_x-16, num_y-16, num_x+16, num_y+16], fill=neon_green)
            draw.text((num_x, num_y), str(i+1), fill=dark_bg, font=font_medium, anchor="mm")
            
            # GerekÃ§e metni
            gerekce_clean = temizle(gerekce)
            words = gerekce_clean.split()
            lines = []
            current = ""
            for word in words:
                test = current + " " + word if current else word
                if len(test) <= 22:
                    current = test
                else:
                    if current:
                        lines.append(current)
                    current = word
            if current:
                lines.append(current)
            
            text_y = y + 60
            for j, line in enumerate(lines[:7]):
                draw.text((mod_x + 12, text_y + j*22), line, fill=(220, 220, 220), font=font_tiny, anchor="lm")
        
        # === FOOTER ===
        y = height - 80
        draw.line([(100, y), (width-100, y)], fill=neon_green, width=2)
        draw.text((width//2, y + 40), "90 DAKIKA ANALIZ", fill=neon_green, font=font_medium, anchor="mm")
        
        # === KÃ–ÅE SÃœSLERÄ° ===
        corner = 30
        draw.line([(0, corner), (0, 0), (corner, 0)], fill=neon_green, width=4)
        draw.line([(width-corner, 0), (width, 0), (width, corner)], fill=neon_green, width=4)
        draw.line([(0, height-corner), (0, height), (corner, height)], fill=neon_green, width=4)
        draw.line([(width-corner, height), (width, height), (width, height-corner)], fill=neon_green, width=4)
        
        return img
    
    def gorsel_ai_olustur_v2(self):
        
        baslik = self.entry_gorsel_baslik.get().strip() or "GÃœNÃœN BANKOSI"
        mac = self.entry_gorsel_mac.get().strip() or "TAKIM A vs TAKIM B"
        tahmin = self.entry_gorsel_tahmin.get().strip() or "MS 1.5 ÃœST"
        guven = self.entry_gorsel_guven.get().strip() or "8/10"
        g1 = self.entry_gorsel_g1.get().strip() or "Ortalama istatistiÄŸi %88 ile Ã§ok yÃ¼ksek."
        g2 = self.entry_gorsel_g2.get().strip() or "Toplam gol beklentisi (xG) 3.33 ile 3 gol barajÄ±nÄ± aÅŸÄ±yor."
        g3 = self.entry_gorsel_g3.get().strip() or "Conversion oranlarÄ± %10'un Ã¼zerinde."
        
        self.lbl_status.config(text="ğŸ¤– AI gÃ¶rsel oluÅŸturuluyor...", fg=self.theme["warning"])
        self.root.update()
        
        # Gemini API ile gÃ¶rsel oluÅŸtur
        prompt = f"""Create a high-tech, dark mode sports analytics infographic for social media with these EXACT details:

BRANDING: "90DK ANALIZ" at the top center with a football icon, glowing green/blue neon style.

TITLE BANNER: "{baslik}" in bold green and white text.

MATCH FIXTURE: "{mac}" in a horizontal bar.

MAIN PREDICTION: "TAHMIN: {tahmin}" in a large, glowing green box.

CONFIDENCE: "GÃœVEN: {guven}" with a progress bar below it.

THREE DATA MODULES labeled "GEREKÃ‡ELER":
Module 1 (trend chart icon): "{g1}"
Module 2 (football icon): "{g2}"  
Module 3 (target icon): "{g3}"

FOOTER: "90 DAKÄ°KA ANALÄ°Z" at the bottom.

STYLE: Futuristic, dark background with glowing tactical football pitch, circuit board patterns, data lines in blue/green/purple. Professional, digital, data-rich appearance. Aspect ratio 4:5."""

        try:
            import google.generativeai as genai
            
            # API Key'i yapÄ±landÄ±r
            api_key = self.entry_api.get().strip() if hasattr(self, 'entry_api') else DEFAULT_API_KEY
            genai.configure(api_key=api_key)
            
            # Gemini 2.0 Flash Experimental (gÃ¶rsel oluÅŸturma destekli)
            model = genai.GenerativeModel('gemini-2.0-flash-exp')
            
            response = model.generate_content(
                prompt,
                generation_config=genai.GenerationConfig(
                    response_mime_type="image/png"
                )
            )
            
            # GÃ¶rsel yanÄ±tÄ± kontrol et
            if response.candidates and response.candidates[0].content.parts:
                for part in response.candidates[0].content.parts:
                    if hasattr(part, 'inline_data') and part.inline_data:
                        # Base64 gÃ¶rsel verisini al
                        import base64
                        from io import BytesIO
                        
                        image_data = base64.b64decode(part.inline_data.data)
                        img = Image.open(BytesIO(image_data))
                        
                        # GÃ¶rseli kaydet ve gÃ¶ster
                        self.gorsel_image = img
                        
                        # Ã–nizleme
                        img_preview = img.copy()
                        img_preview.thumbnail((350, 440), Image.Resampling.LANCZOS)
                        photo = ImageTk.PhotoImage(img_preview)
                        self.lbl_gorsel_onizleme.config(image=photo, text="")
                        self.lbl_gorsel_onizleme.image = photo
                        
                        self.lbl_status.config(text="âœ… AI gÃ¶rsel oluÅŸturuldu!", fg=self.theme["success"])
                        return
            
            # GÃ¶rsel oluÅŸturulamadÄ±ysa alternatif dene
            self.gorsel_ai_alternatif(prompt)
            
        except Exception as e:
            error_msg = str(e)
            if "not supported" in error_msg.lower() or "image" in error_msg.lower():
                # Imagen API dene
                self.gorsel_ai_imagen(baslik, mac, tahmin, guven, g1, g2, g3)
            else:
                self.lbl_status.config(text=f"âŒ AI Hata: {error_msg[:50]}", fg=self.theme["error"])
                messagebox.showerror("AI Hata", f"GÃ¶rsel oluÅŸturulamadÄ±:\n{error_msg}\n\nManuel gÃ¶rsel iÃ§in 'OLUÅTUR' butonunu kullanÄ±n.")
    
    def gorsel_ai_imagen(self, baslik, mac, tahmin, guven, g1, g2, g3):
        """Google Imagen 3 ile gÃ¶rsel oluÅŸtur"""
        try:
            import google.generativeai as genai
            
            # API Key yapÄ±landÄ±r
            api_key = self.entry_api.get().strip() if hasattr(self, "entry_api") else DEFAULT_API_KEY
            genai.configure(api_key=api_key)
            
            # Imagen modeli
            imagen = genai.ImageGenerationModel("imagen-3.0-generate-002")
            
            prompt = f"""A professional sports betting analytics infographic, dark mode, neon green and blue accents.
            
Top: "90DK ANALIZ" branding with football icon
Banner: "{baslik}"
Match: "{mac}"
Prediction box: "TAHMIN: {tahmin}" (glowing green)
Confidence: "GÃœVEN: {guven}" with progress bar
Three data panels showing statistics
Footer: "90 DAKÄ°KA ANALÄ°Z"

Style: Futuristic, high-tech, circuit patterns, tactical pitch background, professional data visualization.
Aspect ratio 4:5, 1080x1350 pixels."""

            result = imagen.generate_images(
                prompt=prompt,
                number_of_images=1,
                aspect_ratio="4:5",
                safety_filter_level="block_only_high",
                person_generation="dont_allow"
            )
            
            if result.images:
                # Ä°lk gÃ¶rseli al
                img_data = result.images[0]._pil_image
                self.gorsel_image = img_data
                
                # Ã–nizleme
                img_preview = img_data.copy()
                img_preview.thumbnail((350, 440), Image.Resampling.LANCZOS)
                photo = ImageTk.PhotoImage(img_preview)
                self.lbl_gorsel_onizleme.config(image=photo, text="")
                self.lbl_gorsel_onizleme.image = photo
                
                self.lbl_status.config(text="âœ… Imagen ile gÃ¶rsel oluÅŸturuldu!", fg=self.theme["success"])
            else:
                raise Exception("GÃ¶rsel Ã¼retilemedi")
                
        except Exception as e:
            self.lbl_status.config(text=f"âŒ Imagen hatasÄ±: {str(e)[:40]}", fg=self.theme["error"])
            # Son Ã§are: manuel gÃ¶rsel
            messagebox.showinfo("Bilgi", "AI gÃ¶rsel ÅŸu an kullanÄ±lamÄ±yor.\nManuel gÃ¶rsel oluÅŸturuluyor...")
            self.gorsel_olustur()
    
    def gorsel_ai_alternatif(self, prompt):
        """Alternatif AI gÃ¶rsel yÃ¶ntemi"""
        try:
            import google.generativeai as genai
            
            # API Key yapÄ±landÄ±r
            api_key = self.entry_api.get().strip() if hasattr(self, "entry_api") else DEFAULT_API_KEY
            genai.configure(api_key=api_key)
            
            # Gemini ile metin tabanlÄ± SVG oluÅŸtur
            model = genai.GenerativeModel('gemini-2.0-flash-exp')
            
            svg_prompt = f"""Create an SVG code for a sports analytics infographic with:
- Dark background (#0a0a1a)
- Neon green (#00ff00) accents
- Title: "90DK ANALIZ"
- Modern, high-tech style
- Size: 1080x1350

{prompt}

Return ONLY the SVG code, nothing else."""

            response = model.generate_content(svg_prompt)
            
            if response.text and "<svg" in response.text:
                # SVG'yi PNG'ye Ã§evir
                import cairosvg
                from io import BytesIO
                
                svg_code = response.text
                # SVG kodunu temizle
                start = svg_code.find("<svg")
                end = svg_code.find("</svg>") + 6
                if start >= 0 and end > start:
                    svg_clean = svg_code[start:end]
                    
                    png_data = cairosvg.svg2png(bytestring=svg_clean.encode())
                    img = Image.open(BytesIO(png_data))
                    
                    self.gorsel_image = img
                    
                    img_preview = img.copy()
                    img_preview.thumbnail((350, 440), Image.Resampling.LANCZOS)
                    photo = ImageTk.PhotoImage(img_preview)
                    self.lbl_gorsel_onizleme.config(image=photo, text="")
                    self.lbl_gorsel_onizleme.image = photo
                    
                    self.lbl_status.config(text="âœ… SVG gÃ¶rsel oluÅŸturuldu!", fg=self.theme["success"])
                    return
            
            # HiÃ§biri Ã§alÄ±ÅŸmadÄ±
            raise Exception("AI gÃ¶rsel oluÅŸturulamadÄ±")
            
        except ImportError:
            # cairosvg yok, manuel gÃ¶rsel
            self.lbl_status.config(text="âš ï¸ cairosvg yok, manuel gÃ¶rsel...", fg=self.theme["warning"])
            self.gorsel_olustur()
        except Exception as e:
            self.lbl_status.config(text=f"âš ï¸ {str(e)[:30]}", fg=self.theme["warning"])
            self.gorsel_olustur()
    
    def gorsel_kaydet(self):
        """GÃ¶rseli kaydet"""
        if not self.gorsel_image:
            messagebox.showwarning("UyarÄ±", "Ã–nce gÃ¶rsel oluÅŸturun!")
            return
        
        dosya = filedialog.asksaveasfilename(
            defaultextension=".png",
            filetypes=[("PNG", "*.png"), ("JPEG", "*.jpg")],
            initialfile=f"tahmin_{datetime.now().strftime('%Y%m%d_%H%M')}.png"
        )
        
        if dosya:
            self.gorsel_image.save(dosya)
            messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… GÃ¶rsel kaydedildi:\n{dosya}")
    
    def gorsel_telegram_gonder(self):
        """GÃ¶rseli Telegram'a gÃ¶nder - KANAL SEÃ‡Ä°CÄ° Ä°LE"""
        if not self.gorsel_image:
            messagebox.showwarning("UyarÄ±", "Ã–nce gÃ¶rsel oluÅŸturun!")
            return
        
        # GeÃ§ici kaydet
        temp_path = os.path.join(BASE_DIR, "temp_gorsel.png")
        self.gorsel_image.save(temp_path)
        
        caption = f"ğŸ¯ {self.entry_gorsel_mac.get()}\nğŸ“Š {self.entry_gorsel_tahmin.get()}"
        
        # Kanal seÃ§ici dialog
        if not self.telegram.channels:
            ok, result = self.telegram.send_photo(temp_path, caption)
            if ok:
                messagebox.showinfo("BaÅŸarÄ±lÄ±", "âœ… GÃ¶rsel gÃ¶nderildi!")
            else:
                messagebox.showerror("Hata", f"âŒ {result}")
        else:
            self.gorsel_kanal_sec_ve_gonder(temp_path, caption)
    
    def gorsel_kanal_sec_ve_gonder(self, foto_path, caption):
        """FotoÄŸraf iÃ§in kanal seÃ§ici"""
        dialog = tk.Toplevel(self.root)
        dialog.title("ğŸ“¤ GÃ¶rsel GÃ¶nder")
        dialog.geometry("400x300")
        dialog.configure(bg=self.theme["bg"])
        dialog.transient(self.root)
        dialog.grab_set()
        
        tk.Label(dialog, text="ğŸ“¢ GÃ¶ndermek istediÄŸiniz kanallarÄ± seÃ§in:", 
                 bg=self.theme["bg"], fg=self.theme["accent"], 
                 font=("Segoe UI", 11, "bold")).pack(pady=10)
        
        frm_list = tk.Frame(dialog, bg=self.theme["bg"])
        frm_list.pack(fill="both", expand=True, padx=20, pady=5)
        
        kanal_vars = []
        for ch in self.telegram.channels:
            var = tk.BooleanVar(value=True)
            cb = tk.Checkbutton(frm_list, 
                               text=f"ğŸ“¢ {ch['name']}",
                               variable=var,
                               bg=self.theme["bg"], fg=self.theme["fg"],
                               selectcolor=self.theme["entry_bg"])
            cb.pack(anchor="w", pady=2)
            kanal_vars.append((ch['chat_id'], var))
        
        def gonder():
            secili = [cid for cid, var in kanal_vars if var.get()]
            if not secili:
                messagebox.showwarning("UyarÄ±", "En az bir kanal seÃ§in!")
                return
            dialog.destroy()
            
            basarili = 0
            for cid in secili:
                ok, _ = self.telegram.send_photo(foto_path, caption, chat_id=cid)
                if ok:
                    basarili += 1
            
            messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… {basarili} kanala gÃ¶nderildi!")
            try:
                os.remove(foto_path)
            except:
                pass
        
        tk.Button(dialog, text="ğŸ“¤ GÃ–NDER", command=gonder,
                  bg="#007bff", fg="white", font=("Segoe UI", 11, "bold")).pack(pady=15)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ORAN TAKÄ°P FONKSÄ°YONLARI (HATA 14)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def oran_gorsel_yukle(self):
        """Oran gÃ¶rselini yÃ¼kle ve Gemini ile oku"""
        file = filedialog.askopenfilename(filetypes=[("GÃ¶rseller", "*.png *.jpg *.jpeg")])
        if not file:
            return
        
        self.txt_oranlar.delete(1.0, tk.END)
        self.txt_oranlar.insert(tk.END, "â³ Oranlar okunuyor...\n")
        
        threading.Thread(target=self._oran_gorsel_oku, args=(file,), daemon=True).start()
    
    def oran_panodan(self):
        """Panodan oran gÃ¶rseli al"""
        try:
            img = ImageGrab.grabclipboard()
            if img:
                path = os.path.join(BASE_DIR, f"oran_{datetime.now().strftime('%H%M%S')}.png")
                img.save(path)
                self.txt_oranlar.delete(1.0, tk.END)
                self.txt_oranlar.insert(tk.END, "â³ Oranlar okunuyor...\n")
                threading.Thread(target=self._oran_gorsel_oku, args=(path,), daemon=True).start()
        except Exception as e:
            self.txt_oranlar.insert(tk.END, f"âŒ Hata: {e}\n")
    
    def _oran_gorsel_oku(self, path):
        """Gemini ile oran gÃ¶rselini oku"""
        try:
            api_key = self.entry_api.get().strip() or DEFAULT_API_KEY
            genai.configure(api_key=api_key)
            model = genai.GenerativeModel("gemini-2.0-flash")
            
            img = Image.open(path)
            
            prompt = """Bu gÃ¶rseldeki bahis oranlarÄ±nÄ± oku ve listele.
Her bahis iÃ§in ÅŸu formatta yaz:
[Bahis TÃ¼rÃ¼]: [Oran]

Ã–rnek:
MS1: 1.45
Beraberlik: 4.50
MS2: 6.00
2.5 Ãœst: 1.65
KG Var: 1.80

Sadece oranlarÄ± listele, baÅŸka bir ÅŸey yazma."""
            
            response = model.generate_content([prompt, img])
            result = response.text
            
            self.root.after(0, lambda: self._oran_sonuc_goster(result))
        except Exception as e:
            self.root.after(0, lambda: self.txt_oranlar.insert(tk.END, f"âŒ Hata: {e}\n"))
    
    def _oran_sonuc_goster(self, result):
        """Okunan oranlarÄ± gÃ¶ster"""
        self.txt_oranlar.delete(1.0, tk.END)
        self.txt_oranlar.insert(tk.END, "ğŸ“Š OKUNAN ORANLAR:\n")
        self.txt_oranlar.insert(tk.END, "="*40 + "\n\n")
        self.txt_oranlar.insert(tk.END, result)
        self.txt_oranlar.insert(tk.END, "\n\nğŸ’¾ 'ORANLARI KAYDET' ile kaydedin.")
    
    def oran_kaydet(self):
        """OranlarÄ± kaydet"""
        # Son analiz varsa ona baÄŸla
        if self.mac_db:
            mac = self.mac_db[-1]
            mac_id = mac.get("id", "")
            
            # Basit kayÄ±t (gerÃ§ek implementasyonda parse edilmeli)
            oranlar_text = self.txt_oranlar.get(1.0, tk.END)
            
            # Oran tracker'a ekle
            self.oran_tracker.add_oran(mac_id, "GENEL", 0, 0)
            self.oran_tracker.save()
            
            messagebox.showinfo("BaÅŸarÄ±lÄ±", "âœ… Oranlar kaydedildi!")
    
    def oran_perf_guncelle(self):
        """Oran aralÄ±ÄŸÄ± performansÄ±nÄ± gÃ¶ster"""
        self.txt_oran_perf.delete(1.0, tk.END)
        self.txt_oran_perf.insert(tk.END, "ğŸ“Š ORAN ARALIÄI PERFORMANSI\n")
        self.txt_oran_perf.insert(tk.END, "="*40 + "\n\n")
        
        stats = self.oran_tracker.get_aralik_stats()
        
        for aralik, data in stats.items():
            if data["toplam"] > 0:
                emoji = "âœ…" if data["basari"] >= 60 else "âš ï¸" if data["basari"] >= 50 else "âŒ"
                self.txt_oran_perf.insert(tk.END, f"{emoji} {aralik}: {data['kazanan']}/{data['toplam']} (%{data['basari']})\n")
            else:
                self.txt_oran_perf.insert(tk.END, f"â¬œ {aralik}: Veri yok\n")
        
        self.txt_oran_perf.insert(tk.END, "\nğŸ’¡ YÃ¼ksek baÅŸarÄ±lÄ± aralÄ±klara odaklan!")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # MARKA FONKSÄ°YONLARI (HATA 12)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def renk_sec(self, tip):
        """Renk seÃ§ici"""
        renk = colorchooser.askcolor(title=f"{tip.capitalize()} Renk SeÃ§")[1]
        if renk:
            if tip == "ana":
                self.btn_renk_ana.config(bg=renk)
                self.brand.set("ana_renk", renk)
            elif tip == "vurgu":
                self.btn_renk_vurgu.config(bg=renk)
                self.brand.set("vurgu_renk", renk)
            elif tip == "arkaplan":
                self.btn_renk_bg.config(bg=renk)
                self.brand.set("arkaplan_renk", renk)
    
    def palet_uygula(self, event=None):
        """HazÄ±r palet uygula"""
        palet = self.combo_palet.get()
        
        paletler = {
            "ğŸŸ¢ Profesyonel (YeÅŸil)": ("#00ff00", "#ffffff", "#0a0a0a"),
            "ğŸ”µ Spor (Mavi)": ("#00b4d8", "#ffffff", "#0d1b2a"),
            "ğŸŸ£ Neon (Mor)": ("#bb86fc", "#00ffff", "#1a0a2e"),
            "ğŸŸ¡ AltÄ±n (SarÄ±)": ("#ffd700", "#ffffff", "#1a1a1a"),
            "ğŸ”´ AteÅŸ (KÄ±rmÄ±zÄ±)": ("#ff4444", "#ffffff", "#0a0a0a")
        }
        
        if palet in paletler:
            ana, vurgu, bg = paletler[palet]
            self.btn_renk_ana.config(bg=ana)
            self.btn_renk_vurgu.config(bg=vurgu)
            self.btn_renk_bg.config(bg=bg)
            self.brand.set("ana_renk", ana)
            self.brand.set("vurgu_renk", vurgu)
            self.brand.set("arkaplan_renk", bg)
    
    def marka_kaydet(self):
        """Marka ayarlarÄ±nÄ± kaydet"""
        self.brand.set("kanal_adi", self.entry_marka_ad.get())
        self.brand.set("telegram", self.entry_marka_tg.get())
        self.brand.set("twitter", self.entry_marka_tw.get())
        self.brand.set("instagram", self.entry_marka_ig.get())
        self.brand.set("watermark_aktif", self.var_watermark.get())
        self.brand.set("watermark_pozisyon", self.combo_wm_pos.get())
        self.brand.set("watermark_opaklik", self.scale_wm_opak.get())
        self.brand.save()
        messagebox.showinfo("BaÅŸarÄ±lÄ±", "âœ… Marka ayarlarÄ± kaydedildi!")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # EXCEL FONKSÄ°YONLARI
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def excel_dosya_sec(self):
        file = filedialog.askopenfilename(filetypes=[("Excel", "*.xlsx")])
        if file:
            self.entry_excel_path.delete(0, tk.END)
            self.entry_excel_path.insert(0, file)
    
    def excel_ekle(self):
        """Son analizi Excel'e ekle - FIX #11: Dosya seÃ§imi ekle"""
        if not EXCEL_AVAILABLE:
            messagebox.showerror("Hata", "openpyxl modÃ¼lÃ¼ yÃ¼klÃ¼ deÄŸil!\npip install openpyxl")
            return
        
        if not self.mac_db:
            messagebox.showwarning("UyarÄ±", "Analiz bulunamadÄ±!")
            return
        
        mac = self.mac_db[-1]
        
        # Ã–nce entry_excel_path var mÄ± kontrol et
        excel_path = ""
        if hasattr(self, 'entry_excel_path'):
            excel_path = self.entry_excel_path.get()
        
        # Dosya yolu yoksa veya geÃ§ersizse seÃ§tir
        if not excel_path or not os.path.exists(excel_path):
            excel_path = filedialog.asksaveasfilename(
                defaultextension=".xlsx",
                filetypes=[("Excel", "*.xlsx")],
                initialfilename=f"analizler_{datetime.now().strftime('%Y%m%d')}.xlsx"
            )
            if not excel_path:
                return
            
            # Entry varsa gÃ¼ncelle
            if hasattr(self, 'entry_excel_path'):
                self.entry_excel_path.delete(0, tk.END)
                self.entry_excel_path.insert(0, excel_path)
        
        try:
            if os.path.exists(excel_path):
                wb = load_workbook(excel_path)
                ws = wb.active
            else:
                wb = Workbook()
                ws = wb.active
                ws.append(["Tarih", "MaÃ§", "Lig", "Banko", "Sigorta", "GÃ¼ven", "xG", "Skor", "SonuÃ§"])
            
            ws.append([
                mac.get("tarih", ""),
                mac.get("mac", mac.get("mac_adi", "")).replace("_", " "),
                mac.get("lig", ""),
                mac.get("banko", ""),
                mac.get("sigorta", ""),
                mac.get("guven", ""),
                mac.get("xg", ""),
                mac.get("skor", mac.get("gercek_skor", "")),
                mac.get("sonuc", "BEKLÄ°YOR")
            ])
            
            wb.save(excel_path)
            
            if hasattr(self, 'txt_excel_log'):
                self.txt_excel_log.insert(tk.END, f"âœ… {mac.get('mac', '?')} eklendi\n")
            
            messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… Excel'e eklendi!\n{excel_path}")
        except Exception as e:
            messagebox.showerror("Hata", f"âŒ {e}")
    
    def excel_gunun_hepsini_ekle(self):
        """GÃ¼nÃ¼n tÃ¼m analizlerini Excel'e ekle"""
        if not EXCEL_AVAILABLE:
            return
        
        tarih = datetime.now().strftime("%d.%m.%Y")
        maclar = [m for m in self.mac_db if m.get("tarih") == tarih]
        
        if not maclar:
            messagebox.showwarning("UyarÄ±", "BugÃ¼n analiz yok!")
            return
        
        excel_path = self.entry_excel_path.get()
        
        try:
            if os.path.exists(excel_path):
                wb = load_workbook(excel_path)
                ws = wb.active
            else:
                wb = Workbook()
                ws = wb.active
                ws.append(["Tarih", "MaÃ§", "Banko", "Sigorta", "GÃ¼ven", "xG", "SonuÃ§"])
            
            for mac in maclar:
                ws.append([
                    mac.get("tarih", ""),
                    mac.get("mac", mac.get("mac_adi", "")).replace("_", " "),
                    mac.get("banko", ""),
                    mac.get("sigorta", ""),
                    mac.get("guven", ""),
                    mac.get("xg", ""),
                    mac.get("sonuc", "BEKLÄ°YOR")
                ])
            
            wb.save(excel_path)
            messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… {len(maclar)} maÃ§ Excel'e eklendi!")
        except Exception as e:
            messagebox.showerror("Hata", f"âŒ {e}")
    
    def excel_ac(self):
        """FIX #21: Excel dosyasÄ±nÄ± aÃ§ - dosya seÃ§ici ile"""
        excel_path = ""
        
        # Ã–nce entry'den dene
        if hasattr(self, 'entry_excel_path'):
            excel_path = self.entry_excel_path.get()
        
        # Dosya yoksa veya geÃ§ersizse seÃ§tir
        if not excel_path or not os.path.exists(excel_path):
            excel_path = filedialog.askopenfilename(
                title="Excel DosyasÄ± SeÃ§",
                filetypes=[("Excel dosyalarÄ±", "*.xlsx *.xlsm *.xls"), ("TÃ¼m dosyalar", "*.*")]
            )
        
        if excel_path and os.path.exists(excel_path):
            try:
                os.startfile(excel_path)
            except Exception as e:
                # Linux/Mac iÃ§in alternatif
                import subprocess
                try:
                    subprocess.Popen(['xdg-open', excel_path])
                except:
                    messagebox.showerror("Hata", f"Dosya aÃ§Ä±lamadÄ±: {e}")
        else:
            messagebox.showwarning("UyarÄ±", "GeÃ§erli bir dosya seÃ§in!")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # WORD FONKSÄ°YONU
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def word_kaydet(self):
        """V70: Analizi Word'e kaydet - FÄ°L HAFIZASI DESTEKLÄ°"""
        if not WORD_AVAILABLE:
            messagebox.showerror("Hata", "python-docx modÃ¼lÃ¼ yÃ¼klÃ¼ deÄŸil!")
            return
        
        # V70: FÄ°L HAFIZASI kontrolÃ¼
        if not self.last_result and not self._analiz_kontrol(goster_uyari=False):
            # last_result yoksa ve analiz de yoksa uyarÄ± ver
            if not self.mac_db and not (hasattr(self, 'mac_arsivi') and self.mac_arsivi):
                messagebox.showwarning("UyarÄ±", "HenÃ¼z analiz yapÄ±lmamÄ±ÅŸ!")
                return
        
        # MaÃ§ ismini bul
        mac_adi = "analiz"
        text = self.last_result or ""
        
        # Metinden maÃ§ adÄ±nÄ± Ã§ek
        mac_match = re.search(r'âš½\s*\*?\*?(.+?(?:VS|vs).+?)\*?\*?\s*\|', text)
        if mac_match:
            mac_adi = mac_match.group(1).strip()
        elif self.mac_db:
            mac_adi = self.mac_db[-1].get("mac", self.mac_db[-1].get("mac_adi", "analiz"))
        
        # Dosya adÄ±nÄ± temizle - geÃ§ersiz karakterleri kaldÄ±r
        mac_adi = mac_adi.replace("**", "").replace("*", "").strip()
        mac_adi = re.sub(r'[<>:"/\\|?*]', '', mac_adi)  # Windows geÃ§ersiz karakterler
        mac_adi = mac_adi.replace("  ", " ").strip()
        
        # Tarih ekle
        tarih_str = datetime.now().strftime('%Y%m%d')
        dosya_adi = f"{mac_adi}_{tarih_str}.docx"
        
        dosya = filedialog.asksaveasfilename(
            defaultextension=".docx",
            filetypes=[("Word", "*.docx")],
            initialfile=dosya_adi
        )
        
        if not dosya:
            return
        
        try:
            doc = Document()
            doc.add_heading("XG-XRAY V5.6 Analiz Raporu", 0)
            doc.add_paragraph(f"MaÃ§: {mac_adi}")
            doc.add_paragraph(f"Tarih: {datetime.now().strftime('%d.%m.%Y %H:%M')}")
            doc.add_paragraph("")
            
            for line in self.last_result.split('\n'):
                if line.strip():
                    doc.add_paragraph(line)
            
            doc.save(dosya)
            messagebox.showinfo("BaÅŸarÄ±lÄ±", f"âœ… Word dosyasÄ± kaydedildi:\n{dosya}")
        except Exception as e:
            messagebox.showerror("Hata", f"âŒ {e}")
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # AYARLAR FONKSÄ°YONLARI
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def tema_degistir(self, tema):
        """Tema deÄŸiÅŸtir - ANINDA uygula"""
        self.current_theme = tema
        self.theme = THEMES[tema]
        self.ayarlar_kaydet()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ANINDA TEMA DEÄÄ°ÅÄ°KLÄ°ÄÄ°
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        try:
            # ModernTheme sÄ±nÄ±fÄ±nÄ± gÃ¼ncelle
            if tema == "ğŸŒ™ Koyu":
                ModernTheme.BG_PRIMARY = "#0a0f1c"
                ModernTheme.BG_SECONDARY = "#111827"
                ModernTheme.BG_CARD = "#1e293b"
                ModernTheme.TEXT_PRIMARY = "#ffffff"
                ModernTheme.TEXT_SECONDARY = "#94a3b8"
                ModernTheme.TEXT_MUTED = "#64748b"
                ModernTheme.ACCENT_PRIMARY = "#3b82f6"
            elif tema == "â˜€ï¸ AÃ§Ä±k":
                ModernTheme.BG_PRIMARY = "#f8fafc"
                ModernTheme.BG_SECONDARY = "#e2e8f0"
                ModernTheme.BG_CARD = "#ffffff"
                ModernTheme.TEXT_PRIMARY = "#1e293b"
                ModernTheme.TEXT_SECONDARY = "#475569"
                ModernTheme.TEXT_MUTED = "#94a3b8"
                ModernTheme.ACCENT_PRIMARY = "#2563eb"
            elif tema == "ğŸ”µ Mavi":
                ModernTheme.BG_PRIMARY = "#0c1929"
                ModernTheme.BG_SECONDARY = "#0f2744"
                ModernTheme.BG_CARD = "#163a5f"
                ModernTheme.TEXT_PRIMARY = "#e0f2fe"
                ModernTheme.TEXT_SECONDARY = "#7dd3fc"
                ModernTheme.TEXT_MUTED = "#38bdf8"
                ModernTheme.ACCENT_PRIMARY = "#0ea5e9"
            elif tema == "ğŸŸ£ Mor":
                ModernTheme.BG_PRIMARY = "#1a0a2e"
                ModernTheme.BG_SECONDARY = "#2d1b4e"
                ModernTheme.BG_CARD = "#3d2a5e"
                ModernTheme.TEXT_PRIMARY = "#f3e8ff"
                ModernTheme.TEXT_SECONDARY = "#c4b5fd"
                ModernTheme.TEXT_MUTED = "#a78bfa"
                ModernTheme.ACCENT_PRIMARY = "#8b5cf6"
            
            # Ana pencere
            self.root.configure(bg=ModernTheme.BG_PRIMARY)
            
            # TÃ¼m widget'larÄ± recursive gÃ¼ncelle
            self._update_widget_theme(self.root)
            
            messagebox.showinfo("âœ… Tema DeÄŸiÅŸti", f"{tema} temasÄ± uygulandÄ±!")
            
        except Exception as e:
            print(f"Tema deÄŸiÅŸtirme hatasÄ±: {e}")
            messagebox.showinfo("Tema", f"âœ… {tema} temasÄ± seÃ§ildi.\nTam uygulama iÃ§in programÄ± yeniden baÅŸlatÄ±n.")
    
    def _update_widget_theme(self, widget):
        """Widget ve alt widget'larÄ±n temasÄ±nÄ± gÃ¼ncelle"""
        try:
            widget_type = widget.winfo_class()
            
            if widget_type in ("Frame", "Labelframe"):
                widget.configure(bg=ModernTheme.BG_PRIMARY)
            elif widget_type == "Label":
                widget.configure(bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
            elif widget_type == "Button":
                widget.configure(bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY)
            elif widget_type == "Entry":
                widget.configure(bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY)
            elif widget_type == "Text":
                widget.configure(bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY)
            elif widget_type == "Canvas":
                widget.configure(bg=ModernTheme.BG_PRIMARY)
        except:
            pass
        
        # Alt widget'larÄ± gÃ¼ncelle
        for child in widget.winfo_children():
            self._update_widget_theme(child)
    
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ”„ GÃœNCELLEME SÄ°STEMÄ° FONKSÄ°YONLARI
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    def _guncelleme_kontrol(self):
        """GitHub'dan son versiyon kontrolÃ¼"""
        self.lbl_update_status.config(text="ğŸ” Kontrol ediliyor...", fg="#ffff00")
        self.root.update()
        
        def kontrol_thread():
            try:
                # version.txt dosyasÄ±nÄ± kontrol et
                response = requests.get(GITHUB_VERSION_URL, timeout=10)
                
                if response.status_code == 200:
                    remote_version = response.text.strip()
                    
                    # Versiyon karÅŸÄ±laÅŸtÄ±r
                    if self._versiyon_karsilastir(remote_version, APP_VERSION):
                        self.root.after(0, lambda: self._guncelleme_mevcut(remote_version))
                    else:
                        self.root.after(0, lambda: self.lbl_update_status.config(
                            text=f"âœ… GÃ¼ncel! (v{APP_VERSION})", fg="#00ff00"))
                else:
                    # version.txt yoksa, doÄŸrudan .py dosyasÄ±ndan versiyon Ã§ek
                    self.root.after(0, lambda: self._py_dosyasindan_versiyon_kontrol())
                    
            except requests.exceptions.ConnectionError:
                self.root.after(0, lambda: self.lbl_update_status.config(
                    text="âŒ Ä°nternet baÄŸlantÄ±sÄ± yok", fg="#ff6666"))
            except Exception as e:
                self.root.after(0, lambda: self.lbl_update_status.config(
                    text=f"âŒ Hata: {str(e)[:30]}", fg="#ff6666"))
        
        threading.Thread(target=kontrol_thread, daemon=True).start()
    
    def _py_dosyasindan_versiyon_kontrol(self):
        """Ana .py dosyasÄ±ndan versiyon kontrolÃ¼"""
        try:
            response = requests.get(GITHUB_RAW_URL, timeout=15)
            if response.status_code == 200:
                # APP_VERSION satÄ±rÄ±nÄ± bul
                match = re.search(r'APP_VERSION\s*=\s*["\']([^"\']+)["\']', response.text)
                if match:
                    remote_version = match.group(1)
                    if self._versiyon_karsilastir(remote_version, APP_VERSION):
                        self._guncelleme_mevcut(remote_version)
                    else:
                        self.lbl_update_status.config(text=f"âœ… GÃ¼ncel! (v{APP_VERSION})", fg="#00ff00")
                else:
                    self.lbl_update_status.config(text="âš ï¸ Versiyon bulunamadÄ±", fg="#ffff00")
            else:
                self.lbl_update_status.config(text=f"âŒ GitHub eriÅŸim hatasÄ± ({response.status_code})", fg="#ff6666")
        except Exception as e:
            self.lbl_update_status.config(text=f"âŒ Hata: {str(e)[:30]}", fg="#ff6666")
    
    def _versiyon_karsilastir(self, remote, local):
        """Versiyon karÅŸÄ±laÅŸtÄ±r - True: gÃ¼ncelleme var"""
        try:
            remote_parts = [int(x) for x in remote.split('.')]
            local_parts = [int(x) for x in local.split('.')]
            
            for i in range(max(len(remote_parts), len(local_parts))):
                r = remote_parts[i] if i < len(remote_parts) else 0
                l = local_parts[i] if i < len(local_parts) else 0
                if r > l:
                    return True
                elif r < l:
                    return False
            return False
        except:
            return remote != local
    
    def _guncelleme_mevcut(self, yeni_versiyon):
        """GÃ¼ncelleme mevcut bildirimi"""
        self.lbl_update_status.config(
            text=f"ğŸ†• Yeni versiyon: v{yeni_versiyon}", fg="#00ff00")
        
        cevap = messagebox.askyesno(
            "ğŸ†• GÃ¼ncelleme Mevcut!",
            f"Yeni versiyon bulundu!\n\n"
            f"Mevcut: v{APP_VERSION}\n"
            f"Yeni: v{yeni_versiyon}\n\n"
            f"Åimdi gÃ¼ncellemek ister misiniz?"
        )
        if cevap:
            self._guncelleme_indir()
    
    def _guncelleme_indir(self):
        """GitHub'dan gÃ¼ncellemeyi indir - Ã¶nce versiyon kontrolÃ¼ yap"""
        self.lbl_update_status.config(text="ğŸ” Kontrol ediliyor...", fg="#ffff00")
        self.root.update()
        
        def indir_thread():
            try:
                # Ã–nce versiyon kontrolÃ¼ yap
                version_response = requests.get(GITHUB_VERSION_URL, timeout=10)
                
                if version_response.status_code == 200:
                    remote_version = version_response.text.strip()
                    
                    # EÄŸer zaten gÃ¼ncelse indirme yapma
                    if not self._versiyon_karsilastir(remote_version, APP_VERSION):
                        self.root.after(0, lambda: self._zaten_guncel())
                        return
                
                # GÃ¼ncelleme var, indir
                self.root.after(0, lambda: self.lbl_update_status.config(
                    text="â¬‡ï¸ Ä°ndiriliyor...", fg="#ffff00"))
                
                # GitHub'dan dosyayÄ± indir
                response = requests.get(GITHUB_RAW_URL, timeout=30)
                
                if response.status_code == 200:
                    # Mevcut dosyanÄ±n yolunu bul
                    current_file = os.path.abspath(__file__)
                    
                    # Yedek al
                    backup_file = current_file + ".backup"
                    try:
                        import shutil
                        shutil.copy2(current_file, backup_file)
                    except:
                        pass
                    
                    # Yeni dosyayÄ± kaydet
                    with open(current_file, 'w', encoding='utf-8') as f:
                        f.write(response.text)
                    
                    self.root.after(0, lambda: self._guncelleme_tamamlandi())
                else:
                    self.root.after(0, lambda: self.lbl_update_status.config(
                        text=f"âŒ Ä°ndirme hatasÄ± ({response.status_code})", fg="#ff6666"))
                    
            except Exception as e:
                self.root.after(0, lambda: messagebox.showerror("Hata", f"Ä°ndirme hatasÄ±:\n{e}"))
                self.root.after(0, lambda: self.lbl_update_status.config(
                    text=f"âŒ Hata: {str(e)[:30]}", fg="#ff6666"))
        
        threading.Thread(target=indir_thread, daemon=True).start()
    
    def _zaten_guncel(self):
        """Zaten gÃ¼ncel mesajÄ±"""
        self.lbl_update_status.config(text=f"âœ… Zaten gÃ¼ncel! (v{APP_VERSION})", fg="#00ff00")
        messagebox.showinfo(
            "âœ… Zaten GÃ¼ncelsiniz!",
            f"ProgramÄ±nÄ±z zaten en gÃ¼ncel sÃ¼rÃ¼mde.\n\n"
            f"Mevcut versiyon: v{APP_VERSION}"
        )
    
    def _guncelleme_tamamlandi(self):
        """GÃ¼ncelleme tamamlandÄ± bildirimi"""
        self.lbl_update_status.config(text="âœ… GÃ¼ncelleme tamamlandÄ±!", fg="#00ff00")
        
        cevap = messagebox.askyesno(
            "âœ… GÃ¼ncelleme TamamlandÄ±!",
            "GÃ¼ncelleme baÅŸarÄ±yla indirildi!\n\n"
            "DeÄŸiÅŸikliklerin geÃ§erli olmasÄ± iÃ§in\n"
            "programÄ± yeniden baÅŸlatmanÄ±z gerekiyor.\n\n"
            "Åimdi yeniden baÅŸlatmak ister misiniz?"
        )
        if cevap:
            self._programi_yeniden_baslat()
    
    def _programi_yeniden_baslat(self):
        """ProgramÄ± yeniden baÅŸlat"""
        try:
            # Verileri kaydet
            self.db_kaydet()
            self.ayarlar_kaydet()
            
            # Python yorumlayÄ±cÄ±sÄ±nÄ± ve dosyayÄ± al
            python = sys.executable
            script = os.path.abspath(__file__)
            
            # Yeni process baÅŸlat
            subprocess.Popen([python, script])
            
            # Mevcut programÄ± kapat
            self.root.quit()
            self.root.destroy()
            sys.exit(0)
            
        except Exception as e:
            messagebox.showerror("Hata", f"Yeniden baÅŸlatma hatasÄ±:\n{e}\n\nLÃ¼tfen programÄ± manuel kapatÄ±p aÃ§Ä±n.")
    
    def _github_ac(self):
        """GitHub sayfasÄ±nÄ± tarayÄ±cÄ±da aÃ§"""
        import webbrowser
        webbrowser.open(f"https://github.com/{GITHUB_USER}/{GITHUB_REPO}")
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def onbellek_temizle(self):
        """GeÃ§ici dosyalarÄ± temizle"""
        temizlenen = 0
        for f in os.listdir(BASE_DIR):
            if f.startswith("pano_") or f.startswith("temp_") or f.startswith("skor_"):
                try:
                    os.remove(os.path.join(BASE_DIR, f))
                    temizlenen += 1
                except:
                    pass
        messagebox.showinfo("Temizlendi", f"âœ… {temizlenen} geÃ§ici dosya silindi.")
    
    def _verileri_sifirla(self):
        """V5.8 YENÄ°: TÃ¼m verileri sÄ±fÄ±rla - Deneme analizlerini temizle"""
        # Onay al
        cevap = messagebox.askyesno(
            "âš ï¸ VERÄ°LERÄ° SIFIRLA",
            "Bu iÅŸlem ÅŸunlarÄ± silecek:\n\n"
            "â€¢ TÃ¼m analiz geÃ§miÅŸi (mac_veritabani.json)\n"
            "â€¢ Performans verileri (performans.json)\n"
            "â€¢ Oranlar verileri (oranlar.json)\n"
            "â€¢ Listeler verileri (listeler.json)\n"
            "â€¢ CanlÄ± bahis verileri (canli_bahis.json)\n"
            "â€¢ ArÅŸiv tablosu\n"
            "â€¢ Dashboard verileri\n\n"
            "âš ï¸ Bu iÅŸlem geri alÄ±namaz!\n\n"
            "Devam etmek istiyor musunuz?"
        )
        
        if not cevap:
            return
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BELLEK DEÄÄ°ÅKENLERÄ°NÄ° Ã–NCE SIFIRLA
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        self.mac_db = []
        self.oranlar = []
        self.listeler = {"1.5_ust": [], "2.5_ust": [], "kg_var": [], "favori": [], "iy_gol": [], "xg_5": []}
        self.canli_bahisler = []
        self.current_analysis = None
        self.last_result = ""
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # BOÅ VERÄ°LERÄ° DOSYALARA KAYDET (SÄ°LMEK YERÄ°NE ÃœSTÃœNE YAZ)
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        try:
            # Ana veritabanÄ± - DB_FILE kullan (mac_veritabani.json)
            with open(DB_FILE, "w", encoding="utf-8") as f:
                json.dump([], f, ensure_ascii=False, indent=2)
            print(f"âœ… {DB_FILE} sÄ±fÄ±rlandÄ±")
        except Exception as e:
            print(f"âŒ DB_FILE sÄ±fÄ±rlama hatasÄ±: {e}")
        
        # DiÄŸer JSON dosyalarÄ±
        json_dosyalari = {
            "performans.json": {"maclar": [], "kurallar": {}, "ligler": {}, "gunluk": {}, "oranlar": {}},
            "oranlar.json": [],
            "listeler.json": {"1.5_ust": [], "2.5_ust": [], "kg_var": [], "favori": [], "iy_gol": [], "xg_5": []},
            "canli_bahis.json": [],
            "favoriler.json": [],
        }
        
        kaydedilen = 0
        for dosya_adi, bos_veri in json_dosyalari.items():
            try:
                dosya_yolu = os.path.join(BASE_DIR, dosya_adi)
                with open(dosya_yolu, "w", encoding="utf-8") as f:
                    json.dump(bos_veri, f, ensure_ascii=False, indent=2)
                kaydedilen += 1
                print(f"âœ… {dosya_adi} sÄ±fÄ±rlandÄ±")
            except Exception as e:
                print(f"âŒ {dosya_adi} sÄ±fÄ±rlama hatasÄ±: {e}")
        
        # Performans tracker'Ä± sÄ±fÄ±rla
        if hasattr(self, 'performance'):
            self.performance.data = {"maclar": [], "kurallar": {}, "ligler": {}, "gunluk": {}, "oranlar": {}}
            self.performance.save()
        
        # Kural sayaÃ§larÄ±nÄ± sÄ±fÄ±rla
        if hasattr(self, 'kural_istatistikleri'):
            self.kural_istatistikleri = {"gecen": 0, "veto": 0, "belirsiz": 0}
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # UI BÄ°LEÅENLERÄ°NÄ° TEMÄ°ZLE
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        # Dashboard tablosunu temizle (SON MAÃ‡LAR)
        if hasattr(self, 'dash_tree'):
            for item in self.dash_tree.get_children():
                self.dash_tree.delete(item)
        
        # ArÅŸiv tablosunu temizle
        if hasattr(self, 'tree_arsiv'):
            for item in self.tree_arsiv.get_children():
                self.tree_arsiv.delete(item)
        
        # Oranlar tablosunu temizle
        if hasattr(self, 'tree_oran'):
            for item in self.tree_oran.get_children():
                self.tree_oran.delete(item)
        
        # Excel tablosunu temizle
        if hasattr(self, 'tree_excel'):
            for item in self.tree_excel.get_children():
                self.tree_excel.delete(item)
        
        # Listeler tablosunu temizle
        for liste_adi in ["1.5_ust", "2.5_ust", "kg_var", "favori", "iy_gol", "xg_5"]:
            tree_attr = f"tree_liste_{liste_adi.replace('.', '_')}"
            if hasattr(self, tree_attr):
                tree = getattr(self, tree_attr)
                for item in tree.get_children():
                    tree.delete(item)
        
        # CanlÄ± bahis tablosunu temizle
        if hasattr(self, 'tree_canli'):
            for item in self.tree_canli.get_children():
                self.tree_canli.delete(item)
        
        # Dashboard'u gÃ¼ncelle
        if hasattr(self, 'dashboard_guncelle'):
            try:
                self.dashboard_guncelle()
            except:
                pass
        
        # Analiz Ã§Ä±ktÄ±sÄ±nÄ± temizle
        if hasattr(self, 'txt_output'):
            self.txt_output.delete("1.0", tk.END)
            self.txt_output.insert("1.0", "âœ… Veriler sÄ±fÄ±rlandÄ±. Yeni analiz iÃ§in hazÄ±r.")
        
        messagebox.showinfo("âœ… SIFIRLANDI", 
            f"{kaydedilen + 1} dosya sÄ±fÄ±rlandÄ±.\n\n"
            "â€¢ Analiz geÃ§miÅŸi temizlendi\n"
            "â€¢ ArÅŸiv tablosu temizlendi\n"
            "â€¢ Dashboard sÄ±fÄ±rlandÄ±\n"
            "â€¢ Listeler temizlendi\n\n"
            "Program yeniden baÅŸlatmaya gerek yok.")
    
    def _kasa_kaydet(self):
        """FIX #45: Kasa deÄŸerini kaydet"""
        try:
            kasa = float(self.entry_kasa.get().replace(",", "."))
            self.ayarlar["kasa"] = kasa
            self.ayarlar_kaydet()
            self._kasa_tablosu_guncelle()
            messagebox.showinfo("âœ…", f"Kasa kaydedildi: {kasa:.2f} TL")
        except:
            messagebox.showerror("Hata", "GeÃ§erli bir sayÄ± girin!")
    
    def _kasa_tablosu_guncelle(self):
        """GÃ¼vene gÃ¶re bahis miktarÄ± tablosu - GÃœNCEL ORANLAR"""
        try:
            kasa = float(self.entry_kasa.get().replace(",", "."))
        except:
            kasa = 1000
        
        tablo = "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n"
        tablo += "â”‚ GÃœVEN  â”‚   %    â”‚   MÄ°KTAR   â”‚\n"
        tablo += "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n"
        
        # YENÄ° ORANLAR: 10=%25, 9=%20, 8=%15, 7=%10, 6=%8, 5=%5
        oranlar = {
            "10/10": 25,
            "9/10": 20,
            "8/10": 15,
            "7/10": 10,
            "6/10": 8,
            "5/10": 5
        }
        
        for guven, yuzde in oranlar.items():
            miktar = kasa * yuzde / 100
            tablo += f"â”‚ {guven:^6} â”‚  %{yuzde:<3}  â”‚ {miktar:>8.2f} TLâ”‚\n"
        
        tablo += "â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
        
        if hasattr(self, 'lbl_kasa_tablo'):
            self.lbl_kasa_tablo.config(text=tablo)
    
    def verileri_yedekle(self):
        """TÃ¼m verileri yedekle"""
        yedek_klasor = filedialog.askdirectory(title="Yedek KlasÃ¶rÃ¼ SeÃ§")
        if not yedek_klasor:
            return
        
        import shutil
        tarih = datetime.now().strftime("%Y%m%d_%H%M")
        
        dosyalar = [DB_FILE, SETTINGS_FILE, PERFORMANCE_FILE, LEARNING_FILE, BRAND_FILE, LAB_FILE, CHANNELS_FILE, ORAN_FILE]
        yedeklenen = 0
        
        for dosya in dosyalar:
            if os.path.exists(dosya):
                ad = os.path.basename(dosya)
                hedef = os.path.join(yedek_klasor, f"{tarih}_{ad}")
                shutil.copy2(dosya, hedef)
                yedeklenen += 1
        
        messagebox.showinfo("Yedeklendi", f"âœ… {yedeklenen} dosya yedeklendi:\n{yedek_klasor}")

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ”´ CANLI BAHÄ°S SEKMESÄ° - V5.8 KASA YÃ–NETÄ°MÄ° EKLENDÄ°
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def _create_canli(self):
        """CanlÄ± Bahis Takip Sekmesi - V5.8 KASA YÃ–NETÄ°MÄ°"""
        page = tk.Frame(self.content, bg=ModernTheme.BG_PRIMARY)
        
        tk.Label(page, text="ğŸ”´ CANLI BAHÄ°S TAKÄ°P", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_DANGER).pack(pady=5)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ğŸ’° KASA DURUMU PANELÄ° - YENÄ°!
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_kasa_durum = tk.Frame(page, bg="#1a2a1a", pady=10)
        frm_kasa_durum.pack(fill="x", padx=20, pady=5)
        
        # Sol: GÃ¼ncel Kasa
        kasa_sol = tk.Frame(frm_kasa_durum, bg="#1a2a1a")
        kasa_sol.pack(side="left", padx=20)
        tk.Label(kasa_sol, text="ğŸ’° GÃœNCEL KASA", bg="#1a2a1a", fg="#888888", 
                font=("Arial", 9)).pack()
        self.lbl_canli_kasa = tk.Label(kasa_sol, text="1.000 TL", bg="#1a2a1a", 
                                        fg="#ffd700", font=("Arial", 20, "bold"))
        self.lbl_canli_kasa.pack()
        
        # Orta: BugÃ¼nkÃ¼ Kar/Zarar
        kasa_orta = tk.Frame(frm_kasa_durum, bg="#1a2a1a")
        kasa_orta.pack(side="left", padx=40)
        tk.Label(kasa_orta, text="ğŸ“Š BUGÃœN", bg="#1a2a1a", fg="#888888", 
                font=("Arial", 9)).pack()
        self.lbl_canli_bugun = tk.Label(kasa_orta, text="+0 TL", bg="#1a2a1a", 
                                         fg="#00ff00", font=("Arial", 18, "bold"))
        self.lbl_canli_bugun.pack()
        
        # SaÄŸ: Toplam Kar/Zarar
        kasa_sag = tk.Frame(frm_kasa_durum, bg="#1a2a1a")
        kasa_sag.pack(side="left", padx=40)
        tk.Label(kasa_sag, text="ğŸ“ˆ TOPLAM KAR", bg="#1a2a1a", fg="#888888", 
                font=("Arial", 9)).pack()
        self.lbl_canli_toplam_kar = tk.Label(kasa_sag, text="+0 TL", bg="#1a2a1a", 
                                              fg="#00ff00", font=("Arial", 18, "bold"))
        self.lbl_canli_toplam_kar.pack()
        
        # En SaÄŸ: BaÅŸarÄ± OranÄ±
        kasa_basari = tk.Frame(frm_kasa_durum, bg="#1a2a1a")
        kasa_basari.pack(side="right", padx=20)
        tk.Label(kasa_basari, text="ğŸ¯ BAÅARI", bg="#1a2a1a", fg="#888888", 
                font=("Arial", 9)).pack()
        self.lbl_canli_basari = tk.Label(kasa_basari, text="%0", bg="#1a2a1a", 
                                          fg="#00aaff", font=("Arial", 18, "bold"))
        self.lbl_canli_basari.pack()
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # â• YENÄ° CANLI BAHÄ°S EKLE
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_ekle = tk.LabelFrame(page, text="â• YENÄ° CANLI BAHÄ°S EKLE", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_ekle.pack(fill="x", padx=20, pady=5)
        
        row0 = tk.Frame(frm_ekle, bg=ModernTheme.BG_CARD)
        row0.pack(fill="x", padx=10, pady=5)
        
        # Analiz maÃ§larÄ± seÃ§imi
        tk.Label(row0, text="ğŸ“‹ Analiz MaÃ§larÄ±:", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_WARNING).pack(side="left", padx=5)
        self.canli_mac_secim = ttk.Combobox(row0, width=40)
        self.canli_mac_secim.pack(side="left", padx=5)
        tk.Button(row0, text="ğŸ”„", command=self._canli_maclari_yukle,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=2)
        tk.Button(row0, text="ğŸ“¥ SEÃ‡", command=self._canli_mac_sec,
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat").pack(side="left", padx=5)
        
        row1 = tk.Frame(frm_ekle, bg=ModernTheme.BG_CARD)
        row1.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row1, text="MaÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.canli_mac = tk.Entry(row1, width=30, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.canli_mac.pack(side="left", padx=5)
        
        tk.Label(row1, text="Lig:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.canli_lig = tk.Entry(row1, width=20, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.canli_lig.pack(side="left", padx=5)
        
        tk.Label(row1, text="Dakika:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.canli_dakika = tk.Entry(row1, width=6, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.canli_dakika.pack(side="left", padx=5)
        
        tk.Label(row1, text="Skor:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.canli_skor = tk.Entry(row1, width=8, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.canli_skor.pack(side="left", padx=5)
        
        row2 = tk.Frame(frm_ekle, bg=ModernTheme.BG_CARD)
        row2.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row2, text="Bahis:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.canli_bahis = ttk.Combobox(row2, values=["2.5 ÃœST", "2.5 ALT", "1.5 ÃœST", "0.5 ÃœST", "3.5 ÃœST", "KG VAR", "KG YOK", "MS 1", "MS 2", "MS X", "Ä°Y 0.5 ÃœST", "Ä°Y 1.5 ÃœST", "DÄ°ÄER"], width=12)
        self.canli_bahis.pack(side="left", padx=5)
        
        tk.Label(row2, text="Oran:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=5)
        self.canli_oran = tk.Entry(row2, width=8, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.canli_oran.pack(side="left", padx=5)
        
        tk.Label(row2, text="Miktar (TL):", bg=ModernTheme.BG_CARD, fg="#ffd700").pack(side="left", padx=5)
        self.canli_miktar = tk.Entry(row2, width=10, bg=ModernTheme.BG_PRIMARY, fg="#ffd700", font=("Arial", 10, "bold"))
        self.canli_miktar.pack(side="left", padx=5)
        
        tk.Button(row2, text="ğŸ’¾ KAYDET", command=self._canli_kaydet,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=10)
        
        # Ek butonlar
        tk.Button(row2, text="ğŸ¯ Taktikler", command=self.canli_taktikler_popup,
                  bg="#6f42c1", fg="white", relief="flat").pack(side="left", padx=3)
        tk.Button(row2, text="ğŸ“± Telegram", command=self.canli_telegram_gonder,
                  bg="#0088cc", fg="white", relief="flat").pack(side="left", padx=3)
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ğŸ“‹ CANLI BAHÄ°S ARÅÄ°VÄ°
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        frm_liste = tk.LabelFrame(page, text="ğŸ“‹ CANLI BAHÄ°S ARÅÄ°VÄ°", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_liste.pack(fill="both", expand=True, padx=20, pady=5)
        
        # SÃ¼tunlar: miktar ve kazanÃ§ eklendi
        cols = ("tarih", "mac", "lig", "dakika", "skor_giris", "bahis", "oran", "miktar", "skor_bitis", "sonuc", "kazanc")
        self.tree_canli = ttk.Treeview(frm_liste, columns=cols, show="headings", height=10)
        
        headers = [
            ("tarih", "TARÄ°H", 70),
            ("mac", "MAÃ‡", 150),
            ("lig", "LÄ°G", 80),
            ("dakika", "DAK", 40),
            ("skor_giris", "GÄ°RÄ°Å", 50),
            ("bahis", "BAHÄ°S", 70),
            ("oran", "ORAN", 50),
            ("miktar", "MÄ°KTAR", 70),
            ("skor_bitis", "BÄ°TÄ°Å", 50),
            ("sonuc", "SONUÃ‡", 70),
            ("kazanc", "KAZANÃ‡", 80)
        ]
        
        for col, header, width in headers:
            self.tree_canli.heading(col, text=header)
            self.tree_canli.column(col, width=width, anchor="center")
        
        self.tree_canli.tag_configure("kazandi", background="#1a472a", foreground="#00ff00")
        self.tree_canli.tag_configure("kaybetti", background="#4a1a1a", foreground="#ff6666")
        self.tree_canli.tag_configure("bekliyor", background="#1a1a2e", foreground="#aaaaaa")
        
        self.tree_canli.pack(fill="both", expand=True, padx=10, pady=5)
        self.tree_canli.bind("<Double-1>", self._canli_sonuc_gir)
        
        # SaÄŸ tÄ±k menÃ¼sÃ¼
        self.canli_menu = tk.Menu(self.tree_canli, tearoff=0)
        self.canli_menu.add_command(label="âœ… KAZANDI", command=lambda: self._canli_sonuc_isle("KAZANDI"))
        self.canli_menu.add_command(label="âŒ KAYBETTÄ°", command=lambda: self._canli_sonuc_isle("KAYBETTÄ°"))
        self.canli_menu.add_separator()
        self.canli_menu.add_command(label="ğŸ—‘ï¸ Sil", command=self._canli_sil)
        self.tree_canli.bind("<Button-3>", self._canli_sag_tik)
        
        # MaÃ§larÄ± yÃ¼kle
        self._canli_maclari_yukle()
        self._canli_listele()
        
        # Kasa durumunu gÃ¼ncelle
        self._canli_kasa_guncelle()
        
        return page

    def _canli_maclari_yukle(self):
        """Analiz edilmiÅŸ maÃ§larÄ± combobox'a yÃ¼kle"""
        bugun = datetime.now().strftime("%d.%m.%Y")
        maclar = []
        for m in self.mac_db:
            if m.get("tarih") == bugun:
                mac_adi = m.get("mac", m.get("mac_adi", "")).replace("_", " ")
                lig = m.get("lig", "")
                maclar.append(f"{mac_adi} | {lig}")
        
        if hasattr(self, 'canli_mac_secim'):
            self.canli_mac_secim["values"] = maclar
            if maclar:
                self.canli_mac_secim.set(maclar[0])
    
    def _canli_mac_sec(self):
        """SeÃ§ili maÃ§Ä± canlÄ± bahise ekle"""
        secim = self.canli_mac_secim.get() if hasattr(self, 'canli_mac_secim') else ""
        if not secim:
            messagebox.showwarning("UyarÄ±", "Ã–nce bir maÃ§ seÃ§in!")
            return
        
        # MaÃ§ adÄ± ve lig ayÄ±r
        parcalar = secim.split(" | ")
        mac_adi = parcalar[0].strip() if parcalar else ""
        lig = parcalar[1].strip() if len(parcalar) > 1 else ""
        
        # Entry'lere yaz
        self.canli_mac.delete(0, tk.END)
        self.canli_mac.insert(0, mac_adi)
        self.canli_lig.delete(0, tk.END)
        self.canli_lig.insert(0, lig)
    
    def _canli_sag_tik(self, event):
        """CanlÄ± bahiste saÄŸ tÄ±k menÃ¼sÃ¼"""
        item = self.tree_canli.identify_row(event.y)
        if item:
            self.tree_canli.selection_set(item)
            self.canli_menu.post(event.x_root, event.y_root)
    
    def _canli_sonuc_isle(self, sonuc):
        """SeÃ§ili canlÄ± bahise sonuÃ§ gir ve KASA GÃœNCELLE"""
        selection = self.tree_canli.selection()
        if not selection:
            return
        
        item = self.tree_canli.item(selection[0])
        values = item["values"]
        mac_adi = values[1]
        
        # Skor sor
        skor = simpledialog.askstring("BitiÅŸ Skoru", f"BitiÅŸ skorunu girin (Ã¶rn: 2-1):", parent=self.root)
        if skor is None:
            return
        
        # VeritabanÄ±nda bul ve gÃ¼ncelle
        for b in self.canli_db:
            if b.get("mac") == mac_adi and b.get("sonuc") == "BEKLÄ°YOR":
                b["sonuc"] = sonuc
                b["skor_bitis"] = skor
                
                # ğŸ’° KAZANÃ‡ HESAPLA
                try:
                    miktar = float(str(b.get("miktar", "0")).replace(",", ".").replace("TL", "").strip())
                    oran = float(str(b.get("oran", "1")).replace(",", "."))
                    
                    if sonuc == "KAZANDI":
                        kazanc = miktar * oran  # BrÃ¼t kazanÃ§
                        net_kar = kazanc - miktar  # Net kar
                        b["kazanc"] = f"+{net_kar:.0f}"
                    else:
                        b["kazanc"] = f"-{miktar:.0f}"
                except:
                    b["kazanc"] = "?"
                
                break
        
        self._save_json(CANLI_BAHIS_FILE, self.canli_db)
        self._canli_listele()
        self._canli_kasa_guncelle()
        
        # ğŸ“Š EXCEL'E YANSIT
        self._canli_excel_guncelle()
        
        messagebox.showinfo("âœ…", f"SonuÃ§ kaydedildi: {sonuc}\nKasa gÃ¼ncellendi!")
    
    def _canli_sil(self):
        """SeÃ§ili canlÄ± bahisi sil"""
        selection = self.tree_canli.selection()
        if not selection:
            return
        
        if not messagebox.askyesno("Onay", "Bu kaydÄ± silmek istiyor musunuz?"):
            return
        
        item = self.tree_canli.item(selection[0])
        mac_adi = item["values"][1]
        
        self.canli_db = [b for b in self.canli_db if b.get("mac") != mac_adi]
        self._save_json(CANLI_BAHIS_FILE, self.canli_db)
        self._canli_listele()
        self._canli_kasa_guncelle()
    
    def _canli_kaydet(self):
        """CanlÄ± bahis kaydet"""
        mac = self.canli_mac.get().strip()
        if not mac:
            messagebox.showwarning("UyarÄ±", "MaÃ§ adÄ± girin!")
            return
        
        miktar = self.canli_miktar.get().strip()
        if not miktar:
            messagebox.showwarning("UyarÄ±", "Miktar girin!")
            return
        
        bahis = {
            "tarih": datetime.now().strftime("%d.%m.%Y"),
            "saat": datetime.now().strftime("%H:%M"),
            "mac": mac,
            "lig": self.canli_lig.get().strip(),
            "dakika": self.canli_dakika.get().strip(),
            "skor_giris": self.canli_skor.get().strip(),
            "bahis": self.canli_bahis.get(),
            "oran": self.canli_oran.get().strip(),
            "miktar": miktar,
            "skor_bitis": "",
            "sonuc": "BEKLÄ°YOR",
            "kazanc": ""
        }
        
        if not hasattr(self, 'canli_db'):
            self.canli_db = []
        
        self.canli_db.append(bahis)
        self._save_json(CANLI_BAHIS_FILE, self.canli_db)
        
        # Temizle
        self.canli_mac.delete(0, tk.END)
        self.canli_lig.delete(0, tk.END)
        self.canli_dakika.delete(0, tk.END)
        self.canli_skor.delete(0, tk.END)
        self.canli_oran.delete(0, tk.END)
        self.canli_miktar.delete(0, tk.END)
        
        self._canli_listele()
        self._canli_kasa_guncelle()
        messagebox.showinfo("âœ…", "CanlÄ± bahis kaydedildi!")
    
    def _canli_listele(self):
        """CanlÄ± bahisleri listele"""
        for item in self.tree_canli.get_children():
            self.tree_canli.delete(item)
        
        if not hasattr(self, 'canli_db'):
            self.canli_db = self._load_json(CANLI_BAHIS_FILE, [])
        
        for b in reversed(self.canli_db[-50:]):
            sonuc = b.get("sonuc", "BEKLÄ°YOR")
            if sonuc in ["KAZANDI", "âœ…"]:
                tag = "kazandi"
            elif sonuc in ["KAYBETTÄ°", "âŒ"]:
                tag = "kaybetti"
            else:
                tag = "bekliyor"
            
            self.tree_canli.insert("", 0, values=(
                b.get("tarih", ""),
                b.get("mac", ""),
                b.get("lig", ""),
                b.get("dakika", ""),
                b.get("skor_giris", ""),
                b.get("bahis", ""),
                b.get("oran", ""),
                b.get("miktar", ""),
                b.get("skor_bitis", ""),
                sonuc,
                b.get("kazanc", "")
            ), tags=(tag,))
    
    def _canli_sonuc_gir(self, event):
        """Ã‡ift tÄ±klama ile sonuÃ§ gir"""
        selection = self.tree_canli.selection()
        if not selection:
            return
        
        item = self.tree_canli.item(selection[0])
        values = item["values"]
        
        # Zaten sonuÃ§lanmÄ±ÅŸ mÄ±?
        if values[9] != "BEKLÄ°YOR":
            messagebox.showinfo("Bilgi", "Bu bahis zaten sonuÃ§lanmÄ±ÅŸ!")
            return
        
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“ SonuÃ§ Gir")
        popup.geometry("350x250")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        popup.grab_set()
        
        tk.Label(popup, text=f"âš½ {values[1]}", font=("Arial", 11, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        tk.Label(popup, text="MaÃ§ Skoru:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack(pady=5)
        entry_skor = tk.Entry(popup, width=10, font=("Arial", 14), justify="center",
                             bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY)
        entry_skor.pack()
        entry_skor.insert(0, "0-0")
        
        tk.Label(popup, text="SonuÃ§:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack(pady=10)
        
        btn_frame = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        btn_frame.pack(pady=10)
        
        def sonuc_kaydet(sonuc_tipi):
            skor = entry_skor.get()
            mac_adi = values[1]
            
            # VeritabanÄ±nda bul ve gÃ¼ncelle
            for b in self.canli_db:
                if b.get("mac") == mac_adi and b.get("sonuc") == "BEKLÄ°YOR":
                    b["sonuc"] = sonuc_tipi
                    b["skor_bitis"] = skor
                    
                    # ğŸ’° KAZANÃ‡ HESAPLA
                    try:
                        miktar = float(str(b.get("miktar", "0")).replace(",", ".").replace("TL", "").strip())
                        oran = float(str(b.get("oran", "1")).replace(",", "."))
                        
                        if sonuc_tipi == "KAZANDI":
                            kazanc = miktar * oran
                            net_kar = kazanc - miktar
                            b["kazanc"] = f"+{net_kar:.0f}"
                        else:
                            b["kazanc"] = f"-{miktar:.0f}"
                    except:
                        b["kazanc"] = "?"
                    
                    break
            
            self._save_json(CANLI_BAHIS_FILE, self.canli_db)
            self._canli_listele()
            self._canli_kasa_guncelle()
            self._canli_excel_guncelle()
            
            popup.destroy()
            messagebox.showinfo("âœ…", f"SonuÃ§: {sonuc_tipi}\nKasa gÃ¼ncellendi!")
        
        tk.Button(btn_frame, text="âœ… KAZANDI", command=lambda: sonuc_kaydet("KAZANDI"),
                  bg="#28a745", fg="white", font=("Arial", 12, "bold"), 
                  relief="flat", padx=20).pack(side="left", padx=10)
        tk.Button(btn_frame, text="âŒ KAYBETTÄ°", command=lambda: sonuc_kaydet("KAYBETTÄ°"),
                  bg="#dc3545", fg="white", font=("Arial", 12, "bold"),
                  relief="flat", padx=20).pack(side="left", padx=10)
        
        entry_skor.focus()
        entry_skor.select_range(0, tk.END)
    
    def _canli_kasa_guncelle(self):
        """ğŸ’° KASA DURUMUNU GÃœNCELLE"""
        if not hasattr(self, 'canli_db'):
            self.canli_db = self._load_json(CANLI_BAHIS_FILE, [])
        
        # Ayarlardan baÅŸlangÄ±Ã§ kasasÄ±nÄ± al
        try:
            if hasattr(self, 'entry_kasa'):
                baslangic_kasa = float(self.entry_kasa.get().replace(",", ".").replace("TL", "").strip())
            else:
                baslangic_kasa = 1000
        except:
            baslangic_kasa = 1000
        
        # Toplam kar/zarar hesapla
        toplam_kar = 0
        bugun_kar = 0
        kazanan = 0
        kaybeden = 0
        bugun = datetime.now().strftime("%d.%m.%Y")
        
        for b in self.canli_db:
            sonuc = b.get("sonuc", "BEKLÄ°YOR")
            if sonuc == "BEKLÄ°YOR":
                continue
            
            try:
                miktar = float(str(b.get("miktar", "0")).replace(",", ".").replace("TL", "").strip())
                oran = float(str(b.get("oran", "1")).replace(",", "."))
                
                if sonuc == "KAZANDI":
                    kar = miktar * (oran - 1)  # Net kar
                    toplam_kar += kar
                    kazanan += 1
                    if b.get("tarih") == bugun:
                        bugun_kar += kar
                else:
                    toplam_kar -= miktar
                    kaybeden += 1
                    if b.get("tarih") == bugun:
                        bugun_kar -= miktar
            except:
                pass
        
        # GÃ¼ncel kasa
        guncel_kasa = baslangic_kasa + toplam_kar
        
        # BaÅŸarÄ± oranÄ±
        decided = kazanan + kaybeden
        basari = (kazanan / decided * 100) if decided > 0 else 0
        
        # Label'larÄ± gÃ¼ncelle
        if hasattr(self, 'lbl_canli_kasa'):
            self.lbl_canli_kasa.config(text=f"{guncel_kasa:,.0f} TL")
            # Renk: yeÅŸil pozitif, kÄ±rmÄ±zÄ± negatif
            if guncel_kasa >= baslangic_kasa:
                self.lbl_canli_kasa.config(fg="#ffd700")
            else:
                self.lbl_canli_kasa.config(fg="#ff6666")
        
        if hasattr(self, 'lbl_canli_bugun'):
            if bugun_kar >= 0:
                self.lbl_canli_bugun.config(text=f"+{bugun_kar:,.0f} TL", fg="#00ff00")
            else:
                self.lbl_canli_bugun.config(text=f"{bugun_kar:,.0f} TL", fg="#ff6666")
        
        if hasattr(self, 'lbl_canli_toplam_kar'):
            if toplam_kar >= 0:
                self.lbl_canli_toplam_kar.config(text=f"+{toplam_kar:,.0f} TL", fg="#00ff00")
            else:
                self.lbl_canli_toplam_kar.config(text=f"{toplam_kar:,.0f} TL", fg="#ff6666")
        
        if hasattr(self, 'lbl_canli_basari'):
            self.lbl_canli_basari.config(text=f"%{basari:.0f}")
            if basari >= 60:
                self.lbl_canli_basari.config(fg="#00ff00")
            elif basari >= 50:
                self.lbl_canli_basari.config(fg="#ffd700")
            else:
                self.lbl_canli_basari.config(fg="#ff6666")
    
    def _canli_excel_guncelle(self):
        """ğŸ“Š CANLI BAHÄ°S SONUÃ‡LARINI EXCEL'E YANSIT"""
        if not EXCEL_AVAILABLE:
            return
        
        try:
            excel_path = "canli_bahis_takip.xlsx"
            
            wb = Workbook()
            ws = wb.active
            ws.title = "CanlÄ± Bahisler"
            
            # BaÅŸlÄ±k satÄ±rÄ±
            headers = ["Tarih", "Saat", "MaÃ§", "Lig", "Dakika", "GiriÅŸ Skoru", "Bahis", 
                      "Oran", "Miktar", "BitiÅŸ Skoru", "SonuÃ§", "KazanÃ§"]
            ws.append(headers)
            
            # Verileri ekle
            for b in self.canli_db:
                ws.append([
                    b.get("tarih", ""),
                    b.get("saat", ""),
                    b.get("mac", ""),
                    b.get("lig", ""),
                    b.get("dakika", ""),
                    b.get("skor_giris", ""),
                    b.get("bahis", ""),
                    b.get("oran", ""),
                    b.get("miktar", ""),
                    b.get("skor_bitis", ""),
                    b.get("sonuc", ""),
                    b.get("kazanc", "")
                ])
            
            # Ã–zet satÄ±rÄ±
            ws.append([])
            
            # Toplam hesapla
            toplam_kazanc = sum(
                float(str(b.get("kazanc", "0")).replace("+", "").replace("-", "").replace("?", "0"))
                * (1 if "+" in str(b.get("kazanc", "")) else -1)
                for b in self.canli_db if b.get("sonuc") != "BEKLÄ°YOR" and b.get("kazanc")
            )
            
            ws.append(["", "", "", "", "", "", "", "", "", "TOPLAM:", "", f"{toplam_kazanc:+.0f} TL"])
            
            wb.save(excel_path)
            
        except Exception as e:
            print(f"Excel gÃ¼ncelleme hatasÄ±: {e}")
        
        # En iyi dakika aralÄ±ÄŸÄ±
        en_iyi_aralik = ""
        en_iyi_basari = 0
        for aralik, data in dakika_stat.items():
            if data["toplam"] >= 3:
                basari_aralik = (data["kazanan"] / data["toplam"] * 100)
                if basari_aralik > en_iyi_basari:
                    en_iyi_basari = basari_aralik
                    en_iyi_aralik = aralik
        
        text = f"""ğŸ“Š CANLI BAHÄ°S PERFORMANSI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Toplam: {toplam} | âœ… Kazanan: {kazanan} | âŒ Kaybeden: {kaybeden} | â³ Bekleyen: {bekleyen}
ğŸ“ˆ BaÅŸarÄ± OranÄ±: %{basari:.0f}
ğŸ¯ En Ä°yi Dakika AralÄ±ÄŸÄ±: {en_iyi_aralik} (%{en_iyi_basari:.0f})
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"""
        
        self.canli_stat_lbl.config(text=text)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“± TELEGRAM POPUP SÄ°STEMÄ° - V5.7
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def _telegram_popup(self):
        """V70: Telegram gÃ¶nderim popup'Ä± - FÄ°L HAFIZASI DESTEKLÄ°"""
        # V70: FÄ°L HAFIZASI kontrolÃ¼ - 3 aÅŸamalÄ± arama
        if not hasattr(self, 'current_analysis') or not self.current_analysis:
            if self.mac_db:
                self.current_analysis = self.mac_db[-1]
            elif hasattr(self, 'mac_arsivi') and self.mac_arsivi:
                self.current_analysis = list(self.mac_arsivi.values())[-1]
            else:
                messagebox.showwarning("UyarÄ±", "HenÃ¼z analiz yapÄ±lmamÄ±ÅŸ!\n\nLÃ¼tfen Ã¶nce bir gÃ¶rsel yÃ¼kleyip analiz yapÄ±n.")
                return
        
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“± Telegram'a GÃ¶nder")
        popup.geometry("600x550")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        popup.grab_set()
        
        tk.Label(popup, text="ğŸ“± TELEGRAM GÃ–NDERÄ°M", font=("Segoe UI", 14, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        # Format seÃ§imi
        frm_format = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        frm_format.pack(fill="x", padx=20)
        
        tk.Label(frm_format, text="Format:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        self.var_tg_format = tk.StringVar(value="detayli")
        
        for val, txt in [("kisa", "KÄ±sa"), ("detayli", "DetaylÄ±")]:
            tk.Radiobutton(frm_format, text=txt, variable=self.var_tg_format, value=val,
                          bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY,
                          selectcolor=ModernTheme.BG_CARD).pack(side="left", padx=10)
        
        # Ã–nizleme
        tk.Label(popup, text="ğŸ“ Ã–nizleme:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(anchor="w", padx=20, pady=(10, 5))
        self.tg_preview = scrolledtext.ScrolledText(popup, height=12, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 9))
        self.tg_preview.pack(fill="x", padx=20)
        
        self._telegram_onizleme_guncelle()
        
        # Kanal seÃ§imi
        tk.Label(popup, text="ğŸ“¢ Kanal SeÃ§:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(anchor="w", padx=20, pady=(10, 5))
        
        frm_kanal = tk.Frame(popup, bg=ModernTheme.BG_CARD)
        frm_kanal.pack(fill="x", padx=20, pady=5)
        
        self.kanal_vars = {}
        if self.telegram_kanallari:
            for kanal in self.telegram_kanallari:
                var = tk.BooleanVar(value=True)
                self.kanal_vars[kanal.get("id", "")] = var
                tk.Checkbutton(frm_kanal, text=f"{kanal.get('ad', 'Kanal')} ({kanal.get('id', '')})",
                              variable=var, bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY,
                              selectcolor=ModernTheme.BG_PRIMARY).pack(anchor="w", padx=10)
        else:
            tk.Label(frm_kanal, text="âš ï¸ Kanal tanÄ±mlÄ± deÄŸil. Telegram sekmesinden ekleyin.",
                    bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_WARNING).pack(pady=10)
        
        # Butonlar
        frm_btn = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        frm_btn.pack(fill="x", padx=20, pady=15)
        
        tk.Button(frm_btn, text="ğŸ“¤ GÃ–NDER", command=lambda: self._telegram_gonder_onayla(popup),
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", font=("Arial", 11, "bold"), relief="flat").pack(side="left", padx=5)
        tk.Button(frm_btn, text="Ä°ptal", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=5)
    
    def _telegram_onizleme_guncelle(self):
        """Telegram Ã¶nizlemesini gÃ¼ncelle - V5.8 DÃœZGÃœN FORMAT"""
        self.tg_preview.delete("1.0", tk.END)
        
        mac = self.current_analysis
        format_type = self.var_tg_format.get() if hasattr(self, 'var_tg_format') else "kisa"
        
        # Banko al
        banko = mac.get('banko', 'MS 1.5 ÃœST')
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # SÄ°GORTA - BANKONUN 1 TIK ALTI
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        sigorta = self.telegram._sigorta_belirle(banko) if hasattr(self, 'telegram') else "MS 0.5 ÃœST"
        
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # KASA - GÃœVENE GÃ–RE
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        guven = mac.get('guven', 7)
        try:
            guven_sayi = int(str(guven).split("/")[0])
        except:
            guven_sayi = 7
        kasa = KASA_ORANLARI.get(guven_sayi, {"oran": 10})["oran"]
        
        mac_adi = mac.get('mac', mac.get('mac_adi', '?')).replace("_", " ")
        tarih = mac.get('tarih', '?')
        lig = mac.get('lig', '?')
        
        if format_type == "kisa":
            mesaj = f"""ğŸ¯ TAHMÄ°N

âš½ {mac_adi}
ğŸ“… {tarih}
ğŸ† {lig}

âœ… BANKO: {banko}
ğŸ›¡ï¸ SÄ°GORTA: {sigorta}
ğŸ“Š GÃœVEN: {guven_sayi}/10
ğŸ’° KASA: %{kasa}

ğŸ“± 90 DAKÄ°KA ANALÄ°Z"""
        else:
            mesaj = f"""ğŸ“Š DETAYLI ANALÄ°Z

âš½ï¸ {mac_adi}
ğŸ“… {tarih} | ğŸ† {lig}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ TAHMÄ°N
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… BANKO: {banko}
ğŸ›¡ï¸ SÄ°GORTA: {sigorta}
ğŸ“Š GÃœVEN: {guven_sayi}/10
ğŸ’° KASA: %{kasa}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“± 90 DAKÄ°KA ANALÄ°Z"""
        
        self.tg_preview.insert("1.0", mesaj)
    
    def _telegram_gonder_onayla(self, popup):
        """Telegram gÃ¶nderimini onayla"""
        secili = [k for k, v in self.kanal_vars.items() if v.get()]
        
        if not secili and self.telegram_kanallari:
            messagebox.showwarning("UyarÄ±", "En az bir kanal seÃ§in!")
            return
        
        # GÃ¶nder
        basarili = 0
        for kanal_id in secili:
            if self._telegram_mesaj_gonder_api(kanal_id):
                basarili += 1
        
        popup.destroy()
        
        if basarili > 0:
            messagebox.showinfo("âœ…", f"{basarili} kanala gÃ¶nderildi!")
        else:
            messagebox.showwarning("UyarÄ±", "GÃ¶nderim baÅŸarÄ±sÄ±z! Token ve Chat ID'yi kontrol edin.")
    
    def _telegram_mesaj_gonder_api(self, chat_id):
        """Telegram API ile mesaj gÃ¶nder"""
        try:
            token = self.ayarlar.get("telegram_token", TELEGRAM_BOT_TOKEN)
            if not token:
                return False
            
            mesaj = self.tg_preview.get("1.0", tk.END)
            url = f"https://api.telegram.org/bot{token}/sendMessage"
            data = {"chat_id": chat_id, "text": mesaj, "parse_mode": "HTML"}
            
            response = requests.post(url, data=data, timeout=10)
            return response.status_code == 200
        except:
            return False

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸš¨ PANÄ°K MODU - V5.7 YENÄ°
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def _toggle_panik_modu(self):
        """Panik modunu aÃ§/kapat"""
        if not hasattr(self, 'panik_modu'):
            self.panik_modu = False
        self.panik_modu = not self.panik_modu
        
        if self.panik_modu:
            messagebox.showinfo("ğŸš¨ PANÄ°K MODU", "Panik modu AKTÄ°F!\n\nSadece 10/10 gÃ¼venli maÃ§lar gÃ¶sterilecek.\nDiÄŸer sekmelere eriÅŸim kÄ±sÄ±tlandÄ±.")
        else:
            messagebox.showinfo("âœ…", "Panik modu kapatÄ±ldÄ±.")

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ’¡ GÃœNÃœN Ä°PUCU - V5.7 YENÄ°
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def _gunun_ipucu(self):
        """GÃ¼nÃ¼n ipucunu gÃ¶ster"""
        ipucu = random.choice(GUNUN_IPUCLARI)
        if hasattr(self, 'lbl_status'):
            self.lbl_status.config(text=ipucu[:50] + "...")

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“‹ HAFTALIK RAPOR - V5.7 YENÄ° (#9)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def haftalik_rapor_goster(self):
        """HaftalÄ±k performans raporu popup - CanlÄ± dahil"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“‹ HaftalÄ±k Rapor")
        popup.geometry("700x600")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“‹ HAFTALIK PERFORMANS RAPORU", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=15)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Son 7 gÃ¼nÃ¼ hesapla
        bugun = datetime.now()
        hafta_basi = bugun - timedelta(days=7)
        
        hafta_maclar = []
        for mac in self.mac_db:
            try:
                tarih = datetime.strptime(mac.get("tarih", "01.01.2000"), "%d.%m.%Y")
                if tarih >= hafta_basi:
                    hafta_maclar.append(mac)
            except:
                pass
        
        toplam = len(hafta_maclar)
        kazanan = len([m for m in hafta_maclar if m.get("sonuc") in ["KAZANDI", "âœ…"]])
        kaybeden = len([m for m in hafta_maclar if m.get("sonuc") in ["KAYBETTÄ°", "âŒ"]])
        bekleyen = toplam - kazanan - kaybeden
        basari = (kazanan / (kazanan + kaybeden) * 100) if (kazanan + kaybeden) > 0 else 0
        
        # CanlÄ± bahis istatistikleri
        canli_kazanan = len([c for c in self.canli_db if c.get("sonuc") in ["KAZANDI", "âœ…"]])
        canli_kaybeden = len([c for c in self.canli_db if c.get("sonuc") in ["KAYBETTÄ°", "âŒ"]])
        canli_toplam = canli_kazanan + canli_kaybeden
        canli_basari = (canli_kazanan / canli_toplam * 100) if canli_toplam > 0 else 0
        
        # Bahis tÃ¼rÃ¼ analizi
        bahis_turleri = {}
        for mac in hafta_maclar:
            banko = mac.get("banko", "?")
            if banko not in bahis_turleri:
                bahis_turleri[banko] = {"toplam": 0, "kazanan": 0}
            bahis_turleri[banko]["toplam"] += 1
            if mac.get("sonuc") in ["KAZANDI", "âœ…"]:
                bahis_turleri[banko]["kazanan"] += 1
        
        rapor = f"""
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    ğŸ“‹ HAFTALIK RAPOR
                 {hafta_basi.strftime('%d.%m.%Y')} - {bugun.strftime('%d.%m.%Y')}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š GENEL Ä°STATÄ°STÄ°KLER
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Toplam Analiz  : {toplam}
  âœ… Kazanan     : {kazanan}
  âŒ Kaybeden    : {kaybeden}
  â³ Bekleyen    : {bekleyen}
  ğŸ“ˆ BaÅŸarÄ± OranÄ±: %{basari:.1f}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”´ CANLI BAHÄ°S Ä°STATÄ°STÄ°KLERÄ°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Toplam CanlÄ±   : {canli_toplam}
  âœ… Kazanan     : {canli_kazanan}
  âŒ Kaybeden    : {canli_kaybeden}
  ğŸ“ˆ BaÅŸarÄ± OranÄ±: %{canli_basari:.1f}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ BAHÄ°S TÃœRÃœ PERFORMANSI
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
"""
        for bahis, data in sorted(bahis_turleri.items(), key=lambda x: x[1]["toplam"], reverse=True)[:10]:
            b_basari = (data["kazanan"] / data["toplam"] * 100) if data["toplam"] > 0 else 0
            emoji = "ğŸ”¥" if b_basari >= 70 else ("âœ…" if b_basari >= 50 else "âš ï¸")
            rapor += f"  {emoji} {bahis[:20]:20} | {data['toplam']:3} maÃ§ | %{b_basari:.0f}\n"
        
        rapor += "\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        
        text.insert("1.0", rapor)
        
        # Raporu instance'a kaydet (kaydet butonu iÃ§in)
        self._haftalik_rapor_text = rapor
        
        # Butonlar
        btn_frame = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        btn_frame.pack(pady=10)
        
        def kaydet_haftalik():
            dosya = filedialog.asksaveasfilename(
                defaultextension=".txt",
                filetypes=[("Text dosyasÄ±", "*.txt"), ("TÃ¼m dosyalar", "*.*")],
                initialfilename=f"haftalik_rapor_{bugun.strftime('%Y%m%d')}.txt"
            )
            if dosya:
                with open(dosya, "w", encoding="utf-8") as f:
                    f.write(self._haftalik_rapor_text)
                messagebox.showinfo("âœ…", f"Rapor kaydedildi:\n{dosya}")
        
        def telegram_haftalik():
            self.kanal_sec_ve_gonder(self._haftalik_rapor_text, "HaftalÄ±k Rapor")
        
        tk.Button(btn_frame, text="ğŸ’¾ Kaydet", command=kaydet_haftalik,
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat", width=12).pack(side="left", padx=5)
        tk.Button(btn_frame, text="ğŸ“± Telegram", command=telegram_haftalik,
                  bg="#0088cc", fg="white", relief="flat", width=12).pack(side="left", padx=5)
        tk.Button(btn_frame, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat", width=12).pack(side="left", padx=5)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“Š AYLIK RAPOR - V5.7 YENÄ° (#37)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def aylik_rapor_goster(self):
        """FIX: AylÄ±k rapor - AyÄ±n 1'inden son gÃ¼nÃ¼ne kadar"""
        import calendar
        
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“Š AylÄ±k Rapor")
        popup.geometry("700x600")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“Š AYLIK PERFORMANS RAPORU", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(pady=15)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # AyÄ±n 1'i ve son gÃ¼nÃ¼
        bugun = datetime.now()
        ay_basi = bugun.replace(day=1)
        son_gun = calendar.monthrange(bugun.year, bugun.month)[1]
        ay_sonu = bugun.replace(day=son_gun)
        ay_adi = ["", "Ocak", "Åubat", "Mart", "Nisan", "MayÄ±s", "Haziran", 
                  "Temmuz", "AÄŸustos", "EylÃ¼l", "Ekim", "KasÄ±m", "AralÄ±k"][bugun.month]
        
        ay_maclar = []
        for mac in self.mac_db:
            try:
                tarih = datetime.strptime(mac.get("tarih", "01.01.2000"), "%d.%m.%Y")
                if tarih >= ay_basi and tarih <= ay_sonu:
                    ay_maclar.append(mac)
            except:
                pass
        
        toplam = len(ay_maclar)
        kazanan = len([m for m in ay_maclar if m.get("sonuc") in ["KAZANDI", "âœ…"]])
        kaybeden = len([m for m in ay_maclar if m.get("sonuc") in ["KAYBETTÄ°", "âŒ"]])
        bekleyen = toplam - kazanan - kaybeden
        basari = (kazanan / (kazanan + kaybeden) * 100) if (kazanan + kaybeden) > 0 else 0
        
        # CanlÄ± bahis istatistikleri
        canli_kazanan = len([c for c in self.canli_db if c.get("sonuc") in ["KAZANDI", "âœ…"]])
        canli_kaybeden = len([c for c in self.canli_db if c.get("sonuc") in ["KAYBETTÄ°", "âŒ"]])
        canli_toplam = canli_kazanan + canli_kaybeden
        canli_basari = (canli_kazanan / canli_toplam * 100) if canli_toplam > 0 else 0
        
        rapor = f"""
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    ğŸ“Š {ay_adi.upper()} {bugun.year} RAPORU
                 01.{bugun.month:02d}.{bugun.year} - {son_gun}.{bugun.month:02d}.{bugun.year}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š GENEL Ä°STATÄ°STÄ°KLER
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Toplam Analiz  : {toplam}
  âœ… Kazanan     : {kazanan}
  âŒ Kaybeden    : {kaybeden}
  â³ Bekleyen    : {bekleyen}
  ğŸ“ˆ BaÅŸarÄ± OranÄ±: %{basari:.1f}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”´ CANLI BAHÄ°S Ä°STATÄ°STÄ°KLERÄ°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Toplam CanlÄ±   : {canli_toplam}
  âœ… Kazanan     : {canli_kazanan}
  âŒ Kaybeden    : {canli_kaybeden}
  ğŸ“ˆ BaÅŸarÄ± OranÄ±: %{canli_basari:.1f}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""
        text.insert("1.0", rapor)
        
        # Raporu instance'a kaydet
        self._aylik_rapor_text = rapor
        
        # Butonlar
        btn_frame = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        btn_frame.pack(pady=10)
        
        def kaydet_aylik():
            dosya = filedialog.asksaveasfilename(
                defaultextension=".txt",
                filetypes=[("Text dosyasÄ±", "*.txt"), ("TÃ¼m dosyalar", "*.*")],
                initialfilename=f"aylik_rapor_{bugun.strftime('%Y%m')}.txt"
            )
            if dosya:
                with open(dosya, "w", encoding="utf-8") as f:
                    f.write(self._aylik_rapor_text)
                messagebox.showinfo("âœ…", f"Rapor kaydedildi:\n{dosya}")
        
        def telegram_aylik():
            self.kanal_sec_ve_gonder(self._aylik_rapor_text, "AylÄ±k Rapor")
        
        tk.Button(btn_frame, text="ğŸ’¾ Kaydet", command=kaydet_aylik,
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat", width=12).pack(side="left", padx=5)
        tk.Button(btn_frame, text="ğŸ“± Telegram", command=telegram_aylik,
                  bg="#0088cc", fg="white", relief="flat", width=12).pack(side="left", padx=5)
        tk.Button(btn_frame, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat", width=12).pack(side="left", padx=5)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ¯ SNIPER MODU - V5.7 YENÄ° (#80)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def sniper_modu_popup(self):
        """Sniper modu - Ã¶zel kriterlere gÃ¶re maÃ§ arama"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ¯ Sniper Modu")
        popup.geometry("600x500")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ¯ SNIPER MODU", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_DANGER).pack(pady=10)
        
        tk.Label(popup, text="Kriterleri belirle, arÅŸivde otomatik tara!", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        
        # Kriterler
        frm = tk.LabelFrame(popup, text="ğŸ” Kriterler", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm.pack(fill="x", padx=20, pady=10)
        
        row1 = tk.Frame(frm, bg=ModernTheme.BG_CARD)
        row1.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row1, text="Min GÃ¼ven:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        self.sniper_guven = ttk.Combobox(row1, values=["5", "6", "7", "8", "9", "10"], width=5)
        self.sniper_guven.set("8")
        self.sniper_guven.pack(side="left", padx=10)
        
        tk.Label(row1, text="Bahis TÃ¼rÃ¼:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=(20, 0))
        self.sniper_bahis = ttk.Combobox(row1, values=["TÃ¼mÃ¼", "2.5 ÃœST", "KG VAR", "MS 1", "MS 2", "1.5 ÃœST"], width=12)
        self.sniper_bahis.set("TÃ¼mÃ¼")
        self.sniper_bahis.pack(side="left", padx=10)
        
        row2 = tk.Frame(frm, bg=ModernTheme.BG_CARD)
        row2.pack(fill="x", padx=10, pady=5)
        
        tk.Label(row2, text="Sadece Kazananlar:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        self.sniper_kazanan = tk.BooleanVar(value=False)
        tk.Checkbutton(row2, variable=self.sniper_kazanan, bg=ModernTheme.BG_CARD, selectcolor=ModernTheme.BG_PRIMARY).pack(side="left")
        
        tk.Button(frm, text="ğŸ” TARA", command=lambda: self._sniper_tara(popup),
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(pady=10)
        
        # SonuÃ§lar
        tk.Label(popup, text="ğŸ“Š SonuÃ§lar:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(anchor="w", padx=20)
        
        self.sniper_sonuc = scrolledtext.ScrolledText(popup, height=15, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 9))
        self.sniper_sonuc.pack(fill="both", expand=True, padx=20, pady=10)
    
    def _sniper_tara(self, popup):
        """Sniper taramasÄ± yap"""
        min_guven = int(self.sniper_guven.get())
        bahis_filtre = self.sniper_bahis.get()
        sadece_kazanan = self.sniper_kazanan.get()
        
        sonuclar = []
        for mac in self.mac_db:
            guven = mac.get("guven", 0)
            if isinstance(guven, str):
                try:
                    guven = int(guven.split("/")[0])
                except:
                    guven = 0
            
            if guven < min_guven:
                continue
            
            banko = mac.get("banko", "")
            if bahis_filtre != "TÃ¼mÃ¼" and bahis_filtre not in banko:
                continue
            
            sonuc = mac.get("sonuc", "")
            if sadece_kazanan and sonuc not in ["KAZANDI", "âœ…"]:
                continue
            
            sonuclar.append(mac)
        
        # SonuÃ§larÄ± gÃ¶ster
        self.sniper_sonuc.delete("1.0", tk.END)
        
        text = f"ğŸ¯ SNIPER SONUÃ‡LARI\n"
        text += f"Kriter: GÃ¼ven â‰¥ {min_guven}, Bahis: {bahis_filtre}\n"
        text += f"Bulunan: {len(sonuclar)} maÃ§\n"
        text += "â•" * 50 + "\n\n"
        
        for mac in sonuclar[-20:]:
            sonuc_emoji = "âœ…" if mac.get("sonuc") in ["KAZANDI", "âœ…"] else ("âŒ" if mac.get("sonuc") in ["KAYBETTÄ°", "âŒ"] else "â³")
            text += f"{sonuc_emoji} {mac.get('tarih', '?')} | {mac.get('mac', '?')[:25]} | {mac.get('banko', '?')[:15]} | G:{mac.get('guven', '?')}\n"
        
        self.sniper_sonuc.insert("1.0", text)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ’ GÄ°ZLÄ° BANKO - V5.7 YENÄ° (#82)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def gizli_banko_kontrol(self, mac_data):
        """Gizli banko kontrolÃ¼ - 10/10 + Elit Lig + Pattern"""
        guven = mac_data.get("guven", 0)
        if isinstance(guven, str):
            try:
                guven = int(guven.split("/")[0])
            except:
                guven = 0
        
        if guven < 10:
            return False, ""
        
        lig = mac_data.get("lig", "")
        elit_lig = any(el.lower() in lig.lower() for el in ELIT_LIGLER)
        
        if not elit_lig:
            return False, ""
        
        # Pattern kontrolÃ¼ - aynÄ± banko tÃ¼rÃ¼nde son 5 maÃ§tan 4+ kazanma
        banko = mac_data.get("banko", "")
        benzer_maclar = [m for m in self.mac_db if banko in m.get("banko", "")][-5:]
        kazanan_sayisi = len([m for m in benzer_maclar if m.get("sonuc") in ["KAZANDI", "âœ…"]])
        
        if kazanan_sayisi >= 4:
            return True, "ğŸ’ GÄ°ZLÄ° BANKO TESPÄ°T EDÄ°LDÄ°!"
        
        return False, ""

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ’€ KARA LÄ°STE / âœ¨ ALTIN LÄ°STE - V5.7 YENÄ° (#57, #58)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def kara_liste_ekle(self, takim_veya_lig):
        """Kara listeye ekle"""
        if not hasattr(self, 'kara_liste'):
            self.kara_liste = self._load_json(KARA_LISTE_FILE, [])
        
        if takim_veya_lig not in self.kara_liste:
            self.kara_liste.append(takim_veya_lig)
            self._save_json(KARA_LISTE_FILE, self.kara_liste)
            return True
        return False
    
    def altin_liste_ekle(self, takim_veya_lig):
        """AltÄ±n listeye ekle"""
        if not hasattr(self, 'altin_liste'):
            self.altin_liste = self._load_json(ALTIN_LISTE_FILE, [])
        
        if takim_veya_lig not in self.altin_liste:
            self.altin_liste.append(takim_veya_lig)
            self._save_json(ALTIN_LISTE_FILE, self.altin_liste)
            return True
        return False
    
    def liste_kontrol(self, mac_adi):
        """MaÃ§Ä±n kara/altÄ±n listede olup olmadÄ±ÄŸÄ±nÄ± kontrol et"""
        kara = self._load_json(KARA_LISTE_FILE, [])
        altin = self._load_json(ALTIN_LISTE_FILE, [])
        
        for item in kara:
            if item.lower() in mac_adi.lower():
                return "kara", f"âš ï¸ KARA LÄ°STE: {item}"
        
        for item in altin:
            if item.lower() in mac_adi.lower():
                return "altin", f"âœ¨ ALTIN LÄ°STE: {item}"
        
        return None, ""

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ† GÃœNLÃœK / HAFTALIK TURNUVA - V5.7 YENÄ° (#89)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def gunluk_turnuva_goster(self):
        """GÃ¼nÃ¼n en iyi maÃ§Ä±nÄ± gÃ¶ster - Telegram butonu ile"""
        bugun = datetime.now().strftime("%d.%m.%Y")
        bugun_maclar = [m for m in self.mac_db if m.get("tarih") == bugun]
        
        if not bugun_maclar:
            messagebox.showinfo("ğŸ† GÃ¼nlÃ¼k Turnuva", "BugÃ¼n henÃ¼z analiz yok!")
            return
        
        # En yÃ¼ksek gÃ¼ven skorlu maÃ§Ä± bul
        en_iyi = None
        max_guven = 0
        
        for mac in bugun_maclar:
            guven = mac.get("guven", 0)
            if isinstance(guven, str):
                try:
                    guven = int(guven.split("/")[0])
                except:
                    guven = 0
            if guven > max_guven:
                max_guven = guven
                en_iyi = mac
        
        if en_iyi:
            msg = f"""ğŸ† GÃœNÃœN EN Ä°YÄ° MAÃ‡I

âš½ {en_iyi.get('mac', '?')}
ğŸ† {en_iyi.get('lig', '?')}

ğŸ¯ BANKO: {en_iyi.get('banko', '?')}
ğŸ”’ SÄ°GORTA: {en_iyi.get('sigorta', '?')}
ğŸ“Š GÃœVEN: {max_guven}/10
ğŸ’° KASA: %{KASA_ORANLARI.get(max_guven, {}).get('oran', 10)}
"""
            # Popup with Telegram button
            popup = tk.Toplevel(self.root)
            popup.title("ğŸ† GÃ¼nlÃ¼k Turnuva")
            popup.geometry("400x300")
            popup.configure(bg=ModernTheme.BG_PRIMARY)
            popup.transient(self.root)
            
            tk.Label(popup, text="ğŸ† GÃœNÃœN EN Ä°YÄ° MAÃ‡I", font=("Segoe UI", 14, "bold"),
                    bg=ModernTheme.BG_PRIMARY, fg="#ffd700").pack(pady=10)
            
            text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00", height=10)
            text.pack(fill="both", expand=True, padx=20, pady=5)
            text.insert("1.0", msg)
            
            self._gunluk_turnuva_msg = msg
            
            btn_frame = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
            btn_frame.pack(pady=10)
            
            tk.Button(btn_frame, text="ğŸ“± Telegram", 
                      command=lambda: self.kanal_sec_ve_gonder(self._gunluk_turnuva_msg, "GÃ¼nlÃ¼k Turnuva"),
                      bg="#0088cc", fg="white", relief="flat", width=12).pack(side="left", padx=5)
            tk.Button(btn_frame, text="Kapat", command=popup.destroy,
                      bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat", width=12).pack(side="left", padx=5)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ’° KASA YÃ–NETÄ°M DANIÅMANI - V5.7 YENÄ° (#22)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def kasa_onerisi_hesapla(self, guven_skoru):
        """GÃ¼ven skoruna gÃ¶re kasa Ã¶nerisi hesapla"""
        if isinstance(guven_skoru, str):
            try:
                guven_skoru = int(guven_skoru.split("/")[0])
            except:
                guven_skoru = 5
        
        if guven_skoru >= 10:
            return {"emoji": "ğŸ’", "oran": 25, "aciklama": "ELÄ°T - Max kasa!", "renk": "#FFD700"}
        elif guven_skoru >= 9:
            return {"emoji": "ğŸ”¥", "oran": 20, "aciklama": "Ã‡ok gÃ¼Ã§lÃ¼", "renk": "#FF6600"}
        elif guven_skoru >= 8:
            return {"emoji": "ğŸ’ª", "oran": 15, "aciklama": "GÃ¼Ã§lÃ¼", "renk": "#00CC00"}
        elif guven_skoru >= 7:
            return {"emoji": "âš–ï¸", "oran": 10, "aciklama": "Standart", "renk": "#0099FF"}
        elif guven_skoru >= 6:
            return {"emoji": "âš ï¸", "oran": 8, "aciklama": "Dikkatli ol", "renk": "#FFCC00"}
        else:
            return {"emoji": "â“", "oran": 5, "aciklama": "Riskli", "renk": "#FF0000"}

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“ MAÃ‡ YORUM OLUÅTURUCU - V5.7 YENÄ° (#79)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def mac_yorumu_olustur(self, mac_data):
        """Profesyonel maÃ§ yorumu oluÅŸtur"""
        mac = mac_data.get("mac", "?")
        banko = mac_data.get("banko", "?")
        sigorta = mac_data.get("sigorta", "?")
        guven = mac_data.get("guven", "?")
        lig = mac_data.get("lig", "?")
        
        # Liste kontrolÃ¼
        liste_tip, liste_msg = self.liste_kontrol(mac)
        
        # Kasa Ã¶nerisi
        kasa = self.kasa_onerisi_hesapla(guven)
        
        yorum = f"""
ğŸ“Š PROFESYONEL ANALÄ°Z

âš½ {mac}
ğŸ† {lig}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ TAHMÄ°N: {banko}
ğŸ”’ SÄ°GORTA: {sigorta}
ğŸ“Š GÃœVEN: {guven}/10 {kasa['emoji']}
ğŸ’° KASA Ã–NERÄ°SÄ°: %{kasa['oran']} ({kasa['aciklama']})

{liste_msg if liste_msg else ''}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸ Bu analiz yatÄ±rÄ±m tavsiyesi deÄŸildir.
Sorumluluk tamamen size aittir.

#XGXray #FutbolAnaliz
"""
        return yorum

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ’¡ GÃœNÃœN Ä°PUCU POPUP - V5.7 YENÄ° (#88)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def gunun_ipucu_popup(self):
        """GÃ¼nÃ¼n motivasyon ipucunu gÃ¶ster"""
        ipucu = random.choice(GUNUN_IPUCLARI)
        messagebox.showinfo("ğŸ’¡ GÃ¼nÃ¼n Ä°pucu", ipucu)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ” PATTERN FINDER - V5.7 YENÄ° (#27)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def pattern_finder_popup(self):
        """Kazanan pattern'leri bul"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ” Pattern Finder")
        popup.geometry("600x500")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ” KAZANAN PATTERN'LERÄ° BUL", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=15)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Pattern analizi yap
        patterns = {}
        
        for mac in self.mac_db:
            if mac.get("sonuc") not in ["KAZANDI", "âœ…"]:
                continue
            
            banko = mac.get("banko", "?")
            lig = mac.get("lig", "?")
            guven = mac.get("guven", "?")
            
            # Banko tÃ¼rÃ¼ pattern
            if banko not in patterns:
                patterns[banko] = {"toplam": 0, "kazanan": 0}
            patterns[banko]["kazanan"] += 1
        
        # TÃ¼m maÃ§larÄ± say
        for mac in self.mac_db:
            banko = mac.get("banko", "?")
            if banko in patterns:
                patterns[banko]["toplam"] += 1
        
        # SonuÃ§larÄ± gÃ¶ster
        rapor = "â•" * 50 + "\n"
        rapor += "        ğŸ” KAZANAN PATTERN'LER\n"
        rapor += "â•" * 50 + "\n\n"
        
        sorted_patterns = sorted(patterns.items(), key=lambda x: x[1]["kazanan"], reverse=True)
        
        for banko, data in sorted_patterns[:15]:
            if data["toplam"] > 0:
                basari = (data["kazanan"] / data["toplam"]) * 100
                emoji = "ğŸ”¥" if basari >= 70 else ("âœ…" if basari >= 50 else "âš ï¸")
                rapor += f"{emoji} {banko[:25]:25} | {data['kazanan']:3}/{data['toplam']:3} | %{basari:.0f}\n"
        
        rapor += "\n" + "â•" * 50
        rapor += "\nğŸ’¡ Ä°PUCU: %70+ baÅŸarÄ±lÄ± pattern'lere odaklan!"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸŒ¡ï¸ SICAKLIK HARÄ°TASI - V5.7 YENÄ° (#26)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def sicaklik_haritasi_popup(self):
        """GÃ¼ven skoruna gÃ¶re sÄ±caklÄ±k haritasÄ±"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸŒ¡ï¸ SÄ±caklÄ±k HaritasÄ±")
        popup.geometry("500x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸŒ¡ï¸ MAÃ‡ SICAKLIK HARÄ°TASI", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(pady=15)
        
        # GÃ¼ven skorlarÄ±na gÃ¶re grupla
        gruplar = {
            "ğŸŸ¢ GÃœVENLÄ° (9-10)": [],
            "ğŸŸ¡ ORTA (7-8)": [],
            "ğŸŸ  RÄ°SKLÄ° (5-6)": [],
            "ğŸ”´ TEHLÄ°KE (1-4)": []
        }
        
        bugun = datetime.now().strftime("%d.%m.%Y")
        
        for mac in self.mac_db:
            if mac.get("tarih") != bugun:
                continue
            
            guven = mac.get("guven", 5)
            if isinstance(guven, str):
                try:
                    guven = int(guven.split("/")[0])
                except:
                    guven = 5
            
            mac_adi = mac.get("mac", "?")[:20]
            banko = mac.get("banko", "?")[:15]
            
            if guven >= 9:
                gruplar["ğŸŸ¢ GÃœVENLÄ° (9-10)"].append(f"{mac_adi} â†’ {banko}")
            elif guven >= 7:
                gruplar["ğŸŸ¡ ORTA (7-8)"].append(f"{mac_adi} â†’ {banko}")
            elif guven >= 5:
                gruplar["ğŸŸ  RÄ°SKLÄ° (5-6)"].append(f"{mac_adi} â†’ {banko}")
            else:
                gruplar["ğŸ”´ TEHLÄ°KE (1-4)"].append(f"{mac_adi} â†’ {banko}")
        
        # Canvas ile gÃ¶ster
        canvas = tk.Canvas(popup, bg=ModernTheme.BG_PRIMARY, highlightthickness=0)
        canvas.pack(fill="both", expand=True, padx=20, pady=10)
        
        y = 20
        renkler = {"ğŸŸ¢": "#22c55e", "ğŸŸ¡": "#eab308", "ğŸŸ ": "#f97316", "ğŸ”´": "#ef4444"}
        
        for grup, maclar in gruplar.items():
            renk = renkler.get(grup[0], "#ffffff")
            canvas.create_text(20, y, text=f"{grup} ({len(maclar)} maÃ§)", anchor="w", 
                              fill=renk, font=("Segoe UI", 12, "bold"))
            y += 25
            
            for mac in maclar[:5]:
                canvas.create_text(40, y, text=f"â€¢ {mac}", anchor="w", 
                                  fill=ModernTheme.TEXT_SECONDARY, font=("Segoe UI", 10))
                y += 20
            
            y += 10
        
        if y == 20:
            canvas.create_text(200, 150, text="BugÃ¼n analiz yok!", fill=ModernTheme.TEXT_SECONDARY)
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“± SOSYAL MEDYA ÅABLONLARI - V5.7 YENÄ° (#18)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def sosyal_sablon_popup(self):
        """V70: Sosyal medya ÅŸablonu oluÅŸtur - FÄ°L HAFIZASI DESTEKLÄ°"""
        # V70: FÄ°L HAFIZASI kontrolÃ¼ - 3 aÅŸamalÄ± arama
        if not hasattr(self, 'current_analysis') or not self.current_analysis:
            if self.mac_db:
                self.current_analysis = self.mac_db[-1]
            elif hasattr(self, 'mac_arsivi') and self.mac_arsivi:
                self.current_analysis = list(self.mac_arsivi.values())[-1]
            else:
                messagebox.showwarning("UyarÄ±", "HenÃ¼z analiz yapÄ±lmamÄ±ÅŸ!\n\nLÃ¼tfen Ã¶nce bir gÃ¶rsel yÃ¼kleyip analiz yapÄ±n.")
                return
        
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“± Sosyal Medya Åablonu")
        popup.geometry("500x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“± SOSYAL MEDYA ÅABLONU", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        # Platform seÃ§imi
        frm = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        frm.pack(fill="x", padx=20)
        
        tk.Label(frm, text="Platform:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack(side="left")
        self.var_platform = tk.StringVar(value="twitter")
        
        for val, txt in [("twitter", "Twitter/X"), ("instagram", "Instagram"), ("telegram", "Telegram")]:
            tk.Radiobutton(frm, text=txt, variable=self.var_platform, value=val,
                          bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY,
                          selectcolor=ModernTheme.BG_CARD,
                          command=lambda: self._sosyal_onizleme_guncelle()).pack(side="left", padx=10)
        
        # Ã–nizleme
        tk.Label(popup, text="ğŸ“ Ã–nizleme:", bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(anchor="w", padx=20, pady=(10, 5))
        
        self.sosyal_text = scrolledtext.ScrolledText(popup, height=15, bg="#0a0a0a", fg="#00ff00", font=("Consolas", 10))
        self.sosyal_text.pack(fill="both", expand=True, padx=20)
        
        self._sosyal_onizleme_guncelle()
        
        # Butonlar
        frm_btn = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        frm_btn.pack(fill="x", padx=20, pady=10)
        
        tk.Button(frm_btn, text="ğŸ“‹ Kopyala", command=self._sosyal_kopyala,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(frm_btn, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=5)
    
    def _sosyal_onizleme_guncelle(self):
        """Sosyal medya Ã¶nizlemesini gÃ¼ncelle"""
        if not hasattr(self, 'sosyal_text'):
            return
        
        self.sosyal_text.delete("1.0", tk.END)
        
        mac = self.current_analysis
        platform = self.var_platform.get() if hasattr(self, 'var_platform') else "twitter"
        
        mac_adi = mac.get("mac", "?")
        banko = mac.get("banko", "?")
        guven = mac.get("guven", "?")
        kasa = self.kasa_onerisi_hesapla(guven)
        
        if platform == "twitter":
            mesaj = f"""ğŸ¯ GÃœNÃœN TAHMÄ°NÄ°

âš½ {mac_adi}
âœ… {banko}
ğŸ“Š GÃ¼ven: {guven}/10 {kasa['emoji']}
ğŸ’° Kasa: %{kasa['oran']}

#Bahis #Futbol #Ä°ddaa #XGXray"""
        
        elif platform == "instagram":
            mesaj = f"""ğŸ¯ GÃœNÃœN ANALÄ°ZÄ°

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš½ {mac_adi}

âœ… TAHMÄ°N: {banko}
ğŸ“Š GÃœVEN: {guven}/10 {kasa['emoji']}
ğŸ’° KASA: %{kasa['oran']}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸ 18+ | Sorumluluk size aittir

#bahis #futbol #iddaa #analiz #tahmin #maÃ§ #spor"""
        
        else:  # telegram
            mesaj = f"""ğŸ“Š ANALÄ°Z

âš½ {mac_adi}
ğŸ† {mac.get('lig', '?')}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ BANKO: {banko}
ğŸ”’ SÄ°GORTA: {mac.get('sigorta', '?')}
ğŸ“Š GÃœVEN: {guven}/10 {kasa['emoji']}
ğŸ’° KASA: %{kasa['oran']}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸ Sorumluluk size aittir"""
        
        self.sosyal_text.insert("1.0", mesaj)
    
    def _sosyal_kopyala(self):
        """Sosyal medya metnini panoya kopyala"""
        metin = self.sosyal_text.get("1.0", tk.END)
        self.root.clipboard_clear()
        self.root.clipboard_append(metin)
        messagebox.showinfo("âœ…", "Panoya kopyalandÄ±!")

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ’ GÄ°ZLÄ° BANKO POPUP - V5.7 YENÄ° (#82)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def gizli_banko_popup(self):
        """Gizli banko maÃ§larÄ± gÃ¶ster"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ’ Gizli Bankolar")
        popup.geometry("550x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ’ GÄ°ZLÄ° BANKO TESPÄ°TÄ°", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg="#FFD700").pack(pady=15)
        
        tk.Label(popup, text="10/10 + Elit Lig + Kazanan Pattern = GÄ°ZLÄ° BANKO", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#FFD700")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Gizli bankolarÄ± bul
        gizli_bankolar = []
        
        for mac in self.mac_db:
            is_gizli, msg = self.gizli_banko_kontrol(mac)
            if is_gizli:
                gizli_bankolar.append(mac)
        
        if gizli_bankolar:
            rapor = "ğŸ’ TESPÄ°T EDÄ°LEN GÄ°ZLÄ° BANKOLAR:\n"
            rapor += "â•" * 45 + "\n\n"
            
            for mac in gizli_bankolar[-10:]:
                rapor += f"â­ {mac.get('tarih', '?')} | {mac.get('mac', '?')[:25]}\n"
                rapor += f"   ğŸ¯ {mac.get('banko', '?')} | ğŸ† {mac.get('lig', '?')[:20]}\n\n"
        else:
            rapor = "âŒ Åu an gizli banko tespit edilmedi.\n\n"
            rapor += "ğŸ’¡ Gizli banko kriterleri:\n"
            rapor += "   â€¢ 10/10 gÃ¼ven skoru\n"
            rapor += "   â€¢ Elit liglerden biri\n"
            rapor += "   â€¢ AynÄ± bahis tÃ¼rÃ¼nde %80+ baÅŸarÄ±\n"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ’° KASA DANIÅMANI POPUP - V5.7 YENÄ° (#22)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def kasa_danismani_popup(self):
        """Kasa yÃ¶netimi danÄ±ÅŸmanÄ±"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ’° Kasa DanÄ±ÅŸmanÄ±")
        popup.geometry("450x350")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ’° KASA YÃ–NETÄ°M DANIÅMANI", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_SUCCESS).pack(pady=15)
        
        # Kasa giriÅŸi
        frm = tk.Frame(popup, bg=ModernTheme.BG_CARD)
        frm.pack(fill="x", padx=20, pady=10)
        
        tk.Label(frm, text="Toplam Kasa (â‚º):", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10, pady=10)
        self.entry_kasa = tk.Entry(frm, width=15, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_kasa.insert(0, "1000")
        self.entry_kasa.pack(side="left", padx=10)
        
        tk.Label(frm, text="GÃ¼ven Skoru:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).pack(side="left", padx=10)
        self.combo_kasa_guven = ttk.Combobox(frm, values=["5", "6", "7", "8", "9", "10"], width=5)
        self.combo_kasa_guven.set("8")
        self.combo_kasa_guven.pack(side="left", padx=10)
        
        tk.Button(frm, text="Hesapla", command=self._kasa_hesapla,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=20)
        
        # SonuÃ§
        self.lbl_kasa_sonuc = tk.Label(popup, text="", font=("Consolas", 12),
                                        bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY, justify="left")
        self.lbl_kasa_sonuc.pack(pady=20)
        
        # Tablo
        tablo = """
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GÃœVEN  â”‚  KASA  â”‚    AÃ‡IKLAMA     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  10/10 â”‚  %25   â”‚ ğŸ’ ELÄ°T         â”‚
â”‚   9/10 â”‚  %20   â”‚ ğŸ”¥ Ã‡ok GÃ¼Ã§lÃ¼    â”‚
â”‚   8/10 â”‚  %15   â”‚ ğŸ’ª GÃ¼Ã§lÃ¼        â”‚
â”‚   7/10 â”‚  %10   â”‚ âš–ï¸ Standart     â”‚
â”‚   6/10 â”‚  %8    â”‚ âš ï¸ Dikkat       â”‚
â”‚   5/10 â”‚  %5    â”‚ â“ Riskli       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
"""
        tk.Label(popup, text=tablo, font=("Consolas", 9), bg=ModernTheme.BG_PRIMARY, 
                fg=ModernTheme.TEXT_SECONDARY, justify="left").pack()
    
    def _kasa_hesapla(self):
        """Kasa Ã¶nerisini hesapla"""
        try:
            kasa = float(self.entry_kasa.get())
            guven = int(self.combo_kasa_guven.get())
            
            oneri = self.kasa_onerisi_hesapla(guven)
            miktar = kasa * oneri["oran"] / 100
            
            self.lbl_kasa_sonuc.config(
                text=f"""
{oneri['emoji']} GÃœVEN: {guven}/10

ğŸ’° Ã–NERÄ°LEN BAHÄ°S: â‚º{miktar:.2f}
ğŸ“Š KASA ORANI: %{oneri['oran']}
ğŸ“ DURUM: {oneri['aciklama']}
""",
                fg=oneri.get("renk", "#ffffff")
            )
        except:
            self.lbl_kasa_sonuc.config(text="âŒ GeÃ§erli deÄŸer girin!", fg="#ff0000")

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ” BENZER MAÃ‡ BULUCU - V5.7 YENÄ° (#10)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def _benzer_mac_popup(self):
        """V70: Benzer maÃ§larÄ± bul ve gÃ¶ster - FÄ°L HAFIZASI DESTEKLÄ°"""
        # V70: Yeni yardÄ±mcÄ± fonksiyon kullan
        if not self._analiz_kontrol():
            return
        
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ” Benzer MaÃ§lar")
        popup.geometry("600x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ” BENZER MAÃ‡ ANALÄ°ZÄ°", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        mac = self.current_analysis
        banko = mac.get("banko", "")
        lig = mac.get("lig", "")
        
        tk.Label(popup, text=f"Aranan: {banko} | {lig}", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Benzer maÃ§larÄ± bul
        benzerler = []
        for m in self.mac_db:
            skor = 0
            
            # AynÄ± bahis tÃ¼rÃ¼
            if banko and banko in m.get("banko", ""):
                skor += 3
            
            # AynÄ± lig
            if lig and lig.lower() in m.get("lig", "").lower():
                skor += 2
            
            # Benzer gÃ¼ven skoru
            guven1 = mac.get("guven", 0)
            guven2 = m.get("guven", 0)
            if isinstance(guven1, str):
                try: guven1 = int(guven1.split("/")[0])
                except: guven1 = 0
            if isinstance(guven2, str):
                try: guven2 = int(guven2.split("/")[0])
                except: guven2 = 0
            
            if abs(guven1 - guven2) <= 1:
                skor += 1
            
            if skor >= 3:
                benzerler.append((m, skor))
        
        # Skoruna gÃ¶re sÄ±rala
        benzerler.sort(key=lambda x: x[1], reverse=True)
        
        rapor = f"ğŸ” BENZER MAÃ‡LAR ({len(benzerler)} adet)\n"
        rapor += "â•" * 50 + "\n\n"
        
        kazanan = 0
        kaybeden = 0
        
        for m, skor in benzerler[:15]:
            sonuc = m.get("sonuc", "?")
            if sonuc in ["KAZANDI", "âœ…"]:
                emoji = "âœ…"
                kazanan += 1
            elif sonuc in ["KAYBETTÄ°", "âŒ"]:
                emoji = "âŒ"
                kaybeden += 1
            else:
                emoji = "â³"
            
            rapor += f"{emoji} {m.get('tarih', '?')} | {m.get('mac', '?')[:22]} | {m.get('banko', '?')[:12]}\n"
        
        toplam = kazanan + kaybeden
        basari = (kazanan / toplam * 100) if toplam > 0 else 0
        
        rapor += f"\n" + "â•" * 50 + "\n"
        rapor += f"ğŸ“Š SONUÃ‡: {kazanan} KazandÄ± / {kaybeden} Kaybetti = %{basari:.0f} BaÅŸarÄ±\n"
        
        if basari >= 70:
            rapor += "ğŸ’¡ Bu tip maÃ§larda baÅŸarÄ±lÄ±sÄ±n! ğŸ”¥"
        elif basari >= 50:
            rapor += "ğŸ’¡ Orta seviye baÅŸarÄ±, dikkatli ol."
        else:
            rapor += "ğŸ’¡ Bu tip maÃ§larda zorlanÄ±yorsun! âš ï¸"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“ MAÃ‡ YORUMU POPUP - V5.7 YENÄ° (#79)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def _mac_yorumu_popup(self):
        """V70: Profesyonel maÃ§ yorumu oluÅŸtur - FÄ°L HAFIZASI DESTEKLÄ°"""
        # V70: Yeni yardÄ±mcÄ± fonksiyon kullan
        if not self._analiz_kontrol():
            return
        
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“ MaÃ§ Yorumu")
        popup.geometry("500x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“ PROFESYONEl MAÃ‡ YORUMU", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        yorum = self.mac_yorumu_olustur(self.current_analysis)
        text.insert("1.0", yorum)
        
        # Butonlar
        frm = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        frm.pack(fill="x", padx=20, pady=10)
        
        def kopyala():
            self.root.clipboard_clear()
            self.root.clipboard_append(yorum)
            messagebox.showinfo("âœ…", "Panoya kopyalandÄ±!")
        
        tk.Button(frm, text="ğŸ“‹ Kopyala", command=kopyala,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(side="left", padx=5)
        tk.Button(frm, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(side="left", padx=5)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # â­ FAVORÄ°LER SÄ°STEMÄ° - V5.7 YENÄ° (#56)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def _favoriye_ekle(self):
        """V70: Mevcut analizi favorilere ekle - FÄ°L HAFIZASI DESTEKLÄ°"""
        # V70: Yeni yardÄ±mcÄ± fonksiyon kullan
        if not self._analiz_kontrol():
            return
        
        if not hasattr(self, 'favoriler'):
            self.favoriler = self._load_json(os.path.join(BASE_DIR, "favoriler.json"), [])
        
        mac = self.current_analysis
        
        # Zaten var mÄ± kontrol et
        mac_adi = mac.get("mac", mac.get("mac_adi", ""))
        for f in self.favoriler:
            if f.get("mac", f.get("mac_adi", "")) == mac_adi:
                messagebox.showinfo("Bilgi", "Bu maÃ§ zaten favorilerde!")
                return
        
        self.favoriler.append(mac)
        self._save_json(os.path.join(BASE_DIR, "favoriler.json"), self.favoriler)
        messagebox.showinfo("âœ…", f"'{mac_adi}' favorilere eklendi!")
    
    def favoriler_popup(self):
        """Favorileri gÃ¶ster"""
        if not hasattr(self, 'favoriler'):
            self.favoriler = self._load_json(os.path.join(BASE_DIR, "favoriler.json"), [])
        
        if not self.favoriler:
            messagebox.showinfo("â­ Favoriler", "HenÃ¼z favori maÃ§ yok!")
            return
        
        popup = tk.Toplevel(self.root)
        popup.title("â­ Favoriler")
        popup.geometry("600x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="â­ FAVORÄ° MAÃ‡LARIM", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg="#ffc107").pack(pady=10)
        
        # Tablo
        cols = ("tarih", "mac", "banko", "guven", "sonuc")
        tree = ttk.Treeview(popup, columns=cols, show="headings", height=12)
        for c, w in [("tarih", 80), ("mac", 200), ("banko", 120), ("guven", 60), ("sonuc", 80)]:
            tree.heading(c, text=c.upper())
            tree.column(c, width=w, anchor="center")
        tree.pack(fill="both", expand=True, padx=20, pady=10)
        
        for mac in self.favoriler:
            tree.insert("", "end", values=(
                mac.get("tarih", "?"),
                mac.get("mac", mac.get("mac_adi", "?"))[:25],
                mac.get("banko", "?")[:15],
                mac.get("guven", "?"),
                mac.get("sonuc", "BEKLÄ°YOR")
            ))
        
        def sil():
            sel = tree.selection()
            if sel:
                idx = tree.index(sel[0])
                self.favoriler.pop(idx)
                self._save_json(os.path.join(BASE_DIR, "favoriler.json"), self.favoriler)
                tree.delete(sel[0])
        
        tk.Button(popup, text="ğŸ—‘ï¸ SeÃ§iliyi Sil", command=sil,
                  bg=ModernTheme.ACCENT_DANGER, fg="white", relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“Š LÄ°G PERFORMANS ANALÄ°ZÄ° - V5.7 YENÄ° (#24)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def lig_performans_popup(self):
        """Lig bazlÄ± performans analizi - Telegram/Kaydet ile"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“Š Lig PerformansÄ±")
        popup.geometry("650x500")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“Š LÄ°G BAZLI PERFORMANS", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Lig bazlÄ± istatistik
        ligler = {}
        for mac in self.mac_db:
            lig = mac.get("lig", "Bilinmiyor")
            if lig not in ligler:
                ligler[lig] = {"toplam": 0, "kazanan": 0, "kaybeden": 0}
            
            ligler[lig]["toplam"] += 1
            sonuc = mac.get("sonuc", "")
            if sonuc in ["KAZANDI", "âœ…"]:
                ligler[lig]["kazanan"] += 1
            elif sonuc in ["KAYBETTÄ°", "âŒ"]:
                ligler[lig]["kaybeden"] += 1
        
        rapor = "ğŸ“Š LÄ°G BAZLI PERFORMANS ANALÄ°ZÄ°\n"
        rapor += "â•" * 55 + "\n\n"
        
        sorted_ligler = sorted(ligler.items(), key=lambda x: x[1]["toplam"], reverse=True)
        
        for lig, data in sorted_ligler[:20]:
            decided = data["kazanan"] + data["kaybeden"]
            basari = (data["kazanan"] / decided * 100) if decided > 0 else 0
            
            if basari >= 70:
                emoji = "ğŸ”¥"
            elif basari >= 50:
                emoji = "âœ…"
            else:
                emoji = "âš ï¸"
            
            rapor += f"{emoji} {lig[:25]:25} | {data['toplam']:3} maÃ§ | âœ…{data['kazanan']:2} âŒ{data['kaybeden']:2} | %{basari:.0f}\n"
        
        rapor += "\n" + "â•" * 55 + "\n"
        
        text.insert("1.0", rapor)
        self._lig_performans_text = rapor
        
        btn_frame = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        btn_frame.pack(pady=10)
        
        def kaydet_lig():
            dosya = filedialog.asksaveasfilename(defaultextension=".txt", 
                    initialfilename=f"lig_performans_{datetime.now().strftime('%Y%m%d')}.txt")
            if dosya:
                with open(dosya, "w", encoding="utf-8") as f:
                    f.write(self._lig_performans_text)
                messagebox.showinfo("âœ…", f"Kaydedildi: {dosya}")
        
        tk.Button(btn_frame, text="ğŸ’¾ Kaydet", command=kaydet_lig,
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat", width=12).pack(side="left", padx=5)
        tk.Button(btn_frame, text="ğŸ“± Telegram", 
                  command=lambda: self.kanal_sec_ve_gonder(self._lig_performans_text, "Lig PerformansÄ±"),
                  bg="#0088cc", fg="white", relief="flat", width=12).pack(side="left", padx=5)
        tk.Button(btn_frame, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat", width=12).pack(side="left", padx=5)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“ˆ TREND ANALÄ°ZÄ° - V5.7 YENÄ° (#25)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def trend_analizi_popup(self):
        """Son dÃ¶nem trend analizi"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“ˆ Trend Analizi")
        popup.geometry("550x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“ˆ TREND ANALÄ°ZÄ°", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_SUCCESS).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Son 10 maÃ§Ä±n trend analizi
        son_maclar = self.mac_db[-10:]
        
        kazanan_seri = 0
        kaybeden_seri = 0
        current_seri = 0
        seri_tip = None
        
        for mac in reversed(son_maclar):
            sonuc = mac.get("sonuc", "")
            if sonuc in ["KAZANDI", "âœ…"]:
                if seri_tip == "kazanan" or seri_tip is None:
                    current_seri += 1
                    seri_tip = "kazanan"
                else:
                    break
            elif sonuc in ["KAYBETTÄ°", "âŒ"]:
                if seri_tip == "kaybeden" or seri_tip is None:
                    current_seri += 1
                    seri_tip = "kaybeden"
                else:
                    break
        
        rapor = "ğŸ“ˆ MEVCUT TREND ANALÄ°ZÄ°\n"
        rapor += "â•" * 45 + "\n\n"
        
        if seri_tip == "kazanan":
            rapor += f"ğŸ”¥ {current_seri} MAÃ‡LIK KAZANMA SERÄ°SÄ°NDESÄ°N!\n\n"
            rapor += "ğŸ’¡ Ã–neriler:\n"
            rapor += "   â€¢ Seriye devam et ama aÅŸÄ±rÄ± gÃ¼venme\n"
            rapor += "   â€¢ Kasa yÃ¶netimine dikkat et\n"
            rapor += "   â€¢ GÃ¼ven skoru 8+ maÃ§lara odaklan\n"
        elif seri_tip == "kaybeden":
            rapor += f"âš ï¸ {current_seri} MAÃ‡LIK KAYIP SERÄ°SÄ°NDESÄ°N!\n\n"
            rapor += "ğŸ’¡ Ã–neriler:\n"
            rapor += "   â€¢ Mola ver, sakinleÅŸ\n"
            rapor += "   â€¢ Sadece 9-10 gÃ¼ven skorlu maÃ§lara gir\n"
            rapor += "   â€¢ Kasa miktarÄ±nÄ± dÃ¼ÅŸÃ¼r\n"
            rapor += "   â€¢ Pattern Finder ile analiz yap\n"
        else:
            rapor += "ğŸ“Š Belirgin bir seri yok.\n\n"
        
        # Son 10 maÃ§ Ã¶zeti
        rapor += "\n" + "â•" * 45 + "\n"
        rapor += "SON 10 MAÃ‡:\n"
        for mac in son_maclar[-10:]:
            sonuc = mac.get("sonuc", "?")
            emoji = "âœ…" if sonuc in ["KAZANDI", "âœ…"] else ("âŒ" if sonuc in ["KAYBETTÄ°", "âŒ"] else "â³")
            rapor += f"{emoji} "
        
        text.insert("1.0", rapor)
        self._trend_analiz_text = rapor
        
        btn_frame = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        btn_frame.pack(pady=10)
        
        tk.Button(btn_frame, text="ğŸ“± Telegram", 
                  command=lambda: self.kanal_sec_ve_gonder(self._trend_analiz_text, "Trend Analizi"),
                  bg="#0088cc", fg="white", relief="flat", width=12).pack(side="left", padx=5)
        tk.Button(btn_frame, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat", width=12).pack(side="left", padx=5)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ’¹ ROI HESAPLAMA - V5.7 YENÄ° (#28)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def roi_hesaplama_popup(self):
        """ROI (Return on Investment) hesaplama"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ’¹ ROI Hesaplama")
        popup.geometry("500x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ’¹ ROI HESAPLAMA", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_SUCCESS).pack(pady=10)
        
        # GiriÅŸ
        frm = tk.Frame(popup, bg=ModernTheme.BG_CARD)
        frm.pack(fill="x", padx=20, pady=10)
        
        tk.Label(frm, text="Toplam YatÄ±rÄ±m (â‚º):", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=0, column=0, padx=10, pady=5, sticky="w")
        self.entry_yatirim = tk.Entry(frm, width=15, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_yatirim.insert(0, "1000")
        self.entry_yatirim.grid(row=0, column=1, padx=10, pady=5)
        
        tk.Label(frm, text="Ort. Oran:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=1, column=0, padx=10, pady=5, sticky="w")
        self.entry_oran = tk.Entry(frm, width=15, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.entry_oran.insert(0, "1.75")
        self.entry_oran.grid(row=1, column=1, padx=10, pady=5)
        
        tk.Button(frm, text="Hesapla", command=self._roi_hesapla,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").grid(row=2, column=0, columnspan=2, pady=10)
        
        # SonuÃ§
        self.roi_sonuc_label = tk.Label(popup, text="", font=("Consolas", 11),
                                         bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY, justify="left")
        self.roi_sonuc_label.pack(pady=20)
        
        # ArÅŸivden otomatik hesapla
        self._roi_arsivden_hesapla(popup)
    
    def _roi_hesapla(self):
        """ROI hesapla"""
        try:
            yatirim = float(self.entry_yatirim.get())
            oran = float(self.entry_oran.get())
            
            # ArÅŸivden baÅŸarÄ± oranÄ± al
            toplam = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]])
            kazanan = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…"]])
            basari = (kazanan / toplam * 100) if toplam > 0 else 50
            
            # ROI hesapla: (KazanÃ§ - YatÄ±rÄ±m) / YatÄ±rÄ±m * 100
            beklenen_kazanc = (basari/100) * yatirim * oran
            kayip = ((100-basari)/100) * yatirim
            net = beklenen_kazanc - kayip
            roi = (net / yatirim) * 100
            
            self.roi_sonuc_label.config(text=f"""
ğŸ“Š HESAPLAMA SONUCU
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’° Toplam YatÄ±rÄ±m: â‚º{yatirim:.2f}
ğŸ“ˆ Ortalama Oran: {oran}
âœ… BaÅŸarÄ± OranÄ±: %{basari:.1f}

ğŸ’¹ Beklenen ROI: %{roi:.1f}
{'ğŸ”¥ KÃ‚RDASIN!' if roi > 0 else 'âš ï¸ ZARARDASIN!'}

ğŸ“ Net Beklenti: â‚º{net:.2f}
""", fg="#22c55e" if roi > 0 else "#ef4444")
        except:
            self.roi_sonuc_label.config(text="âŒ GeÃ§erli deÄŸer girin!", fg="#ef4444")
    
    def _roi_arsivden_hesapla(self, popup):
        """ArÅŸivden otomatik ROI hesapla"""
        toplam = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]])
        kazanan = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…"]])
        
        info = f"ğŸ“Š ArÅŸiv: {toplam} sonuÃ§lanmÄ±ÅŸ maÃ§, {kazanan} kazanan"
        tk.Label(popup, text=info, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ”¥ STREAK TAKÄ°P - V5.7 YENÄ° (#29)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def streak_takip_popup(self):
        """Kazanma/kaybetme serisi takibi"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ”¥ Streak Takip")
        popup.geometry("500x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ”¥ STREAK TAKÄ°P", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Streak analizi
        max_kazanma = 0
        max_kayip = 0
        current_kazanma = 0
        current_kayip = 0
        mevcut_seri = 0
        mevcut_tip = None
        
        for mac in self.mac_db:
            sonuc = mac.get("sonuc", "")
            if sonuc in ["KAZANDI", "âœ…"]:
                current_kazanma += 1
                current_kayip = 0
                if current_kazanma > max_kazanma:
                    max_kazanma = current_kazanma
            elif sonuc in ["KAYBETTÄ°", "âŒ"]:
                current_kayip += 1
                current_kazanma = 0
                if current_kayip > max_kayip:
                    max_kayip = current_kayip
        
        # Mevcut seriyi bul
        for mac in reversed(self.mac_db):
            sonuc = mac.get("sonuc", "")
            if sonuc in ["KAZANDI", "âœ…"]:
                if mevcut_tip is None or mevcut_tip == "K":
                    mevcut_seri += 1
                    mevcut_tip = "K"
                else:
                    break
            elif sonuc in ["KAYBETTÄ°", "âŒ"]:
                if mevcut_tip is None or mevcut_tip == "L":
                    mevcut_seri += 1
                    mevcut_tip = "L"
                else:
                    break
            else:
                continue
        
        rapor = "ğŸ”¥ STREAK ANALÄ°ZÄ°\n"
        rapor += "â•" * 40 + "\n\n"
        rapor += f"ğŸ† En Uzun Kazanma Serisi: {max_kazanma} maÃ§\n"
        rapor += f"ğŸ’€ En Uzun KayÄ±p Serisi: {max_kayip} maÃ§\n\n"
        rapor += "â•" * 40 + "\n\n"
        
        if mevcut_tip == "K":
            rapor += f"ğŸ”¥ MEVCUT: {mevcut_seri} MAÃ‡LIK KAZANMA SERÄ°SÄ°!\n\n"
            if mevcut_seri >= 5:
                rapor += "âš ï¸ Dikkat: Uzun seriler tehlikeli olabilir!\n"
                rapor += "ğŸ’¡ Kasa korumasÄ±na geÃ§.\n"
            else:
                rapor += "âœ… Devam et, iyi gidiyorsun!\n"
        elif mevcut_tip == "L":
            rapor += f"âŒ MEVCUT: {mevcut_seri} MAÃ‡LIK KAYIP SERÄ°SÄ°!\n\n"
            if mevcut_seri >= 3:
                rapor += "ğŸš¨ UYARI: Mola zamanÄ±!\n"
                rapor += "ğŸ’¡ Panik modunu aktifleÅŸtir.\n"
            else:
                rapor += "âš ï¸ Dikkatli ol, seriden Ã§Ä±k.\n"
        else:
            rapor += "ğŸ“Š HenÃ¼z sonuÃ§lanmÄ±ÅŸ maÃ§ yok.\n"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # âš ï¸ RÄ°SK ANALÄ°ZÄ° - V5.7 YENÄ° (#30)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def risk_analizi_popup(self):
        """V70: Risk seviyesi analizi - DETAYLANDIRILMIÅ
        
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        ğŸ¯ RÄ°SK ANALÄ°ZÄ° NASIL Ã‡ALIÅIR?
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        Risk skoru 5 farklÄ± faktÃ¶re gÃ¶re hesaplanÄ±r:
        
        1. GÃœVEN SKORU (0-3 puan):
           - 8-10 gÃ¼ven: 0 risk puanÄ± (gÃ¼venli)
           - 7 gÃ¼ven: 1 risk puanÄ± (orta)
           - 6 ve altÄ±: 3 risk puanÄ± (yÃ¼ksek risk)
        
        2. LÄ°G KONTROLÃ¼ (0-2 puan):
           - Elit lig (Premier, La Liga vb): 0 risk puanÄ±
           - Normal lig: 2 risk puanÄ±
        
        3. KARA/ALTIN LÄ°STE (0-3 puan):
           - AltÄ±n liste: 0 risk puanÄ± (bonus)
           - Kara liste: 3 risk puanÄ± (tehlike!)
           - Listede deÄŸil: 0 puan
        
        4. BENZER MAÃ‡ BAÅARISI (0-2 puan):
           - %60+ baÅŸarÄ±: 0 risk puanÄ±
           - %50 altÄ±: 2 risk puanÄ±
        
        5. VETO DURUMU (0-2 puan):
           - Veto yok: 0 risk puanÄ±
           - Veto var: 2 risk puanÄ±
        
        SONUÃ‡:
        - 0-2 puan: ğŸŸ¢ DÃœÅÃœK RÄ°SK â†’ RahatlÄ±kla oynanÄ±r
        - 3-5 puan: ğŸŸ¡ ORTA RÄ°SK â†’ Dikkatli olunmalÄ±
        - 6+ puan: ğŸ”´ YÃœKSEK RÄ°SK â†’ Ã–nerilmez
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        """
        # V70: Yeni yardÄ±mcÄ± fonksiyon kullan
        if not self._analiz_kontrol():
            return
        
        popup = tk.Toplevel(self.root)
        popup.title("âš ï¸ Risk Analizi")
        popup.geometry("550x550")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        mac = self.current_analysis
        
        tk.Label(popup, text="âš ï¸ RÄ°SK ANALÄ°ZÄ°", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_DANGER).pack(pady=10)
        
        # AÃ§Ä±klama kutusu
        frm_info = tk.LabelFrame(popup, text="â„¹ï¸ Bu Analiz NasÄ±l Ã‡alÄ±ÅŸÄ±r?", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_info.pack(fill="x", padx=20, pady=5)
        tk.Label(frm_info, text="Risk skoru 5 faktÃ¶re gÃ¶re hesaplanÄ±r:\nGÃ¼ven Skoru + Lig + Liste Durumu + Benzer MaÃ§ + Veto Durumu", 
                bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY, font=("Segoe UI", 9)).pack(padx=10, pady=5)
        
        # Risk faktÃ¶rleri hesapla
        risk_skoru = 0
        risk_faktorler = []
        
        # 1. GÃ¼ven skoru
        guven = mac.get("guven", 5)
        if isinstance(guven, str):
            try: guven = int(guven.split("/")[0])
            except: guven = 5
        
        if guven <= 6:
            risk_skoru += 3
            risk_faktorler.append(("âŒ", f"DÃ¼ÅŸÃ¼k gÃ¼ven skoru: {guven}/10", "+3 risk"))
        elif guven <= 7:
            risk_skoru += 1
            risk_faktorler.append(("âš ï¸", f"Orta gÃ¼ven skoru: {guven}/10", "+1 risk"))
        else:
            risk_faktorler.append(("âœ…", f"YÃ¼ksek gÃ¼ven skoru: {guven}/10", "0 risk"))
        
        # 2. Lig kontrolÃ¼
        lig = mac.get("lig", "")
        if lig and any(elit.lower() in lig.lower() for elit in ELIT_LIGLER):
            risk_faktorler.append(("âœ…", f"Elit lig: {lig}", "0 risk"))
        else:
            risk_skoru += 2
            risk_faktorler.append(("âŒ", f"Elit olmayan lig: {lig or 'Bilinmiyor'}", "+2 risk"))
        
        # 3. Kara liste kontrolÃ¼
        liste_durum, _ = self.liste_kontrol(mac.get("mac", ""))
        if liste_durum == "kara":
            risk_skoru += 3
            risk_faktorler.append(("âŒ", "TakÄ±m KARA LÄ°STEDE!", "+3 risk"))
        elif liste_durum == "altin":
            risk_faktorler.append(("âœ…", "TakÄ±m ALTIN LÄ°STEDE!", "0 risk"))
        else:
            risk_faktorler.append(("âšª", "Listede deÄŸil", "0 risk"))
        
        # 4. Benzer maÃ§ baÅŸarÄ±sÄ±
        banko = mac.get("banko", "")
        benzer_kazanan = len([m for m in self.mac_db if banko in m.get("banko", "") and m.get("sonuc") in ["KAZANDI", "âœ…"]])
        benzer_toplam = len([m for m in self.mac_db if banko in m.get("banko", "")])
        if benzer_toplam >= 5:
            benzer_basari = benzer_kazanan / benzer_toplam * 100
            if benzer_basari < 50:
                risk_skoru += 2
                risk_faktorler.append(("âŒ", f"Bu tip maÃ§larda %{benzer_basari:.0f} baÅŸarÄ± ({benzer_kazanan}/{benzer_toplam})", "+2 risk"))
            else:
                risk_faktorler.append(("âœ…", f"Bu tip maÃ§larda %{benzer_basari:.0f} baÅŸarÄ± ({benzer_kazanan}/{benzer_toplam})", "0 risk"))
        else:
            risk_faktorler.append(("âšª", f"Yeterli veri yok ({benzer_toplam} maÃ§)", "0 risk"))
        
        # 5. Veto durumu
        veto_sayisi = mac.get("veto_sayisi", 0)
        if veto_sayisi and veto_sayisi > 0:
            risk_skoru += 2
            risk_faktorler.append(("âŒ", f"{veto_sayisi} adet VETO tespit edildi", "+2 risk"))
        else:
            risk_faktorler.append(("âœ…", "Veto yok", "0 risk"))
        
        # Risk seviyesi
        if risk_skoru <= 2:
            risk_seviye = "ğŸŸ¢ DÃœÅÃœK RÄ°SK"
            renk = "#22c55e"
            tavsiye = "âœ… RahatlÄ±kla oynanabilir"
        elif risk_skoru <= 5:
            risk_seviye = "ğŸŸ¡ ORTA RÄ°SK"
            renk = "#eab308"
            tavsiye = "âš ï¸ Dikkatli olunmalÄ±, kasa %50 azaltÄ±labilir"
        else:
            risk_seviye = "ğŸ”´ YÃœKSEK RÄ°SK"
            renk = "#ef4444"
            tavsiye = "âŒ Ã–nerilmez, geÃ§ilmesi tavsiye edilir"
        
        # GÃ¶ster
        tk.Label(popup, text=f"ğŸ“Š {mac.get('mac', '?')[:35]}", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        
        tk.Label(popup, text=risk_seviye, font=("Segoe UI", 20, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=renk).pack(pady=10)
        
        tk.Label(popup, text=f"Toplam Risk PuanÄ±: {risk_skoru}", font=("Segoe UI", 12),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack()
        
        # FaktÃ¶rler tablosu
        frm_faktorler = tk.LabelFrame(popup, text="ğŸ“‹ Risk FaktÃ¶rleri", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_faktorler.pack(fill="x", padx=20, pady=10)
        
        for emoji, aciklama, puan in risk_faktorler:
            row = tk.Frame(frm_faktorler, bg=ModernTheme.BG_CARD)
            row.pack(fill="x", padx=10, pady=2)
            tk.Label(row, text=f"{emoji} {aciklama}", bg=ModernTheme.BG_CARD, 
                    fg=ModernTheme.TEXT_PRIMARY, font=("Segoe UI", 10)).pack(side="left")
            puan_renk = "#ef4444" if "+" in puan else "#22c55e"
            tk.Label(row, text=puan, bg=ModernTheme.BG_CARD, 
                    fg=puan_renk, font=("Segoe UI", 10, "bold")).pack(side="right")
        
        # Tavsiye
        tk.Label(popup, text=tavsiye, font=("Segoe UI", 11, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=renk).pack(pady=10)
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # â° SAAT BAZLI ANALÄ°Z - V5.7 YENÄ° (#31)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def saat_analizi_popup(self):
        """Saat bazlÄ± baÅŸarÄ± analizi"""
        popup = tk.Toplevel(self.root)
        popup.title("â° Saat Analizi")
        popup.geometry("500x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="â° SAAT BAZLI ANALÄ°Z", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Saat dilimlerine gÃ¶re grupla
        saatler = {
            "12:00-15:00": {"k": 0, "t": 0},
            "15:00-18:00": {"k": 0, "t": 0},
            "18:00-21:00": {"k": 0, "t": 0},
            "21:00-00:00": {"k": 0, "t": 0},
        }
        
        for mac in self.mac_db:
            saat = mac.get("saat", "")
            sonuc = mac.get("sonuc", "")
            
            if not saat or sonuc not in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]:
                continue
            
            try:
                h = int(saat.split(":")[0])
                if 12 <= h < 15:
                    key = "12:00-15:00"
                elif 15 <= h < 18:
                    key = "15:00-18:00"
                elif 18 <= h < 21:
                    key = "18:00-21:00"
                else:
                    key = "21:00-00:00"
                
                saatler[key]["t"] += 1
                if sonuc in ["KAZANDI", "âœ…"]:
                    saatler[key]["k"] += 1
            except:
                continue
        
        rapor = "â° SAAT DÄ°LÄ°MÄ° PERFORMANSI\n"
        rapor += "â•" * 45 + "\n\n"
        
        for saat, data in saatler.items():
            if data["t"] > 0:
                basari = data["k"] / data["t"] * 100
                emoji = "ğŸ”¥" if basari >= 70 else ("âœ…" if basari >= 50 else "âš ï¸")
                rapor += f"{emoji} {saat}: {data['k']}/{data['t']} = %{basari:.0f}\n"
            else:
                rapor += f"â³ {saat}: Veri yok\n"
        
        rapor += "\n" + "â•" * 45 + "\n"
        rapor += "ğŸ’¡ En baÅŸarÄ±lÄ± saat dilimlerine odaklan!"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“… GÃœN BAZLI ANALÄ°Z - V5.7 YENÄ° (#32)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def gun_analizi_popup(self):
        """GÃ¼n bazlÄ± baÅŸarÄ± analizi"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“… GÃ¼n Analizi")
        popup.geometry("500x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“… GÃœN BAZLI ANALÄ°Z", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        gunler = {
            0: {"ad": "Pazartesi", "k": 0, "t": 0},
            1: {"ad": "SalÄ±", "k": 0, "t": 0},
            2: {"ad": "Ã‡arÅŸamba", "k": 0, "t": 0},
            3: {"ad": "PerÅŸembe", "k": 0, "t": 0},
            4: {"ad": "Cuma", "k": 0, "t": 0},
            5: {"ad": "Cumartesi", "k": 0, "t": 0},
            6: {"ad": "Pazar", "k": 0, "t": 0},
        }
        
        for mac in self.mac_db:
            tarih = mac.get("tarih", "")
            sonuc = mac.get("sonuc", "")
            
            if not tarih or sonuc not in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]:
                continue
            
            try:
                d = datetime.strptime(tarih, "%d.%m.%Y")
                gun = d.weekday()
                gunler[gun]["t"] += 1
                if sonuc in ["KAZANDI", "âœ…"]:
                    gunler[gun]["k"] += 1
            except:
                continue
        
        rapor = "ğŸ“… HAFTALIK PERFORMANS\n"
        rapor += "â•" * 45 + "\n\n"
        
        for gun, data in gunler.items():
            if data["t"] > 0:
                basari = data["k"] / data["t"] * 100
                emoji = "ğŸ”¥" if basari >= 70 else ("âœ…" if basari >= 50 else "âš ï¸")
                rapor += f"{emoji} {data['ad']:12} | {data['k']:2}/{data['t']:2} = %{basari:.0f}\n"
            else:
                rapor += f"â³ {data['ad']:12} | Veri yok\n"
        
        rapor += "\n" + "â•" * 45 + "\n"
        rapor += "ğŸ’¡ En baÅŸarÄ±lÄ± gÃ¼nlere odaklan!"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ’° KAZANÃ‡ SÄ°MÃœLATÃ–RÃœ - V5.7 YENÄ° (#33)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def kazanc_simulatoru_popup(self):
        """KazanÃ§ simÃ¼lasyonu"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ’° KazanÃ§ SimÃ¼latÃ¶rÃ¼")
        popup.geometry("500x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ’° KAZANÃ‡ SÄ°MÃœLATÃ–RÃœ", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_SUCCESS).pack(pady=10)
        
        # GiriÅŸler
        frm = tk.Frame(popup, bg=ModernTheme.BG_CARD)
        frm.pack(fill="x", padx=20, pady=10)
        
        tk.Label(frm, text="BaÅŸlangÄ±Ã§ Kasa (â‚º):", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=0, column=0, padx=10, pady=5)
        self.sim_kasa = tk.Entry(frm, width=12, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.sim_kasa.insert(0, "1000")
        self.sim_kasa.grid(row=0, column=1, padx=10, pady=5)
        
        tk.Label(frm, text="Bahis/MaÃ§ (â‚º):", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=1, column=0, padx=10, pady=5)
        self.sim_bahis = tk.Entry(frm, width=12, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.sim_bahis.insert(0, "100")
        self.sim_bahis.grid(row=1, column=1, padx=10, pady=5)
        
        tk.Label(frm, text="Ort. Oran:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=2, column=0, padx=10, pady=5)
        self.sim_oran = tk.Entry(frm, width=12, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.sim_oran.insert(0, "1.75")
        self.sim_oran.grid(row=2, column=1, padx=10, pady=5)
        
        tk.Label(frm, text="MaÃ§ SayÄ±sÄ±:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=3, column=0, padx=10, pady=5)
        self.sim_mac = tk.Entry(frm, width=12, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.sim_mac.insert(0, "30")
        self.sim_mac.grid(row=3, column=1, padx=10, pady=5)
        
        tk.Button(frm, text="SimÃ¼le Et", command=self._kazanc_simule,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").grid(row=4, column=0, columnspan=2, pady=10)
        
        # SonuÃ§
        self.sim_sonuc = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00", height=12)
        self.sim_sonuc.pack(fill="both", expand=True, padx=20, pady=10)
    
    def _kazanc_simule(self):
        """KazanÃ§ simÃ¼lasyonu yap"""
        try:
            kasa = float(self.sim_kasa.get())
            bahis = float(self.sim_bahis.get())
            oran = float(self.sim_oran.get())
            mac_sayisi = int(self.sim_mac.get())
            
            # ArÅŸivden baÅŸarÄ± oranÄ±
            toplam = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]])
            kazanan = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…"]])
            basari = (kazanan / toplam) if toplam > 0 else 0.5
            
            # SimÃ¼lasyon
            import random
            self.sim_sonuc.delete("1.0", tk.END)
            
            rapor = f"ğŸ’° KAZANÃ‡ SÄ°MÃœLASYONU (%{basari*100:.0f} baÅŸarÄ±)\n"
            rapor += "â•" * 40 + "\n\n"
            
            baslangic = kasa
            for i in range(mac_sayisi):
                if random.random() < basari:
                    kazanc = bahis * (oran - 1)
                    kasa += kazanc
                    rapor += f"âœ… MaÃ§ {i+1}: +â‚º{kazanc:.0f} â†’ Kasa: â‚º{kasa:.0f}\n"
                else:
                    kasa -= bahis
                    rapor += f"âŒ MaÃ§ {i+1}: -â‚º{bahis:.0f} â†’ Kasa: â‚º{kasa:.0f}\n"
                
                if kasa <= 0:
                    rapor += "\nğŸ’€ KASA BÄ°TTÄ°!\n"
                    break
            
            rapor += "\n" + "â•" * 40 + "\n"
            rapor += f"ğŸ“Š SONUÃ‡: â‚º{baslangic:.0f} â†’ â‚º{kasa:.0f}\n"
            kar = kasa - baslangic
            rapor += f"{'ğŸ’° KAR' if kar > 0 else 'ğŸ’¸ ZARAR'}: â‚º{abs(kar):.0f}"
            
            self.sim_sonuc.insert("1.0", rapor)
        except Exception as e:
            self.sim_sonuc.delete("1.0", tk.END)
            self.sim_sonuc.insert("1.0", f"âŒ Hata: {e}")

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # âš¡ QUICK BET - V5.7 YENÄ° (#34)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def quick_bet_popup(self):
        """HÄ±zlÄ± bahis kaydÄ±"""
        popup = tk.Toplevel(self.root)
        popup.title("âš¡ Quick Bet")
        popup.geometry("400x350")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="âš¡ HIZLI BAHÄ°S", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(pady=10)
        
        frm = tk.Frame(popup, bg=ModernTheme.BG_CARD)
        frm.pack(fill="x", padx=20, pady=10)
        
        tk.Label(frm, text="MaÃ§:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=0, column=0, sticky="w", padx=10, pady=5)
        self.qb_mac = tk.Entry(frm, width=30, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.qb_mac.grid(row=0, column=1, padx=10, pady=5)
        
        tk.Label(frm, text="Tahmin:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=1, column=0, sticky="w", padx=10, pady=5)
        self.qb_tahmin = ttk.Combobox(frm, values=["MS 1", "MS X", "MS 2", "Ä°Y 1", "Ä°Y X", "Ä°Y 2", 
                                                    "1.5 Ãœst", "2.5 Ãœst", "3.5 Ãœst", "1.5 Alt", "2.5 Alt",
                                                    "KG Var", "KG Yok", "Handikap", "DiÄŸer"], width=27)
        self.qb_tahmin.set("MS 1")
        self.qb_tahmin.grid(row=1, column=1, padx=10, pady=5)
        
        tk.Label(frm, text="Oran:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=2, column=0, sticky="w", padx=10, pady=5)
        self.qb_oran = tk.Entry(frm, width=30, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY)
        self.qb_oran.insert(0, "1.75")
        self.qb_oran.grid(row=2, column=1, padx=10, pady=5)
        
        tk.Label(frm, text="GÃ¼ven:", bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY).grid(row=3, column=0, sticky="w", padx=10, pady=5)
        self.qb_guven = ttk.Combobox(frm, values=["5", "6", "7", "8", "9", "10"], width=27)
        self.qb_guven.set("7")
        self.qb_guven.grid(row=3, column=1, padx=10, pady=5)
        
        tk.Button(popup, text="ğŸ’¾ KAYDET", command=self._quick_bet_kaydet,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", font=("Segoe UI", 12, "bold"),
                  relief="flat", pady=10).pack(fill="x", padx=20, pady=20)
    
    def _quick_bet_kaydet(self):
        """Quick bet kaydet"""
        mac = self.qb_mac.get().strip()
        tahmin = self.qb_tahmin.get()
        oran = self.qb_oran.get()
        guven = self.qb_guven.get()
        
        if not mac:
            messagebox.showwarning("UyarÄ±", "MaÃ§ adÄ± girin!")
            return
        
        yeni = {
            "tarih": datetime.now().strftime("%d.%m.%Y"),
            "saat": datetime.now().strftime("%H:%M"),
            "mac": mac,
            "lig": "Quick Bet",
            "banko": tahmin,
            "sigorta": "-",
            "oran": oran,
            "guven": f"{guven}/10",
            "sonuc": "BEKLÄ°YOR",
            "kaynak": "quick_bet"
        }
        
        self.mac_db.append(yeni)
        self.db_kaydet()
        messagebox.showinfo("âœ…", f"'{mac}' kaydedildi!")
        self.qb_mac.delete(0, tk.END)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ”” BÄ°LDÄ°RÄ°M SÄ°STEMÄ° - V5.7 YENÄ° (#35)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def bildirim_goster(self, baslik, mesaj, tip="info"):
        """MasaÃ¼stÃ¼ bildirimi gÃ¶ster"""
        # Basit popup bildirimi
        if tip == "success":
            renk = ModernTheme.ACCENT_SUCCESS
            emoji = "âœ…"
        elif tip == "error":
            renk = ModernTheme.ACCENT_DANGER
            emoji = "âŒ"
        elif tip == "warning":
            renk = ModernTheme.ACCENT_WARNING
            emoji = "âš ï¸"
        else:
            renk = ModernTheme.ACCENT_PRIMARY
            emoji = "â„¹ï¸"
        
        # Toast tarzÄ± bildirim
        toast = tk.Toplevel(self.root)
        toast.overrideredirect(True)
        toast.configure(bg=renk)
        
        # EkranÄ±n saÄŸ alt kÃ¶ÅŸesinde gÃ¶ster
        screen_w = self.root.winfo_screenwidth()
        screen_h = self.root.winfo_screenheight()
        toast.geometry(f"300x80+{screen_w-320}+{screen_h-150}")
        
        tk.Label(toast, text=f"{emoji} {baslik}", font=("Segoe UI", 11, "bold"),
                bg=renk, fg="white").pack(pady=(10, 2))
        tk.Label(toast, text=mesaj, font=("Segoe UI", 9),
                bg=renk, fg="white", wraplength=280).pack()
        
        # 3 saniye sonra kapat
        toast.after(3000, toast.destroy)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ’¾ OTOMATÄ°K YEDEKLEME - V5.7 YENÄ° (#36)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def otomatik_yedekleme_baslat(self):
        """Her 30 dakikada otomatik yedekleme"""
        self._otomatik_yedekle()
        # 30 dakika sonra tekrar
        self.root.after(30 * 60 * 1000, self.otomatik_yedekleme_baslat)
    
    def _otomatik_yedekle(self):
        """Otomatik yedek al"""
        try:
            yedek_dir = os.path.join(BASE_DIR, "yedekler")
            os.makedirs(yedek_dir, exist_ok=True)
            
            tarih = datetime.now().strftime("%Y%m%d_%H%M")
            yedek_dosya = os.path.join(yedek_dir, f"otoyedek_{tarih}.json")
            
            with open(yedek_dosya, "w", encoding="utf-8") as f:
                json.dump(self.mac_db, f, ensure_ascii=False, indent=2)
            
            # Eski yedekleri temizle (7 gÃ¼nden eski)
            for dosya in os.listdir(yedek_dir):
                if dosya.startswith("otoyedek_"):
                    yol = os.path.join(yedek_dir, dosya)
                    if os.path.getmtime(yol) < (datetime.now().timestamp() - 7*24*60*60):
                        os.remove(yol)
        except:
            pass

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“Š DETAYLI Ä°STATÄ°STÄ°K - V5.7 YENÄ° (#38)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def detayli_istatistik_popup(self):
        """TÃ¼m detaylÄ± istatistikler"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“Š DetaylÄ± Ä°statistik")
        popup.geometry("650x550")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“Š DETAYLI Ä°STATÄ°STÄ°K RAPORU", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 9), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Ä°statistikleri hesapla
        toplam = len(self.mac_db)
        sonuclanan = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]])
        kazanan = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…"]])
        kaybeden = len([m for m in self.mac_db if m.get("sonuc") in ["KAYBETTÄ°", "âŒ"]])
        bekleyen = toplam - sonuclanan
        
        basari = (kazanan / sonuclanan * 100) if sonuclanan > 0 else 0
        
        # Bahis tÃ¼rlerine gÃ¶re
        bahis_turleri = {}
        for mac in self.mac_db:
            banko = mac.get("banko", "DiÄŸer")
            if banko not in bahis_turleri:
                bahis_turleri[banko] = {"k": 0, "t": 0}
            
            sonuc = mac.get("sonuc", "")
            if sonuc in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]:
                bahis_turleri[banko]["t"] += 1
                if sonuc in ["KAZANDI", "âœ…"]:
                    bahis_turleri[banko]["k"] += 1
        
        rapor = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              ğŸ“Š DETAYLI Ä°STATÄ°STÄ°K RAPORU                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
"""
        rapor += f"""
  ğŸ“ˆ GENEL Ã–ZET
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Toplam Analiz     : {toplam}
  SonuÃ§lanan        : {sonuclanan}
  âœ… Kazanan        : {kazanan}
  âŒ Kaybeden       : {kaybeden}
  â³ Bekleyen       : {bekleyen}
  
  ğŸ¯ BAÅARI ORANI   : %{basari:.1f}
"""
        rapor += """
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  ğŸ“Š BAHÄ°S TÃœRÃœ PERFORMANSI
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"""
        sorted_bahisler = sorted(bahis_turleri.items(), key=lambda x: x[1]["t"], reverse=True)
        for bahis, data in sorted_bahisler[:12]:
            if data["t"] > 0:
                b = data["k"] / data["t"] * 100
                emoji = "ğŸ”¥" if b >= 70 else ("âœ…" if b >= 50 else "âš ï¸")
                rapor += f"  {emoji} {bahis[:20]:20} | {data['k']:2}/{data['t']:2} | %{b:.0f}\n"
        
        rapor += """
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""
        text.insert("1.0", rapor)
        self._detayli_istatistik_text = rapor
        
        btn_frame = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        btn_frame.pack(pady=10)
        
        def kaydet_istatistik():
            dosya = filedialog.asksaveasfilename(defaultextension=".txt",
                    initialfilename=f"detayli_istatistik_{datetime.now().strftime('%Y%m%d')}.txt")
            if dosya:
                with open(dosya, "w", encoding="utf-8") as f:
                    f.write(self._detayli_istatistik_text)
                messagebox.showinfo("âœ…", f"Kaydedildi: {dosya}")
        
        tk.Button(btn_frame, text="ğŸ’¾ Kaydet", command=kaydet_istatistik,
                  bg=ModernTheme.ACCENT_PRIMARY, fg="white", relief="flat", width=12).pack(side="left", padx=5)
        tk.Button(btn_frame, text="ğŸ“± Telegram", 
                  command=lambda: self.kanal_sec_ve_gonder(self._detayli_istatistik_text, "DetaylÄ± Ä°statistik"),
                  bg="#0088cc", fg="white", relief="flat", width=12).pack(side="left", padx=5)
        tk.Button(btn_frame, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat", width=12).pack(side="left", padx=5)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“‰ KAYIP ANALÄ°ZÄ° - V5.7 YENÄ° (#16)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def kayip_analizi_popup(self):
        """Kaybedilen maÃ§larÄ±n detaylÄ± analizi"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“‰ KayÄ±p Analizi")
        popup.geometry("600x500")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“‰ KAYIP ANALÄ°ZÄ°", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_DANGER).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#ff6b6b")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        kayiplar = [m for m in self.mac_db if m.get("sonuc") in ["KAYBETTÄ°", "âŒ"]]
        
        rapor = "ğŸ“‰ KAYIP ANALÄ°Z RAPORU\n"
        rapor += "â•" * 50 + "\n\n"
        rapor += f"Toplam KayÄ±p: {len(kayiplar)} maÃ§\n\n"
        
        # Lig bazlÄ± kayÄ±p
        lig_kayip = {}
        bahis_kayip = {}
        guven_kayip = {}
        
        for mac in kayiplar:
            lig = mac.get("lig", "Bilinmiyor")
            lig_kayip[lig] = lig_kayip.get(lig, 0) + 1
            
            banko = mac.get("banko", "DiÄŸer")
            bahis_kayip[banko] = bahis_kayip.get(banko, 0) + 1
            
            guven = str(mac.get("guven", "?"))
            guven_kayip[guven] = guven_kayip.get(guven, 0) + 1
        
        rapor += "ğŸ† EN Ã‡OK KAYIP YAÅANAN LÄ°GLER:\n"
        for lig, count in sorted(lig_kayip.items(), key=lambda x: x[1], reverse=True)[:5]:
            rapor += f"   âŒ {lig[:25]:25} : {count} kayÄ±p\n"
        
        rapor += "\nğŸ¯ EN Ã‡OK KAYIP YAÅANAN BAHÄ°S TÃœRLERÄ°:\n"
        for bahis, count in sorted(bahis_kayip.items(), key=lambda x: x[1], reverse=True)[:5]:
            rapor += f"   âŒ {bahis[:25]:25} : {count} kayÄ±p\n"
        
        rapor += "\nğŸ“Š GÃœVEN SKORUNA GÃ–RE KAYIPLAR:\n"
        for guven, count in sorted(guven_kayip.items(), key=lambda x: x[1], reverse=True)[:5]:
            rapor += f"   âš ï¸ GÃ¼ven {guven:10} : {count} kayÄ±p\n"
        
        rapor += "\n" + "â•" * 50 + "\n"
        
        text.insert("1.0", rapor)
        self._kayip_analiz_text = rapor
        
        btn_frame = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        btn_frame.pack(pady=10)
        
        tk.Button(btn_frame, text="ğŸ“± Telegram", 
                  command=lambda: self.kanal_sec_ve_gonder(self._kayip_analiz_text, "KayÄ±p Analizi"),
                  bg="#0088cc", fg="white", relief="flat", width=12).pack(side="left", padx=5)
        tk.Button(btn_frame, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat", width=12).pack(side="left", padx=5)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ­ Ã‡Ä°FT KONTROL SÄ°STEMÄ° - V5.7 YENÄ° (#28)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def cift_kontrol_popup(self):
        """V70: Analizi Ã§ift kontrol et - DETAYLANDIRILMIÅ
        
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        ğŸ¯ Ã‡Ä°FT KONTROL SÄ°STEMÄ° NASIL Ã‡ALIÅIR?
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        Bu sistem analizin gÃ¼venilirliÄŸini 4 farklÄ± aÃ§Ä±dan kontrol eder:
        
        1. GÃœVEN SKORU KONTROLÃœ (+0 ile +2):
           - 8-10 gÃ¼ven: +2 puan (mÃ¼kemmel)
           - 6-7 gÃ¼ven: +1 puan (yeterli)
           - 5 ve altÄ±: 0 puan (yetersiz)
        
        2. LÄ°G KONTROLÃœ (+1 ile +2):
           - Elit lig (Top 13): +2 puan
           - Normal lig: +1 puan
        
        3. LÄ°STE KONTROLÃœ (-2 ile +2):
           - AltÄ±n liste: +2 puan (bonus!)
           - Kara liste: -2 puan (ceza!)
           - Listede deÄŸil: 0 puan
        
        4. BENZER MAÃ‡ KONTROLÃœ (+1 ile +2):
           - %60+ baÅŸarÄ±: +2 puan
           - %60 altÄ±: +1 puan
           - Yeterli veri yok: 0 puan
        
        TOPLAM PUAN DEÄERLENDÄ°RME:
        - 6-8 puan: ğŸŸ¢ GÃœVENLÄ° â†’ Bahis yapÄ±labilir
        - 3-5 puan: ğŸŸ¡ DÄ°KKATLÄ° â†’ Risk mevcut
        - 0-2 puan: ğŸ”´ RÄ°SKLÄ° â†’ Ã–nerilmez
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        """
        # V70: Yeni yardÄ±mcÄ± fonksiyon kullan
        if not self._analiz_kontrol():
            return
        
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ­ Ã‡ift Kontrol")
        popup.geometry("550x600")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        mac = self.current_analysis
        
        tk.Label(popup, text="ğŸ­ Ã‡Ä°FT KONTROL SÄ°STEMÄ°", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(pady=10)
        
        # AÃ§Ä±klama kutusu
        frm_info = tk.LabelFrame(popup, text="â„¹ï¸ Bu Sistem NasÄ±l Ã‡alÄ±ÅŸÄ±r?", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_info.pack(fill="x", padx=20, pady=5)
        tk.Label(frm_info, text="Analiz 4 farklÄ± aÃ§Ä±dan puanlanÄ±r:\nGÃ¼ven + Lig + Liste Durumu + Benzer MaÃ§ BaÅŸarÄ±sÄ±\nMaksimum 8 puan alÄ±nabilir.", 
                bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_SECONDARY, font=("Segoe UI", 9)).pack(padx=10, pady=5)
        
        kontroller = []
        puan = 0
        
        # 1. GÃ¼ven skoru kontrolÃ¼
        guven = mac.get("guven", 5)
        if isinstance(guven, str):
            try: guven = int(guven.split("/")[0])
            except: guven = 5
        
        if guven >= 8:
            kontroller.append(("âœ…", f"GÃ¼ven skoru: {guven}/10 (MÃ¼kemmel)", "+2"))
            puan += 2
        elif guven >= 6:
            kontroller.append(("âš ï¸", f"GÃ¼ven skoru: {guven}/10 (Yeterli)", "+1"))
            puan += 1
        else:
            kontroller.append(("âŒ", f"GÃ¼ven skoru: {guven}/10 (Yetersiz)", "0"))
        
        # 2. Lig kontrolÃ¼
        lig = mac.get("lig", "")
        if lig and any(elit.lower() in lig.lower() for elit in ELIT_LIGLER):
            kontroller.append(("âœ…", f"Elit Lig: {lig}", "+2"))
            puan += 2
        else:
            kontroller.append(("âš ï¸", f"Normal Lig: {lig or 'Bilinmiyor'}", "+1"))
            puan += 1
        
        # 3. Kara liste kontrolÃ¼
        liste_durum, _ = self.liste_kontrol(mac.get("mac", ""))
        if liste_durum == "altin":
            kontroller.append(("âœ…", "TakÄ±m ALTIN LÄ°STEDE! (Bonus)", "+2"))
            puan += 2
        elif liste_durum == "kara":
            kontroller.append(("âŒ", "TakÄ±m KARA LÄ°STEDE! (Ceza)", "-2"))
            puan -= 2
        else:
            kontroller.append(("âšª", "Listede deÄŸil (NÃ¶tr)", "0"))
        
        # 4. Benzer maÃ§ baÅŸarÄ±sÄ±
        banko = mac.get("banko", "")
        benzer = [m for m in self.mac_db if banko in m.get("banko", "")]
        if len(benzer) >= 3:
            kazanan = len([m for m in benzer if m.get("sonuc") in ["KAZANDI", "âœ…"]])
            oran = kazanan / len(benzer) * 100
            if oran >= 60:
                kontroller.append(("âœ…", f"Benzer maÃ§larda %{oran:.0f} baÅŸarÄ± ({kazanan}/{len(benzer)})", "+2"))
                puan += 2
            else:
                kontroller.append(("âš ï¸", f"Benzer maÃ§larda %{oran:.0f} baÅŸarÄ± ({kazanan}/{len(benzer)})", "+1"))
                puan += 1
        else:
            kontroller.append(("âšª", f"Yeterli benzer maÃ§ yok ({len(benzer)} maÃ§)", "0"))
        
        # SonuÃ§
        if puan >= 6:
            sonuc = "ğŸŸ¢ GÃœVENLÄ° - Bahis yapÄ±labilir"
            renk = "#22c55e"
            tavsiye = "âœ… Tam kasayla girilebilir"
        elif puan >= 3:
            sonuc = "ğŸŸ¡ DÄ°KKATLÄ° - Risk var"
            renk = "#eab308"
            tavsiye = "âš ï¸ Kasa %50 azaltÄ±larak girilebilir"
        else:
            sonuc = "ğŸ”´ RÄ°SKLÄ° - Ã–nerilmez"
            renk = "#ef4444"
            tavsiye = "âŒ Bu maÃ§ geÃ§ilmeli"
        
        # MaÃ§ bilgisi
        tk.Label(popup, text=f"ğŸ“Š {mac.get('mac', '?')[:35]}", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        tk.Label(popup, text=f"ğŸ¯ Banko: {banko}", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack()
        
        # Kontroller tablosu
        frm_kontroller = tk.LabelFrame(popup, text="ğŸ“‹ Kontrol SonuÃ§larÄ±", bg=ModernTheme.BG_CARD, fg=ModernTheme.ACCENT_PRIMARY)
        frm_kontroller.pack(fill="x", padx=20, pady=10)
        
        for emoji, aciklama, p in kontroller:
            frm = tk.Frame(frm_kontroller, bg=ModernTheme.BG_CARD)
            frm.pack(fill="x", padx=10, pady=3)
            tk.Label(frm, text=f"{emoji} {aciklama}", bg=ModernTheme.BG_CARD, 
                    fg=ModernTheme.TEXT_PRIMARY, font=("Segoe UI", 10)).pack(side="left", pady=3)
            puan_renk = "#22c55e" if "+" in p and p != "0" else ("#ef4444" if "-" in p else ModernTheme.TEXT_SECONDARY)
            tk.Label(frm, text=p, bg=ModernTheme.BG_CARD, 
                    fg=puan_renk, font=("Segoe UI", 10, "bold")).pack(side="right", padx=10)
        
        # Toplam puan
        tk.Label(popup, text=f"ğŸ“Š Toplam Puan: {puan}/8", font=("Segoe UI", 14, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack(pady=10)
        
        # Progress bar
        progress_frm = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        progress_frm.pack(fill="x", padx=40)
        canvas = tk.Canvas(progress_frm, width=400, height=30, bg=ModernTheme.BG_PRIMARY, highlightthickness=0)
        canvas.pack()
        # Arka plan
        canvas.create_rectangle(0, 5, 400, 25, fill=ModernTheme.BG_CARD, outline="")
        # Dolgu
        dolgu_genislik = max(0, min(400, (puan + 2) / 10 * 400))  # -2 ile 8 arasÄ±, 0-400'e map
        canvas.create_rectangle(0, 5, dolgu_genislik, 25, fill=renk, outline="")
        
        # SonuÃ§
        tk.Label(popup, text=sonuc, font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=renk).pack(pady=10)
        
        tk.Label(popup, text=tavsiye, font=("Segoe UI", 11),
                bg=ModernTheme.BG_PRIMARY, fg=renk).pack()
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=15)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ§² MANYETÄ°K LÄ°G TESPÄ°TÄ° - V5.7 YENÄ° (#30)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def manyetik_lig_popup(self):
        """En baÅŸarÄ±lÄ± ligleri tespit et"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ§² Manyetik Lig")
        popup.geometry("550x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ§² MANYETÄ°K LÄ°G TESPÄ°TÄ°", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        tk.Label(popup, text="Seni kendine Ã§eken ligler!", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Lig bazlÄ± istatistik
        ligler = {}
        for mac in self.mac_db:
            lig = mac.get("lig", "Bilinmiyor")
            if lig not in ligler:
                ligler[lig] = {"k": 0, "t": 0}
            
            sonuc = mac.get("sonuc", "")
            if sonuc in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]:
                ligler[lig]["t"] += 1
                if sonuc in ["KAZANDI", "âœ…"]:
                    ligler[lig]["k"] += 1
        
        # %70+ baÅŸarÄ±lÄ± ligler = Manyetik
        manyetik = []
        for lig, data in ligler.items():
            if data["t"] >= 3:  # En az 3 maÃ§
                basari = data["k"] / data["t"] * 100
                if basari >= 70:
                    manyetik.append((lig, data, basari))
        
        manyetik.sort(key=lambda x: x[2], reverse=True)
        
        rapor = "ğŸ§² MANYETÄ°K LÄ°GLER (%70+ BaÅŸarÄ±)\n"
        rapor += "â•" * 45 + "\n\n"
        
        if manyetik:
            for lig, data, basari in manyetik[:10]:
                rapor += f"ğŸ§² {lig[:30]:30}\n"
                rapor += f"   âœ… {data['k']}/{data['t']} = %{basari:.0f} baÅŸarÄ±\n\n"
            
            rapor += "â•" * 45 + "\n"
            rapor += "ğŸ’¡ Bu liglere odaklan, seni Ã§ekiyorlar!"
        else:
            rapor += "âŒ HenÃ¼z manyetik lig tespit edilmedi.\n"
            rapor += "ğŸ’¡ Daha fazla analiz yaparak ligleri keÅŸfet!"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸª SÃœRPRÄ°Z RADAR - V5.7 YENÄ° (#38)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def surpriz_radar_popup(self):
        """SÃ¼rpriz sonuÃ§larÄ± tespit et"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸª SÃ¼rpriz Radar")
        popup.geometry("550x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸª SÃœRPRÄ°Z RADAR", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg="#e83e8c").pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#ff69b4")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # SÃ¼rprizleri bul: YÃ¼ksek gÃ¼venle kaybeden veya dÃ¼ÅŸÃ¼k gÃ¼venle kazanan
        surprizler = []
        
        for mac in self.mac_db:
            guven = mac.get("guven", 5)
            if isinstance(guven, str):
                try: guven = int(guven.split("/")[0])
                except: guven = 5
            
            sonuc = mac.get("sonuc", "")
            
            # YÃ¼ksek gÃ¼ven + KayÄ±p = Negatif sÃ¼rpriz
            if guven >= 9 and sonuc in ["KAYBETTÄ°", "âŒ"]:
                surprizler.append((mac, "NEGATÄ°F", guven))
            
            # DÃ¼ÅŸÃ¼k gÃ¼ven + KazanÃ§ = Pozitif sÃ¼rpriz
            elif guven <= 6 and sonuc in ["KAZANDI", "âœ…"]:
                surprizler.append((mac, "POZÄ°TÄ°F", guven))
        
        rapor = "ğŸª SÃœRPRÄ°Z SONUÃ‡LAR\n"
        rapor += "â•" * 50 + "\n\n"
        
        negatif = [s for s in surprizler if s[1] == "NEGATÄ°F"]
        pozitif = [s for s in surprizler if s[1] == "POZÄ°TÄ°F"]
        
        rapor += f"ğŸ˜± NEGATÄ°F SÃœRPRÄ°ZLER ({len(negatif)} adet):\n"
        rapor += "(YÃ¼ksek gÃ¼ven ama kayÄ±p)\n\n"
        for mac, _, guven in negatif[-5:]:
            rapor += f"âŒ {mac.get('tarih', '?')} | {mac.get('mac', '?')[:20]} | G:{guven}\n"
        
        rapor += f"\nğŸ‰ POZÄ°TÄ°F SÃœRPRÄ°ZLER ({len(pozitif)} adet):\n"
        rapor += "(DÃ¼ÅŸÃ¼k gÃ¼ven ama kazanÃ§)\n\n"
        for mac, _, guven in pozitif[-5:]:
            rapor += f"âœ… {mac.get('tarih', '?')} | {mac.get('mac', '?')[:20]} | G:{guven}\n"
        
        rapor += "\n" + "â•" * 50 + "\n"
        rapor += "ğŸ’¡ SÃ¼rprizleri analiz et, pattern bul!"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ”„ OTOMATÄ°K YENÄ°DEN ANALÄ°Z - V5.7 YENÄ° (#44)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def otomatik_yeniden_analiz(self):
        """Bekleyen maÃ§larÄ± tekrar analiz et"""
        bekleyenler = [m for m in self.mac_db if m.get("sonuc") in ["BEKLÄ°YOR", "â³", ""]]
        
        if not bekleyenler:
            messagebox.showinfo("Bilgi", "Bekleyen maÃ§ yok!")
            return
        
        cevap = messagebox.askyesno("Yeniden Analiz", 
            f"{len(bekleyenler)} bekleyen maÃ§ var.\nHepsini yeniden analiz etmek ister misiniz?")
        
        if cevap:
            self.bildirim_goster("Analiz", f"{len(bekleyenler)} maÃ§ yeniden analiz ediliyor...", "info")
            # Burada gerÃ§ek analiz yapÄ±labilir
            messagebox.showinfo("âœ…", "Yeniden analiz tamamlandÄ±!")

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“Š KARÅILAÅTIRMALI GRAFÄ°K - V5.7 YENÄ° (#45)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def karsilastirmali_grafik_popup(self):
        """ASCII grafik ile karÅŸÄ±laÅŸtÄ±rma"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“Š KarÅŸÄ±laÅŸtÄ±rmalÄ± Grafik")
        popup.geometry("600x500")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“Š KARÅILAÅTIRMALI GRAFÄ°K", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Son 7 gÃ¼n performans
        from collections import defaultdict
        gunluk = defaultdict(lambda: {"k": 0, "t": 0})
        
        for mac in self.mac_db:
            tarih = mac.get("tarih", "")
            sonuc = mac.get("sonuc", "")
            if tarih and sonuc in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]:
                gunluk[tarih]["t"] += 1
                if sonuc in ["KAZANDI", "âœ…"]:
                    gunluk[tarih]["k"] += 1
        
        rapor = "ğŸ“Š SON GÃœNLER PERFORMANS GRAFÄ°ÄÄ°\n"
        rapor += "â•" * 50 + "\n\n"
        
        # Son 7 gÃ¼nÃ¼ al
        son_gunler = sorted(gunluk.keys(), reverse=True)[:7]
        son_gunler.reverse()
        
        max_mac = max([gunluk[g]["t"] for g in son_gunler]) if son_gunler else 1
        
        for gun in son_gunler:
            data = gunluk[gun]
            basari = (data["k"] / data["t"] * 100) if data["t"] > 0 else 0
            
            # Bar uzunluÄŸu
            bar_len = int(data["t"] / max_mac * 20)
            kazanan_bar = int(data["k"] / max_mac * 20)
            
            bar = "â–ˆ" * kazanan_bar + "â–‘" * (bar_len - kazanan_bar)
            
            rapor += f"{gun} | {bar:20} | {data['k']}/{data['t']} = %{basari:.0f}\n"
        
        rapor += "\n" + "â•" * 50 + "\n"
        rapor += "â–ˆ = Kazanan  â–‘ = Kaybeden\n"
        
        # Ã–zet
        toplam_k = sum(gunluk[g]["k"] for g in son_gunler)
        toplam_t = sum(gunluk[g]["t"] for g in son_gunler)
        genel = (toplam_k / toplam_t * 100) if toplam_t > 0 else 0
        
        rapor += f"\nğŸ“ˆ 7 GÃ¼nlÃ¼k Genel: {toplam_k}/{toplam_t} = %{genel:.0f}"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ§  HAFIZA MODU - V5.7 YENÄ° (#47)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def hafiza_modu_popup(self):
        """GeÃ§miÅŸ analizlerden Ã¶ÄŸren"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ§  HafÄ±za Modu")
        popup.geometry("550x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ§  HAFIZA MODU", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg="#9b59b6").pack(pady=10)
        
        tk.Label(popup, text="GeÃ§miÅŸ analizlerden Ã¶ÄŸrenilen dersler", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#bb86fc")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        rapor = "ğŸ§  HAFIZA ANALÄ°ZÄ°\n"
        rapor += "â•" * 50 + "\n\n"
        
        # Ã–ÄŸrenilen dersler
        dersler = []
        
        # 1. En baÅŸarÄ±lÄ± bahis tÃ¼rÃ¼
        bahisler = {}
        for mac in self.mac_db:
            banko = mac.get("banko", "")
            sonuc = mac.get("sonuc", "")
            if banko and sonuc in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]:
                if banko not in bahisler:
                    bahisler[banko] = {"k": 0, "t": 0}
                bahisler[banko]["t"] += 1
                if sonuc in ["KAZANDI", "âœ…"]:
                    bahisler[banko]["k"] += 1
        
        if bahisler:
            en_iyi = max(bahisler.items(), key=lambda x: x[1]["k"]/x[1]["t"] if x[1]["t"]>=3 else 0)
            if en_iyi[1]["t"] >= 3:
                basari = en_iyi[1]["k"] / en_iyi[1]["t"] * 100
                dersler.append(f"âœ… En iyi bahis tÃ¼rÃ¼n: {en_iyi[0]} (%{basari:.0f})")
        
        # 2. En kÃ¶tÃ¼ bahis tÃ¼rÃ¼
        if bahisler:
            en_kotu = min(bahisler.items(), key=lambda x: x[1]["k"]/x[1]["t"] if x[1]["t"]>=3 else 1)
            if en_kotu[1]["t"] >= 3:
                basari = en_kotu[1]["k"] / en_kotu[1]["t"] * 100
                dersler.append(f"âŒ Uzak dur: {en_kotu[0]} (%{basari:.0f})")
        
        # 3. En baÅŸarÄ±lÄ± gÃ¼ven skoru
        guvenler = {}
        for mac in self.mac_db:
            guven = str(mac.get("guven", ""))
            sonuc = mac.get("sonuc", "")
            if guven and sonuc in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]:
                if guven not in guvenler:
                    guvenler[guven] = {"k": 0, "t": 0}
                guvenler[guven]["t"] += 1
                if sonuc in ["KAZANDI", "âœ…"]:
                    guvenler[guven]["k"] += 1
        
        if guvenler:
            en_iyi_g = max(guvenler.items(), key=lambda x: x[1]["k"]/x[1]["t"] if x[1]["t"]>=3 else 0)
            if en_iyi_g[1]["t"] >= 3:
                basari = en_iyi_g[1]["k"] / en_iyi_g[1]["t"] * 100
                dersler.append(f"ğŸ¯ En gÃ¼venilir skor: {en_iyi_g[0]} (%{basari:.0f})")
        
        # Toplam istatistik
        toplam = len(self.mac_db)
        kazanan = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…"]])
        
        rapor += "ğŸ“š Ã–ÄRENÄ°LEN DERSLER:\n\n"
        for ders in dersler:
            rapor += f"  {ders}\n"
        
        rapor += f"\n\nğŸ“Š GENEL:\n"
        rapor += f"  â€¢ {toplam} analiz yapÄ±ldÄ±\n"
        rapor += f"  â€¢ {kazanan} kazanÃ§ elde edildi\n"
        
        rapor += "\n" + "â•" * 50 + "\n"
        rapor += "ğŸ’¡ Bu dersleri kullanarak daha iyi tahminler yap!"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ° ORAN/Ä°STATÄ°STÄ°K Ã‡AKIÅMASI - V5.7 YENÄ° (#49)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def oran_istatistik_cakismasi_popup(self):
        """Oran ve istatistik uyumsuzluklarÄ±nÄ± bul"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ° Oran Ã‡akÄ±ÅŸmasÄ±")
        popup.geometry("550x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ° ORAN/Ä°STATÄ°STÄ°K Ã‡AKIÅMASI", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#ffc107")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        rapor = "ğŸ° DEÄER BAHÄ°SÄ° ANALÄ°ZÄ°\n"
        rapor += "â•" * 45 + "\n\n"
        rapor += "YÃ¼ksek oran + YÃ¼ksek gÃ¼ven = DEÄER BAHÄ°SÄ°\n\n"
        
        deger_bahisleri = []
        
        for mac in self.mac_db:
            guven = mac.get("guven", 5)
            if isinstance(guven, str):
                try: guven = int(guven.split("/")[0])
                except: guven = 5
            
            oran = mac.get("oran", "1.50")
            try:
                oran_f = float(str(oran).replace(",", "."))
            except:
                oran_f = 1.50
            
            # YÃ¼ksek oran (>2.0) + YÃ¼ksek gÃ¼ven (>=8) = DeÄŸer
            if oran_f >= 2.0 and guven >= 8:
                deger_bahisleri.append((mac, oran_f, guven))
        
        if deger_bahisleri:
            rapor += "ğŸ’ TESPÄ°T EDÄ°LEN DEÄER BAHÄ°SLERÄ°:\n\n"
            for mac, oran, guven in deger_bahisleri[-10:]:
                sonuc = mac.get("sonuc", "?")
                emoji = "âœ…" if sonuc in ["KAZANDI", "âœ…"] else ("âŒ" if sonuc in ["KAYBETTÄ°", "âŒ"] else "â³")
                rapor += f"{emoji} {mac.get('mac', '?')[:20]} | O:{oran:.2f} G:{guven}/10\n"
            
            # Ä°statistik
            kazanan = len([d for d in deger_bahisleri if d[0].get("sonuc") in ["KAZANDI", "âœ…"]])
            toplam = len([d for d in deger_bahisleri if d[0].get("sonuc") in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]])
            if toplam > 0:
                basari = kazanan / toplam * 100
                rapor += f"\nğŸ“Š DeÄŸer bahisi baÅŸarÄ±sÄ±: {kazanan}/{toplam} = %{basari:.0f}\n"
        else:
            rapor += "âŒ DeÄŸer bahisi tespit edilmedi.\n"
        
        rapor += "\n" + "â•" * 45 + "\n"
        rapor += "ğŸ’¡ DeÄŸer bahislerini takip et!"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“Š VERÄ° KALÄ°TESÄ° SKORU - V5.7 YENÄ° (#50)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def veri_kalitesi_popup(self):
        """Analiz verilerinin kalitesini deÄŸerlendir"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“Š Veri Kalitesi")
        popup.geometry("450x350")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“Š VERÄ° KALÄ°TESÄ° SKORU", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=15)
        
        # Kalite metrikleri
        toplam = len(self.mac_db)
        
        # Dolu alanlar
        tam_veri = len([m for m in self.mac_db if m.get("mac") and m.get("lig") and m.get("banko") and m.get("guven")])
        sonuclanan = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]])
        
        if toplam > 0:
            tamlÄ±k = tam_veri / toplam * 100
            sonuc_orani = sonuclanan / toplam * 100
            genel_kalite = (tamlÄ±k + sonuc_orani) / 2
        else:
            tamlÄ±k = sonuc_orani = genel_kalite = 0
        
        # Kalite seviyesi
        if genel_kalite >= 80:
            seviye = "ğŸŸ¢ MÃœKEMMEL"
            renk = "#22c55e"
        elif genel_kalite >= 60:
            seviye = "ğŸŸ¡ Ä°YÄ°"
            renk = "#eab308"
        elif genel_kalite >= 40:
            seviye = "ğŸŸ  ORTA"
            renk = "#f97316"
        else:
            seviye = "ğŸ”´ DÃœÅÃœK"
            renk = "#ef4444"
        
        tk.Label(popup, text=f"Kalite: %{genel_kalite:.0f}", font=("Segoe UI", 24, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=renk).pack(pady=10)
        
        tk.Label(popup, text=seviye, font=("Segoe UI", 16),
                bg=ModernTheme.BG_PRIMARY, fg=renk).pack()
        
        frm = tk.Frame(popup, bg=ModernTheme.BG_CARD)
        frm.pack(fill="x", padx=30, pady=20)
        
        tk.Label(frm, text=f"ğŸ“‹ Veri TamlÄ±ÄŸÄ±: %{tamlÄ±k:.0f}", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_PRIMARY, font=("Segoe UI", 11)).pack(anchor="w", padx=15, pady=5)
        tk.Label(frm, text=f"âœ… SonuÃ§ GiriÅŸi: %{sonuc_orani:.0f}", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_PRIMARY, font=("Segoe UI", 11)).pack(anchor="w", padx=15, pady=5)
        tk.Label(frm, text=f"ğŸ“Š Toplam KayÄ±t: {toplam}", bg=ModernTheme.BG_CARD, 
                fg=ModernTheme.TEXT_PRIMARY, font=("Segoe UI", 11)).pack(anchor="w", padx=15, pady=5)
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=15)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ† LÄ°G ÅAMPÄ°YONU - V5.7 YENÄ° (#51)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def lig_sampiyonu_popup(self):
        """En baÅŸarÄ±lÄ± lig"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ† Lig Åampiyonu")
        popup.geometry("450x300")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        # En baÅŸarÄ±lÄ± ligi bul
        ligler = {}
        for mac in self.mac_db:
            lig = mac.get("lig", "Bilinmiyor")
            sonuc = mac.get("sonuc", "")
            if sonuc in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]:
                if lig not in ligler:
                    ligler[lig] = {"k": 0, "t": 0}
                ligler[lig]["t"] += 1
                if sonuc in ["KAZANDI", "âœ…"]:
                    ligler[lig]["k"] += 1
        
        # En az 5 maÃ§Ä± olan en baÅŸarÄ±lÄ± lig
        sampiyon = None
        max_basari = 0
        for lig, data in ligler.items():
            if data["t"] >= 5:
                basari = data["k"] / data["t"] * 100
                if basari > max_basari:
                    max_basari = basari
                    sampiyon = (lig, data, basari)
        
        tk.Label(popup, text="ğŸ† LÄ°G ÅAMPÄ°YONU", font=("Segoe UI", 18, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg="#ffd700").pack(pady=20)
        
        if sampiyon:
            lig, data, basari = sampiyon
            tk.Label(popup, text=lig, font=("Segoe UI", 16, "bold"),
                    bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY).pack(pady=10)
            
            tk.Label(popup, text=f"âœ… {data['k']}/{data['t']} = %{basari:.0f} BaÅŸarÄ±", 
                    font=("Segoe UI", 14),
                    bg=ModernTheme.BG_PRIMARY, fg="#22c55e").pack(pady=5)
            
            tk.Label(popup, text="ğŸ‘‘ Senin ÅŸampiyon ligin!", 
                    font=("Segoe UI", 12),
                    bg=ModernTheme.BG_PRIMARY, fg="#ffd700").pack(pady=10)
        else:
            tk.Label(popup, text="HenÃ¼z yeterli veri yok", 
                    font=("Segoe UI", 12),
                    bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack(pady=20)
            tk.Label(popup, text="En az 5 maÃ§ analizi olan lig gerekli", 
                    bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=20)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ”¢ Ä°STATÄ°STÄ°K YORUMCUSU - V5.7 YENÄ° (#55)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def istatistik_yorumcusu_popup(self):
        """Ä°statistikleri yorumla"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ”¢ Ä°statistik Yorumcusu")
        popup.geometry("550x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ”¢ Ä°STATÄ°STÄ°K YORUMCUSU", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        toplam = len(self.mac_db)
        sonuclanan = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…", "KAYBETTÄ°", "âŒ"]])
        kazanan = len([m for m in self.mac_db if m.get("sonuc") in ["KAZANDI", "âœ…"]])
        
        basari = (kazanan / sonuclanan * 100) if sonuclanan > 0 else 0
        
        rapor = "ğŸ”¢ Ä°STATÄ°STÄ°K YORUMU\n"
        rapor += "â•" * 50 + "\n\n"
        
        # BaÅŸarÄ± yorumu
        if basari >= 70:
            rapor += "ğŸ”¥ MÃœKEMMEL PERFORMANS!\n"
            rapor += f"   %{basari:.0f} baÅŸarÄ± oranÄ± profesyonel seviye.\n\n"
        elif basari >= 55:
            rapor += "âœ… Ä°YÄ° PERFORMANS\n"
            rapor += f"   %{basari:.0f} baÅŸarÄ± oranÄ± ortalamanÄ±n Ã¼stÃ¼nde.\n\n"
        elif basari >= 45:
            rapor += "âš ï¸ ORTA PERFORMANS\n"
            rapor += f"   %{basari:.0f} baÅŸarÄ± oranÄ± geliÅŸtirilebilir.\n\n"
        else:
            rapor += "âŒ DÃœÅÃœK PERFORMANS\n"
            rapor += f"   %{basari:.0f} baÅŸarÄ± oranÄ± problem.\n\n"
        
        # Veri miktarÄ± yorumu
        if toplam >= 100:
            rapor += "ğŸ“Š Veri: Yeterli veri var, istatistikler gÃ¼venilir.\n"
        elif toplam >= 30:
            rapor += "ğŸ“Š Veri: Orta dÃ¼zey veri, daha fazla analiz gerekli.\n"
        else:
            rapor += "ğŸ“Š Veri: Yetersiz veri, daha fazla analiz yapÄ±lmalÄ±.\n"
        
        # Ã–neriler
        rapor += "\n" + "â•" * 50 + "\n"
        rapor += "ğŸ’¡ Ã–NERÄ°LER:\n\n"
        
        if basari < 50:
            rapor += "â€¢ Pattern Finder ile baÅŸarÄ±lÄ± kalÄ±plarÄ± bul\n"
            rapor += "â€¢ Manyetik Lig ile gÃ¼Ã§lÃ¼ liglere odaklan\n"
            rapor += "â€¢ KayÄ±p analizini incele\n"
        else:
            rapor += "â€¢ Mevcut stratejine devam et\n"
            rapor += "â€¢ Kasa yÃ¶netimine dikkat et\n"
            rapor += "â€¢ Yeni ligler keÅŸfet\n"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“‹ GÃœNLÃœK GÃ–REV LÄ°STESÄ° - V5.7 YENÄ° (#60)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def gunluk_gorev_popup(self):
        """GÃ¼nlÃ¼k gÃ¶rev listesi"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“‹ GÃ¼nlÃ¼k GÃ¶revler")
        popup.geometry("450x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“‹ GÃœNLÃœK GÃ–REV LÄ°STESÄ°", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        bugun = datetime.now().strftime("%d.%m.%Y")
        bugun_maclar = [m for m in self.mac_db if m.get("tarih") == bugun]
        bekleyen = [m for m in self.mac_db if m.get("sonuc") in ["BEKLÄ°YOR", "â³", ""]]
        
        gorevler = [
            ("ğŸ“Š En az 3 analiz yap", len(bugun_maclar) >= 3),
            ("âœ… SonuÃ§larÄ± gÃ¼ncelle", len(bekleyen) < 5),
            ("ğŸ“‹ HaftalÄ±k raporu kontrol et", True),
            ("ğŸ” Pattern Finder Ã§alÄ±ÅŸtÄ±r", True),
            ("ğŸ’¾ Yedek al", True),
            ("ğŸ§  HafÄ±za modunu incele", True),
        ]
        
        for gorev, tamamlandi in gorevler:
            frm = tk.Frame(popup, bg=ModernTheme.BG_CARD)
            frm.pack(fill="x", padx=20, pady=3)
            
            emoji = "âœ…" if tamamlandi else "â¬œ"
            renk = "#22c55e" if tamamlandi else ModernTheme.TEXT_SECONDARY
            
            tk.Label(frm, text=f"{emoji} {gorev}", bg=ModernTheme.BG_CARD, 
                    fg=renk, font=("Segoe UI", 11)).pack(anchor="w", padx=15, pady=8)
        
        tamamlanan = sum(1 for _, t in gorevler if t)
        tk.Label(popup, text=f"Ä°lerleme: {tamamlanan}/{len(gorevler)}", 
                font=("Segoe UI", 12, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_SUCCESS).pack(pady=15)
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“ˆ SKOR DURUMU ANALÄ°ZÄ° - V5.7 YENÄ° (#69)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def skor_durumu_analizi_popup(self):
        """CanlÄ± bahiste skor durumu analizi"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ“ˆ Skor Durumu")
        popup.geometry("500x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ“ˆ SKOR DURUMU ANALÄ°ZÄ°", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#00ff00")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        rapor = "ğŸ“ˆ CANLI BAHÄ°S SKOR ANALÄ°ZÄ°\n"
        rapor += "â•" * 45 + "\n\n"
        
        rapor += "ğŸ¯ Ã–NERÄ°LEN STRATEJÄ°LER:\n\n"
        rapor += "ğŸ“Š 0-0 Durumu:\n"
        rapor += "   â€¢ 1.5 Ãœst bahsi deÄŸerlendir (oran yÃ¼kselir)\n"
        rapor += "   â€¢ 60'+ dakikada KG Var dÃ¼ÅŸÃ¼n\n\n"
        
        rapor += "ğŸ“Š 1-0 / 0-1 Durumu:\n"
        rapor += "   â€¢ Geride olan takÄ±ma dikkat\n"
        rapor += "   â€¢ 2.5 Alt koruma bahsi\n\n"
        
        rapor += "ğŸ“Š 1-1 Durumu:\n"
        rapor += "   â€¢ 2.5 Ãœst deÄŸerli olabilir\n"
        rapor += "   â€¢ Son dakika gol ihtimali yÃ¼ksek\n\n"
        
        rapor += "ğŸ“Š 2-0 / 0-2 Durumu:\n"
        rapor += "   â€¢ Dikkat: Geri dÃ¶nÃ¼ÅŸ zor\n"
        rapor += "   â€¢ Handikap bahisleri incele\n\n"
        
        rapor += "â•" * 45 + "\n"
        rapor += "ğŸ’¡ Her duruma gÃ¶re strateji belirle!"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ¯ CANLI TAKTÄ°KLER - V5.7 YENÄ° (#70)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def canli_taktikler_popup(self):
        """CanlÄ± bahis taktikleri"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ¯ CanlÄ± Taktikler")
        popup.geometry("550x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ¯ CANLI BAHÄ°S TAKTÄ°KLERÄ°", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_DANGER).pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#ff6b6b")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        rapor = """ğŸ¯ CANLI BAHÄ°S TAKTÄ°KLERÄ°
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â° DAKÄ°KA BAZLI STRATEJÄ°LER:

ğŸ“ 0-15' (BaÅŸlangÄ±Ã§)
   â€¢ Bekle ve gÃ¶zlemle
   â€¢ Ä°lk 15'te bahis yapma
   â€¢ TakÄ±mlarÄ±n performansÄ±nÄ± izle

ğŸ“ 15-30' (Erken DÃ¶nem)
   â€¢ Gol yoksa 1.5 Ãœst deÄŸerlendir
   â€¢ BaskÄ±n takÄ±mÄ± tespit et
   â€¢ Oran hareketlerini takip et

ğŸ“ 30-45' (Ä°lk YarÄ± Sonu)
   â€¢ Ä°lk yarÄ± sonucu netleÅŸir
   â€¢ Korner/kart bahisleri iÃ§in ideal
   â€¢ 0-0 ise 2.5 Alt dÃ¼ÅŸÃ¼n

ğŸ“ 45-60' (Ä°kinci YarÄ± BaÅŸÄ±)
   â€¢ TakÄ±m deÄŸiÅŸiklikleri
   â€¢ Taze oyuncular = gol potansiyeli
   â€¢ Strateji deÄŸiÅŸikliklerini izle

ğŸ“ 60-75' (Kritik DÃ¶nem)
   â€¢ En fazla gol atÄ±lan periyot
   â€¢ 1.5/2.5 Ãœst iÃ§in ideal
   â€¢ Geride olan risk alÄ±r

ğŸ“ 75-90' (Final)
   â€¢ SÃ¼rpriz sonuÃ§lar olabilir
   â€¢ YÃ¼ksek oran, yÃ¼ksek risk
   â€¢ Cash out deÄŸerlendir

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’¡ SabÄ±rlÄ± ol, doÄŸru anÄ± bekle!
"""
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ”” CANLI FIRSAT ALARMI - V5.7 YENÄ° (#71)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def canli_firsat_alarmi_popup(self):
        """CanlÄ± fÄ±rsat alarmÄ± ayarlarÄ±"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ”” FÄ±rsat AlarmÄ±")
        popup.geometry("450x350")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ”” CANLI FIRSAT ALARMI", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_WARNING).pack(pady=15)
        
        tk.Label(popup, text="Alarm koÅŸullarÄ±nÄ± belirle:", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        
        frm = tk.Frame(popup, bg=ModernTheme.BG_CARD)
        frm.pack(fill="x", padx=30, pady=20)
        
        # Alarm seÃ§enekleri
        self.alarm_var1 = tk.BooleanVar(value=True)
        self.alarm_var2 = tk.BooleanVar(value=True)
        self.alarm_var3 = tk.BooleanVar(value=False)
        
        tk.Checkbutton(frm, text="ğŸ¯ YÃ¼ksek gÃ¼venli maÃ§ baÅŸladÄ±ÄŸÄ±nda", 
                      variable=self.alarm_var1, bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY,
                      selectcolor=ModernTheme.BG_HOVER).pack(anchor="w", padx=15, pady=5)
        
        tk.Checkbutton(frm, text="ğŸ“‰ Favori takÄ±m geride kaldÄ±ÄŸÄ±nda", 
                      variable=self.alarm_var2, bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY,
                      selectcolor=ModernTheme.BG_HOVER).pack(anchor="w", padx=15, pady=5)
        
        tk.Checkbutton(frm, text="â° 75'+ dakikada 0-0 durumunda", 
                      variable=self.alarm_var3, bg=ModernTheme.BG_CARD, fg=ModernTheme.TEXT_PRIMARY,
                      selectcolor=ModernTheme.BG_HOVER).pack(anchor="w", padx=15, pady=5)
        
        def kaydet():
            messagebox.showinfo("âœ…", "Alarm ayarlarÄ± kaydedildi!")
            popup.destroy()
        
        tk.Button(popup, text="ğŸ’¾ Kaydet", command=kaydet,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat",
                  font=("Segoe UI", 11)).pack(pady=20)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ“± CANLI TELEGRAM - V5.7 YENÄ° (#74)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def canli_telegram_gonder(self):
        """CanlÄ± bahis bilgisini Telegram'a gÃ¶nder - YENÄ° FORMAT"""
        if not hasattr(self, 'canli_db') or not self.canli_db:
            messagebox.showwarning("UyarÄ±", "CanlÄ± bahis kaydÄ± yok!")
            return
        
        son_canli = self.canli_db[-1]
        
        # Kritik 3 veriyi al (varsa)
        kritik_veriler = son_canli.get('kritik_3', '')
        if not kritik_veriler:
            # EÄŸer kritik veri yoksa, son analizden almaya Ã§alÄ±ÅŸ
            if hasattr(self, 'last_result') and self.last_result:
                kritik_match = re.search(r'EN KRÄ°TÄ°K 3 VERÄ°SÄ°.*?(?=\n\n|\nâ”|\nâ”€)', self.last_result, re.DOTALL)
                if kritik_match:
                    kritik_veriler = kritik_match.group().strip()
        
        mesaj = f"""ğŸ”´ CANLI BAHÄ°S
âš½ï¸ {son_canli.get('mac', '?')}
ğŸ† {son_canli.get('lig', '?')}
â° {son_canli.get('dakika', '?')}'
ğŸ“Š Skor: {son_canli.get('skor_giris', son_canli.get('skor', '?'))}
ğŸ¯ Tahmin: {son_canli.get('bahis', son_canli.get('tahmin', '?'))}
ğŸ’° Oran: {son_canli.get('oran', '?')}

ğŸ“Œ BU MAÃ‡IN KRÄ°TÄ°K 3 VERÄ°SÄ°:
{kritik_veriler if kritik_veriler else 'â€¢ Analiz verileri mevcut deÄŸil'}

#90DakikaAnaliz"""
        
        # Ã–nizleme popup'Ä± gÃ¶ster
        self._telegram_onizleme_popup(mesaj, "CanlÄ± Bahis")
    
    def _telegram_onizleme_popup(self, mesaj, baslik):
        """Telegram gÃ¶nderme Ã¶ncesi Ã¶nizleme popup'Ä±"""
        popup = tk.Toplevel(self.root)
        popup.title(f"ğŸ“± {baslik} - Ã–nizleme")
        popup.geometry("500x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        popup.grab_set()
        
        tk.Label(popup, text=f"ğŸ“± {baslik} Ã–NÄ°ZLEME", font=("Segoe UI", 14, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        # Mesaj Ã¶nizleme
        txt = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#1a1a1a", fg="#00FF00",
                                        height=15, width=55)
        txt.pack(padx=20, pady=10, fill="both", expand=True)
        txt.insert(tk.END, mesaj)
        txt.config(state="disabled")
        
        # Butonlar
        btn_frame = tk.Frame(popup, bg=ModernTheme.BG_PRIMARY)
        btn_frame.pack(pady=15)
        
        tk.Button(btn_frame, text="ğŸ“¤ GÃ–NDER", command=lambda: self._onizleme_gonder(popup, mesaj),
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", font=("Arial", 11, "bold"),
                  width=15, relief="flat").pack(side="left", padx=10)
        
        tk.Button(btn_frame, text="âŒ Ä°PTAL", command=popup.destroy,
                  bg=ModernTheme.ACCENT_DANGER, fg="white", font=("Arial", 11),
                  width=15, relief="flat").pack(side="left", padx=10)
    
    def _onizleme_gonder(self, popup, mesaj):
        """Ã–nizlemeden sonra gÃ¶nder"""
        popup.destroy()
        self.kanal_sec_ve_gonder(mesaj, "Telegram GÃ¶nder")

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ† HAFTALIK TURNUVA - V5.7 YENÄ° (#89b)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def haftalik_turnuva_popup(self):
        """HaftalÄ±k en iyi maÃ§lar turnuvasÄ±"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ† HaftalÄ±k Turnuva")
        popup.geometry("550x400")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ† HAFTALIK TURNUVA", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg="#ffd700").pack(pady=10)
        
        text = scrolledtext.ScrolledText(popup, font=("Consolas", 10), bg="#0a0a0a", fg="#ffd700")
        text.pack(fill="both", expand=True, padx=20, pady=10)
        
        # Son 7 gÃ¼nÃ¼n maÃ§larÄ±
        bugun = datetime.now()
        hafta_once = (bugun - timedelta(days=7)).strftime("%d.%m.%Y")
        
        hafta_maclari = []
        for mac in self.mac_db:
            tarih = mac.get("tarih", "")
            guven = mac.get("guven", 0)
            if isinstance(guven, str):
                try: guven = int(guven.split("/")[0])
                except: guven = 0
            
            sonuc = mac.get("sonuc", "")
            if sonuc in ["KAZANDI", "âœ…"]:
                hafta_maclari.append((mac, guven))
        
        # En yÃ¼ksek gÃ¼vene gÃ¶re sÄ±rala
        hafta_maclari.sort(key=lambda x: x[1], reverse=True)
        
        rapor = "ğŸ† HAFTANIN EN Ä°YÄ° MAÃ‡LARI\n"
        rapor += "â•" * 45 + "\n\n"
        
        if hafta_maclari:
            for i, (mac, guven) in enumerate(hafta_maclari[:5], 1):
                madalya = "ğŸ¥‡" if i == 1 else ("ğŸ¥ˆ" if i == 2 else ("ğŸ¥‰" if i == 3 else f"{i}."))
                rapor += f"{madalya} {mac.get('mac', '?')[:25]}\n"
                rapor += f"   ğŸ¯ {mac.get('banko', '?')} | ğŸ“Š G:{guven}/10\n\n"
            
            rapor += "â•" * 45 + "\n"
            rapor += f"âœ… Bu hafta {len(hafta_maclari)} maÃ§ kazandÄ±n!"
        else:
            rapor += "âŒ Bu hafta kazanan maÃ§ yok.\n"
            rapor += "ğŸ’ª Gelecek hafta daha iyi olacak!"
        
        text.insert("1.0", rapor)
        text.config(state="disabled")
        
        tk.Button(popup, text="Kapat", command=popup.destroy,
                  bg=ModernTheme.BG_HOVER, fg=ModernTheme.TEXT_PRIMARY, relief="flat").pack(pady=10)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ğŸ”€ SEKME SIRALAMA - V5.7 YENÄ° (#101)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    def sekme_siralama_popup(self):
        """Sidebar sekmelerini yeniden sÄ±rala"""
        popup = tk.Toplevel(self.root)
        popup.title("ğŸ”€ Sekme SÄ±ralama")
        popup.geometry("400x450")
        popup.configure(bg=ModernTheme.BG_PRIMARY)
        popup.transient(self.root)
        
        tk.Label(popup, text="ğŸ”€ SEKME SIRALAMA", font=("Segoe UI", 16, "bold"),
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.ACCENT_PRIMARY).pack(pady=10)
        
        tk.Label(popup, text="Sekmeleri yukarÄ±/aÅŸaÄŸÄ± taÅŸÄ±:", 
                bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_SECONDARY).pack()
        
        frm = tk.Frame(popup, bg=ModernTheme.BG_CARD)
        frm.pack(fill="both", expand=True, padx=20, pady=10)
        
        sekmeler = ["ğŸ“Š Dashboard", "ğŸš€ Analiz", "ğŸ“ ArÅŸiv", "ğŸ”´ CanlÄ±", "ğŸ“‹ Kupon", 
                   "ğŸ“± Telegram", "ğŸ“‘ Excel", "ğŸ”¬ Lab", "âš™ï¸ Ayarlar"]
        
        listbox = tk.Listbox(frm, bg=ModernTheme.BG_PRIMARY, fg=ModernTheme.TEXT_PRIMARY,
                            font=("Segoe UI", 11), height=12, selectbackground=ModernTheme.ACCENT_PRIMARY)
        listbox.pack(side="left", fill="both", expand=True, padx=10, pady=10)
        
        for s in sekmeler:
            listbox.insert(tk.END, s)
        
        btn_frm = tk.Frame(frm, bg=ModernTheme.BG_CARD)
        btn_frm.pack(side="right", padx=10)
        
        def yukari():
            idx = listbox.curselection()
            if idx and idx[0] > 0:
                item = listbox.get(idx)
                listbox.delete(idx)
                listbox.insert(idx[0]-1, item)
                listbox.select_set(idx[0]-1)
        
        def asagi():
            idx = listbox.curselection()
            if idx and idx[0] < listbox.size()-1:
                item = listbox.get(idx)
                listbox.delete(idx)
                listbox.insert(idx[0]+1, item)
                listbox.select_set(idx[0]+1)
        
        tk.Button(btn_frm, text="â¬†ï¸", command=yukari, bg=ModernTheme.BG_HOVER, 
                 fg=ModernTheme.TEXT_PRIMARY, width=4).pack(pady=5)
        tk.Button(btn_frm, text="â¬‡ï¸", command=asagi, bg=ModernTheme.BG_HOVER, 
                 fg=ModernTheme.TEXT_PRIMARY, width=4).pack(pady=5)
        
        def kaydet():
            messagebox.showinfo("âœ…", "Sekme sÄ±ralamasÄ± kaydedildi!\n(Yeniden baÅŸlatÄ±nca aktif olur)")
            popup.destroy()
        
        tk.Button(popup, text="ğŸ’¾ Kaydet", command=kaydet,
                  bg=ModernTheme.ACCENT_SUCCESS, fg="white", relief="flat").pack(pady=10)


# ============================================================
# MAIN
# ============================================================
def _api_key_iste():
    """Ä°lk aÃ§Ä±lÄ±ÅŸta API key iste"""
    import tkinter.simpledialog as simpledialog
    
    # GeÃ§ici root pencere
    temp_root = tk.Tk()
    temp_root.withdraw()
    
    # Bilgi mesajÄ±
    messagebox.showinfo(
        "ğŸ”‘ API Key Gerekli",
        "XG-XRAY Commander'Ä± kullanmak iÃ§in\n"
        "Google Gemini API Key gereklidir.\n\n"
        "API Key almak iÃ§in:\n"
        "1. https://aistudio.google.com adresine gidin\n"
        "2. Google hesabÄ±nÄ±zla giriÅŸ yapÄ±n\n"
        "3. 'Get API Key' butonuna tÄ±klayÄ±n\n"
        "4. Yeni key oluÅŸturun ve kopyalayÄ±n"
    )
    
    # API key iste
    api_key = simpledialog.askstring(
        "ğŸ”‘ Gemini API Key",
        "LÃ¼tfen Gemini API Key'inizi girin:",
        parent=temp_root
    )
    
    temp_root.destroy()
    
    if api_key and api_key.strip():
        _save_api_key(api_key.strip())
        return api_key.strip()
    return None

def main():
    global DEFAULT_API_KEY
    
    # API Key kontrolÃ¼
    if not DEFAULT_API_KEY:
        api_key = _api_key_iste()
        if api_key:
            DEFAULT_API_KEY = api_key
        else:
            messagebox.showerror(
                "âŒ API Key Gerekli",
                "API Key girilmeden program Ã§alÄ±ÅŸamaz.\n"
                "LÃ¼tfen programÄ± tekrar baÅŸlatÄ±n."
            )
            return
    
    root = tk.Tk()
    app = XrayCommanderV70(root)
    root.mainloop()


if __name__ == "__main__":
    main()
